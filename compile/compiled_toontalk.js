var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.checkStringArgs=function(a,k,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(k instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,k,c){a!=Array.prototype&&a!=Object.prototype&&(a[k]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,k,c,e){if(k){c=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var b=a[e];b in c||(c[b]={});c=c[b]}a=a[a.length-1];e=c[a];k=k(e);k!=e&&null!=k&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:k})}};
$jscomp.polyfill("String.prototype.repeat",function(a){return a?a:function(a){var c=$jscomp.checkStringArgs(this,null,"repeat");if(0>a||1342177279<a)throw new RangeError("Invalid count value");a|=0;for(var e="";a;)if(a&1&&(e+=c),a>>>=1)c+=c;return e}},"es6","es3");$jscomp.findInternal=function(a,k,c){a instanceof String&&(a=String(a));for(var e=a.length,b=0;b<e;b++){var h=a[b];if(k.call(c,h,b,a))return{i:b,v:h}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var k=0;return $jscomp.iteratorPrototype(function(){return k<a.length?{done:!1,value:a[k++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,k){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,e={next:function(){if(c<a.length){var b=c++;return{value:k(b,a[b]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e};
$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,c){return c})}},"es6","es3");$jscomp.polyfill("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991},"es6","es3");$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
$jscomp.polyfill("Object.is",function(a){return a?a:function(a,c){return a===c?0!==a||1/a===1/c:a!==a&&c!==c}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,c){var e=this;e instanceof String&&(e=String(e));var b=e.length;for(c=c||0;c<b;c++)if(e[c]==a||Object.is(e[c],a))return!0;return!1}},"es7","es3");
$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,c){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,c||0)}},"es6","es3");
(function(a){if("undefined"===typeof exports)if("function"===typeof define&&"object"===typeof define.amd&&define.amd){var k={};define(function(){return k})}else k="undefined"!==typeof window?window:a;else k=exports;(function(a){var c,b,h,m,g,k={greatest_common_divisor:function(a,b){if(1===b||1===a)return 1;for(var n;0!==b;){n=b;b=a%b;if(!isFinite(b))return 0;a=n}return a}};k.gcd=k.greatest_common_divisor;k.fromRandom=function(a){return Math.random()*(1<<a)>>>0};k.fromMillitime=function(){return+new Date};
k.fromUnixtime=function(){return.001*k.fromMillitime()|0};"undefined"!==typeof a&&(a.integer=k);(function(a){function n(a,e,g){if(g!==b)return a instanceof n?a:"undefined"===typeof a?c:n.parse(a);for(a=a||[];a.length&&!a[a.length-1];)--a.length;this._d=a;this._s=a.length?e||1:0}var b={};n._construct=function(a,c){return new n(a,c,b)};n.base=1E7;n.base_log10=7;var c=new n([],0,b);n.ZERO=c;var e=new n([1],1,b);n.ONE=e;var g=new n(e._d,-1,b);n.M_ONE=g;n._0=c;n._1=e;n.small=[c,e,new n([2],1,b),new n([3],
1,b),new n([4],1,b),new n([5],1,b),new n([6],1,b),new n([7],1,b),new n([8],1,b),new n([9],1,b),new n([10],1,b),new n([11],1,b),new n([12],1,b),new n([13],1,b),new n([14],1,b),new n([15],1,b),new n([16],1,b),new n([17],1,b),new n([18],1,b),new n([19],1,b),new n([20],1,b),new n([21],1,b),new n([22],1,b),new n([23],1,b),new n([24],1,b),new n([25],1,b),new n([26],1,b),new n([27],1,b),new n([28],1,b),new n([29],1,b),new n([30],1,b),new n([31],1,b),new n([32],1,b),new n([33],1,b),new n([34],1,b),new n([35],
1,b),new n([36],1,b)];n.digits="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");n.prototype.toString=function(a){a=+a||10;if(2>a||36<a)throw Error("illegal radix "+a+".");if(0===this._s)return"0";if(10===a){a=0>this._s?"-":"";a+=this._d[this._d.length-1].toString();for(var b=this._d.length-2;0<=b;b--){for(var c=this._d[b].toString();7>c.length;)c="0"+c;a+=c}return a}b=n.digits;a=n.small[a];c=this._s;for(var e=this.abs(),g=[],w;0!==e._s;)w=e.divRem(a),e=w[0],w=w[1],g.push(b[w.valueOf()]);return(0>
c?"-":"")+g.reverse().join("")};n.radixRegex=[/^$/,/^$/,/^[01]*$/,/^[012]*$/,/^[0-3]*$/,/^[0-4]*$/,/^[0-5]*$/,/^[0-6]*$/,/^[0-7]*$/,/^[0-8]*$/,/^[0-9]*$/,/^[0-9aA]*$/,/^[0-9abAB]*$/,/^[0-9abcABC]*$/,/^[0-9a-dA-D]*$/,/^[0-9a-eA-E]*$/,/^[0-9a-fA-F]*$/,/^[0-9a-gA-G]*$/,/^[0-9a-hA-H]*$/,/^[0-9a-iA-I]*$/,/^[0-9a-jA-J]*$/,/^[0-9a-kA-K]*$/,/^[0-9a-lA-L]*$/,/^[0-9a-mA-M]*$/,/^[0-9a-nA-N]*$/,/^[0-9a-oA-O]*$/,/^[0-9a-pA-P]*$/,/^[0-9a-qA-Q]*$/,/^[0-9a-rA-R]*$/,/^[0-9a-sA-S]*$/,/^[0-9a-tA-T]*$/,/^[0-9a-uA-U]*$/,
/^[0-9a-vA-V]*$/,/^[0-9a-wA-W]*$/,/^[0-9a-xA-X]*$/,/^[0-9a-yA-Y]*$/,/^[0-9a-zA-Z]*$/];n.parse=function(a,e){function g(a){a=a.replace(/\s*[*xX]\s*10\s*(\^|\*\*)\s*/,"e");return a.replace(/^([+\-])?(\d+)\.?(\d*)[eE]([+\-]?\d+)$/,function(a,d,f,n,b){b=+b;var r=0>b,t=f.length+b;a=(r?f:n).length;b=(b=Math.abs(b))>=a?b-a+r:0;a=Array(b+1).join("0");f+=n;return(d||"")+(r?f=a+f:f+=a).substr(0,t+=r?a.length:0)+(t<f.length?"."+f.substr(t):"")})}var w;a=a.toString();if("undefined"===typeof e||10===+e)a=g(a);
if(w=(new RegExp("^([+\\-]?)("+("undefined"===typeof e?"0[xcb]":16==e?"0x":8==e?"0c":2==e?"0b":"")+")?([0-9a-z]*)(?:\\.\\d*)?$","i")).exec(a)){a=w[1]||"+";var h=w[2]||"";w=w[3]||"";if("undefined"===typeof e)e="0x"===h||"0X"===h?16:"0c"===h||"0C"===h?8:"0b"===h||"0B"===h?2:10;else if(2>e||36<e)throw Error("Illegal radix "+e+".");e=+e;if(!n.radixRegex[e].test(w))throw Error("Bad digit for radix "+e);w=w.replace(/^0+/,"").split("");if(0===w.length)return c;a="-"===a?-1:1;if(10==e){for(h=[];7<=w.length;)h.push(parseInt(w.splice(w.length-
n.base_log10,n.base_log10).join(""),10));h.push(parseInt(w.join(""),10));return new n(h,a,b)}h=c;e=n.small[e];for(var m=n.small,p=0;p<w.length;p++)h=h.multiply(e).add(m[parseInt(w[p],36)]);return new n(h._d,a,b)}throw Error("Invalid BigInteger format: "+a);};n.prototype.add=function(a){if(0===this._s)return n(a);a=n(a);if(0===a._s)return this;if(this._s!==a._s)return a=a.negate(),this.subtract(a);var c=this._d;a=a._d;for(var e=c.length,g=a.length,w=Array(Math.max(e,g)+1),h=Math.min(e,g),m=0,p=0;p<
h;p++)m=c[p]+a[p]+m,w[p]=m%1E7,m=m/1E7|0;g>e&&(c=a,e=g);for(p=h;m&&p<e;p++)m=c[p]+m,w[p]=m%1E7,m=m/1E7|0;for(m&&(w[p]=m);p<e;p++)w[p]=c[p];return new n(w,this._s,b)};n.prototype.negate=function(){return new n(this._d,-this._s|0,b)};n.prototype.abs=function(){return 0>this._s?this.negate():this};n.prototype.subtract=function(a){if(0===this._s)return n(a).negate();a=n(a);if(0===a._s)return this;if(this._s!==a._s)return a=a.negate(),this.add(a);var e=this;0>this._s&&(e=new n(a._d,1,b),a=new n(this._d,
1,b));var g=e.compareAbs(a);if(0===g)return c;if(0>g){var w=a;a=e;e=w}e=e._d;a=a._d;w=e.length;var h=a.length,m=Array(w),p=0,k;for(k=0;k<h;k++){var q=e[k]-p-a[k];0>q?(q+=1E7,p=1):p=0;m[k]=q}for(k=h;k<w;k++){q=e[k]-p;if(0>q)q+=1E7;else{m[k++]=q;break}m[k]=q}for(;k<w;k++)m[k]=e[k];return new n(m,g,b)};(function(){function a(a,c){a=a._d;for(var e=a.slice(),g=0;;){var w=(a[g]||0)+1;e[g]=w%1E7;if(9999999>=w)break;++g}return new n(e,c,b)}function c(a,c){a=a._d;for(var e=a.slice(),g=0;;){var w=(a[g]||0)-
1;if(0>w)e[g]=w+1E7;else{e[g]=w;break}++g}return new n(e,c,b)}n.prototype.next=function(){switch(this._s){case 0:return e;case -1:return c(this,-1);default:return a(this,1)}};n.prototype.prev=function(){switch(this._s){case 0:return g;case -1:return a(this,-1);default:return c(this,1)}}})();n.prototype.compareAbs=function(a){if(this===a)return 0;if(!(a instanceof n)){if(!isFinite(a))return isNaN(a)?a:-1;a=n(a)}if(0===this._s)return 0!==a._s?-1:0;if(0===a._s)return 1;var b=this._d.length,c=a._d.length;
if(b<c)return-1;if(b>c)return 1;c=this._d;a=a._d;for(--b;0<=b;b--)if(c[b]!==a[b])return c[b]<a[b]?-1:1;return 0};n.prototype.compare=function(a){if(this===a)return 0;a=n(a);return 0===this._s?-a._s:this._s===a._s?this.compareAbs(a)*this._s:this._s};n.prototype.isUnit=function(){return this===e||this===g||1===this._d.length&&1===this._d[0]};n.prototype.multiply=function(a){if(0===this._s)return c;a=n(a);if(0===a._s)return c;if(this.isUnit())return 0>this._s?a.negate():a;if(a.isUnit())return 0>a._s?
this.negate():this;if(this===a)return this.square();var e=this._d.length>=a._d.length,g=(e?this:a)._d;e=(e?a:this)._d;var w=g.length,h=e.length,m=w+h,p=Array(m),k;for(k=0;k<m;k++)p[k]=0;for(k=0;k<h;k++){m=0;for(var q=e[k],d=w+k,f,r=k;r<d;r++)f=p[r]+q*g[r-k]+m,m=f/1E7|0,p[r]=f%1E7|0;m&&(f=p[r]+m,p[r]=f%1E7)}return new n(p,this._s*a._s,b)};n.prototype.multiplySingleDigit=function(a){if(0===a||0===this._s)return c;if(1===a)return this;var e;if(1===this._d.length)return e=this._d[0]*a,1E7<=e?new n([e%
1E7|0,e/1E7|0],1,b):new n([e],1,b);if(2===a)return this.add(this);if(this.isUnit())return new n([a],1,b);var g=this._d,w=g.length;e=w+1;for(var h=Array(e),m=0;m<e;m++)h[m]=0;for(var p=m=0;p<w;p++)e=a*g[p]+m,m=e/1E7|0,h[p]=e%1E7|0;m&&(h[p]=m);return new n(h,1,b)};n.prototype.square=function(){if(0===this._s)return c;if(this.isUnit())return e;var a=this._d,g=a.length,w=Array(g+g+1),h;for(h=0;h<g;h++){var m=2*h;var p=a[h]*a[h];var k=p/1E7|0;w[m]=p%1E7;w[m+1]=k}for(h=0;h<g;h++){k=0;m=2*h+1;for(var q=
h+1;q<g;q++,m++)p=a[q]*a[h]*2+w[m]+k,k=p/1E7|0,w[m]=p%1E7;m=g+h;p=k+w[m];k=p/1E7|0;w[m]=p%1E7;w[m+1]+=k}return new n(w,1,b)};n.prototype.quotient=function(a){return this.divRem(a)[0]};n.prototype.divide=n.prototype.quotient;n.prototype.remainder=function(a){return this.divRem(a)[1]};n.prototype.divRem=function(a){a=n(a);if(0===a._s)throw Error("Divide by zero");if(0===this._s)return[c,c];if(1===a._d.length)return this.divRemSmall(a._s*a._d[0]);switch(this.compareAbs(a)){case 0:return[this._s===a._s?
e:g,c];case -1:return[c,this]}var w=this._s*a._s,h=a.abs(),m=this._d,p=m.length,k=[],q=new n([],0,b);for(q._s=1;p;)if(q._d.unshift(m[--p]),0>q.compareAbs(a))k.push(0);else{if(0===q._s)var y=0;else{var v=q._d.length;y=h._d.length;v=1E7*q._d[v-1]+q._d[v-2];y=1E7*h._d[y-1]+h._d[y-2];q._d.length>h._d.length&&(v=1E7*(v+1));y=Math.ceil(v/y)}do{v=h.multiplySingleDigit(y);if(0>=v.compareAbs(q))break;y--}while(y);k.push(y);y&&(y=q.subtract(v),q._d=y._d.slice(),0===q._d.length&&(q._s=0))}return[new n(k.reverse(),
w,b),new n(q._d,this._s,b)]};n.prototype.divRemSmall=function(a){a=+a;if(0===a)throw Error("Divide by zero");var e=this._s*(0>a?-1:1);a=Math.abs(a);if(1>a||1E7<=a)throw Error("Argument out of range");if(0===this._s)return[c,c];if(1===a||-1===a)return[1===e?this.abs():new n(this._d,e,b),c];if(1===this._d.length){var g=new n([this._d[0]/a|0],1,b);a=new n([this._d[0]%a|0],1,b);0>e&&(g=g.negate());0>this._s&&(a=a.negate());return[g,a]}var w=this._d.slice();g=Array(w.length);for(var h=0,m=0,p=0,k;w.length;)h=
1E7*h+w[w.length-1],h<a?(g[p++]=0,w.pop(),m=1E7*m+h):(k=0===h?0:h/a|0,m=h-a*k,(g[p++]=k)?(w.pop(),h=m):w.pop());a=new n([m],1,b);0>this._s&&(a=a.negate());return[new n(g.reverse(),e,b),a]};n.prototype.isEven=function(){var a=this._d;return 0===this._s||0===a.length||0===a[0]%2};n.prototype.isOdd=function(){return!this.isEven()};n.prototype.sign=function(){return this._s};n.prototype.isPositive=function(){return 0<this._s};n.prototype.isNegative=function(){return 0>this._s};n.prototype.isZero=function(){return 0===
this._s};n.prototype.exp10=function(a){a=+a;if(0===a)return this;if(Math.abs(a)>Number(h))throw Error("exponent too large in BigInteger.exp10");if(0<a){for(var e=new n(this._d.slice(),this._s,b);7<=a;a-=7)e._d.unshift(0);if(0==a)return e;e._s=1;e=e.multiplySingleDigit(Math.pow(10,a));return 0>this._s?e.negate():e}if(-a>=7*this._d.length)return c;e=new n(this._d.slice(),this._s,b);for(a=-a;7<=a;a-=7)e._d.shift();return 0==a?e:e.divRemSmall(Math.pow(10,a))[0]};n.prototype.pow=function(a){if(this.isUnit())return 0<
this._s?this:n(a).isOdd()?this:this.negate();a=n(a);if(0===a._s)return e;if(0>a._s){if(0===this._s)throw Error("Divide by zero");return c}if(0===this._s)return c;if(a.isUnit())return this;if(0<a.compareAbs(h))throw Error("exponent too large in BigInteger.pow");for(var b=this,g=e,w=n.small[2];a.isPositive()&&(!a.isOdd()||(g=g.multiply(b),!a.isUnit()));)b=b.square(),a=a.quotient(w);return g};n.prototype.modPow=function(a,b){for(var c=e,g=this;a.isPositive();)a.isOdd()&&(c=c.multiply(g).remainder(b)),
a=a.quotient(n.small[2]),a.isPositive()&&(g=g.square().remainder(b));return c};n.prototype.log=function(){switch(this._s){case 0:return-Infinity;case -1:return NaN}var a=this._d.length;if(30>7*a)return Math.log(this.valueOf());var c=Math.ceil(30/7),e=this._d.slice(a-c);return Math.log((new n(e,1,b)).valueOf())+(a-c)*Math.log(1E7)};n.prototype.valueOf=function(){return parseInt(this.toString(),10)};n.prototype.toJSValue=function(){return parseInt(this.toString(),10)};var h=n(2147483647);n.MAX_EXP=
h;(function(){function a(a){return function(b){return a.call(n(b))}}function b(a){return function(b,c){return a.call(n(b),n(c))}}function c(a){return function(b,c,e){return a.call(n(b),n(c),n(e))}}(function(){var e,g="toJSValue isEven isOdd sign isZero isNegative abs isUnit square negate isPositive toString next prev log".split(" "),w="compare remainder divRem subtract add quotient divide multiply pow compareAbs".split(" "),h=["modPow"];for(e=0;e<g.length;e++){var m=g[e];n[m]=a(n.prototype[m])}for(e=
0;e<w.length;e++)m=w[e],n[m]=b(n.prototype[m]);for(e=0;e<h.length;e++)m=h[e],n[m]=c(n.prototype[m]);n.exp10=function(a,d){return n(a).exp10(d)}})()})();a.BigInteger=n})("undefined"!==typeof a?a:this);var x={greatest_common_divisor:function(a,b){if(b.isUnit()||a.isUnit())return BigInteger.ONE;for(var n;!b.isZero();)n=b,b=a.remainder(b),a=n;return a},create:function(){return[0]},clone:function(a){for(var n=[],b=0,c=a.length;b<c;b++)n[b]=a[b];return n},copy:function(a,b){a=[];for(var n=0,c=b.length;n<
c;n++)a[n]=b[n];return a},abs:function(a,b){a[0]=Math.abs(b[0]);return a},str:function(a){return a[0].toString()},toInteger:function(a){return out[0]},fromInteger:function(a){return[parseInt(a)]}};x.ZERO=x.fromInteger(0);x.ONE=x.fromInteger(1);"undefined"!==typeof a&&(a.bigint=x);g||(g=Array);m||(m=Math.pow(2,56));h||(h=16777216);var p={EPSILON:2E-16};p.MAX_LOOPS=h;p.create=function(){var a=new g(2);a[0]=0;a[1]=1;return a};p.clone=function(a){var n=new g(2);n[0]=a[0];n[1]=a[1];return n};p.fromValues=
function(a,b){var n=new g(2);n[0]=a;n[1]=b;return p.normalize(n,n)};p.copy=function(a,b){a[0]=b[0];a[1]=b[1];return a};p.set=function(a,b,c){a[0]=b;a[1]=c;return p.normalize(a,a)};p.abs=function(a,b){a[0]=Math.abs(b[0]);a[1]=b[1];return a};p.invert=function(a,b){var n=b[0];a[0]=b[1];a[1]=n;return a};p.reciprocal=p.invert;p.add=function(a,b,c){b[1]===c[1]?(a[0]=b[0]+c[0],a[1]=b[1]):(a[0]=b[0]*c[1]+c[0]*b[1],a[1]=b[1]*c[1]);return p.normalize(a,a)};p.subtract=function(a,b,c){b[1]===c[1]?(a[0]=b[0]-
c[0],a[1]=b[1]):(a[0]=b[0]*c[1]-c[0]*b[1],a[1]=b[1]*c[1]);return p.normalize(a,a)};p.sub=p.subtract;p.multiply=function(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];return p.normalize(a,a)};p.mul=p.multiply;p.mediant=function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];return p.normalize(a,a)};p.divide=function(a,b,c){a[0]=b[0]*c[1];a[1]=b[1]*c[0];return p.normalize(a,a)};p.div=p.divide;p.equals=function(a,b){return 0===a[0]&&0===b[0]||0===a[1]&&0===b[1]?!0:a[0]===b[0]&&a[1]===b[1]};p.approximates=function(a,b){if(p.equals(a,
b))return!0;var n=p.create();p.sub(n,a,b);p.abs(n,n);return p.isLessThan(n,p.INFINITESIMAL)};p.isGreaterThan=function(a,b){return p.equals(a,b)?!1:a[0]*b[1]>b[0]*a[1]};p.isLessThan=function(a,b){return p.equals(a,b)?!1:a[0]*b[1]<b[0]*a[1]};p.isNegative=function(a){return 0>a[0]};p.min=function(a,b,c){p.isLessThan(b,c)?(a[0]=b[0],a[1]=b[1]):(a[0]=c[0],a[1]=c[1]);return a};p.max=function(a,b,c){p.isGreaterThan(b,c)?(a[0]=b[0],a[1]=b[1]):(a[0]=c[0],a[1]=c[1]);return a};p.scalar_multiply=function(a,b,
c){a[0]=b[0]*c;a[1]=b[1];return p.normalize(a,a)};p.scalar_divide=function(a,b,c){a[0]=b[0];a[1]=b[1]*c;return p.normalize(a,a)};p.normalize=function(a,b){if(isNaN(b[0])||isNaN(b[1])||0===b[0]&&0===b[1])return a[0]=0,a[1]=0,a;if(0===b[0])return a[0]=0,a[1]=1,a;if(0===b[1])return a[0]=1,a[1]=0,a;if(b[0]===b[1])return a[0]=1,a[1]=1,a;0<b[1]?(a[0]=b[0],a[1]=b[1]):(a[0]=-b[0],a[1]=-b[1]);b=k.greatest_common_divisor(Math.abs(a[0]),a[1]);1<b&&(a[0]/=b,a[1]/=b);return a};p.opposite=function(a,b){a[0]=-b[0];
a[1]=b[1];return a};p.negative=p.opposite;p.neg=p.opposite;p.power=function(a,b,c){2===c?(a[0]=b[0]*b[0],a[1]=b[1]*b[1]):0<c?(a[0]=Math.pow(b[0],c),a[1]=Math.pow(b[1],c)):0>c?(c=Math.abs(c),a[0]=Math.pow(b[1],c),a[1]=Math.pow(b[0],c)):p.copy(a,p.ONE);return p.normalize(a,a)};p.pow=p.power;p.sqrt=function(a,b){return p.nthRoot(a,b,2)};p.nthRoot=function(a,b,c){if(p.equals(b,p.ZERO))return p.copy(a,p.ZERO);if(p.equals(b,p.ONE))return p.copy(a,p.ONE);if(p.equals(b,p.INFINITY))return p.copy(a,p.INFINITY);
if(p.equals(b,p.INFINULL))return p.copy(a,p.INFINULL);var n=p.isNegative(b);n&&(b[0]=-b[0]);a=p.copy(a,p.ONE);for(var e=[1,0,0,1],g=p.clone(p.ONE),h=p.MAX_LOOPS;!p.approximates(b,g)&&h--;)p.isLessThan(b,g)?(e[0]+=e[1],e[2]+=e[3]):(e[1]+=e[0],e[3]+=e[2]),a[0]=e[0]+e[1],a[1]=e[2]+e[3],p.pow(g,a,c);n&&(b[0]=-b[0],1===c%2&&p.neg(a,a));return a};p.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};p.str=function(a){return 1===a[1]?a[0].toString():a[0]+"/"+a[1]};p.toDecimal=function(a){return a[0]/a[1]};p.dec=
p.toDecimal;p.toInteger=function(a){return Math.round(p.toDecimal(a))};p.round=p.toInteger;p.floor=function(a){return Math.floor(p.toDecimal(a))};p.ceil=function(a){return Math.ceil(p.toDecimal(a))};p.fromInteger_copy=function(a,b){a[0]=parseInt(b);a[1]=1;return a};p.fromInteger=function(a){return p.fromInteger_copy(p.create(),a)};p.fromIntegerInverse_copy=function(a,b){a[0]=1;a[1]=parseInt(b);0>a[1]&&(a[0]=-a[0],a[1]=-a[1]);return a};p.fromIntegerInverse=function(a){return p.fromIntegerInverse_copy(p.create(),
a)};p.fromDecimal=function(a){return p.fromDecimal_copy(p.create(),a)};p.fromDecimal_copy=function(a,b){b=parseFloat(b);if(isNaN(b))return p.copy(a,p.INFINULL);if(Infinity===b)return p.copy(a,p.INFINITY);if(Math.abs(b)<p.EPSILON)return p.copy(a,p.ZERO);if(Math.abs(b-1)<p.EPSILON)return p.copy(a,p.ONE);if(Math.abs(b%1)<p.EPSILON)return p.fromInteger_copy(a,b);if(Math.abs(1/b%1)<p.EPSILON)return p.fromIntegerInverse_copy(a,Math.round(1/b));p.copy(a,p.ONE);for(var n=[1,0,0,1],c=b,e,g=p.MAX_LOOPS;g--&&
Math.abs(b-p.toDecimal(a))>p.EPSILON;){e=Math.floor(c);a[0]=e*n[0]+n[2];a[1]=e*n[1]+n[3];if(c===e)break;c=1/(c-e);n[2]=n[0];n[3]=n[1];n[0]=a[0];n[1]=a[1]}return a};p.fromRandom=function(a){a[0]=0xfffffffffffff*Math.random()<<0;a[1]=Math.abs(0xfffffffffffff*Math.random()<<0);return p.normalize(a,a)};p.sin=function(a,b){if(0===b[1])return p.copy(a,p.ZERO);p.scalar_multiply(a,b,2);var n=p.create();p.pow(n,b,2);p.add(n,n,p.ONE);p.divide(a,a,n);return a};p.cos=function(a,b){if(0===b[1])return p.neg(a,
p.ONE);var n=p.create();p.pow(n,b,2);p.sub(a,p.ONE,n);b=p.create();p.add(b,p.ONE,n);p.divide(a,a,b);return a};p.tan=function(a,b){p.scalar_multiply(a,b,2);var n=p.create();p.pow(n,b,2);p.scalar_multiply(n,n,2);p.add(a,a,n);p.pow(n,b,4);p.sub(n,p.ONE,n);p.divide(a,a,n);return a};p.toEgyptian=function(a){a=p.clone(a);p.abs(a,a);var b=p.floor(a);b&&p.sub(a,a,p.fromInteger(b));if(!a[0])return b.toString();b||(b="");var n=1;for(p.create();1!==a[0];){n++;var c=p.fromValues(1,n);p.isGreaterThan(a,c)&&(b&&
(b+=" + "),b+=p.str(c),p.sub(a,a,c))}return a?b?b+" + "+p.str(a):p.str(a):b?b:"0"};p.toBabylonian=function(a){var b="",n=p.toDecimal(a);a=parseInt(n);n-=a;for(var c=0,e=0;0<a;)(c=a%60)&&(b=c+" * 60^"+e+(b?" + ":"")+b),a=(a-c)/60,e++;for(e=-1;0<n;)n*=60,c=parseInt(n+1E-13),n-=c,-1E-13>n||(c&&(b+=(b?" + ":"")+c+" * 60^"+e),e--);return b?b:"0"};p.traceSternBrocot=function(a){var b="";if(p.equals(a,p.ZERO)||p.equals(a,p.ONE)||p.equals(a,p.INFINITY)||p.equals(a,p.INFINULL))return b;a=p.clone(a);p.isNegative(a)&&
(a[0]=-a[0]);for(var n=p.clone(p.ONE),c=[1,0,0,1],e=0,g=0,h=p.MAX_LOOPS;!p.approximates(a,n)&&h--;)p.isLessThan(a,n)?(c[0]+=c[1],c[2]+=c[3],g++,e&&(b+="R",1!==e&&(b+=e),e=0,b+=" ")):(c[1]+=c[0],c[3]+=c[2],e++,g&&(b+="L",1!==g&&(b+=g),g=0,b+=" ")),n[0]=c[0]+c[1],n[1]=c[2]+c[3];g?(b+="L",1!==g&&(b+=g)):e&&(b+="R",1!==e&&(b+=e));0>h&&(b+="...");return b};p.toContinuedFraction=function(a,b){b="undefined"===typeof b?65536:parseInt(b);if(p.equals(a,p.ZERO))return[0];if(p.equals(a,p.ONE))return[1];if(p.equals(a,
p.NEGONE))return[-1];if(p.equals(a,p.INFINITY))return[1,0];if(p.equals(a,p.INFINULL))return[0,0];a=p.clone(a);var n=p.isNegative(a);n&&(a[0]=-a[0]);for(var c=p.clone(p.ONE),e=[1,0,0,1],g=1,h=[0],m=h.length-1;!p.equals(a,c)&&b--;)p.isLessThan(a,c)?(-1===g?h[m]++:(g=-1,h.push(1),m++),e[0]+=e[1],e[2]+=e[3]):(1===g?h[m]++:(g=1,h.push(1),m++),e[1]+=e[0],e[3]+=e[2]),c[0]=e[0]+e[1],c[1]=e[2]+e[3];0>b?h.push(0):h[m]++;if(n)for(var w in h)h[w]=-h[w];return h};p.fromContinuedFraction=function(a,b){p.fromInteger_copy(a,
b[b.length-1]);for(var n=b.length-2;-1<n;n--)p.invert(a,a),p.add(a,p.fromInteger(b[n]),a);return a};p.dump=function(a){p.create();return"rat\t"+p.str(a)+"\n~\t"+p.toDecimal(a)+"\nCF:\t["+p.toContinuedFraction(a)+"]\n"};p.ZERO=p.fromInteger(0);p.ONE=p.fromInteger(1);p.NEGONE=p.fromInteger(-1);p.INFINITY=p.fromValues(1,0);p.INFINULL=p.fromValues(0,0);p.INFINITESIMAL=p.clone([1,m]);p.PI=p.fromValues(1320192667429,420230377710);"undefined"!==typeof a&&(a.rat=p);b||(b=new BigInteger("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF"));
c||(c=1073741824);var q={EPSILON:2E-16};q.MAX_LOOPS=c;q.create=function(){var a=[];a[0]=BigInteger.ZERO;a[1]=BigInteger.ONE;return a};q.clone=function(a){var b=[];b[0]=a[0];b[1]=a[1];return b};q.fromValues=function(a,b){var n=[];n[0]=new BigInteger(a);n[1]=new BigInteger(b);return q.normalize(n,n)};q.copy=function(a,b){a[0]=b[0];a[1]=b[1];return a};q.set=function(a,b,c){a[0]=b;a[1]=c;return q.normalize(a,a)};q.toRat=function(a,b){return p.set(a,b[0].toJSValue(),b[1].toJSValue())};q.fromRat=function(a,
b){return q.set(a,BigInteger(b[0]),BigInteger(b[1]))};q.abs=function(a,b){a[0]=b[0].abs();a[1]=b[1];return a};q.invert=function(a,b){var c=b[0];a[0]=b[1];a[1]=c;return a};q.reciprocal=q.invert;q.add=function(a,b,c){0===b[1].compare(c[1])?(a[0]=b[0].add(c[0]),a[1]=b[1]):(a[0]=b[0].multiply(c[1]).add(c[0].multiply(b[1])),a[1]=b[1].multiply(c[1]));return q.normalize(a,a)};q.subtract=function(a,b,c){0===b[1].compare(c[1])?(a[0]=b[0].subtract(c[0]),a[1]=b[1]):(a[0]=b[0].multiply(c[1]).subtract(c[0].multiply(b[1])),
a[1]=b[1].multiply(c[1]));return q.normalize(a,a)};q.sub=q.subtract;q.multiply=function(a,b,c){a[0]=b[0].multiply(c[0]);a[1]=b[1].multiply(c[1]);return q.normalize(a,a)};q.mul=q.multiply;q.mediant=function(a,b,c){a[0]=b[0].add(c[0]);a[1]=b[1].add(c[1]);return q.normalize(a,a)};q.divide=function(a,b,c){a[0]=b[0].multiply(c[1]);a[1]=b[1].multiply(c[0]);return q.normalize(a,a)};q.div=q.divide;q.equals=function(a,b){return a[0].isZero()&&b[0].isZero()||a[1].isZero()&&b[1].isZero()?!0:0===a[0].compare(b[0])&&
0===a[1].compare(b[1])};q.approximates=function(a,b){if(q.equals(a,b))return!0;var c=q.create();q.sub(c,a,b);q.abs(c,c);return q.isLessThan(c,q.INFINITESIMAL)};q.isGreaterThan=function(a,b){return q.equals(a,b)?!1:0<a[0].multiply(b[1]).compare(b[0].multiply(a[1]))};q.isLessThan=function(a,b){return q.equals(a,b)?!1:0>a[0].multiply(b[1]).compare(b[0].multiply(a[1]))};q.isNegative=function(a){return a[0].isNegative()};q.min=function(a,b,c){q.isLessThan(b,c)?(a[0]=b[0],a[1]=b[1]):(a[0]=c[0],a[1]=c[1]);
return a};q.max=function(a,b,c){q.isGreaterThan(b,c)?(a[0]=b[0],a[1]=b[1]):(a[0]=c[0],a[1]=c[1]);return a};q.scalar_multiply=function(a,b,c){a[0]=b[0].multiply(c);a[1]=b[1];return q.normalize(a,a)};q.scalar_divide=function(a,b,c){a[0]=b[0];a[1]=b[1].multiply(c);return q.normalize(a,a)};q.normalize=function(a,b){if(b[0].isZero()||b[1].isZero())return b;if(0===b[0].compare(b[1]))return q.clone(q.ONE);if(b[1].isNegative())a[0]=b[0].negate(),a[1]=b[1].negate();else if(a[0]=b[0],a[1]=b[1],a[1].isZero())return a;
b=x.greatest_common_divisor(a[0].abs(),a[1]);0<b.compare(BigInteger.ONE)&&(a[0]=a[0].quotient(b),a[1]=a[1].quotient(b));return a};q.opposite=function(a,b){a[0]=b[0].negate();a[1]=b[1];return a};q.negative=q.opposite;q.neg=q.opposite;q.power=function(a,b,c){2===c?(a[0]=b[0].square(),a[1]=b[1].square()):0<c?(a[0]=b[0].pow(c),a[1]=b[1].pow(c)):0>c?(c=Math.abs(c),a[0]=b[1].pow(c),a[1]=b[0].pow(c)):q.copy(a,q.ONE);return a};q.pow=q.power;q.sqrt=function(a,b){return q.nthRoot(a,b,2)};q.nthRoot=function(a,
b,e){if(q.equals(b,q.ZERO))return q.copy(a,q.ZERO);if(q.equals(b,q.ONE))return q.copy(a,q.ONE);if(q.equals(b,q.INFINITY))return q.copy(a,q.INFINITY);if(q.equals(b,q.INFINULL))return q.copy(a,q.INFINULL);var n=q.isNegative(b);n&&(b[0]=b[0].negate());q.copy(a,q.ONE);for(var g=[BigInteger(1),BigInteger(0),BigInteger(0),BigInteger(1)],h=q.clone(q.ONE),m=c;!q.approximates(b,h)&&m--;)q.isLessThan(b,h)?(g[0]=g[0].add(g[1]),g[2]=g[2].add(g[3])):(g[1]=g[1].add(g[0]),g[3]=g[3].add(g[2])),a[0]=g[0].add(g[1]),
a[1]=g[2].add(g[3]),q.pow(h,a,e);n&&(b[0]=b[0].negate(),1===e%2&&q.neg(a,a));return a};q.dot=function(a,b){return a[0].multiply(b[0]).add(a[1].multiply(b[1]))};q.str=function(a){return 0===a[1].compare(BigInteger.ONE)?a[0].toString():a[0].toString()+"/"+a[1].toString()};q.toDecimal=function(a){return a[0].toJSValue()/a[1].toJSValue()};q.dec=q.toDecimal;q.toInteger=function(a){return a[0].quotient(a[1]).toJSValue()};q.round=q.toInteger;q.toBigInteger=function(a){return a[0].quotient(a[1])};q.floor=
function(a){return Math.floor(q.toDecimal(a))};q.ceil=function(a){return Math.ceil(q.toDecimal(a))};q.fromInteger_copy=function(a,b){a[0]=BigInteger(b);a[1]=BigInteger.ONE;return a};q.fromInteger=function(a){return q.fromInteger_copy(q.create(),a)};q.fromIntegerInverse_copy=function(a,b){a[0]=BigInteger.ONE;a[1]=BigInteger(b);a[1].isNegative()&&(a[0]=a[0].negate(),a[1]=a[1].negate());return a};q.fromIntegerInverse=function(a){return q.fromIntegerInverse_copy(q.create(),a)};q.fromDecimal=function(a){return q.fromDecimal_copy(q.create(),
a)};q.fromDecimal_copy=function(a,b){b=parseFloat(b);if(isNaN(b))return q.copy(a,q.INFINULL);if(Infinity===b)return q.copy(a,q.INFINITY);if(Math.abs(b)<q.EPSILON)return q.copy(a,q.ZERO);if(Math.abs(b-1)<q.EPSILON)return q.copy(a,q.ONE);if(Math.abs(b%1)<q.EPSILON)return q.fromInteger_copy(a,b);if(Math.abs(1/b%1)<q.EPSILON)return q.fromIntegerInverse_copy(a,Math.round(1/b));q.copy(a,q.ONE);var c=[BigInteger(1),BigInteger(0),BigInteger(0),BigInteger(1)],e=b;BigInteger(1);for(var g=q.MAX_LOOPS;g--&&Math.abs(b-
q.toDecimal(a))>q.EPSILON;){var n=BigInteger(Math.floor(e));a[0]=n.multiply(c[0]).add(c[2]);a[1]=n.multiply(c[1]).add(c[3]);if(n=e-parseInt(n.toString(),10))e=1/n;else{if(b.toString()===q.toDecimal(a))break;e=(c=(b.toString()+"e+10").match(/(\d+)(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/))?Math.max(c[2]?c[2].length:0):0;q.add(a,q.fromInteger(c[1]),q.fromValues(c[2],Math.pow(10,e)));break}c[2]=c[0];c[3]=c[1];c[0]=a[0];c[1]=a[1]}return a};q.fromRandom=function(a){a[0]=BigInteger(0xfffffffffffff*Math.random()<<
0);a[1]=BigInteger(Math.abs(0xfffffffffffff*Math.random()<<0));return q.normalize(a,a)};q.sin=function(a,b){if(b[1].isZero())return q.copy(a,q.ZERO);q.scalar_multiply(a,b,2);var c=q.create();q.pow(c,b,2);q.add(c,c,q.ONE);q.divide(a,a,c);return a};q.cos=function(a,b){if(b[1].isZero())return q.neg(a,q.ONE);var c=q.create();q.pow(c,b,2);q.sub(a,q.ONE,c);b=q.create();q.add(b,q.ONE,c);q.divide(a,a,b);return a};q.tan=function(a,b){q.scalar_multiply(a,b,2);var c=q.create();q.pow(c,b,2);q.scalar_multiply(c,
c,2);q.add(a,a,c);q.pow(c,b,4);q.sub(c,q.ONE,c);q.divide(a,a,c);return a};q.toEgyptian=function(a){a=q.clone(a);q.abs(a,a);var b=q.floor(a);b&&q.sub(a,a,q.fromInteger(b));if(!a[0])return b.toString();b||(b="");var c=1;for(q.create();1!==a[0];){c++;var e=q.fromValues(1,c);q.isGreaterThan(a,e)&&(b&&(b+=" + "),b+=q.str(e),q.sub(a,a,e))}return a?b?b+" + "+q.str(a):q.str(a):b?b:"0"};q.toBabylonian=function(a){var b="",c=q.toDecimal(a);a=parseInt(c);c-=a;for(var e=0,g=0;0<a;)(e=a%60)&&(b=e+" * 60^"+g+(b?
" + ":"")+b),a=(a-e)/60,g++;for(g=-1;0<c;)c*=60,e=parseInt(c+1E-13),c-=e,-1E-13>c||(e&&(b+=(b?" + ":"")+e+" * 60^"+g),g--);return b?b:"0"};q.traceSternBrocot=function(a){var b="";if(q.equals(a,q.ZERO)||q.equals(a,q.ONE)||q.equals(a,q.INFINITY)||q.equals(a,q.INFINULL))return b;a=q.clone(a);q.isNegative(a)&&(a[0]=a[0].negate());for(var c=q.clone(q.ONE),e=[BigInteger(1),BigInteger(0),BigInteger(0),BigInteger(1)],g=0,n=0,h=65536;!q.equals(a,c)&&h--;)q.isLessThan(a,c)?(e[0]=e[0].add(e[1]),e[2]=e[2].add(e[3]),
n++,g&&(b+="R",1!==g&&(b+=g),g=0,b+=" ")):(e[1]=e[1].add(e[0]),e[3]=e[3].add(e[2]),g++,n&&(b+="L",1!==n&&(b+=n),n=0,b+=" ")),c[0]=e[0].add(e[1]),c[1]=e[2].add(e[3]);n?(b+="L",1!==n&&(b+=n)):g&&(b+="R",1!==g&&(b+=g));0>h&&(b+="...");return b};q.toContinuedFraction=function(a,b){b="undefined"===typeof b?65536:parseInt(b);if(q.equals(a,q.ZERO))return[0];if(q.equals(a,q.ONE))return[1];if(q.equals(a,q.NEGONE))return[-1];if(q.equals(a,q.INFINITY))return[1,0];if(q.equals(a,q.INFINULL))return[0,0];a=q.clone(a);
var c=q.isNegative(a);c&&(a[0]=a[0].negate());for(var e=q.clone(q.ONE),g=[BigInteger(1),BigInteger(0),BigInteger(0),BigInteger(1)],n=1,h=[0],m=h.length-1;!q.equals(a,e)&&b--;)q.isLessThan(a,e)?(-1===n?h[m]++:(n=-1,h.push(1),m++),g[0]=g[0].add(g[1]),g[2]=g[2].add(g[3])):(1===n?h[m]++:(n=1,h.push(1),m++),g[1]=g[1].add(g[0]),g[3]=g[3].add(g[2])),e[0]=g[0].add(g[1]),e[1]=g[2].add(g[3]);0>b?h.push(0):h[m]++;if(c)for(var p in h)h[p]=-h[p];return h};q.fromContinuedFraction=function(a,b){q.fromInteger_copy(a,
b[b.length-1]);for(var c=b.length-2;-1<c;c--)q.invert(a,a),q.add(a,q.fromInteger(b[c]),a);return a};q.fromFactorial=function(a,b){if("undefined"!==typeof factorial.PREPARED[b])return q.fromInteger_copy(a,factorial.PREPARED[b]);var c=factorial.PREPARED.length-1;for(q.fromInteger_copy(a,factorial.PREPARED[c]);c<b;)q.scalar_multiply(a,a,++c);return a};q.dump=function(a){return"bigrat\t"+q.str(a)+"\n~\t"+q.toDecimal(a)+"\nCF:\t["+q.toContinuedFraction(a)+"]\n"};q.ZERO=q.fromInteger(0);q.ONE=q.fromInteger(1);
q.NEGONE=q.fromInteger(-1);q.INFINITY=q.fromValues(1,0);q.INFINULL=q.fromValues(0,0);q.INFINITESIMAL=q.clone([new BigInteger(1),b]);q.PI=q.fromValues("3141592653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117067982148086513282306647093844609550582231725359408128481117450284102701938521105559644622948954930381964428810975665933446128475648233786783165271201909145648566923460348610454326648213393607260249141273724587","1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000");
"undefined"!==typeof a&&(a.bigrat=q);var A=function(a,b){this.a=p.fromValues(parseInt(a),parseInt(b))};A.prototype.toString=function(){return p.str(this.a)};A.prototype.toContinuedFraction=function(a){return p.toContinuedFraction(this.a,a)};A.prototype.invert=function(){return p.invert(this.a)};A.prototype.reciprocal=A.prototype.invert;A.prototype.add=function(a){var b=p.create();p.add(b,this.a,a.a);return new A(b[0],b[1])};A.prototype.plus=A.prototype.add;A.prototype.subtract=function(a){var b=p.create();
p.sub(b,this.a,a.a);return new A(b[0],b[1])};A.prototype.sub=A.prototype.subtract;A.prototype.minus=A.prototype.subtract;A.prototype.multiply=function(a){var b=p.create();p.mul(b,this.a,a.a);return new A(b[0],b[1])};A.prototype.mul=A.prototype.multiply;A.prototype.times=A.prototype.multiply;A.prototype.mediant=function(a){var b=p.create();p.mediant(b,this.a,a.a);return new A(b[0],b[1])};A.prototype.divide=function(a){var b=p.create();p.div(b,this.a,a.a);return new A(b[0],b[1])};A.prototype.div=A.prototype.divide;
A.prototype.divided_by=A.prototype.divide;A.prototype.power=function(a){var b=p.create();p.pow(b,this.a,a);return new A(b[0],b[1])};A.prototype.pow=A.prototype.power;A.prototype.dump=function(){return p.dump(this.a)};A.prototype.toRat=function(){return p.clone(this.a)};A.prototype.toDecimal=function(){return p.toDecimal(this.a)};A.fromRat=function(a){var b=new A;b.a[0]=a[0];b.a[1]=a[1];return b};A.fromInteger=function(a){return A.fromRat(p.fromInteger(a))};A.fromIntegerInverse=function(a){return A.fromRat(p.fromIntegerInverse(a))};
A.fromDecimal=function(a){return A.fromRat(p.fromDecimal(a))};A.fromContinuedFraction=function(a){return A.fromRat(p.fromContinuedFraction(p.create(),a))};"undefined"!==typeof a&&(a.rational=A);var y={GREEK:"\u03b1\u03b2\u03b3\u03b4\u03bc\u03c0\u03c1\u03c2\u03c4\u03c6\u03c7\u03c8\u03c9\u0398\u03a6\u03a9".split(""),iterator:function(){this.i=0;this.next=function(){return this.i<y.GREEK.length?y.GREEK[this.i++]:"?"}}};"undefined"!==typeof a&&(a.alpha=y);b={};b.FINE_STRUCTURE=q.fromValues(30223,4141639);
b.a=b.FINE_STRUCTURE;b.FINE_STRUCTURE_ALT=q.fromValues(13355891,1830237867);b.PLANK=q.fromValues(662606957,1E42);b.h=b.PLANK;b.hBAR=q.fromValues(1054571726,1E43);b.GRAVITATIONAL=q.fromValues(667384,1E16);b.G=b.GRAVITATIONAL;b.SPEED_OF_LIGHT=q.fromInteger(299792458);b.c=b.SPEED_OF_LIGHT;"undefined"!==typeof a&&(a.physics=b);var z={create:function(){return[[],[]]},fromValues:function(a){var b=z.create();b[0]=a.slice();a=z.countDimensions(b);for(b[1]=Array(a);a--;)b[1][a]=0;return z.normalize(b,b)},
mergeDimension:function(a,b,c){a[0]=[b.slice()];a[1].push(0);for(var e in c)a[0].push(c[e]);return a},evaluate:function(a,b,c){q.copy(a,q.ZERO);var e=z.countDimensions(b);if(0===e)return"0";if(1===e)for(var g in b[0]){if(b[0][g]){e=q.fromInteger(b[0][g]);var n=q.pow(q.create(),q.fromInteger(c[0]),b[1][0]+ +g);q.mul(e,e,n);q.add(a,a,e)}}else if(2===e)for(var h in b[0])for(g in b[0][h]){if(b[0][h][g]){e=q.fromInteger(b[0][h][g]);n=q.pow(q.create(),q.fromInteger(c[0]),b[1][1]+ +g);var m=q.pow(q.create(),
q.fromInteger(c[1]),b[1][0]+ +h);q.mul(e,e,n);q.mul(e,e,m);q.add(a,a,e)}}else if(3===e)for(var p in b[0])for(h in b[0][p])for(g in b[0][p][h]){if(b[0][p][h][g]){e=q.fromInteger(b[0][p][h][g]);n=q.pow(q.create(),q.fromInteger(c[0]),b[1][2]+ +g);m=q.pow(q.create(),q.fromInteger(c[1]),b[1][1]+ +h);var k=q.pow(q.create(),q.fromInteger(c[1]),b[1][0]+ +p);q.mul(e,e,n);q.mul(e,e,m);q.mul(e,e,k);q.add(a,a,e)}}else alert("unsupported dimension "+e);return a},derivatives:function(a){return[]},forEachNonZeroElement:function(a,
b){a=a.slice();for(b=0;"object"===typeof a[0];)a=a[0].slice(),b++;for(var c=b+1;0<c;--c){print(Array(c).join("[0]"));a=eval("(a"+Array(c).join("[0]")+")");for(var e in a)for(var g=b+2;0<g;--g)print(a[e])}return""},str:function(a){var b="",c=new y.iterator,e=c.next(),g=c.next();c=c.next();var h=z.countDimensions(a);if(0===h)b+=a.toString();else if(1===h)for(var n in a[0]){if(a[0][n]){b?b+=" "+(0>a[0][n]?"-":"+")+" ":0>a[0][n]&&(b+="-");h=Math.abs(a[0][n]);var m=a[1][0]+ +n;if(1!==h||0===m)b+=h;0!==
m&&(b+=e+(1===m?"":"<sup>"+m+"</sup>"))}}else if(2===h)for(var p in a[0])for(n in a[0][p]){if(a[0][p][n]){b?b+=" "+(0>a[0][p][n]?"-":"+")+" ":0>a[0][p][n]&&(b+="-");h=Math.abs(a[0][p][n]);m=a[1][1]+ +n;var k=a[1][0]+ +p;if(1!==h||0===k&&0===m)b+=h;0!==m&&(b+=e+(1===m?"":"<sup>"+m+"</sup>"));0!==k&&(b+=g+(1===k?"":"<sup>"+k+"</sup>"))}}else if(3===h)for(var q in a[0])for(p in a[0][q])for(n in a[0][q][p]){if(a[0][q][p][n]){b?b+=" "+(0>a[0][q][p][n]?"-":"+")+" ":0>a[0][q][p][n]&&(b+="-");h=Math.abs(a[0][q][p][n]);
m=a[1][2]+ +n;k=a[1][1]+ +p;var v=a[1][0]+ +q;if(1!==h||0===v&&0===k&&0===m)b+=h;0!==m&&(b+=e+(1===m?"":"<sup>"+m+"</sup>"));0!==k&&(b+=g+(1===k?"":"<sup>"+k+"</sup>"));0!==v&&(b+=c+(1===v?"":"<sup>"+v+"</sup>"))}}else alert("unsupported dimension "+h);""===b&&(b="0");return b},getJSFormula:function(a){var b="";var c=z.countDimensions(a);if(0===c)return"0";if(1===c)for(var e in a[0])a[0][e]&&(b&&(b+="+"),b+=a[0][e],c=a[1][0]+ +e,0!==c&&(b=1===c?b+"*m[0]":b+("*Math.pow(m[0],"+c+")")));else if(2===
c)for(var g in a[0])for(e in a[0][g]){if(a[0][g][e]){b&&(b+="+");b+=a[0][g][e];c=a[1][1]+ +e;var h=a[1][0]+ +g;0!==c&&(b=1===c?b+"*m[0]":b+("*Math.pow(m[0],"+c+")"));0!==h&&(b=1===h?b+"*m[1]":b+("*Math.pow(m[1],"+h+")"))}}else if(3===c)for(var n in a[0])for(g in a[0][n])for(e in a[0][n][g]){if(a[0][n][g][e]){b&&(b+="+");b+=a[0][n][g][e];c=a[1][2]+ +e;h=a[1][1]+ +g;var m=a[1][0]+ +n;0!==c&&(b=1===c?b+"*m[0]":b+("*Math.pow(m[0],"+c+")"));0!==h&&(b=1===h?b+"*m[1]":b+("*Math.pow(m[1],"+h+")"));0!==m&&
(b=1===m?b+"*m[2]":b+("*Math.pow(m[2],"+m+")"))}}else alert("unsupported dimension "+c);""===b&&(b="0");return b}};String.prototype.repeat=function(a){return Array(a+1).join(this)};z.getGLSLFormula=function(a){var b="";var c=z.countDimensions(a);if(0===c)return"0.0";if(1===c)for(var e in a[0])a[0][e]&&(b&&(b+="+"),b+=a[0][e]+".0",c=a[1][0]+ +e,0!==c&&(b=1===c?b+"*m_0":1<c?b+"*m_0".repeat(c):b+("*pow(1.0"+"*m_0".repeat(Math.abs(c))+",-1.0)")));else if(2===c)for(var g in a[0])for(e in a[0][g]){if(a[0][g][e]){b&&
(b+="+");b+=a[0][g][e]+".0";c=a[1][1]+ +e;var h=a[1][0]+ +g;0!==c&&(b=1===c?b+"*m_0":1<c?b+"*m_0".repeat(c):b+("*pow(1.0"+"*m_0".repeat(Math.abs(c))+",-1.0)"));0!==h&&(b=1===h?b+"*m_1":1<h?b+"*m_1".repeat(h):b+("*pow(1.0"+"*m_1".repeat(Math.abs(h))+",-1.0)"))}}else alert("unsupported dimension "+c);""===b&&(b="0.0");return b};z.toJSON=function(a){return JSON.stringify(a)};z.fromJSON=function(a){return JSON.parse(a)};z.normalize=function(a,b){return b};z.binary_operation=function(a,b,c,e){a=z.create();
var g=z.countDimensions(b),h=z.countDimensions(c);b[1][n]!==c[1][n]&&alert("adding polyrats only works if the offsets are the same (for now)");if(1===g&&1===h){for(var n in b[0])a[0][n]="undefined"===typeof c[0][n]?b[0][n]:e(b[0][n],c[0][n]);for(n in c[0])"undefined"===typeof b[0][n]&&(a[0][n]=c[0][n]);for(n in a[0])"undefined"===typeof b[0][n]&&"undefined"===typeof c[0][n]&&(a[0][n]=null)}else alert("unsupported dimension "+g);for(n=g;n--;)a[1][n]=b[1][n];return a};z.add=function(a,b,c){return z.binary_operation(a,
b,c,function(a,b){return a+b})};z.subtract=function(a,b,c){return z.binary_operation(a,b,c,function(a,b){return a-b})};z.sub=z.subtract;z.multiply=function(a,b,c){return a};z.mul=z.multiply;z.divide=function(a,b,c){return a};z.div=z.divide;z.equals=function(a,b){return a[0]===b[0]&&a[1]===b[1]};z.countDimensions=function(a){return"object"===typeof a[0]?z._countDimensions(a[0],1):0};z._countDimensions=function(a,b){return"object"===typeof a[0]?z._countDimensions(a[0],++b):b};z.ZERO=z.fromValues([0]);
z.IDENTITY=z.fromValues([1]);z.ONE=z.IDENTITY;"undefined"!==typeof a&&(a.polyrat=z)})(k)})(this);/*
   Copyright 2008-2016 SpryMedia Ltd.

 This source file is free software, available under the following license:
   MIT license - http://datatables.net/license

 This source file is distributed in the hope that it will be useful, but
 WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 or FITNESS FOR A PARTICULAR PURPOSE. See the license files for details.

 For details please refer to: http://www.datatables.net
 DataTables 1.10.13
 ?2008-2016 SpryMedia Ltd - datatables.net/license
*/
(function(a){"function"===typeof define&&define.amd?define(["jquery"],function(k){return a(k,window,document)}):"object"===typeof exports?module.exports=function(k,c){k||(k=window);c||(c="undefined"!==typeof window?require("jquery"):require("jquery")(k));return a(c,k,k.document)}:a(jQuery,window,document)})(function(a,k,c,e){function b(d){var f,l,c={};a.each(d,function(a,r){(f=a.match(/^([^A-Z]+?)([A-Z])/))&&-1!=="a aa ai ao as b fn i m o s ".indexOf(f[1]+" ")&&(l=a.replace(f[0],f[2].toLowerCase()),
c[l]=a,"o"===f[1]&&b(d[a]))});d._hungarianMap=c}function h(d,f,l){d._hungarianMap||b(d);var c;a.each(f,function(b,r){c=d._hungarianMap[b];c===e||!l&&f[c]!==e||("o"===c.charAt(0)?(f[c]||(f[c]={}),a.extend(!0,f[c],f[b]),h(d[c],f[c],l)):f[c]=f[b])})}function m(a){var d=H.defaults.oLanguage,f=a.sZeroRecords;!a.sEmptyTable&&f&&"No data available in table"===d.sEmptyTable&&na(a,a,"sZeroRecords","sEmptyTable");!a.sLoadingRecords&&f&&"Loading..."===d.sLoadingRecords&&na(a,a,"sZeroRecords","sLoadingRecords");
a.sInfoThousands&&(a.sThousands=a.sInfoThousands);(a=a.sDecimal)&&gb(a)}function g(a){ka(a,"ordering","bSort");ka(a,"orderMulti","bSortMulti");ka(a,"orderClasses","bSortClasses");ka(a,"orderCellsTop","bSortCellsTop");ka(a,"order","aaSorting");ka(a,"orderFixed","aaSortingFixed");ka(a,"paging","bPaginate");ka(a,"pagingType","sPaginationType");ka(a,"pageLength","iDisplayLength");ka(a,"searching","bFilter");"boolean"===typeof a.sScrollX&&(a.sScrollX=a.sScrollX?"100%":"");"boolean"===typeof a.scrollX&&
(a.scrollX=a.scrollX?"100%":"");if(a=a.aoSearchCols)for(var d=0,f=a.length;d<f;d++)a[d]&&h(H.models.oSearch,a[d])}function v(d){ka(d,"orderable","bSortable");ka(d,"orderData","aDataSort");ka(d,"orderSequence","asSorting");ka(d,"orderDataType","sortDataType");var f=d.aDataSort;f&&!a.isArray(f)&&(d.aDataSort=[f])}function x(d){if(!H.__browser){var f={};H.__browser=f;var b=a("<div/>").css({position:"fixed",top:0,left:-1*a(k).scrollLeft(),height:1,width:1,overflow:"hidden"}).append(a("<div/>").css({position:"absolute",
top:1,left:1,width:100,overflow:"scroll"}).append(a("<div/>").css({width:"100%",height:10}))).appendTo("body"),l=b.children(),c=l.children();f.barWidth=l[0].offsetWidth-l[0].clientWidth;f.bScrollOversize=100===c[0].offsetWidth&&100!==l[0].clientWidth;f.bScrollbarLeft=1!==Math.round(c.offset().left);f.bBounding=b[0].getBoundingClientRect().width?!0:!1;b.remove()}a.extend(d.oBrowser,H.__browser);d.oScroll.iBarWidth=H.__browser.barWidth}function p(a,d,f,b,l,c){var r=!1;if(f!==e){var t=f;r=!0}for(;b!==
l;)a.hasOwnProperty(b)&&(t=r?d(t,a[b],b,a):a[b],r=!0,b+=c);return t}function q(d,f){var b=H.defaults.column,l=d.aoColumns.length;b=a.extend({},H.models.oColumn,b,{nTh:f?f:c.createElement("th"),sTitle:b.sTitle?b.sTitle:f?f.innerHTML:"",aDataSort:b.aDataSort?b.aDataSort:[l],mData:b.mData?b.mData:l,idx:l});d.aoColumns.push(b);b=d.aoPreSearchCols;b[l]=a.extend({},H.models.oSearch,b[l]);A(d,l,a(f).data())}function A(d,f,b){f=d.aoColumns[f];var l=d.oClasses,c=a(f.nTh);if(!f.sWidthOrig){f.sWidthOrig=c.attr("width")||
null;var r=(c.attr("style")||"").match(/width:\s*(\d+[pxem%]+)/);r&&(f.sWidthOrig=r[1])}b!==e&&null!==b&&(v(b),h(H.defaults.column,b),b.mDataProp===e||b.mData||(b.mData=b.mDataProp),b.sType&&(f._sManualType=b.sType),b.className&&!b.sClass&&(b.sClass=b.className),a.extend(f,b),na(f,b,"sWidth","sWidthOrig"),b.iDataSort!==e&&(f.aDataSort=[b.iDataSort]),na(f,b,"aDataSort"));var t=f.mData,B=P(t),g=f.mRender?P(f.mRender):null;b=function(a){return"string"===typeof a&&-1!==a.indexOf("@")};f._bAttrSrc=a.isPlainObject(t)&&
(b(t.sort)||b(t.type)||b(t.filter));f._setter=null;f.fnGetData=function(a,d,f){var b=B(a,d,e,f);return g&&d?g(b,d,a,f):b};f.fnSetData=function(a,d,f){return G(t)(a,d,f)};"number"!==typeof t&&(d._rowReadObject=!0);d.oFeatures.bSort||(f.bSortable=!1,c.addClass(l.sSortableNone));d=-1!==a.inArray("asc",f.asSorting);b=-1!==a.inArray("desc",f.asSorting);f.bSortable&&(d||b)?d&&!b?(f.sSortingClass=l.sSortableAsc,f.sSortingClassJUI=l.sSortJUIAscAllowed):!d&&b?(f.sSortingClass=l.sSortableDesc,f.sSortingClassJUI=
l.sSortJUIDescAllowed):(f.sSortingClass=l.sSortable,f.sSortingClassJUI=l.sSortJUI):(f.sSortingClass=l.sSortableNone,f.sSortingClassJUI="")}function y(a){if(!1!==a.oFeatures.bAutoWidth){var d=a.aoColumns;Qa(a);for(var f=0,b=d.length;f<b;f++)d[f].nTh.style.width=d[f].sWidth}d=a.oScroll;""===d.sY&&""===d.sX||ta(a);Y(a,null,"column-sizing",[a])}function z(a,d){a=I(a,"bVisible");return"number"===typeof a[d]?a[d]:null}function n(d,f){d=I(d,"bVisible");f=a.inArray(f,d);return-1!==f?f:null}function w(d){var f=
0;a.each(d.aoColumns,function(d,b){b.bVisible&&"none"!==a(b.nTh).css("display")&&f++});return f}function I(d,f){var b=[];a.map(d.aoColumns,function(a,d){a[f]&&b.push(d)});return b}function D(a){var d=a.aoColumns,f=a.aoData,b=H.ext.type.detect,l,c,r;var t=0;for(l=d.length;t<l;t++){var B=d[t];var g=[];if(!B.sType&&B._sManualType)B.sType=B._sManualType;else if(!B.sType){var u=0;for(c=b.length;u<c;u++){var h=0;for(r=f.length;h<r;h++){g[h]===e&&(g[h]=J(a,h,t,"type"));var C=b[u](g[h],a);if(!C&&u!==b.length-
1)break;if("html"===C)break}if(C){B.sType=C;break}}B.sType||(B.sType="string")}}}function K(d,f,b,l){var c,r,t,B=d.aoColumns;if(f)for(c=f.length-1;0<=c;c--){var g=f[c];var u=g.targets!==e?g.targets:g.aTargets;a.isArray(u)||(u=[u]);var h=0;for(r=u.length;h<r;h++)if("number"===typeof u[h]&&0<=u[h]){for(;B.length<=u[h];)q(d);l(u[h],g)}else if("number"===typeof u[h]&&0>u[h])l(B.length+u[h],g);else if("string"===typeof u[h]){var C=0;for(t=B.length;C<t;C++)("_all"==u[h]||a(B[C].nTh).hasClass(u[h]))&&l(C,
g)}}if(b)for(c=0,d=b.length;c<d;c++)l(c,b[c])}function E(d,b,l,c){var r=d.aoData.length,t=a.extend(!0,{},H.models.oRow,{src:l?"dom":"data",idx:r});t._aData=b;d.aoData.push(t);for(var B=d.aoColumns,g=0,u=B.length;g<u;g++)B[g].sType=null;d.aiDisplayMaster.push(r);b=d.rowIdFn(b);b!==e&&(d.aIds[b]=t);!l&&d.oFeatures.bDeferRender||f(d,r,l,c);return r}function O(f,b){var l;b instanceof a||(b=a(b));return b.map(function(a,b){l=d(f,b);return E(f,l.data,b,l.cells)})}function J(a,d,f,b){var l=a.iDraw,c=a.aoColumns[f],
r=a.aoData[d]._aData,t=c.sDefaultContent,g=c.fnGetData(r,b,{settings:a,row:d,col:f});if(g===e)return a.iDrawError!=l&&null===t&&(ra(a,0,"Requested unknown parameter "+("function"==typeof c.mData?"{function}":"'"+c.mData+"'")+" for row "+d+", column "+f,4),a.iDrawError=l),t;if((g===r||null===g)&&null!==t&&b!==e)g=t;else if("function"===typeof g)return g.call(r);return null===g&&"display"==b?"":g}function V(a,d,f,b){a.aoColumns[f].fnSetData(a.aoData[d]._aData,b,{settings:a,row:d,col:f})}function N(d){return a.map(d.match(/(\\.|[^\.])+/g)||
[""],function(a){return a.replace(/\\\./g,".")})}function P(d){if(a.isPlainObject(d)){var f={};a.each(d,function(a,d){d&&(f[a]=P(d))});return function(a,d,b,l){var c=f[d]||f._;return c!==e?c(a,d,b,l):a}}if(null===d)return function(a){return a};if("function"===typeof d)return function(a,f,b,l){return d(a,f,b,l)};if("string"!==typeof d||-1===d.indexOf(".")&&-1===d.indexOf("[")&&-1===d.indexOf("("))return function(a,f){return a[d]};var b=function(d,f,l){if(""!==l){var c=N(l);for(var r=0,t=c.length;r<
t;r++){l=c[r].match(za);var g=c[r].match(va);if(l){c[r]=c[r].replace(za,"");""!==c[r]&&(d=d[c[r]]);g=[];c.splice(0,r+1);c=c.join(".");if(a.isArray(d))for(r=0,t=d.length;r<t;r++)g.push(b(d[r],f,c));d=l[0].substring(1,l[0].length-1);d=""===d?g:g.join(d);break}else if(g){c[r]=c[r].replace(va,"");d=d[c[r]]();continue}if(null===d||d[c[r]]===e)return e;d=d[c[r]]}}return d};return function(a,f){return b(a,f,d)}}function G(d){if(a.isPlainObject(d))return G(d._);if(null===d)return function(){};if("function"===
typeof d)return function(a,f,b){d(a,"set",f,b)};if("string"!==typeof d||-1===d.indexOf(".")&&-1===d.indexOf("[")&&-1===d.indexOf("("))return function(a,f){a[d]=f};var f=function(d,b,l){l=N(l);var c=l[l.length-1];for(var r,t,g=0,B=l.length-1;g<B;g++){r=l[g].match(za);t=l[g].match(va);if(r){l[g]=l[g].replace(za,"");d[l[g]]=[];c=l.slice();c.splice(0,g+1);r=c.join(".");if(a.isArray(b))for(t=0,B=b.length;t<B;t++)c={},f(c,b[t],r),d[l[g]].push(c);else d[l[g]]=b;return}t&&(l[g]=l[g].replace(va,""),d=d[l[g]](b));
if(null===d[l[g]]||d[l[g]]===e)d[l[g]]={};d=d[l[g]]}if(c.match(va))d[c.replace(va,"")](b);else d[c.replace(za,"")]=b};return function(a,b){return f(a,b,d)}}function Q(a){return ma(a.aoData,"_aData")}function T(a){a.aoData.length=0;a.aiDisplayMaster.length=0;a.aiDisplay.length=0;a.aIds={}}function U(a,d,f){for(var b=-1,l=0,c=a.length;l<c;l++)a[l]==d?b=l:a[l]>d&&a[l]--; -1!=b&&f===e&&a.splice(b,1)}function F(a,f,b,l){var c=a.aoData[f],t,g=function(d,b){for(;d.childNodes.length;)d.removeChild(d.firstChild);
d.innerHTML=J(a,f,b,"display")};if("dom"!==b&&(b&&"auto"!==b||"dom"!==c.src)){var u=c.anCells;if(u)if(l!==e)g(u[l],l);else for(b=0,t=u.length;b<t;b++)g(u[b],b)}else c._aData=d(a,c,l,l===e?e:c._aData).data;c._aSortData=null;c._aFilterData=null;g=a.aoColumns;if(l!==e)g[l].sType=null;else{b=0;for(t=g.length;b<t;b++)g[b].sType=null;r(a,c)}}function d(d,f,b,l){var c=[],r=f.firstChild,t,g=0,u,B=d.aoColumns,h=d._rowReadObject;l=l!==e?l:h?{}:[];var C=function(a,d){if("string"===typeof a){var f=a.indexOf("@");
-1!==f&&(f=a.substring(f+1),G(a)(l,d.getAttribute(f)))}},n=function(d){if(b===e||b===g)t=B[g],u=a.trim(d.innerHTML),t&&t._bAttrSrc?(G(t.mData._)(l,u),C(t.mData.sort,d),C(t.mData.type,d),C(t.mData.filter,d)):h?(t._setter||(t._setter=G(t.mData)),t._setter(l,u)):l[g]=u;g++};if(r)for(;r;){var m=r.nodeName.toUpperCase();if("TD"==m||"TH"==m)n(r),c.push(r);r=r.nextSibling}else for(c=f.anCells,r=0,m=c.length;r<m;r++)n(c[r]);(f=f.firstChild?f:f.nTr)&&(f=f.getAttribute("id"))&&G(d.rowId)(l,f);return{data:l,
cells:c}}function f(d,f,b,l){var t=d.aoData[f],e=t._aData,g=[],u;if(null===t.nTr){var B=b||c.createElement("tr");t.nTr=B;t.anCells=g;B._DT_RowIndex=f;r(d,t);var h=0;for(u=d.aoColumns.length;h<u;h++){var C=d.aoColumns[h];var n=b?l[h]:c.createElement(C.sCellType);n._DT_CellIndex={row:f,column:h};g.push(n);b&&!C.mRender&&C.mData===h||a.isPlainObject(C.mData)&&C.mData._===h+".display"||(n.innerHTML=J(d,f,h,"display"));C.sClass&&(n.className+=" "+C.sClass);C.bVisible&&!b?B.appendChild(n):!C.bVisible&&
b&&n.parentNode.removeChild(n);C.fnCreatedCell&&C.fnCreatedCell.call(d.oInstance,n,J(d,f,h),e,f,h)}Y(d,"aoRowCreatedCallback",null,[B,e,f])}t.nTr.setAttribute("role","row")}function r(d,f){var b=f.nTr,l=f._aData;if(b){if(d=d.rowIdFn(l))b.id=d;l.DT_RowClass&&(d=l.DT_RowClass.split(" "),f.__rowc=f.__rowc?Ea(f.__rowc.concat(d)):d,a(b).removeClass(f.__rowc.join(" ")).addClass(l.DT_RowClass));l.DT_RowAttr&&a(b).attr(l.DT_RowAttr);l.DT_RowData&&a(b).data(l.DT_RowData)}}function t(d){var f,b,l=d.nTHead,
c=d.nTFoot,r=0===a("th, td",l).length,t=d.oClasses,e=d.aoColumns;r&&(b=a("<tr/>").appendTo(l));var g=0;for(f=e.length;g<f;g++){var B=e[g];var h=a(B.nTh).addClass(B.sClass);r&&h.appendTo(b);d.oFeatures.bSort&&(h.addClass(B.sSortingClass),!1!==B.bSortable&&(h.attr("tabindex",d.iTabIndex).attr("aria-controls",d.sTableId),Ra(d,B.nTh,g)));B.sTitle!=h[0].innerHTML&&h.html(B.sTitle);Sa(d,"header")(d,h,B,t)}r&&u(d.aoHeader,l);a(l).find(">tr").attr("role","row");a(l).find(">tr>th, >tr>td").addClass(t.sHeaderTH);
a(c).find(">tr>th, >tr>td").addClass(t.sFooterTH);if(null!==c)for(d=d.aoFooter[0],g=0,f=d.length;g<f;g++)B=e[g],B.nTf=d[g].cell,B.sClass&&a(B.nTf).addClass(B.sClass)}function C(d,f,b){var l,c,r=[],t=[],g=d.aoColumns.length;if(f){b===e&&(b=!1);var u=0;for(l=f.length;u<l;u++){r[u]=f[u].slice();r[u].nTr=f[u].nTr;for(c=g-1;0<=c;c--)d.aoColumns[c].bVisible||b||r[u].splice(c,1);t.push([])}u=0;for(l=r.length;u<l;u++){if(d=r[u].nTr)for(;c=d.firstChild;)d.removeChild(c);c=0;for(f=r[u].length;c<f;c++){var B=
g=1;if(t[u][c]===e){d.appendChild(r[u][c].cell);for(t[u][c]=1;r[u+g]!==e&&r[u][c].cell==r[u+g][c].cell;)t[u+g][c]=1,g++;for(;r[u][c+B]!==e&&r[u][c].cell==r[u][c+B].cell;){for(b=0;b<g;b++)t[u+b][c+B]=1;B++}a(r[u][c].cell).attr("rowspan",g).attr("colspan",B)}}}}}function S(d){var b=Y(d,"aoPreDrawCallback","preDraw",[d]);if(-1!==a.inArray(!1,b))ha(d,!1);else{b=[];var l=0,c=d.asStripeClasses,r=c.length,t=d.oLanguage,g=d.iInitDisplayStart,u="ssp"==ia(d),B=d.aiDisplay;d.bDrawing=!0;g!==e&&-1!==g&&(d._iDisplayStart=
u?g:g>=d.fnRecordsDisplay()?0:g,d.iInitDisplayStart=-1);g=d._iDisplayStart;var h=d.fnDisplayEnd();if(d.bDeferLoading)d.bDeferLoading=!1,d.iDraw++,ha(d,!1);else if(!u)d.iDraw++;else if(!d.bDestroying&&!da(d))return;if(0!==B.length)for(t=u?d.aoData.length:h,u=u?0:g;u<t;u++){var C=B[u],n=d.aoData[C];null===n.nTr&&f(d,C);C=n.nTr;if(0!==r){var m=c[l%r];n._sRowStripe!=m&&(a(C).removeClass(n._sRowStripe).addClass(m),n._sRowStripe=m)}Y(d,"aoRowCallback",null,[C,n._aData,l,u]);b.push(C);l++}else l=t.sZeroRecords,
1==d.iDraw&&"ajax"==ia(d)?l=t.sLoadingRecords:t.sEmptyTable&&0===d.fnRecordsTotal()&&(l=t.sEmptyTable),b[0]=a("<tr/>",{"class":r?c[0]:""}).append(a("<td />",{valign:"top",colSpan:w(d),"class":d.oClasses.sRowEmpty}).html(l))[0];Y(d,"aoHeaderCallback","header",[a(d.nTHead).children("tr")[0],Q(d),g,h,B]);Y(d,"aoFooterCallback","footer",[a(d.nTFoot).children("tr")[0],Q(d),g,h,B]);c=a(d.nTBody);c.children().detach();c.append(a(b));Y(d,"aoDrawCallback","draw",[d]);d.bSorted=!1;d.bFiltered=!1;d.bDrawing=
!1}}function Z(a,d){var f=a.oFeatures,b=f.bFilter;f.bSort&&hb(a);b?oa(a,a.oPreviousSearch):a.aiDisplay=a.aiDisplayMaster.slice();!0!==d&&(a._iDisplayStart=0);a._drawHold=d;S(a);a._drawHold=!1}function l(d){var f=d.oClasses,b=a(d.nTable);b=a("<div/>").insertBefore(b);var l=d.oFeatures,c=a("<div/>",{id:d.sTableId+"_wrapper","class":f.sWrapper+(d.nTFoot?"":" "+f.sNoFooter)});d.nHolding=b[0];d.nTableWrapper=c[0];d.nTableReinsertBefore=d.nTable.nextSibling;for(var r=d.sDom.split(""),t,e,g,u,B,h,C=0;C<
r.length;C++){t=null;e=r[C];if("<"==e){g=a("<div/>")[0];u=r[C+1];if("'"==u||'"'==u){B="";for(h=2;r[C+h]!=u;)B+=r[C+h],h++;"H"==B?B=f.sJUIHeader:"F"==B&&(B=f.sJUIFooter);-1!=B.indexOf(".")?(u=B.split("."),g.id=u[0].substr(1,u[0].length-1),g.className=u[1]):"#"==B.charAt(0)?g.id=B.substr(1,B.length-1):g.className=B;C+=h}c.append(g);c=a(g)}else if(">"==e)c=c.parent();else if("l"==e&&l.bPaginate&&l.bLengthChange)t=ib(d);else if("f"==e&&l.bFilter)t=jb(d);else if("r"==e&&l.bProcessing)t=X(d);else if("t"==
e)t=ua(d);else if("i"==e&&l.bInfo)t=kb(d);else if("p"==e&&l.bPaginate)t=lb(d);else if(0!==H.ext.feature.length)for(g=H.ext.feature,h=0,u=g.length;h<u;h++)if(e==g[h].cFeature){t=g[h].fnInit(d);break}t&&(g=d.aanFeatures,g[e]||(g[e]=[]),g[e].push(t),c.append(t))}b.replaceWith(c);d.nHolding=null}function u(d,f){f=a(f).children("tr");var b,l,c;d.splice(0,d.length);var r=0;for(c=f.length;r<c;r++)d.push([]);r=0;for(c=f.length;r<c;r++){var t=f[r];for(b=t.firstChild;b;){if("TD"==b.nodeName.toUpperCase()||
"TH"==b.nodeName.toUpperCase()){var e=1*b.getAttribute("colspan");var g=1*b.getAttribute("rowspan");e=e&&0!==e&&1!==e?e:1;g=g&&0!==g&&1!==g?g:1;var u=0;for(l=d[r];l[u];)u++;var B=u;var h=1===e?!0:!1;for(l=0;l<e;l++)for(u=0;u<g;u++)d[r+u][B+l]={cell:b,unique:h},d[r+u].nTr=t}b=b.nextSibling}}}function L(a,d,f){var b=[];f||(f=a.aoHeader,d&&(f=[],u(f,d)));d=0;for(var l=f.length;d<l;d++)for(var c=0,r=f[d].length;c<r;c++)!f[d][c].unique||b[c]&&a.bSortCellsTop||(b[c]=f[d][c].cell);return b}function M(d,
f,b){Y(d,"aoServerParams","serverParams",[f]);if(f&&a.isArray(f)){var l={},c=/(.*?)\[\]$/;a.each(f,function(a,d){(a=d.name.match(c))?(a=a[0],l[a]||(l[a]=[]),l[a].push(d.value)):l[d.name]=d.value});f=l}var r=d.ajax,t=d.oInstance,e=function(a){Y(d,null,"xhr",[d,a,d.jqXHR]);b(a)};if(a.isPlainObject(r)&&r.data){var g=r.data;var u=a.isFunction(g)?g(f,d):g;f=a.isFunction(g)&&u?u:a.extend(!0,f,u);delete r.data}u={data:f,success:function(a){var f=a.error||a.sError;f&&ra(d,0,f);d.json=a;e(a)},dataType:"json",
cache:!1,type:d.sServerMethod,error:function(f,b,l){l=Y(d,null,"xhr",[d,null,d.jqXHR]);-1===a.inArray(!0,l)&&("parsererror"==b?ra(d,0,"Invalid JSON response",1):4===f.readyState&&ra(d,0,"Ajax error",7));ha(d,!1)}};d.oAjaxData=f;Y(d,null,"preXhr",[d,f]);d.fnServerData?d.fnServerData.call(t,d.sAjaxSource,a.map(f,function(a,d){return{name:d,value:a}}),e,d):d.sAjaxSource||"string"===typeof r?d.jqXHR=a.ajax(a.extend(u,{url:r||d.sAjaxSource})):a.isFunction(r)?d.jqXHR=r.call(t,f,e,d):(d.jqXHR=a.ajax(a.extend(u,
r)),r.data=g)}function da(a){return a.bAjaxDataGet?(a.iDraw++,ha(a,!0),M(a,aa(a),function(d){pa(a,d)}),!1):!0}function aa(d){var f=d.aoColumns,b=f.length,l=d.oFeatures,c=d.oPreviousSearch,r=d.aoPreSearchCols,t=[],e=wa(d);var g=d._iDisplayStart;var u=!1!==l.bPaginate?d._iDisplayLength:-1;var h=function(a,d){t.push({name:a,value:d})};h("sEcho",d.iDraw);h("iColumns",b);h("sColumns",ma(f,"sName").join(","));h("iDisplayStart",g);h("iDisplayLength",u);var C={draw:d.iDraw,columns:[],order:[],start:g,length:u,
search:{value:c.sSearch,regex:c.bRegex}};for(g=0;g<b;g++){var B=f[g];var n=r[g];u="function"==typeof B.mData?"function":B.mData;C.columns.push({data:u,name:B.sName,searchable:B.bSearchable,orderable:B.bSortable,search:{value:n.sSearch,regex:n.bRegex}});h("mDataProp_"+g,u);l.bFilter&&(h("sSearch_"+g,n.sSearch),h("bRegex_"+g,n.bRegex),h("bSearchable_"+g,B.bSearchable));l.bSort&&h("bSortable_"+g,B.bSortable)}l.bFilter&&(h("sSearch",c.sSearch),h("bRegex",c.bRegex));l.bSort&&(a.each(e,function(a,d){C.order.push({column:d.col,
dir:d.dir});h("iSortCol_"+a,d.col);h("sSortDir_"+a,d.dir)}),h("iSortingCols",e.length));f=H.ext.legacy.ajax;return null===f?d.sAjaxSource?t:C:f?t:C}function pa(a,d){var f=function(a,f){return d[a]!==e?d[a]:d[f]},b=la(a,d),l=f("sEcho","draw"),c=f("iTotalRecords","recordsTotal");f=f("iTotalDisplayRecords","recordsFiltered");if(l){if(1*l<a.iDraw)return;a.iDraw=1*l}T(a);a._iRecordsTotal=parseInt(c,10);a._iRecordsDisplay=parseInt(f,10);l=0;for(c=b.length;l<c;l++)E(a,b[l]);a.aiDisplay=a.aiDisplayMaster.slice();
a.bAjaxDataGet=!1;S(a);a._bInitComplete||Fa(a,d);a.bAjaxDataGet=!0;ha(a,!1)}function la(d,f){d=a.isPlainObject(d.ajax)&&d.ajax.dataSrc!==e?d.ajax.dataSrc:d.sAjaxDataProp;return"data"===d?f.aaData||f[d]:""!==d?P(d)(f):f}function jb(d){var f=d.oClasses,b=d.sTableId,l=d.oLanguage,r=d.oPreviousSearch,t=d.aanFeatures,e='<input type="search" class="'+f.sFilterInput+'"/>',g=l.sSearch;g=g.match(/_INPUT_/)?g.replace("_INPUT_",e):g+e;f=a("<div/>",{id:t.f?null:b+"_filter","class":f.sFilter}).append(a("<label/>").append(g));
t=function(){var a=this.value?this.value:"";a!=r.sSearch&&(oa(d,{sSearch:a,bRegex:r.bRegex,bSmart:r.bSmart,bCaseInsensitive:r.bCaseInsensitive}),d._iDisplayStart=0,S(d))};e=null!==d.searchDelay?d.searchDelay:"ssp"===ia(d)?400:0;var u=a("input",f).val(r.sSearch).attr("placeholder",l.sSearchPlaceholder).on("keyup.DT search.DT input.DT paste.DT cut.DT",e?Ta(t,e):t).on("keypress.DT",function(a){if(13==a.keyCode)return!1}).attr("aria-controls",b);a(d.nTable).on("search.dt.DT",function(a,f){if(d===f)try{u[0]!==
c.activeElement&&u.val(r.sSearch)}catch(Xb){}});return f[0]}function oa(a,d,f){var b=a.oPreviousSearch,l=a.aoPreSearchCols,c=function(a){b.sSearch=a.sSearch;b.bRegex=a.bRegex;b.bSmart=a.bSmart;b.bCaseInsensitive=a.bCaseInsensitive},r=function(a){return a.bEscapeRegex!==e?!a.bEscapeRegex:a.bRegex};D(a);if("ssp"!=ia(a)){Ga(a,d.sSearch,f,r(d),d.bSmart,d.bCaseInsensitive);c(d);for(d=0;d<l.length;d++)Ha(a,l[d].sSearch,d,r(l[d]),l[d].bSmart,l[d].bCaseInsensitive);xa(a)}else c(d);a.bFiltered=!0;Y(a,null,
"search",[a])}function xa(d){for(var f=H.ext.search,b=d.aiDisplay,l,c,r=0,t=f.length;r<t;r++){for(var e=[],g=0,u=b.length;g<u;g++)c=b[g],l=d.aoData[c],f[r](d,l._aFilterData,c,l._aData,g)&&e.push(c);b.length=0;a.merge(b,e)}}function Ha(a,d,f,b,l,c){if(""!==d){var r=[],t=a.aiDisplay;b=Ia(d,b,l,c);for(l=0;l<t.length;l++)d=a.aoData[t[l]]._aFilterData[f],b.test(d)&&r.push(t[l]);a.aiDisplay=r}}function Ga(a,d,f,b,l,c){b=Ia(d,b,l,c);c=a.oPreviousSearch.sSearch;var r=a.aiDisplayMaster;l=[];0!==H.ext.search.length&&
(f=!0);var t=Aa(a);if(0>=d.length)a.aiDisplay=r.slice();else{if(t||f||c.length>d.length||0!==d.indexOf(c)||a.bSorted)a.aiDisplay=r.slice();d=a.aiDisplay;for(f=0;f<d.length;f++)b.test(a.aoData[d[f]]._sFilterRow)&&l.push(d[f]);a.aiDisplay=l}}function Ia(d,f,b,l){d=f?d:Ua(d);b&&(d="^(?=.*?"+a.map(d.match(/"[^"]+"|[^ ]+/g)||[""],function(a){if('"'===a.charAt(0)){var d=a.match(/^"(.*)"$/);a=d?d[1]:a}return a.replace('"',"")}).join(")(?=.*?")+").*$");return new RegExp(d,l?"i":"")}function Aa(a){var d=a.aoColumns,
f,b,l=H.ext.type.search;var c=!1;var r=0;for(f=a.aoData.length;r<f;r++){var t=a.aoData[r];if(!t._aFilterData){var e=[];var g=0;for(b=d.length;g<b;g++){c=d[g];if(c.bSearchable){var u=J(a,r,g,"filter");l[c.sType]&&(u=l[c.sType](u));null===u&&(u="");"string"!==typeof u&&u.toString&&(u=u.toString())}else u="";u.indexOf&&-1!==u.indexOf("&")&&(Ja.innerHTML=u,u=Jb?Ja.textContent:Ja.innerText);u.replace&&(u=u.replace(/[\r\n]/g,""));e.push(u)}t._aFilterData=e;t._sFilterRow=e.join("  ");c=!0}}return c}function mb(a){return{search:a.sSearch,
smart:a.bSmart,regex:a.bRegex,caseInsensitive:a.bCaseInsensitive}}function nb(a){return{sSearch:a.search,bSmart:a.smart,bRegex:a.regex,bCaseInsensitive:a.caseInsensitive}}function kb(d){var f=d.sTableId,b=d.aanFeatures.i,l=a("<div/>",{"class":d.oClasses.sInfo,id:b?null:f+"_info"});b||(d.aoDrawCallback.push({fn:ob,sName:"information"}),l.attr("role","status").attr("aria-live","polite"),a(d.nTable).attr("aria-describedby",f+"_info"));return l[0]}function ob(d){var f=d.aanFeatures.i;if(0!==f.length){var b=
d.oLanguage,l=d._iDisplayStart+1,c=d.fnDisplayEnd(),r=d.fnRecordsTotal(),t=d.fnRecordsDisplay(),e=t?b.sInfo:b.sInfoEmpty;t!==r&&(e+=" "+b.sInfoFiltered);e+=b.sInfoPostFix;e=pb(d,e);b=b.fnInfoCallback;null!==b&&(e=b.call(d.oInstance,d,l,c,r,t,e));a(f).html(e)}}function pb(a,d){var f=a.fnFormatNumber,b=a._iDisplayStart+1,l=a._iDisplayLength,c=a.fnRecordsDisplay(),r=-1===l;return d.replace(/_START_/g,f.call(a,b)).replace(/_END_/g,f.call(a,a.fnDisplayEnd())).replace(/_MAX_/g,f.call(a,a.fnRecordsTotal())).replace(/_TOTAL_/g,
f.call(a,c)).replace(/_PAGE_/g,f.call(a,r?1:Math.ceil(b/l))).replace(/_PAGES_/g,f.call(a,r?1:Math.ceil(c/l)))}function Ba(a){var d=a.iInitDisplayStart,f=a.aoColumns;var b=a.oFeatures;var c=a.bDeferLoading;if(a.bInitialised){l(a);t(a);C(a,a.aoHeader);C(a,a.aoFooter);ha(a,!0);b.bAutoWidth&&Qa(a);var r=0;for(b=f.length;r<b;r++){var e=f[r];e.sWidth&&(e.nTh.style.width=ca(e.sWidth))}Y(a,null,"preInit",[a]);Z(a);f=ia(a);if("ssp"!=f||c)"ajax"==f?M(a,[],function(f){var b=la(a,f);for(r=0;r<b.length;r++)E(a,
b[r]);a.iInitDisplayStart=d;Z(a);ha(a,!1);Fa(a,f)},a):(ha(a,!1),Fa(a))}else setTimeout(function(){Ba(a)},200)}function Fa(a,d){a._bInitComplete=!0;(d||a.oInit.aaData)&&y(a);Y(a,null,"plugin-init",[a,d]);Y(a,"aoInitComplete","init",[a,d])}function Va(a,d){d=parseInt(d,10);a._iDisplayLength=d;Wa(a);Y(a,null,"length",[a,d])}function ib(d){var f=d.oClasses,b=d.sTableId,l=d.aLengthMenu,c=a.isArray(l[0]),r=c?l[0]:l;l=c?l[1]:l;c=a("<select/>",{name:b+"_length","aria-controls":b,"class":f.sLengthSelect});
for(var t=0,e=r.length;t<e;t++)c[0][t]=new Option(l[t],r[t]);var g=a("<div><label/></div>").addClass(f.sLength);d.aanFeatures.l||(g[0].id=b+"_length");g.children().append(d.oLanguage.sLengthMenu.replace("_MENU_",c[0].outerHTML));a("select",g).val(d._iDisplayLength).on("change.DT",function(f){Va(d,a(this).val());S(d)});a(d.nTable).on("length.dt.DT",function(f,b,l){d===b&&a("select",g).val(l)});return g[0]}function lb(d){var f=d.sPaginationType,b=H.ext.pager[f],l="function"===typeof b,c=function(a){S(a)};
f=a("<div/>").addClass(d.oClasses.sPaging+f)[0];var r=d.aanFeatures;l||b.fnInit(d,f,c);r.p||(f.id=d.sTableId+"_paginate",d.aoDrawCallback.push({fn:function(a){if(l){var d=a._iDisplayStart,f=a._iDisplayLength,t=a.fnRecordsDisplay(),e=-1===f;d=e?0:Math.ceil(d/f);f=e?1:Math.ceil(t/f);t=b(d,f);var g;e=0;for(g=r.p.length;e<g;e++)Sa(a,"pageButton")(a,r.p[e],e,t,d,f)}else b.fnUpdate(a,c)},sName:"pagination"}));return f}function Xa(a,d,f){var b=a._iDisplayStart,l=a._iDisplayLength,c=a.fnRecordsDisplay();
0===c||-1===l?b=0:"number"===typeof d?(b=d*l,b>c&&(b=0)):"first"==d?b=0:"previous"==d?(b=0<=l?b-l:0,0>b&&(b=0)):"next"==d?b+l<c&&(b+=l):"last"==d?b=Math.floor((c-1)/l)*l:ra(a,0,"Unknown paging action: "+d,5);d=a._iDisplayStart!==b;a._iDisplayStart=b;d&&(Y(a,null,"page",[a]),f&&S(a));return d}function X(d){return a("<div/>",{id:d.aanFeatures.r?null:d.sTableId+"_processing","class":d.oClasses.sProcessing}).html(d.oLanguage.sProcessing).insertBefore(d.nTable)[0]}function ha(d,f){d.oFeatures.bProcessing&&
a(d.aanFeatures.r).css("display",f?"block":"none");Y(d,null,"processing",[d,f])}function ua(d){var f=a(d.nTable);f.attr("role","grid");var b=d.oScroll;if(""===b.sX&&""===b.sY)return d.nTable;var l=b.sX,c=b.sY,r=d.oClasses,t=f.children("caption"),e=t.length?t[0]._captionSide:null,g=a(f[0].cloneNode(!1)),u=a(f[0].cloneNode(!1)),h=f.children("tfoot");h.length||(h=null);g=a("<div/>",{"class":r.sScrollWrapper}).append(a("<div/>",{"class":r.sScrollHead}).css({overflow:"hidden",position:"relative",border:0,
width:l?l?ca(l):null:"100%"}).append(a("<div/>",{"class":r.sScrollHeadInner}).css({"box-sizing":"content-box",width:b.sXInner||"100%"}).append(g.removeAttr("id").css("margin-left",0).append("top"===e?t:null).append(f.children("thead"))))).append(a("<div/>",{"class":r.sScrollBody}).css({position:"relative",overflow:"auto",width:l?ca(l):null}).append(f));h&&g.append(a("<div/>",{"class":r.sScrollFoot}).css({overflow:"hidden",border:0,width:l?l?ca(l):null:"100%"}).append(a("<div/>",{"class":r.sScrollFootInner}).append(u.removeAttr("id").css("margin-left",
0).append("bottom"===e?t:null).append(f.children("tfoot")))));f=g.children();var C=f[0];r=f[1];var n=h?f[2]:null;if(l)a(r).on("scroll.DT",function(a){a=this.scrollLeft;C.scrollLeft=a;h&&(n.scrollLeft=a)});a(r).css(c&&b.bCollapse?"max-height":"height",c);d.nScrollHead=C;d.nScrollBody=r;d.nScrollFoot=n;d.aoDrawCallback.push({fn:ta,sName:"scrolling"});return g[0]}function ta(d){var f=d.oScroll,b=f.sX,l=f.sXInner,c=f.sY;f=f.iBarWidth;var r=a(d.nScrollHead),t=r[0].style,g=r.children("div"),u=g[0].style,
h=g.children("table");g=d.nScrollBody;var C=a(g),n=g.style,m=a(d.nScrollFoot).children("div"),p=m.children("table"),B=a(d.nTHead),k=a(d.nTable),q=k[0],S=q.style,v=d.nTFoot?a(d.nTFoot):null,M=d.oBrowser,x=M.bScrollOversize,Z=ma(d.aoColumns,"nTh"),da=[],aa=[],w=[],A=[],pa,la=function(a){a=a.style;a.paddingTop="0";a.paddingBottom="0";a.borderTopWidth="0";a.borderBottomWidth="0";a.height=0};var G=g.scrollHeight>g.clientHeight;if(d.scrollBarVis!==G&&d.scrollBarVis!==e)d.scrollBarVis=G,y(d);else{d.scrollBarVis=
G;k.children("thead, tfoot").remove();if(v){var E=v.clone().prependTo(k);var T=v.find("tr");E=E.find("tr")}var K=B.clone().prependTo(k);B=B.find("tr");G=K.find("tr");K.find("th, td").removeAttr("tabindex");b||(n.width="100%",r[0].style.width="100%");a.each(L(d,K),function(a,f){pa=z(d,a);f.style.width=d.aoColumns[pa].sWidth});v&&qa(function(a){a.style.width=""},E);r=k.outerWidth();""===b?(S.width="100%",x&&(k.find("tbody").height()>g.offsetHeight||"scroll"==C.css("overflow-y"))&&(S.width=ca(k.outerWidth()-
f)),r=k.outerWidth()):""!==l&&(S.width=ca(l),r=k.outerWidth());qa(la,G);qa(function(d){w.push(d.innerHTML);da.push(ca(a(d).css("width")))},G);qa(function(d,f){-1!==a.inArray(d,Z)&&(d.style.width=da[f])},B);a(G).height(0);v&&(qa(la,E),qa(function(d){A.push(d.innerHTML);aa.push(ca(a(d).css("width")))},E),qa(function(a,d){a.style.width=aa[d]},T),a(E).height(0));qa(function(a,d){a.innerHTML='<div class="dataTables_sizing" style="height:0;overflow:hidden;">'+w[d]+"</div>";a.style.width=da[d]},G);v&&qa(function(a,
d){a.innerHTML='<div class="dataTables_sizing" style="height:0;overflow:hidden;">'+A[d]+"</div>";a.style.width=aa[d]},E);k.outerWidth()<r?(T=g.scrollHeight>g.offsetHeight||"scroll"==C.css("overflow-y")?r+f:r,x&&(g.scrollHeight>g.offsetHeight||"scroll"==C.css("overflow-y"))&&(S.width=ca(T-f)),""!==b&&""===l||ra(d,1,"Possible column misalignment",6)):T="100%";n.width=ca(T);t.width=ca(T);v&&(d.nScrollFoot.style.width=ca(T));!c&&x&&(n.height=ca(q.offsetHeight+f));b=k.outerWidth();h[0].style.width=ca(b);
u.width=ca(b);l=k.height()>g.clientHeight||"scroll"==C.css("overflow-y");c="padding"+(M.bScrollbarLeft?"Left":"Right");u[c]=l?f+"px":"0px";v&&(p[0].style.width=ca(b),m[0].style.width=ca(b),m[0].style[c]=l?f+"px":"0px");k.children("colgroup").insertBefore(k.children("thead"));C.scroll();!d.bSorted&&!d.bFiltered||d._drawHold||(g.scrollTop=0)}}function qa(a,d,f){for(var b=0,l=0,c=d.length,r,t;l<c;){r=d[l].firstChild;for(t=f?f[l].firstChild:null;r;)1===r.nodeType&&(f?a(r,t,b):a(r,b),b++),r=r.nextSibling,
t=f?t.nextSibling:null;l++}}function Qa(d){var f=d.nTable,b=d.aoColumns,l=d.oScroll,c=l.sY,r=l.sX,t=l.sXInner,e=b.length,g=I(d,"bVisible"),u=a("th",d.nTHead),h=f.getAttribute("width"),C=f.parentNode,n=!1,m,p=d.oBrowser;l=p.bScrollOversize;(m=f.style.width)&&-1!==m.indexOf("%")&&(h=m);for(m=0;m<g.length;m++){var B=b[g[m]];null!==B.sWidth&&(B.sWidth=qb(B.sWidthOrig,C),n=!0)}if(l||!n&&!r&&!c&&e==w(d)&&e==u.length)for(m=0;m<e;m++)g=z(d,m),null!==g&&(b[g].sWidth=ca(u.eq(m).width()));else{e=a(f).clone().css("visibility",
"hidden").removeAttr("id");e.find("tbody tr").remove();var q=a("<tr/>").appendTo(e.find("tbody"));e.find("thead, tfoot").remove();e.append(a(d.nTHead).clone()).append(a(d.nTFoot).clone());e.find("tfoot th, tfoot td").css("width","");u=L(d,e.find("thead")[0]);for(m=0;m<g.length;m++)B=b[g[m]],u[m].style.width=null!==B.sWidthOrig&&""!==B.sWidthOrig?ca(B.sWidthOrig):"",B.sWidthOrig&&r&&a(u[m]).append(a("<div/>").css({width:B.sWidthOrig,margin:0,padding:0,border:0,height:1}));if(d.aoData.length)for(m=
0;m<g.length;m++)n=g[m],B=b[n],a(rb(d,n)).clone(!1).append(B.sContentPadding).appendTo(q);a("[name]",e).removeAttr("name");B=a("<div/>").css(r||c?{position:"absolute",top:0,left:0,height:1,right:0,overflow:"hidden"}:{}).append(e).appendTo(C);r&&t?e.width(t):r?(e.css("width","auto"),e.removeAttr("width"),e.width()<C.clientWidth&&h&&e.width(C.clientWidth)):c?e.width(C.clientWidth):h&&e.width(h);for(m=c=0;m<g.length;m++)C=a(u[m]),t=C.outerWidth()-C.width(),C=p.bBounding?Math.ceil(u[m].getBoundingClientRect().width):
C.outerWidth(),c+=C,b[g[m]].sWidth=ca(C-t);f.style.width=ca(c);B.remove()}h&&(f.style.width=ca(h));!h&&!r||d._reszEvt||(f=function(){a(k).on("resize.DT-"+d.sInstance,Ta(function(){y(d)}))},l?setTimeout(f,1E3):f(),d._reszEvt=!0)}function qb(d,f){if(!d)return 0;d=a("<div/>").css("width",ca(d)).appendTo(f||c.body);f=d[0].offsetWidth;d.remove();return f}function rb(d,f){var b=sb(d,f);if(0>b)return null;var l=d.aoData[b];return l.nTr?l.anCells[f]:a("<td/>").html(J(d,b,f,"display"))[0]}function sb(a,d){for(var f,
b=-1,l=-1,c=0,r=a.aoData.length;c<r;c++)f=J(a,c,d,"display")+"",f=f.replace(Kb,""),f=f.replace(/&nbsp;/g," "),f.length>b&&(b=f.length,l=c);return l}function ca(a){return null===a?"0px":"number"==typeof a?0>a?"0px":a+"px":a.match(/\d$/)?a+"px":a}function wa(d){var f=[],b=d.aoColumns;var l=d.aaSortingFixed;var c=a.isPlainObject(l);var r=[];var t=function(d){d.length&&!a.isArray(d[0])?r.push(d):a.merge(r,d)};a.isArray(l)&&t(l);c&&l.pre&&t(l.pre);t(d.aaSorting);c&&l.post&&t(l.post);for(d=0;d<r.length;d++){var g=
r[d][0];t=b[g].aDataSort;l=0;for(c=t.length;l<c;l++){var u=t[l];var h=b[u].sType||"string";r[d]._idx===e&&(r[d]._idx=a.inArray(r[d][1],b[u].asSorting));f.push({src:g,col:u,dir:r[d][1],index:r[d]._idx,type:h,formatter:H.ext.type.order[h+"-pre"]})}}return f}function hb(a){var d,f=[],b=H.ext.type.order,l=a.aoData,c=0,r=a.aiDisplayMaster;D(a);var t=wa(a);var e=0;for(d=t.length;e<d;e++){var g=t[e];g.formatter&&c++;tb(a,g.col)}if("ssp"!=ia(a)&&0!==t.length){e=0;for(d=r.length;e<d;e++)f[r[e]]=e;c===t.length?
r.sort(function(a,d){var b,c=t.length,r=l[a]._aSortData,e=l[d]._aSortData;for(b=0;b<c;b++){var g=t[b];var u=r[g.col];var h=e[g.col];u=u<h?-1:u>h?1:0;if(0!==u)return"asc"===g.dir?u:-u}u=f[a];h=f[d];return u<h?-1:u>h?1:0}):r.sort(function(a,d){var c,r=t.length,e=l[a]._aSortData,g=l[d]._aSortData;for(c=0;c<r;c++){var u=t[c];var h=e[u.col];var C=g[u.col];u=b[u.type+"-"+u.dir]||b["string-"+u.dir];h=u(h,C);if(0!==h)return h}h=f[a];C=f[d];return h<C?-1:h>C?1:0})}a.bSorted=!0}function ub(a){var d=a.aoColumns,
f=wa(a);a=a.oLanguage.oAria;for(var b=0,l=d.length;b<l;b++){var c=d[b];var r=c.asSorting;var t=c.sTitle.replace(/<.*?>/g,"");var e=c.nTh;e.removeAttribute("aria-sort");c.bSortable&&(0<f.length&&f[0].col==b?(e.setAttribute("aria-sort","asc"==f[0].dir?"ascending":"descending"),c=r[f[0].index+1]||r[0]):c=r[0],t+="asc"===c?a.sSortAscending:a.sSortDescending);e.setAttribute("aria-label",t)}}function Ya(d,f,b,l){var c=d.aaSorting,r=d.aoColumns[f].asSorting,t=function(d,f){var b=d._idx;b===e&&(b=a.inArray(d[1],
r));return b+1<r.length?b+1:f?null:0};"number"===typeof c[0]&&(c=d.aaSorting=[c]);b&&d.oFeatures.bSortMulti?(b=a.inArray(f,ma(c,"0")),-1!==b?(f=t(c[b],!0),null===f&&1===c.length&&(f=0),null===f?c.splice(b,1):(c[b][1]=r[f],c[b]._idx=f)):(c.push([f,r[0],0]),c[c.length-1]._idx=0)):c.length&&c[0][0]==f?(f=t(c[0]),c.length=1,c[0][1]=r[f],c[0]._idx=f):(c.length=0,c.push([f,r[0]]),c[0]._idx=0);Z(d);"function"==typeof l&&l(d)}function Ra(a,d,f,b){var l=a.aoColumns[f];Za(d,{},function(d){!1!==l.bSortable&&
(a.oFeatures.bProcessing?(ha(a,!0),setTimeout(function(){Ya(a,f,d.shiftKey,b);"ssp"!==ia(a)&&ha(a,!1)},0)):Ya(a,f,d.shiftKey,b))})}function Ka(d){var f=d.aLastSort,b=d.oClasses.sSortColumn,l=wa(d),c=d.oFeatures,r;if(c.bSort&&c.bSortClasses){c=0;for(r=f.length;c<r;c++){var t=f[c].src;a(ma(d.aoData,"anCells",t)).removeClass(b+(2>c?c+1:3))}c=0;for(r=l.length;c<r;c++)t=l[c].src,a(ma(d.aoData,"anCells",t)).addClass(b+(2>c?c+1:3))}d.aLastSort=l}function tb(a,d){var f=a.aoColumns[d],b=H.ext.order[f.sSortDataType],
l;b&&(l=b.call(a.oInstance,a,d,n(a,d)));for(var c,r=H.ext.type.order[f.sType+"-pre"],t=0,e=a.aoData.length;t<e;t++)if(f=a.aoData[t],f._aSortData||(f._aSortData=[]),!f._aSortData[d]||b)c=b?l[t]:J(a,t,d,"sort"),f._aSortData[d]=r?r(c):c}function La(d){if(d.oFeatures.bStateSave&&!d.bDestroying){var f={time:+new Date,start:d._iDisplayStart,length:d._iDisplayLength,order:a.extend(!0,[],d.aaSorting),search:mb(d.oPreviousSearch),columns:a.map(d.aoColumns,function(a,f){return{visible:a.bVisible,search:mb(d.aoPreSearchCols[f])}})};
Y(d,"aoStateSaveParams","stateSaveParams",[d,f]);d.oSavedState=f;d.fnStateSaveCallback.call(d.oInstance,d,f)}}function vb(d,f,b){var l,c,r=d.aoColumns;f=function(f){if(f&&f.time){var g=Y(d,"aoStateLoadParams","stateLoadParams",[d,t]);if(-1===a.inArray(!1,g)&&(g=d.iStateDuration,!(0<g&&f.time<+new Date-1E3*g||f.columns&&r.length!==f.columns.length))){d.oLoadedState=a.extend(!0,{},t);f.start!==e&&(d._iDisplayStart=f.start,d.iInitDisplayStart=f.start);f.length!==e&&(d._iDisplayLength=f.length);f.order!==
e&&(d.aaSorting=[],a.each(f.order,function(a,f){d.aaSorting.push(f[0]>=r.length?[0,f[1]]:f)}));f.search!==e&&a.extend(d.oPreviousSearch,nb(f.search));if(f.columns)for(l=0,c=f.columns.length;l<c;l++)g=f.columns[l],g.visible!==e&&(r[l].bVisible=g.visible),g.search!==e&&a.extend(d.aoPreSearchCols[l],nb(g.search));Y(d,"aoStateLoaded","stateLoaded",[d,t])}}b()};if(d.oFeatures.bStateSave){var t=d.fnStateLoadCallback.call(d.oInstance,d,f);t!==e&&f(t)}else b()}function Ma(d){var f=H.settings;d=a.inArray(d,
ma(f,"nTable"));return-1!==d?f[d]:null}function ra(a,d,f,b){f="DataTables warning: "+(a?"table id="+a.sTableId+" - ":"")+f;b&&(f+=". For more information about this error, please see http://datatables.net/tn/"+b);if(d)k.console&&console.log&&console.log(f);else if(d=H.ext,d=d.sErrMode||d.errMode,a&&Y(a,null,"error",[a,b,f]),"alert"==d)alert(f);else{if("throw"==d)throw Error(f);"function"==typeof d&&d(a,b,f)}}function na(d,f,b,l){a.isArray(b)?a.each(b,function(b,l){a.isArray(l)?na(d,f,l[0],l[1]):na(d,
f,l)}):(l===e&&(l=b),f[b]!==e&&(d[l]=f[b]))}function wb(d,f,b){var l;for(l in f)if(f.hasOwnProperty(l)){var c=f[l];a.isPlainObject(c)?(a.isPlainObject(d[l])||(d[l]={}),a.extend(!0,d[l],c)):b&&"data"!==l&&"aaData"!==l&&a.isArray(c)?d[l]=c.slice():d[l]=c}return d}function Za(d,f,b){a(d).on("click.DT",f,function(a){d.blur();b(a)}).on("keypress.DT",f,function(a){13===a.which&&(a.preventDefault(),b(a))}).on("selectstart.DT",function(){return!1})}function ja(a,d,f,b){f&&a[d].push({fn:f,sName:b})}function Y(d,
f,b,l){var c=[];f&&(c=a.map(d[f].slice().reverse(),function(a,f){return a.fn.apply(d.oInstance,l)}));null!==b&&(f=a.Event(b+".dt"),a(d.nTable).trigger(f,l),c.push(f.result));return c}function Wa(a){var d=a._iDisplayStart,f=a.fnDisplayEnd(),b=a._iDisplayLength;d>=f&&(d=f-b);d-=d%b;if(-1===b||0>d)d=0;a._iDisplayStart=d}function Sa(d,f){d=d.renderer;var b=H.ext.renderer[f];return a.isPlainObject(d)&&d[f]?b[d[f]]||b._:"string"===typeof d?b[d]||b._:b._}function ia(a){return a.oFeatures.bServerSide?"ssp":
a.ajax||a.sAjaxSource?"ajax":"dom"}function Ca(a,d){var f=xb.numbers_length,b=Math.floor(f/2);d<=f?a=ya(0,d):a<=b?(a=ya(0,f-2),a.push("ellipsis"),a.push(d-1)):(a>=d-1-b?a=ya(d-(f-2),d):(a=ya(a-b+2,a+b-1),a.push("ellipsis"),a.push(d-1)),a.splice(0,0,"ellipsis"),a.splice(0,0,0));a.DT_el="span";return a}function gb(d){a.each({num:function(a){return Na(a,d)},"num-fmt":function(a){return Na(a,d,$a)},"html-num":function(a){return Na(a,d,Oa)},"html-num-fmt":function(a){return Na(a,d,Oa,$a)}},function(a,
f){ea.type.order[a+d+"-pre"]=f;a.match(/^html\-/)&&(ea.type.search[a+d]=ea.type.search.html)})}function yb(a){return function(){var d=[Ma(this[H.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return H.ext.internal[a].apply(this,d)}}var H=function(d){this.$=function(a,d){return this.api(!0).$(a,d)};this._=function(a,d){return this.api(!0).rows(a,d).data()};this.api=function(a){return a?new W(Ma(this[ea.iApiIndex])):new W(this)};this.fnAddData=function(d,f){var b=this.api(!0);d=a.isArray(d)&&
(a.isArray(d[0])||a.isPlainObject(d[0]))?b.rows.add(d):b.row.add(d);(f===e||f)&&b.draw();return d.flatten().toArray()};this.fnAdjustColumnSizing=function(a){var d=this.api(!0).columns.adjust(),f=d.settings()[0],b=f.oScroll;a===e||a?d.draw(!1):""===b.sX&&""===b.sY||ta(f)};this.fnClearTable=function(a){var d=this.api(!0).clear();(a===e||a)&&d.draw()};this.fnClose=function(a){this.api(!0).row(a).child.hide()};this.fnDeleteRow=function(a,d,f){var b=this.api(!0);a=b.rows(a);var l=a.settings()[0],c=l.aoData[a[0][0]];
a.remove();d&&d.call(this,l,c);(f===e||f)&&b.draw();return c};this.fnDestroy=function(a){this.api(!0).destroy(a)};this.fnDraw=function(a){this.api(!0).draw(a)};this.fnFilter=function(a,d,f,b,l,c){l=this.api(!0);null===d||d===e?l.search(a,f,b,c):l.column(d).search(a,f,b,c);l.draw()};this.fnGetData=function(a,d){var f=this.api(!0);if(a!==e){var b=a.nodeName?a.nodeName.toLowerCase():"";return d!==e||"td"==b||"th"==b?f.cell(a,d).data():f.row(a).data()||null}return f.data().toArray()};this.fnGetNodes=
function(a){var d=this.api(!0);return a!==e?d.row(a).node():d.rows().nodes().flatten().toArray()};this.fnGetPosition=function(a){var d=this.api(!0),f=a.nodeName.toUpperCase();return"TR"==f?d.row(a).index():"TD"==f||"TH"==f?(a=d.cell(a).index(),[a.row,a.columnVisible,a.column]):null};this.fnIsOpen=function(a){return this.api(!0).row(a).child.isShown()};this.fnOpen=function(a,d,f){return this.api(!0).row(a).child(d,f).show().child()[0]};this.fnPageChange=function(a,d){a=this.api(!0).page(a);(d===e||
d)&&a.draw(!1)};this.fnSetColumnVis=function(a,d,f){a=this.api(!0).column(a).visible(d);(f===e||f)&&a.columns.adjust().draw()};this.fnSettings=function(){return Ma(this[ea.iApiIndex])};this.fnSort=function(a){this.api(!0).order(a).draw()};this.fnSortListener=function(a,d,f){this.api(!0).order.listener(a,d,f)};this.fnUpdate=function(a,d,f,b,l){var c=this.api(!0);f===e||null===f?c.row(d).data(a):c.cell(d,f).data(a);(l===e||l)&&c.columns.adjust();(b===e||b)&&c.draw();return 0};this.fnVersionCheck=ea.fnVersionCheck;
var f=this,b=d===e,l=this.length;b&&(d={});this.oApi=this.internal=ea.internal;for(var c in H.ext.internal)c&&(this[c]=yb(c));this.each(function(){var c={},r=1<l?wb(c,d,!0):d,t=0,C;c=this.getAttribute("id");var n=!1,p=H.defaults,k=a(this);if("table"!=this.nodeName.toLowerCase())ra(null,0,"Non-table node initialisation ("+this.nodeName+")",2);else{g(p);v(p.column);h(p,p,!0);h(p.column,p.column,!0);h(p,a.extend(r,k.data()));var S=H.settings;t=0;for(C=S.length;t<C;t++){var y=S[t];if(y.nTable==this||
y.nTHead.parentNode==this||y.nTFoot&&y.nTFoot.parentNode==this){var z=r.bRetrieve!==e?r.bRetrieve:p.bRetrieve;if(b||z)return y.oInstance;if(r.bDestroy!==e?r.bDestroy:p.bDestroy){y.oInstance.fnDestroy();break}else{ra(y,0,"Cannot reinitialise DataTable",3);return}}if(y.sTableId==this.id){S.splice(t,1);break}}if(null===c||""===c)this.id=c="DataTables_Table_"+H.ext._unique++;var B=a.extend(!0,{},H.models.oSettings,{sDestroyWidth:k[0].style.width,sInstance:c,sTableId:c});B.nTable=this;B.oApi=f.internal;
B.oInit=r;S.push(B);B.oInstance=1===f.length?f:k.dataTable();g(r);r.oLanguage&&m(r.oLanguage);r.aLengthMenu&&!r.iDisplayLength&&(r.iDisplayLength=a.isArray(r.aLengthMenu[0])?r.aLengthMenu[0][0]:r.aLengthMenu[0]);r=wb(a.extend(!0,{},p),r);na(B.oFeatures,r,"bPaginate bLengthChange bFilter bSort bSortMulti bInfo bProcessing bAutoWidth bSortClasses bServerSide bDeferRender".split(" "));na(B,r,["asStripeClasses","ajax","fnServerData","fnFormatNumber","sServerMethod","aaSorting","aaSortingFixed","aLengthMenu",
"sPaginationType","sAjaxSource","sAjaxDataProp","iStateDuration","sDom","bSortCellsTop","iTabIndex","fnStateLoadCallback","fnStateSaveCallback","renderer","searchDelay","rowId",["iCookieDuration","iStateDuration"],["oSearch","oPreviousSearch"],["aoSearchCols","aoPreSearchCols"],["iDisplayLength","_iDisplayLength"],["bJQueryUI","bJUI"]]);na(B.oScroll,r,[["sScrollX","sX"],["sScrollXInner","sXInner"],["sScrollY","sY"],["bScrollCollapse","bCollapse"]]);na(B.oLanguage,r,"fnInfoCallback");ja(B,"aoDrawCallback",
r.fnDrawCallback,"user");ja(B,"aoServerParams",r.fnServerParams,"user");ja(B,"aoStateSaveParams",r.fnStateSaveParams,"user");ja(B,"aoStateLoadParams",r.fnStateLoadParams,"user");ja(B,"aoStateLoaded",r.fnStateLoaded,"user");ja(B,"aoRowCallback",r.fnRowCallback,"user");ja(B,"aoRowCreatedCallback",r.fnCreatedRow,"user");ja(B,"aoHeaderCallback",r.fnHeaderCallback,"user");ja(B,"aoFooterCallback",r.fnFooterCallback,"user");ja(B,"aoInitComplete",r.fnInitComplete,"user");ja(B,"aoPreDrawCallback",r.fnPreDrawCallback,
"user");B.rowIdFn=P(r.rowId);x(B);var M=B.oClasses;r.bJQueryUI?(a.extend(M,H.ext.oJUIClasses,r.oClasses),r.sDom===p.sDom&&"lfrtip"===p.sDom&&(B.sDom='<"H"lfr>t<"F"ip>'),B.renderer)?a.isPlainObject(B.renderer)&&!B.renderer.header&&(B.renderer.header="jqueryui"):B.renderer="jqueryui":a.extend(M,H.ext.classes,r.oClasses);k.addClass(M.sTable);B.iInitDisplayStart===e&&(B.iInitDisplayStart=r.iDisplayStart,B._iDisplayStart=r.iDisplayStart);null!==r.iDeferLoading&&(B.bDeferLoading=!0,c=a.isArray(r.iDeferLoading),
B._iRecordsDisplay=c?r.iDeferLoading[0]:r.iDeferLoading,B._iRecordsTotal=c?r.iDeferLoading[1]:r.iDeferLoading);var Z=B.oLanguage;a.extend(!0,Z,r.oLanguage);Z.sUrl&&(a.ajax({dataType:"json",url:Z.sUrl,success:function(d){m(d);h(p.oLanguage,d);a.extend(!0,Z,d);Ba(B)},error:function(){Ba(B)}}),n=!0);null===r.asStripeClasses&&(B.asStripeClasses=[M.sStripeOdd,M.sStripeEven]);c=B.asStripeClasses;var da=k.children("tbody").find("tr").eq(0);-1!==a.inArray(!0,a.map(c,function(a,d){return da.hasClass(a)}))&&
(a("tbody tr",this).removeClass(c.join(" ")),B.asDestroyStripes=c.slice());c=[];S=this.getElementsByTagName("thead");0!==S.length&&(u(B.aoHeader,S[0]),c=L(B));if(null===r.aoColumns)for(S=[],t=0,C=c.length;t<C;t++)S.push(null);else S=r.aoColumns;t=0;for(C=S.length;t<C;t++)q(B,c?c[t]:null);K(B,r.aoColumnDefs,S,function(a,d){A(B,a,d)});if(da.length){var aa=function(a,d){return null!==a.getAttribute("data-"+d)?d:null};a(da[0]).children("th, td").each(function(a,d){var f=B.aoColumns[a];if(f.mData===a){var b=
aa(d,"sort")||aa(d,"order");d=aa(d,"filter")||aa(d,"search");if(null!==b||null!==d)f.mData={_:a+".display",sort:null!==b?a+".@data-"+b:e,type:null!==b?a+".@data-"+b:e,filter:null!==d?a+".@data-"+d:e},A(B,a)}})}var w=B.oFeatures;c=function(){if(r.aaSorting===e){var d=B.aaSorting;t=0;for(C=d.length;t<C;t++)d[t][1]=B.aoColumns[t].asSorting[0]}Ka(B);w.bSort&&ja(B,"aoDrawCallback",function(){if(B.bSorted){var d=wa(B),f={};a.each(d,function(a,d){f[d.src]=d.dir});Y(B,null,"order",[B,d,f]);ub(B)}});ja(B,
"aoDrawCallback",function(){(B.bSorted||"ssp"===ia(B)||w.bDeferRender)&&Ka(B)},"sc");d=k.children("caption").each(function(){this._captionSide=a(this).css("caption-side")});var f=k.children("thead");0===f.length&&(f=a("<thead/>").appendTo(k));B.nTHead=f[0];f=k.children("tbody");0===f.length&&(f=a("<tbody/>").appendTo(k));B.nTBody=f[0];f=k.children("tfoot");0===f.length&&0<d.length&&(""!==B.oScroll.sX||""!==B.oScroll.sY)&&(f=a("<tfoot/>").appendTo(k));0===f.length||0===f.children().length?k.addClass(M.sNoFooter):
0<f.length&&(B.nTFoot=f[0],u(B.aoFooter,B.nTFoot));if(r.aaData)for(t=0;t<r.aaData.length;t++)E(B,r.aaData[t]);else(B.bDeferLoading||"dom"==ia(B))&&O(B,a(B.nTBody).children("tr"));B.aiDisplay=B.aiDisplayMaster.slice();B.bInitialised=!0;!1===n&&Ba(B)};r.bStateSave?(w.bStateSave=!0,ja(B,"aoDrawCallback",La,"state_save"),vb(B,r,c)):c()}});f=null;return this},ea,R,ba,ab={},zb=/[\r\n]/g,Oa=/<.*?>/g,Lb=/^\d{2,4}[\.\/\-]\d{1,2}[\.\/\-]\d{1,2}([T ]{1}\d{1,2}[:\.]\d{2}([\.:]\d{2})?)?$/,Mb=/(\/|\.|\*|\+|\?|\||\(|\)|\[|\]|\{|\}|\\|\$|\^|\-)/g,
$a=/[',$\u00a3\u20ac\u00a5%\u2009\u202F\u20BD\u20a9\u20BArfk]/gi,sa=function(a){return a&&!0!==a&&"-"!==a?!1:!0},Ab=function(a){var d=parseInt(a,10);return!isNaN(d)&&isFinite(a)?d:null},Bb=function(a,d){ab[d]||(ab[d]=new RegExp(Ua(d),"g"));return"string"===typeof a&&"."!==d?a.replace(/\./g,"").replace(ab[d],"."):a},bb=function(a,d,f){var b="string"===typeof a;if(sa(a))return!0;d&&b&&(a=Bb(a,d));f&&b&&(a=a.replace($a,""));return!isNaN(parseFloat(a))&&isFinite(a)},Cb=function(a,d,f){return sa(a)?!0:
sa(a)||"string"===typeof a?bb(a.replace(Oa,""),d,f)?!0:null:null},ma=function(a,d,f){var b=[],l=0,c=a.length;if(f!==e)for(;l<c;l++)a[l]&&a[l][d]&&b.push(a[l][d][f]);else for(;l<c;l++)a[l]&&b.push(a[l][d]);return b},Da=function(a,d,f,b){var l=[],c=0,r=d.length;if(b!==e)for(;c<r;c++)a[d[c]][f]&&l.push(a[d[c]][f][b]);else for(;c<r;c++)l.push(a[d[c]][f]);return l},ya=function(a,d){var f=[];if(d===e){d=0;var b=a}else b=d,d=a;for(a=d;a<b;a++)f.push(a);return f},Db=function(a){for(var d=[],f=0,b=a.length;f<
b;f++)a[f]&&d.push(a[f]);return d},Ea=function(a){var d=[],f=a.length,b,l=0;var c=0;a:for(;c<f;c++){var r=a[c];for(b=0;b<l;b++)if(d[b]===r)continue a;d.push(r);l++}return d};H.util={throttle:function(a,d){var f=d!==e?d:200,b,l;return function(){var d=this,c=+new Date,r=arguments;b&&c<b+f?(clearTimeout(l),l=setTimeout(function(){b=e;a.apply(d,r)},f)):(b=c,a.apply(d,r))}},escapeRegex:function(a){return a.replace(Mb,"\\$1")}};var ka=function(a,d,f){a[d]!==e&&(a[f]=a[d])},za=/\[.*?\]$/,va=/\(\)$/,Ua=
H.util.escapeRegex,Ja=a("<div>")[0],Jb=Ja.textContent!==e,Kb=/<.*?>/g,Ta=H.util.throttle,Eb=[],fa=Array.prototype,Nb=function(d){var f,b=H.settings,l=a.map(b,function(a,d){return a.nTable});if(d){if(d.nTable&&d.oApi)return[d];if(d.nodeName&&"table"===d.nodeName.toLowerCase()){var c=a.inArray(d,l);return-1!==c?[b[c]]:null}if(d&&"function"===typeof d.settings)return d.settings().toArray();"string"===typeof d?f=a(d):d instanceof a&&(f=d)}else return[];if(f)return f.map(function(d){c=a.inArray(this,l);
return-1!==c?b[c]:null}).toArray()};var W=function(d,f){if(!(this instanceof W))return new W(d,f);var b=[],l=function(a){(a=Nb(a))&&(b=b.concat(a))};if(a.isArray(d))for(var c=0,r=d.length;c<r;c++)l(d[c]);else l(d);this.context=Ea(b);f&&a.merge(this,f);this.selector={rows:null,cols:null,opts:null};W.extend(this,this,Eb)};H.Api=W;a.extend(W.prototype,{any:function(){return 0!==this.count()},concat:fa.concat,context:[],count:function(){return this.flatten().length},each:function(a){for(var d=0,f=this.length;d<
f;d++)a.call(this,this[d],d,this);return this},eq:function(a){var d=this.context;return d.length>a?new W(d[a],this[a]):null},filter:function(a){var d=[];if(fa.filter)d=fa.filter.call(this,a,this);else for(var f=0,b=this.length;f<b;f++)a.call(this,this[f],f,this)&&d.push(this[f]);return new W(this.context,d)},flatten:function(){var a=[];return new W(this.context,a.concat.apply(a,this.toArray()))},join:fa.join,indexOf:fa.indexOf||function(a,d){d=d||0;for(var f=this.length;d<f;d++)if(this[d]===a)return d;
return-1},iterator:function(a,d,f,b){var l=[],c,r,t=this.context,g,u=this.selector;"string"===typeof a&&(b=f,f=d,d=a,a=!1);var h=0;for(c=t.length;h<c;h++){var C=new W(t[h]);if("table"===d){var n=f.call(C,t[h],h);n!==e&&l.push(n)}else if("columns"===d||"rows"===d)n=f.call(C,t[h],this[h],h),n!==e&&l.push(n);else if("column"===d||"column-rows"===d||"row"===d||"cell"===d){var m=this[h];"column-rows"===d&&(g=Pa(t[h],u.opts));var p=0;for(r=m.length;p<r;p++)n=m[p],n="cell"===d?f.call(C,t[h],n.row,n.column,
h,p):f.call(C,t[h],n,h,p,g),n!==e&&l.push(n)}}return l.length||b?(a=new W(t,a?l.concat.apply([],l):l),d=a.selector,d.rows=u.rows,d.cols=u.cols,d.opts=u.opts,a):this},lastIndexOf:fa.lastIndexOf||function(a,d){return this.indexOf.apply(this.toArray.reverse(),arguments)},length:0,map:function(a){var d=[];if(fa.map)d=fa.map.call(this,a,this);else for(var f=0,b=this.length;f<b;f++)d.push(a.call(this,this[f],f));return new W(this.context,d)},pluck:function(a){return this.map(function(d){return d[a]})},
pop:fa.pop,push:fa.push,reduce:fa.reduce||function(a,d){return p(this,a,d,0,this.length,1)},reduceRight:fa.reduceRight||function(a,d){return p(this,a,d,this.length-1,-1,-1)},reverse:fa.reverse,selector:null,shift:fa.shift,sort:fa.sort,splice:fa.splice,toArray:function(){return fa.slice.call(this)},to$:function(){return a(this)},toJQuery:function(){return a(this)},unique:function(){return new W(this.context,Ea(this))},unshift:fa.unshift});W.extend=function(d,f,b){if(b.length&&f&&(f instanceof W||f.__dt_wrapper)){var l,
c=function(a,d,f){return function(){var b=d.apply(a,arguments);W.extend(b,b,f.methodExt);return b}};var r=0;for(l=b.length;r<l;r++){var t=b[r];f[t.name]="function"===typeof t.val?c(d,t.val,t):a.isPlainObject(t.val)?{}:t.val;f[t.name].__dt_wrapper=!0;W.extend(d,f[t.name],t.propExt)}}};W.register=R=function(d,f){if(a.isArray(d))for(var b=0,l=d.length;b<l;b++)W.register(d[b],f);else{l=d.split(".");var c=Eb,r;d=0;for(b=l.length;d<b;d++){var t=(r=-1!==l[d].indexOf("()"))?l[d].replace("()",""):l[d];a:{var e=
0;for(var g=c.length;e<g;e++)if(c[e].name===t){e=c[e];break a}e=null}e||(e={name:t,val:{},methodExt:[],propExt:[]},c.push(e));d===b-1?e.val=f:c=r?e.methodExt:e.propExt}}};W.registerPlural=ba=function(d,f,b){W.register(d,b);W.register(f,function(){var d=b.apply(this,arguments);return d===this?this:d instanceof W?d.length?a.isArray(d[0])?new W(d.context,d[0]):d[0]:e:d})};var Ob=function(d,f){if("number"===typeof d)return[f[d]];var b=a.map(f,function(a,d){return a.nTable});return a(b).filter(d).map(function(d){d=
a.inArray(this,b);return f[d]}).toArray()};R("tables()",function(a){return a?new W(Ob(a,this.context)):this});R("table()",function(a){a=this.tables(a);var d=a.context;return d.length?new W(d[0]):a});ba("tables().nodes()","table().node()",function(){return this.iterator("table",function(a){return a.nTable},1)});ba("tables().body()","table().body()",function(){return this.iterator("table",function(a){return a.nTBody},1)});ba("tables().header()","table().header()",function(){return this.iterator("table",
function(a){return a.nTHead},1)});ba("tables().footer()","table().footer()",function(){return this.iterator("table",function(a){return a.nTFoot},1)});ba("tables().containers()","table().container()",function(){return this.iterator("table",function(a){return a.nTableWrapper},1)});R("draw()",function(a){return this.iterator("table",function(d){"page"===a?S(d):("string"===typeof a&&(a="full-hold"===a?!1:!0),Z(d,!1===a))})});R("page()",function(a){return a===e?this.page.info().page:this.iterator("table",
function(d){Xa(d,a)})});R("page.info()",function(a){if(0===this.context.length)return e;a=this.context[0];var d=a._iDisplayStart,f=a.oFeatures.bPaginate?a._iDisplayLength:-1,b=a.fnRecordsDisplay(),l=-1===f;return{page:l?0:Math.floor(d/f),pages:l?1:Math.ceil(b/f),start:d,end:a.fnDisplayEnd(),length:f,recordsTotal:a.fnRecordsTotal(),recordsDisplay:b,serverSide:"ssp"===ia(a)}});R("page.len()",function(a){return a===e?0!==this.context.length?this.context[0]._iDisplayLength:e:this.iterator("table",function(d){Va(d,
a)})});var Fb=function(a,d,f){if(f){var b=new W(a);b.one("draw",function(){f(b.ajax.json())})}if("ssp"==ia(a))Z(a,d);else{ha(a,!0);var l=a.jqXHR;l&&4!==l.readyState&&l.abort();M(a,[],function(f){T(a);f=la(a,f);for(var b=0,l=f.length;b<l;b++)E(a,f[b]);Z(a,d);ha(a,!1)})}};R("ajax.json()",function(){var a=this.context;if(0<a.length)return a[0].json});R("ajax.params()",function(){var a=this.context;if(0<a.length)return a[0].oAjaxData});R("ajax.reload()",function(a,d){return this.iterator("table",function(f){Fb(f,
!1===d,a)})});R("ajax.url()",function(d){var f=this.context;if(d===e){if(0===f.length)return e;f=f[0];return f.ajax?a.isPlainObject(f.ajax)?f.ajax.url:f.ajax:f.sAjaxSource}return this.iterator("table",function(f){a.isPlainObject(f.ajax)?f.ajax.url=d:f.ajax=d})});R("ajax.url().load()",function(a,d){return this.iterator("table",function(f){Fb(f,!1===d,a)})});var cb=function(d,f,b,l,c){var r=[],t,g,u;var h=typeof f;f&&"string"!==h&&"function"!==h&&f.length!==e||(f=[f]);h=0;for(g=f.length;h<g;h++){var C=
f[h]&&f[h].split&&!f[h].match(/[\[\(:]/)?f[h].split(","):[f[h]];var n=0;for(u=C.length;n<u;n++)(t=b("string"===typeof C[n]?a.trim(C[n]):C[n]))&&t.length&&(r=r.concat(t))}d=ea.selector[d];if(d.length)for(h=0,g=d.length;h<g;h++)r=d[h](l,c,r);return Ea(r)},db=function(d){d||(d={});d.filter&&d.search===e&&(d.search=d.filter);return a.extend({search:"none",order:"current",page:"all"},d)},eb=function(a){for(var d=0,f=a.length;d<f;d++)if(0<a[d].length)return a[0]=a[d],a[0].length=1,a.length=1,a.context=
[a.context[d]],a;a.length=0;return a},Pa=function(d,f){var b=[],l=d.aiDisplay;var c=d.aiDisplayMaster;var r=f.search;var t=f.order;f=f.page;if("ssp"==ia(d))return"removed"===r?[]:ya(0,c.length);if("current"==f)for(c=d._iDisplayStart,d=d.fnDisplayEnd();c<d;c++)b.push(l[c]);else if("current"==t||"applied"==t)b="none"==r?c.slice():"applied"==r?l.slice():a.map(c,function(d,f){return-1===a.inArray(d,l)?d:null});else if("index"==t||"original"==t)for(c=0,d=d.aoData.length;c<d;c++)"none"==r?b.push(c):(t=
a.inArray(c,l),(-1===t&&"removed"==r||0<=t&&"applied"==r)&&b.push(c));return b},Pb=function(d,f,b){var l;return cb("row",f,function(f){var c=Ab(f);if(null!==c&&!b)return[c];l||(l=Pa(d,b));if(null!==c&&-1!==a.inArray(c,l))return[c];if(null===f||f===e||""===f)return l;if("function"===typeof f)return a.map(l,function(a){var b=d.aoData[a];return f(a,b._aData,b.nTr)?a:null});c=Db(Da(d.aoData,l,"nTr"));if(f.nodeName){if(f._DT_RowIndex!==e)return[f._DT_RowIndex];if(f._DT_CellIndex)return[f._DT_CellIndex.row];
c=a(f).closest("*[data-dt-row]");return c.length?[c.data("dt-row")]:[]}if("string"===typeof f&&"#"===f.charAt(0)){var r=d.aIds[f.replace(/^#/,"")];if(r!==e)return[r.idx]}return a(c).filter(f).map(function(){return this._DT_RowIndex}).toArray()},d,b)};R("rows()",function(d,f){d===e?d="":a.isPlainObject(d)&&(f=d,d="");f=db(f);var b=this.iterator("table",function(a){return Pb(a,d,f)},1);b.selector.rows=d;b.selector.opts=f;return b});R("rows().nodes()",function(){return this.iterator("row",function(a,
d){return a.aoData[d].nTr||e},1)});R("rows().data()",function(){return this.iterator(!0,"rows",function(a,d){return Da(a.aoData,d,"_aData")},1)});ba("rows().cache()","row().cache()",function(a){return this.iterator("row",function(d,f){d=d.aoData[f];return"search"===a?d._aFilterData:d._aSortData},1)});ba("rows().invalidate()","row().invalidate()",function(a){return this.iterator("row",function(d,f){F(d,f,a)})});ba("rows().indexes()","row().index()",function(){return this.iterator("row",function(a,
d){return d},1)});ba("rows().ids()","row().id()",function(a){for(var d=[],f=this.context,b=0,l=f.length;b<l;b++)for(var c=0,r=this[b].length;c<r;c++){var t=f[b].rowIdFn(f[b].aoData[this[b][c]]._aData);d.push((!0===a?"#":"")+t)}return new W(f,d)});ba("rows().remove()","row().remove()",function(){var a=this;this.iterator("row",function(d,f,b){var l=d.aoData,c=l[f],r,t;l.splice(f,1);var g=0;for(r=l.length;g<r;g++){var u=l[g];var h=u.anCells;null!==u.nTr&&(u.nTr._DT_RowIndex=g);if(null!==h)for(u=0,t=
h.length;u<t;u++)h[u]._DT_CellIndex.row=g}U(d.aiDisplayMaster,f);U(d.aiDisplay,f);U(a[b],f,!1);Wa(d);f=d.rowIdFn(c._aData);f!==e&&delete d.aIds[f]});this.iterator("table",function(a){for(var d=0,f=a.aoData.length;d<f;d++)a.aoData[d].idx=d});return this});R("rows.add()",function(d){var f=this.iterator("table",function(a){var f,b=[];var l=0;for(f=d.length;l<f;l++){var c=d[l];c.nodeName&&"TR"===c.nodeName.toUpperCase()?b.push(O(a,c)[0]):b.push(E(a,c))}return b},1),b=this.rows(-1);b.pop();a.merge(b,f);
return b});R("row()",function(a,d){return eb(this.rows(a,d))});R("row().data()",function(a){var d=this.context;if(a===e)return d.length&&this.length?d[0].aoData[this[0]]._aData:e;d[0].aoData[this[0]]._aData=a;F(d[0],this[0],"data");return this});R("row().node()",function(){var a=this.context;return a.length&&this.length?a[0].aoData[this[0]].nTr||null:null});R("row.add()",function(d){d instanceof a&&d.length&&(d=d[0]);var f=this.iterator("table",function(a){return d.nodeName&&"TR"===d.nodeName.toUpperCase()?
O(a,d)[0]:E(a,d)});return this.row(f[0])});var Qb=function(d,f,b,l){var c=[],r=function(f,b){if(a.isArray(f)||f instanceof a)for(var l=0,t=f.length;l<t;l++)r(f[l],b);else f.nodeName&&"tr"===f.nodeName.toLowerCase()?c.push(f):(l=a("<tr><td/></tr>").addClass(b),a("td",l).addClass(b).html(f)[0].colSpan=w(d),c.push(l[0]))};r(b,l);f._details&&f._details.detach();f._details=a(c);f._detailsShow&&f._details.insertAfter(f.nTr)},fb=function(a,d){var f=a.context;f.length&&(a=f[0].aoData[d!==e?d:a[0]])&&a._details&&
(a._details.remove(),a._detailsShow=e,a._details=e)},Gb=function(a,d){var f=a.context;f.length&&a.length&&(a=f[0].aoData[a[0]],a._details&&((a._detailsShow=d)?a._details.insertAfter(a.nTr):a._details.detach(),Rb(f[0])))},Rb=function(a){var d=new W(a),f=a.aoData;d.off("draw.dt.DT_details column-visibility.dt.DT_details destroy.dt.DT_details");0<ma(f,"_details").length&&(d.on("draw.dt.DT_details",function(b,l){a===l&&d.rows({page:"current"}).eq(0).each(function(a){a=f[a];a._detailsShow&&a._details.insertAfter(a.nTr)})}),
d.on("column-visibility.dt.DT_details",function(d,b,l,c){if(a===b)for(b=w(b),l=0,c=f.length;l<c;l++)d=f[l],d._details&&d._details.children("td[colspan]").attr("colspan",b)}),d.on("destroy.dt.DT_details",function(b,l){if(a===l)for(b=0,l=f.length;b<l;b++)f[b]._details&&fb(d,b)}))};R("row().child()",function(a,d){var f=this.context;if(a===e)return f.length&&this.length?f[0].aoData[this[0]]._details:e;!0===a?this.child.show():!1===a?fb(this):f.length&&this.length&&Qb(f[0],f[0].aoData[this[0]],a,d);return this});
R(["row().child.show()","row().child().show()"],function(a){Gb(this,!0);return this});R(["row().child.hide()","row().child().hide()"],function(){Gb(this,!1);return this});R(["row().child.remove()","row().child().remove()"],function(){fb(this);return this});R("row().child.isShown()",function(){var a=this.context;return a.length&&this.length?a[0].aoData[this[0]]._detailsShow||!1:!1});var Sb=/^([^:]+):(name|visIdx|visible)$/,Hb=function(a,d,f,b,l){f=[];b=0;for(var c=l.length;b<c;b++)f.push(J(a,l[b],
d));return f},Tb=function(d,f,b){var l=d.aoColumns,c=ma(l,"sName"),r=ma(l,"nTh");return cb("column",f,function(f){var t=Ab(f);if(""===f)return ya(l.length);if(null!==t)return[0<=t?t:l.length+t];if("function"===typeof f){var e=Pa(d,b);return a.map(l,function(a,b){return f(b,Hb(d,b,0,0,e),r[b])?b:null})}var g="string"===typeof f?f.match(Sb):"";if(g)switch(g[2]){case "visIdx":case "visible":t=parseInt(g[1],10);if(0>t){var u=a.map(l,function(a,d){return a.bVisible?d:null});return[u[u.length+t]]}return[z(d,
t)];case "name":return a.map(c,function(a,d){return a===g[1]?d:null});default:return[]}if(f.nodeName&&f._DT_CellIndex)return[f._DT_CellIndex.column];t=a(r).filter(f).map(function(){return a.inArray(this,r)}).toArray();if(t.length||!f.nodeName)return t;t=a(f).closest("*[data-dt-column]");return t.length?[t.data("dt-column")]:[]},d,b)};R("columns()",function(d,f){d===e?d="":a.isPlainObject(d)&&(f=d,d="");f=db(f);var b=this.iterator("table",function(a){return Tb(a,d,f)},1);b.selector.cols=d;b.selector.opts=
f;return b});ba("columns().header()","column().header()",function(a,d){return this.iterator("column",function(a,d){return a.aoColumns[d].nTh},1)});ba("columns().footer()","column().footer()",function(a,d){return this.iterator("column",function(a,d){return a.aoColumns[d].nTf},1)});ba("columns().data()","column().data()",function(){return this.iterator("column-rows",Hb,1)});ba("columns().dataSrc()","column().dataSrc()",function(){return this.iterator("column",function(a,d){return a.aoColumns[d].mData},
1)});ba("columns().cache()","column().cache()",function(a){return this.iterator("column-rows",function(d,f,b,l,c){return Da(d.aoData,c,"search"===a?"_aFilterData":"_aSortData",f)},1)});ba("columns().nodes()","column().nodes()",function(){return this.iterator("column-rows",function(a,d,f,b,l){return Da(a.aoData,l,"anCells",d)},1)});ba("columns().visible()","column().visible()",function(d,f){var b=this.iterator("column",function(f,b){if(d===e)return f.aoColumns[b].bVisible;var l=f.aoColumns,c=l[b],
r=f.aoData,t;if(d!==e&&c.bVisible!==d){if(d){var g=a.inArray(!0,ma(l,"bVisible"),b+1);var u=0;for(t=r.length;u<t;u++){var h=r[u].nTr;l=r[u].anCells;h&&h.insertBefore(l[b],l[g]||null)}}else a(ma(f.aoData,"anCells",b)).detach();c.bVisible=d;C(f,f.aoHeader);C(f,f.aoFooter);La(f)}});d!==e&&(this.iterator("column",function(a,b){Y(a,null,"column-visibility",[a,b,d,f])}),(f===e||f)&&this.columns.adjust());return b});ba("columns().indexes()","column().index()",function(a){return this.iterator("column",function(d,
f){return"visible"===a?n(d,f):f},1)});R("columns.adjust()",function(){return this.iterator("table",function(a){y(a)},1)});R("column.index()",function(a,d){if(0!==this.context.length){var f=this.context[0];if("fromVisible"===a||"toData"===a)return z(f,d);if("fromData"===a||"toVisible"===a)return n(f,d)}});R("column()",function(a,d){return eb(this.columns(a,d))});var Ub=function(d,f,b){var l=d.aoData,c=Pa(d,b),r=Db(Da(l,c,"anCells")),t=a([].concat.apply([],r)),g,u=d.aoColumns.length,h,C,n,m,p,L;return cb("cell",
f,function(f){var b="function"===typeof f;if(null===f||f===e||b){h=[];C=0;for(n=c.length;C<n;C++)for(g=c[C],m=0;m<u;m++)p={row:g,column:m},b?(L=l[g],f(p,J(d,g,m),L.anCells?L.anCells[m]:null)&&h.push(p)):h.push(p);return h}if(a.isPlainObject(f))return[f];b=t.filter(f).map(function(a,d){return{row:d._DT_CellIndex.row,column:d._DT_CellIndex.column}}).toArray();if(b.length||!f.nodeName)return b;L=a(f).closest("*[data-dt-row]");return L.length?[{row:L.data("dt-row"),column:L.data("dt-column")}]:[]},d,
b)};R("cells()",function(d,f,b){a.isPlainObject(d)&&(d.row===e?(b=d,d=null):(b=f,f=null));a.isPlainObject(f)&&(b=f,f=null);if(null===f||f===e)return this.iterator("table",function(a){return Ub(a,d,db(b))});var l=this.columns(f,b),c=this.rows(d,b),r,t,g,u,h,C=this.iterator("table",function(a,d){r=[];t=0;for(g=c[d].length;t<g;t++)for(u=0,h=l[d].length;u<h;u++)r.push({row:c[d][t],column:l[d][u]});return r},1);a.extend(C.selector,{cols:f,rows:d,opts:b});return C});ba("cells().nodes()","cell().node()",
function(){return this.iterator("cell",function(a,d,f){return(a=a.aoData[d])&&a.anCells?a.anCells[f]:e},1)});R("cells().data()",function(){return this.iterator("cell",function(a,d,f){return J(a,d,f)},1)});ba("cells().cache()","cell().cache()",function(a){a="search"===a?"_aFilterData":"_aSortData";return this.iterator("cell",function(d,f,b){return d.aoData[f][a][b]},1)});ba("cells().render()","cell().render()",function(a){return this.iterator("cell",function(d,f,b){return J(d,f,b,a)},1)});ba("cells().indexes()",
"cell().index()",function(){return this.iterator("cell",function(a,d,f){return{row:d,column:f,columnVisible:n(a,f)}},1)});ba("cells().invalidate()","cell().invalidate()",function(a){return this.iterator("cell",function(d,f,b){F(d,f,a,b)})});R("cell()",function(a,d,f){return eb(this.cells(a,d,f))});R("cell().data()",function(a){var d=this.context,f=this[0];if(a===e)return d.length&&f.length?J(d[0],f[0].row,f[0].column):e;V(d[0],f[0].row,f[0].column,a);F(d[0],f[0].row,"data",f[0].column);return this});
R("order()",function(d,f){var b=this.context;if(d===e)return 0!==b.length?b[0].aaSorting:e;"number"===typeof d?d=[[d,f]]:d.length&&!a.isArray(d[0])&&(d=Array.prototype.slice.call(arguments));return this.iterator("table",function(a){a.aaSorting=d.slice()})});R("order.listener()",function(a,d,f){return this.iterator("table",function(b){Ra(b,a,d,f)})});R("order.fixed()",function(d){if(!d){var f=this.context;f=f.length?f[0].aaSortingFixed:e;return a.isArray(f)?{pre:f}:f}return this.iterator("table",function(f){f.aaSortingFixed=
a.extend(!0,{},d)})});R(["columns().order()","column().order()"],function(d){var f=this;return this.iterator("table",function(b,l){var c=[];a.each(f[l],function(a,f){c.push([f,d])});b.aaSorting=c})});R("search()",function(d,f,b,l){var c=this.context;return d===e?0!==c.length?c[0].oPreviousSearch.sSearch:e:this.iterator("table",function(c){c.oFeatures.bFilter&&oa(c,a.extend({},c.oPreviousSearch,{sSearch:d+"",bRegex:null===f?!1:f,bSmart:null===b?!0:b,bCaseInsensitive:null===l?!0:l}),1)})});ba("columns().search()",
"column().search()",function(d,f,b,l){return this.iterator("column",function(c,r){var t=c.aoPreSearchCols;if(d===e)return t[r].sSearch;c.oFeatures.bFilter&&(a.extend(t[r],{sSearch:d+"",bRegex:null===f?!1:f,bSmart:null===b?!0:b,bCaseInsensitive:null===l?!0:l}),oa(c,c.oPreviousSearch,1))})});R("state()",function(){return this.context.length?this.context[0].oSavedState:null});R("state.clear()",function(){return this.iterator("table",function(a){a.fnStateSaveCallback.call(a.oInstance,a,{})})});R("state.loaded()",
function(){return this.context.length?this.context[0].oLoadedState:null});R("state.save()",function(){return this.iterator("table",function(a){La(a)})});H.versionCheck=H.fnVersionCheck=function(a){var d=H.version.split(".");a=a.split(".");for(var f,b,l=0,c=a.length;l<c;l++)if(f=parseInt(d[l],10)||0,b=parseInt(a[l],10)||0,f!==b)return f>b;return!0};H.isDataTable=H.fnIsDataTable=function(d){var f=a(d).get(0),b=!1;if(d instanceof H.Api)return!0;a.each(H.settings,function(d,l){d=l.nScrollHead?a("table",
l.nScrollHead)[0]:null;var c=l.nScrollFoot?a("table",l.nScrollFoot)[0]:null;if(l.nTable===f||d===f||c===f)b=!0});return b};H.tables=H.fnTables=function(d){var f=!1;a.isPlainObject(d)&&(f=d.api,d=d.visible);var b=a.map(H.settings,function(f){if(!d||d&&a(f.nTable).is(":visible"))return f.nTable});return f?new W(b):b};H.camelToHungarian=h;R("$()",function(d,f){f=this.rows(f).nodes();f=a(f);return a([].concat(f.filter(d).toArray(),f.find(d).toArray()))});a.each(["on","one","off"],function(d,f){R(f+"()",
function(){var d=Array.prototype.slice.call(arguments);d[0]=a.map(d[0].split(/\s/),function(a){return a.match(/\.dt\b/)?a:a+".dt"}).join(" ");var b=a(this.tables().nodes());b[f].apply(b,d);return this})});R("clear()",function(){return this.iterator("table",function(a){T(a)})});R("settings()",function(){return new W(this.context,this.context)});R("init()",function(){var a=this.context;return a.length?a[0].oInit:null});R("data()",function(){return this.iterator("table",function(a){return ma(a.aoData,
"_aData")}).flatten()});R("destroy()",function(d){d=d||!1;return this.iterator("table",function(f){var b=f.nTableWrapper.parentNode,l=f.oClasses,c=f.nTable,r=f.nTBody,t=f.nTHead,e=f.nTFoot,g=a(c);r=a(r);var u=a(f.nTableWrapper),h=a.map(f.aoData,function(a){return a.nTr}),C;f.bDestroying=!0;Y(f,"aoDestroyCallback","destroy",[f]);d||(new W(f)).columns().visible(!0);u.off(".DT").find(":not(tbody *)").off(".DT");a(k).off(".DT-"+f.sInstance);c!=t.parentNode&&(g.children("thead").detach(),g.append(t));
e&&c!=e.parentNode&&(g.children("tfoot").detach(),g.append(e));f.aaSorting=[];f.aaSortingFixed=[];Ka(f);a(h).removeClass(f.asStripeClasses.join(" "));a("th, td",t).removeClass(l.sSortable+" "+l.sSortableAsc+" "+l.sSortableDesc+" "+l.sSortableNone);f.bJUI&&(a("th span."+l.sSortIcon+", td span."+l.sSortIcon,t).detach(),a("th, td",t).each(function(){var d=a("div."+l.sSortJUIWrapper,this);a(this).append(d.contents());d.detach()}));r.children().detach();r.append(h);t=d?"remove":"detach";g[t]();u[t]();
!d&&b&&(b.insertBefore(c,f.nTableReinsertBefore),g.css("width",f.sDestroyWidth).removeClass(l.sTable),(C=f.asDestroyStripes.length)&&r.children().each(function(d){a(this).addClass(f.asDestroyStripes[d%C])}));b=a.inArray(f,H.settings);-1!==b&&H.settings.splice(b,1)})});a.each(["column","row","cell"],function(a,d){R(d+"s().every()",function(a){var f=this.selector.opts,b=this;return this.iterator(d,function(l,c,r,t,g){a.call(b[d](c,"cell"===d?r:f,"cell"===d?f:e),c,r,t,g)})})});R("i18n()",function(d,
f,b){var l=this.context[0];d=P(d)(l.oLanguage);d===e&&(d=f);b!==e&&a.isPlainObject(d)&&(d=d[b]!==e?d[b]:d._);return d.replace("%d",b)});H.version="1.10.13";H.settings=[];H.models={};H.models.oSearch={bCaseInsensitive:!0,sSearch:"",bRegex:!1,bSmart:!0};H.models.oRow={nTr:null,anCells:null,_aData:[],_aSortData:null,_aFilterData:null,_sFilterRow:null,_sRowStripe:"",src:null,idx:-1};H.models.oColumn={idx:null,aDataSort:null,asSorting:null,bSearchable:null,bSortable:null,bVisible:null,_sManualType:null,
_bAttrSrc:!1,fnCreatedCell:null,fnGetData:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null};H.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:[],ajax:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],asStripeClasses:null,bAutoWidth:!0,bDeferRender:!1,bDestroy:!1,bFilter:!0,
bInfo:!0,bJQueryUI:!1,bLengthChange:!0,bPaginate:!0,bProcessing:!1,bRetrieve:!1,bScrollCollapse:!1,bServerSide:!1,bSort:!0,bSortMulti:!0,bSortCellsTop:!1,bSortClasses:!0,bStateSave:!1,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,this.oLanguage.sThousands)},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,fnRowCallback:null,fnServerData:null,fnServerParams:null,fnStateLoadCallback:function(a){try{return JSON.parse((-1===
a.iStateDuration?sessionStorage:localStorage).getItem("DataTables_"+a.sInstance+"_"+location.pathname))}catch(Vb){}},fnStateLoadParams:null,fnStateLoaded:null,fnStateSaveCallback:function(a,d){try{(-1===a.iStateDuration?sessionStorage:localStorage).setItem("DataTables_"+a.sInstance+"_"+location.pathname,JSON.stringify(d))}catch(Wb){}},fnStateSaveParams:null,iStateDuration:7200,iDeferLoading:null,iDisplayLength:10,iDisplayStart:0,iTabIndex:0,oClasses:{},oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",
sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sDecimal:"",sThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sSearchPlaceholder:"",sUrl:"",sZeroRecords:"No matching records found"},
oSearch:a.extend({},H.models.oSearch),sAjaxDataProp:"data",sAjaxSource:null,sDom:"lfrtip",searchDelay:null,sPaginationType:"simple_numbers",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET",renderer:null,rowId:"DT_RowId"};b(H.defaults);H.defaults.column={aDataSort:null,iDataSort:-1,asSorting:["asc","desc"],bSearchable:!0,bSortable:!0,bVisible:!0,fnCreatedCell:null,mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,
sType:null,sWidth:null};b(H.defaults.column);H.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortMulti:null,bSortClasses:null,bStateSave:null},oScroll:{bCollapse:null,iBarWidth:0,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:!1,bScrollbarLeft:!1,bBounding:!1,barWidth:0},ajax:null,aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],
aIds:{},aoColumns:[],aoHeader:[],aoFooter:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:[],asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,nTableWrapper:null,bDeferLoading:!1,bInitialised:!1,aoOpenRows:[],sDom:null,
searchDelay:null,sPaginationType:"two_button",iStateDuration:0,aoStateSave:[],aoStateLoad:[],oSavedState:null,oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:!0,jqXHR:null,json:e,oAjaxData:e,fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:!1,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iRecordsTotal:0,_iRecordsDisplay:0,bJUI:null,oClasses:{},bFiltered:!1,bSorted:!1,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],
fnRecordsTotal:function(){return"ssp"==ia(this)?1*this._iRecordsTotal:this.aiDisplayMaster.length},fnRecordsDisplay:function(){return"ssp"==ia(this)?1*this._iRecordsDisplay:this.aiDisplay.length},fnDisplayEnd:function(){var a=this._iDisplayLength,d=this._iDisplayStart,f=d+a,b=this.aiDisplay.length,l=this.oFeatures,c=l.bPaginate;return l.bServerSide?!1===c||-1===a?d+b:Math.min(d+a,this._iRecordsDisplay):!c||f>b||-1===a?b:f},oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null,
aLastSort:[],oPlugins:{},rowIdFn:null,rowId:null};H.ext=ea={buttons:{},classes:{},builder:"-source-",errMode:"alert",feature:[],search:[],selector:{cell:[],column:[],row:[]},internal:{},legacy:{ajax:null},pager:{},renderer:{pageButton:{},header:{}},order:{},type:{detect:[],search:{},order:{}},_unique:0,fnVersionCheck:H.fnVersionCheck,iApiIndex:0,oJUIClasses:{},sVersion:H.version};a.extend(ea,{afnFiltering:ea.search,aTypes:ea.type.detect,ofnSearch:ea.type.search,oSort:ea.type.order,afnSortData:ea.order,
aoFeatures:ea.feature,oApi:ea.internal,oStdClasses:ea.classes,oPagination:ea.pager});a.extend(H.ext.classes,{sTable:"dataTable",sNoFooter:"no-footer",sPageButton:"paginate_button",sPageButtonActive:"current",sPageButtonDisabled:"disabled",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",
sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sFilterInput:"",sLengthSelect:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sHeaderTH:"",sFooterTH:"",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",
sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sJUIHeader:"",sJUIFooter:""});a.extend(H.ext.oJUIClasses,H.ext.classes,{sPageButton:"fg-button ui-button ui-state-default",sPageButtonActive:"ui-state-disabled",sPageButtonDisabled:"ui-state-disabled",sPaging:"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_",sSortAsc:"ui-state-default sorting_asc",sSortDesc:"ui-state-default sorting_desc",sSortable:"ui-state-default sorting",sSortableAsc:"ui-state-default sorting_asc_disabled",
sSortableDesc:"ui-state-default sorting_desc_disabled",sSortableNone:"ui-state-default sorting_disabled",sSortJUIAsc:"css_right ui-icon ui-icon-triangle-1-n",sSortJUIDesc:"css_right ui-icon ui-icon-triangle-1-s",sSortJUI:"css_right ui-icon ui-icon-carat-2-n-s",sSortJUIAscAllowed:"css_right ui-icon ui-icon-carat-1-n",sSortJUIDescAllowed:"css_right ui-icon ui-icon-carat-1-s",sSortJUIWrapper:"DataTables_sort_wrapper",sSortIcon:"DataTables_sort_icon",sScrollHead:"dataTables_scrollHead ui-state-default",
sScrollFoot:"dataTables_scrollFoot ui-state-default",sHeaderTH:"ui-state-default",sFooterTH:"ui-state-default",sJUIHeader:"fg-toolbar ui-toolbar ui-widget-header ui-helper-clearfix ui-corner-tl ui-corner-tr",sJUIFooter:"fg-toolbar ui-toolbar ui-widget-header ui-helper-clearfix ui-corner-bl ui-corner-br"});var xb=H.ext.pager;a.extend(xb,{simple:function(a,d){return["previous","next"]},full:function(a,d){return["first","previous","next","last"]},numbers:function(a,d){return[Ca(a,d)]},simple_numbers:function(a,
d){return["previous",Ca(a,d),"next"]},full_numbers:function(a,d){return["first","previous",Ca(a,d),"next","last"]},first_last_numbers:function(a,d){return["first",Ca(a,d),"last"]},_numbers:Ca,numbers_length:7});a.extend(!0,H.ext.renderer,{pageButton:{_:function(d,f,b,l,r,t){var g=d.oClasses,u=d.oLanguage.oPaginate,h=d.oLanguage.oAria.paginate||{},C,n,m=0,p=function(f,l){var c,e=function(a){Xa(d,a.data.action,!0)};var L=0;for(c=l.length;L<c;L++){var k=l[L];if(a.isArray(k)){var q=a("<"+(k.DT_el||"div")+
"/>").appendTo(f);p(q,k)}else{C=null;n="";switch(k){case "ellipsis":f.append('<span class="ellipsis">&#x2026;</span>');break;case "first":C=u.sFirst;n=k+(0<r?"":" "+g.sPageButtonDisabled);break;case "previous":C=u.sPrevious;n=k+(0<r?"":" "+g.sPageButtonDisabled);break;case "next":C=u.sNext;n=k+(r<t-1?"":" "+g.sPageButtonDisabled);break;case "last":C=u.sLast;n=k+(r<t-1?"":" "+g.sPageButtonDisabled);break;default:C=k+1,n=r===k?g.sPageButtonActive:""}null!==C&&(q=a("<a>",{"class":g.sPageButton+" "+n,
"aria-controls":d.sTableId,"aria-label":h[k],"data-dt-idx":m,tabindex:d.iTabIndex,id:0===b&&"string"===typeof k?d.sTableId+"_"+k:null}).html(C).appendTo(f),Za(q,{action:k},e),m++)}}};try{var L=a(f).find(c.activeElement).data("dt-idx")}catch(Yb){}p(a(f).empty(),l);L!==e&&a(f).find("[data-dt-idx="+L+"]").focus()}}});a.extend(H.ext.type.detect,[function(a,d){d=d.oLanguage.sDecimal;return bb(a,d)?"num"+d:null},function(a,d){if(a&&!(a instanceof Date)&&!Lb.test(a))return null;d=Date.parse(a);return null!==
d&&!isNaN(d)||sa(a)?"date":null},function(a,d){d=d.oLanguage.sDecimal;return bb(a,d,!0)?"num-fmt"+d:null},function(a,d){d=d.oLanguage.sDecimal;return Cb(a,d)?"html-num"+d:null},function(a,d){d=d.oLanguage.sDecimal;return Cb(a,d,!0)?"html-num-fmt"+d:null},function(a,d){return sa(a)||"string"===typeof a&&-1!==a.indexOf("<")?"html":null}]);a.extend(H.ext.type.search,{html:function(a){return sa(a)?a:"string"===typeof a?a.replace(zb," ").replace(Oa,""):""},string:function(a){return sa(a)?a:"string"===
typeof a?a.replace(zb," "):a}});var Na=function(a,d,f,b){if(0!==a&&(!a||"-"===a))return-Infinity;d&&(a=Bb(a,d));a.replace&&(f&&(a=a.replace(f,"")),b&&(a=a.replace(b,"")));return 1*a};a.extend(ea.type.order,{"date-pre":function(a){return Date.parse(a)||-Infinity},"html-pre":function(a){return sa(a)?"":a.replace?a.replace(/<.*?>/g,"").toLowerCase():a+""},"string-pre":function(a){return sa(a)?"":"string"===typeof a?a.toLowerCase():a.toString?a.toString():""},"string-asc":function(a,d){return a<d?-1:
a>d?1:0},"string-desc":function(a,d){return a<d?1:a>d?-1:0}});gb("");a.extend(!0,H.ext.renderer,{header:{_:function(d,f,b,l){a(d.nTable).on("order.dt.DT",function(a,c,r,t){d===c&&(a=b.idx,f.removeClass(b.sSortingClass+" "+l.sSortAsc+" "+l.sSortDesc).addClass("asc"==t[a]?l.sSortAsc:"desc"==t[a]?l.sSortDesc:b.sSortingClass))})},jqueryui:function(d,f,b,l){a("<div/>").addClass(l.sSortJUIWrapper).append(f.contents()).append(a("<span/>").addClass(l.sSortIcon+" "+b.sSortingClassJUI)).appendTo(f);a(d.nTable).on("order.dt.DT",
function(a,c,r,t){d===c&&(a=b.idx,f.removeClass(l.sSortAsc+" "+l.sSortDesc).addClass("asc"==t[a]?l.sSortAsc:"desc"==t[a]?l.sSortDesc:b.sSortingClass),f.find("span."+l.sSortIcon).removeClass(l.sSortJUIAsc+" "+l.sSortJUIDesc+" "+l.sSortJUI+" "+l.sSortJUIAscAllowed+" "+l.sSortJUIDescAllowed).addClass("asc"==t[a]?l.sSortJUIAsc:"desc"==t[a]?l.sSortJUIDesc:b.sSortingClassJUI))})}}});var Ib=function(a){return"string"===typeof a?a.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):a};H.render=
{number:function(a,d,f,b,l){return{display:function(c){if("number"!==typeof c&&"string"!==typeof c)return c;var r=0>c?"-":"",t=parseFloat(c);if(isNaN(t))return Ib(c);t=t.toFixed(f);c=Math.abs(t);t=parseInt(c,10);c=f?d+(c-t).toFixed(f).substring(2):"";return r+(b||"")+t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,a)+c+(l||"")}}},text:function(){return{display:Ib}}};a.extend(H.ext.internal,{_fnExternApiFunc:yb,_fnBuildAjax:M,_fnAjaxUpdate:da,_fnAjaxParameters:aa,_fnAjaxUpdateDraw:pa,_fnAjaxDataSrc:la,
_fnAddColumn:q,_fnColumnOptions:A,_fnAdjustColumnSizing:y,_fnVisibleToColumnIndex:z,_fnColumnIndexToVisible:n,_fnVisbleColumns:w,_fnGetColumns:I,_fnColumnTypes:D,_fnApplyColumnDefs:K,_fnHungarianMap:b,_fnCamelToHungarian:h,_fnLanguageCompat:m,_fnBrowserDetect:x,_fnAddData:E,_fnAddTr:O,_fnNodeToDataIndex:function(a,d){return d._DT_RowIndex!==e?d._DT_RowIndex:null},_fnNodeToColumnIndex:function(d,f,b){return a.inArray(b,d.aoData[f].anCells)},_fnGetCellData:J,_fnSetCellData:V,_fnSplitObjNotation:N,_fnGetObjectDataFn:P,
_fnSetObjectDataFn:G,_fnGetDataMaster:Q,_fnClearTable:T,_fnDeleteIndex:U,_fnInvalidate:F,_fnGetRowElements:d,_fnCreateTr:f,_fnBuildHead:t,_fnDrawHead:C,_fnDraw:S,_fnReDraw:Z,_fnAddOptionsHtml:l,_fnDetectHeader:u,_fnGetUniqueThs:L,_fnFeatureHtmlFilter:jb,_fnFilterComplete:oa,_fnFilterCustom:xa,_fnFilterColumn:Ha,_fnFilter:Ga,_fnFilterCreateSearch:Ia,_fnEscapeRegex:Ua,_fnFilterData:Aa,_fnFeatureHtmlInfo:kb,_fnUpdateInfo:ob,_fnInfoMacros:pb,_fnInitialise:Ba,_fnInitComplete:Fa,_fnLengthChange:Va,_fnFeatureHtmlLength:ib,
_fnFeatureHtmlPaginate:lb,_fnPageChange:Xa,_fnFeatureHtmlProcessing:X,_fnProcessingDisplay:ha,_fnFeatureHtmlTable:ua,_fnScrollDraw:ta,_fnApplyToChildren:qa,_fnCalculateColumnWidths:Qa,_fnThrottle:Ta,_fnConvertToWidth:qb,_fnGetWidestNode:rb,_fnGetMaxLenString:sb,_fnStringToCss:ca,_fnSortFlatten:wa,_fnSort:hb,_fnSortAria:ub,_fnSortListener:Ya,_fnSortAttachListener:Ra,_fnSortingClasses:Ka,_fnSortData:tb,_fnSaveState:La,_fnLoadState:vb,_fnSettingsFromNode:Ma,_fnLog:ra,_fnMap:na,_fnBindAction:Za,_fnCallbackReg:ja,
_fnCallbackFire:Y,_fnLengthOverflow:Wa,_fnRenderer:Sa,_fnDataSource:ia,_fnRowAttributes:r,_fnCalculateEnd:function(){}});a.fn.dataTable=H;H.$=a;a.fn.dataTableSettings=H.settings;a.fn.dataTableExt=H.ext;a.fn.DataTable=function(d){return a(this).dataTable(d).api()};a.each(H,function(d,f){a.fn.DataTable[d]=f});return a.fn.dataTable});/*
 jQuery UI - v1.13.1 - 2022-01-20
 http://jqueryui.com
 Includes: widget.js, position.js, data.js, disable-selection.js, effect.js, effects/effect-blind.js, effects/effect-bounce.js, effects/effect-clip.js, effects/effect-drop.js, effects/effect-explode.js, effects/effect-fade.js, effects/effect-fold.js, effects/effect-highlight.js, effects/effect-puff.js, effects/effect-pulsate.js, effects/effect-scale.js, effects/effect-shake.js, effects/effect-size.js, effects/effect-slide.js, effects/effect-transfer.js, focusable.js, form-reset-mixin.js, jquery-patch.js, keycode.js, labels.js, scroll-parent.js, tabbable.js, unique-id.js, widgets/accordion.js, widgets/autocomplete.js, widgets/button.js, widgets/checkboxradio.js, widgets/controlgroup.js, widgets/datepicker.js, widgets/dialog.js, widgets/draggable.js, widgets/droppable.js, widgets/menu.js, widgets/mouse.js, widgets/progressbar.js, widgets/resizable.js, widgets/selectable.js, widgets/selectmenu.js, widgets/slider.js, widgets/sortable.js, widgets/spinner.js, widgets/tabs.js, widgets/tooltip.js
 Copyright jQuery Foundation and other contributors; Licensed MIT  jQuery UI Widget 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Position 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license

 http://api.jqueryui.com/position/
 jQuery UI :data 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Disable Selection 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery Color Animations v2.2.0
 https://github.com/jquery/jquery-color

 Copyright OpenJS Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license

 Date: Sun May 10 09:02:36 2020 +0200
 jQuery UI Effects 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Effects Blind 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Effects Bounce 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Effects Clip 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Effects Drop 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Effects Explode 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Effects Fade 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Effects Fold 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Effects Highlight 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Effects Size 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Effects Scale 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Effects Puff 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Effects Pulsate 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Effects Shake 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Effects Slide 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Effects Transfer 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Focusable 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Form Reset Mixin 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Support for jQuery core 1.8.x and newer 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license

 jQuery UI Keycode 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Labels 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Scroll Parent 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Tabbable 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Unique ID 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Accordion 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Menu 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Autocomplete 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Controlgroup 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Checkboxradio 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Button 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Datepicker 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Mouse 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Draggable 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Resizable 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Dialog 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Droppable 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Progressbar 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Selectable 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Selectmenu 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Slider 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Sortable 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Spinner 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Tabs 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
 jQuery UI Tooltip 1.13.1
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
*/
(function(a){"function"===typeof define&&define.amd?define(["jquery"],a):a(jQuery)})(function(a){function k(a){return null==a?a+"":"object"===typeof a?n[w.call(a)]||"object":typeof a}function c(a,f,b){var d=O[f.type]||{};if(null==a)return b||!f.def?null:f.def;a=d.floor?~~a:parseFloat(a);return isNaN(a)?f.def:d.mod?(a+d.mod)%d.mod:Math.min(d.max,Math.max(0,a))}function e(a){var d=K(),b=d._rgba=[];a=a.toLowerCase();N(D,function(f,c){f=(f=c.re.exec(a))&&c.parse(f);c=c.space||"rgba";if(f)return f=d[c](f),
d[E[c].cache]=f[E[c].cache],b=d._rgba=f._rgba,!1});return b.length?("0,0,0,0"===b.join()&&z.extend(b,P.transparent),d):P[a]}function b(a,f,b){b=(b+1)%1;return 1>6*b?a+(f-a)*b*6:1>2*b?f:2>3*b?a+(f-a)*(2/3-b)*6:a}function h(a){for(var d;a.length&&a[0]!==document;){d=a.css("position");if("absolute"===d||"relative"===d||"fixed"===d)if(d=parseInt(a.css("zIndex"),10),!isNaN(d)&&0!==d)return d;a=a.parent()}return 0}function m(){this._curInst=null;this._keyEvent=!1;this._disabledInputs=[];this._inDialog=
this._datepickerShowing=!1;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",
currentText:"Today",monthNames:"January February March April May June July August September October November December".split(" "),monthNamesShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),dayNames:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),dayNamesShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),dayNamesMin:"Su Mo Tu We Th Fr Sa".split(" "),weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:"",selectMonthLabel:"Select month",
selectYearLabel:"Select year"};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,
onClose:null,onUpdateDatepicker:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1};a.extend(this._defaults,this.regional[""]);this.regional.en=a.extend(!0,{},this.regional[""]);this.regional["en-US"]=a.extend(!0,{},this.regional.en);this.dpDiv=g(a("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function g(d){return d.on("mouseout",
"button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a",function(){a(this).removeClass("ui-state-hover");-1!==this.className.indexOf("ui-datepicker-prev")&&a(this).removeClass("ui-datepicker-prev-hover");-1!==this.className.indexOf("ui-datepicker-next")&&a(this).removeClass("ui-datepicker-next-hover")}).on("mouseover","button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a",v)}function v(){a.datepicker._isDisabledDatepicker(U.inline?U.dpDiv.parent()[0]:
U.input[0])||(a(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),a(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&a(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&a(this).addClass("ui-datepicker-next-hover"))}function x(d,f){a.extend(d,f);for(var b in f)null==f[b]&&(d[b]=f[b]);return d}function p(a){return function(){var d=this.element.val();a.apply(this,arguments);this._refresh();d!==
this.element.val()&&this._trigger("change")}}a.ui=a.ui||{};a.ui.version="1.13.1";var q=0,A=Array.prototype.hasOwnProperty,y=Array.prototype.slice;a.cleanData=function(d){return function(f){var b,c,e;for(e=0;null!=(c=f[e]);e++)(b=a._data(c,"events"))&&b.remove&&a(c).triggerHandler("remove");d(f)}}(a.cleanData);a.widget=function(d,f,b){var c={},r=d.split(".")[0];d=d.split(".")[1];var e=r+"-"+d;b||(b=f,f=a.Widget);Array.isArray(b)&&(b=a.extend.apply(null,[{}].concat(b)));a.expr.pseudos[e.toLowerCase()]=
function(d){return!!a.data(d,e)};a[r]=a[r]||{};var g=a[r][d];var l=a[r][d]=function(a,d){if(!this||!this._createWidget)return new l(a,d);arguments.length&&this._createWidget(a,d)};a.extend(l,g,{version:b.version,_proto:a.extend({},b),_childConstructors:[]});var u=new f;u.options=a.widget.extend({},u.options);a.each(b,function(a,d){c[a]="function"!==typeof d?d:function(){function b(){return f.prototype[a].apply(this,arguments)}function l(d){return f.prototype[a].apply(this,d)}return function(){var a=
this._super,f=this._superApply;this._super=b;this._superApply=l;var c=d.apply(this,arguments);this._super=a;this._superApply=f;return c}}()});l.prototype=a.widget.extend(u,{widgetEventPrefix:g?u.widgetEventPrefix||d:d},c,{constructor:l,namespace:r,widgetName:d,widgetFullName:e});g?(a.each(g._childConstructors,function(d,f){d=f.prototype;a.widget(d.namespace+"."+d.widgetName,l,f._proto)}),delete g._childConstructors):f._childConstructors.push(l);a.widget.bridge(d,l);return l};a.widget.extend=function(d){for(var f=
y.call(arguments,1),b=0,c=f.length,e,g;b<c;b++)for(e in f[b])g=f[b][e],A.call(f[b],e)&&void 0!==g&&(a.isPlainObject(g)?d[e]=a.isPlainObject(d[e])?a.widget.extend({},d[e],g):a.widget.extend({},g):d[e]=g);return d};a.widget.bridge=function(d,f){var b=f.prototype.widgetFullName||d;a.fn[d]=function(c){var r="string"===typeof c,t=y.call(arguments,1),e=this;r?this.length||"instance"!==c?this.each(function(){var f=a.data(this,b);if("instance"===c)return e=f,!1;if(!f)return a.error("cannot call methods on "+
d+" prior to initialization; attempted to call method '"+c+"'");if("function"!==typeof f[c]||"_"===c.charAt(0))return a.error("no such method '"+c+"' for "+d+" widget instance");var r=f[c].apply(f,t);if(r!==f&&void 0!==r)return e=r&&r.jquery?e.pushStack(r.get()):r,!1}):e=void 0:(t.length&&(c=a.widget.extend.apply(null,[c].concat(t))),this.each(function(){var d=a.data(this,b);d?(d.option(c||{}),d._init&&d._init()):a.data(this,b,new f(c,this))}));return e}};a.Widget=function(){};a.Widget._childConstructors=
[];a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(d,f){f=a(f||this.defaultElement||this)[0];this.element=a(f);this.uuid=q++;this.eventNamespace="."+this.widgetName+this.uuid;this.bindings=a();this.hoverable=a();this.focusable=a();this.classesElementLookup={};f!==this&&(a.data(f,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===f&&this.destroy()}}),this.document=
a(f.style?f.ownerDocument:f.document||f),this.window=a(this.document[0].defaultView||this.document[0].parentWindow));this.options=a.widget.extend({},this.options,this._getCreateOptions(),d);this._create();this.options.disabled&&this._setOptionDisabled(this.options.disabled);this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){var d=this;this._destroy();a.each(this.classesElementLookup,
function(a,b){d._removeClass(b,a)});this.element.off(this.eventNamespace).removeData(this.widgetFullName);this.widget().off(this.eventNamespace).removeAttr("aria-disabled");this.bindings.off(this.eventNamespace)},_destroy:a.noop,widget:function(){return this.element},option:function(d,f){var b=d,c;if(0===arguments.length)return a.widget.extend({},this.options);if("string"===typeof d){b={};var e=d.split(".");d=e.shift();if(e.length){var g=b[d]=a.widget.extend({},this.options[d]);for(c=0;c<e.length-
1;c++)g[e[c]]=g[e[c]]||{},g=g[e[c]];d=e.pop();if(1===arguments.length)return void 0===g[d]?null:g[d];g[d]=f}else{if(1===arguments.length)return void 0===this.options[d]?null:this.options[d];b[d]=f}}this._setOptions(b);return this},_setOptions:function(a){for(var d in a)this._setOption(d,a[d]);return this},_setOption:function(a,f){"classes"===a&&this._setOptionClasses(f);this.options[a]=f;"disabled"===a&&this._setOptionDisabled(f);return this},_setOptionClasses:function(d){var f;for(f in d){var b=
this.classesElementLookup[f];if(d[f]!==this.options.classes[f]&&b&&b.length){var c=a(b.get());this._removeClass(b,f);c.addClass(this._classes({element:c,keys:f,classes:d,add:!0}))}}},_setOptionDisabled:function(a){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!a);a&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},
_classes:function(d){function f(){var f=[];d.element.each(function(d,b){a.map(e.classesElementLookup,function(a){return a}).some(function(a){return a.is(b)})||f.push(b)});e._on(a(f),{remove:"_untrackClassesElement"})}function b(b,r){var l;for(l=0;l<b.length;l++){var t=e.classesElementLookup[b[l]]||a();d.add?(f(),t=a(a.uniqueSort(t.get().concat(d.element.get())))):t=a(t.not(d.element).get());e.classesElementLookup[b[l]]=t;c.push(b[l]);r&&d.classes[b[l]]&&c.push(d.classes[b[l]])}}var c=[],e=this;d=
a.extend({element:this.element,classes:this.options.classes||{}},d);d.keys&&b(d.keys.match(/\S+/g)||[],!0);d.extra&&b(d.extra.match(/\S+/g)||[]);return c.join(" ")},_untrackClassesElement:function(d){var f=this;a.each(f.classesElementLookup,function(b,c){-1!==a.inArray(d.target,c)&&(f.classesElementLookup[b]=a(c.not(d.target).get()))});this._off(a(d.target))},_removeClass:function(a,f,b){return this._toggleClass(a,f,b,!1)},_addClass:function(a,f,b){return this._toggleClass(a,f,b,!0)},_toggleClass:function(a,
f,b,c){c="boolean"===typeof c?c:b;var d="string"===typeof a||null===a;a={extra:d?f:b,keys:d?a:f,element:d?this.element:a,add:c};a.element.toggleClass(this._classes(a),c);return this},_on:function(d,f,b){var c,r=this;"boolean"!==typeof d&&(b=f,f=d,d=!1);b?(f=c=a(f),this.bindings=this.bindings.add(f)):(b=f,f=this.element,c=this.widget());a.each(b,function(b,t){function l(){if(d||!0!==r.options.disabled&&!a(this).hasClass("ui-state-disabled"))return("string"===typeof t?r[t]:t).apply(r,arguments)}"string"!==
typeof t&&(l.guid=t.guid=t.guid||l.guid||a.guid++);var e=b.match(/^([\w:-]*)\s*(.*)$/);b=e[1]+r.eventNamespace;if(e=e[2])c.on(b,e,l);else f.on(b,l)})},_off:function(d,f){f=(f||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;d.off(f);this.bindings=a(this.bindings.not(d).get());this.focusable=a(this.focusable.not(d).get());this.hoverable=a(this.hoverable.not(d).get())},_delay:function(a,f){var d=this;return setTimeout(function(){return("string"===typeof a?d[a]:a).apply(d,arguments)},
f||0)},_hoverable:function(d){this.hoverable=this.hoverable.add(d);this._on(d,{mouseenter:function(d){this._addClass(a(d.currentTarget),null,"ui-state-hover")},mouseleave:function(d){this._removeClass(a(d.currentTarget),null,"ui-state-hover")}})},_focusable:function(d){this.focusable=this.focusable.add(d);this._on(d,{focusin:function(d){this._addClass(a(d.currentTarget),null,"ui-state-focus")},focusout:function(d){this._removeClass(a(d.currentTarget),null,"ui-state-focus")}})},_trigger:function(d,
f,b){var c,r=this.options[d];b=b||{};f=a.Event(f);f.type=(d===this.widgetEventPrefix?d:this.widgetEventPrefix+d).toLowerCase();f.target=this.element[0];if(d=f.originalEvent)for(c in d)c in f||(f[c]=d[c]);this.element.trigger(f,b);return!("function"===typeof r&&!1===r.apply(this.element[0],[f].concat(b))||f.isDefaultPrevented())}};a.each({show:"fadeIn",hide:"fadeOut"},function(d,f){a.Widget.prototype["_"+d]=function(b,c,e){"string"===typeof c&&(c={effect:c});var r=c?!0===c||"number"===typeof c?f:c.effect||
f:d;c=c||{};"number"===typeof c?c={duration:c}:!0===c&&(c={});var t=!a.isEmptyObject(c);c.complete=e;c.delay&&b.delay(c.delay);if(t&&a.effects&&a.effects.effect[r])b[d](c);else if(r!==d&&b[r])b[r](c.duration,c.easing,e);else b.queue(function(f){a(this)[d]();e&&e.call(b[0]);f()})}});(function(){function d(a,d,f){return[parseFloat(a[0])*(n.test(a[0])?d/100:1),parseFloat(a[1])*(n.test(a[1])?f/100:1)]}function f(a){var d=a[0];return 9===d.nodeType?{width:a.width(),height:a.height(),offset:{top:0,left:0}}:
null!=d&&d===d.window?{width:a.width(),height:a.height(),offset:{top:a.scrollTop(),left:a.scrollLeft()}}:d.preventDefault?{width:0,height:0,offset:{top:d.pageY,left:d.pageX}}:{width:a.outerWidth(),height:a.outerHeight(),offset:a.offset()}}var b,c=Math.max,e=Math.abs,g=/left|center|right/,h=/top|center|bottom/,l=/[\+\-]\d+(\.[\d]+)?%?/,u=/^\w+/,n=/%$/,m=a.fn.position;a.position={scrollbarWidth:function(){if(void 0!==b)return b;var d=a("<div style='display:block;position:absolute;width:200px;height:200px;overflow:hidden;'><div style='height:300px;width:auto;'></div></div>");
var f=d.children()[0];a("body").append(d);var c=f.offsetWidth;d.css("overflow","scroll");f=f.offsetWidth;c===f&&(f=d[0].clientWidth);d.remove();return b=c-f},getScrollInfo:function(d){var f=d.isWindow||d.isDocument?"":d.element.css("overflow-x"),b=d.isWindow||d.isDocument?"":d.element.css("overflow-y");f="scroll"===f||"auto"===f&&d.width<d.element[0].scrollWidth;return{width:"scroll"===b||"auto"===b&&d.height<d.element[0].scrollHeight?a.position.scrollbarWidth():0,height:f?a.position.scrollbarWidth():
0}},getWithinInfo:function(d){var f=a(d||window);var b=f[0];b=null!=b&&b===b.window;var c=!!f[0]&&9===f[0].nodeType;return{element:f,isWindow:b,isDocument:c,offset:b||c?{left:0,top:0}:a(d).offset(),scrollLeft:f.scrollLeft(),scrollTop:f.scrollTop(),width:f.outerWidth(),height:f.outerHeight()}}};a.fn.position=function(b){if(!b||!b.of)return m.apply(this,arguments);b=a.extend({},b);var r="string"===typeof b.of?a(document).find(b.of):a(b.of),t=a.position.getWithinInfo(b.within),C=a.position.getScrollInfo(t),
n=(b.collision||"flip").split(" "),p={};var k=f(r);r[0].preventDefault&&(b.at="left top");var L=k.width;var q=k.height;var y=k.offset;var v=a.extend({},y);a.each(["my","at"],function(){var a=(b[this]||"").split(" ");1===a.length&&(a=g.test(a[0])?a.concat(["center"]):h.test(a[0])?["center"].concat(a):["center","center"]);a[0]=g.test(a[0])?a[0]:"center";a[1]=h.test(a[1])?a[1]:"center";var d=l.exec(a[0]);var f=l.exec(a[1]);p[this]=[d?d[0]:0,f?f[0]:0];b[this]=[u.exec(a[0])[0],u.exec(a[1])[0]]});1===n.length&&
(n[1]=n[0]);"right"===b.at[0]?v.left+=L:"center"===b.at[0]&&(v.left+=L/2);"bottom"===b.at[1]?v.top+=q:"center"===b.at[1]&&(v.top+=q/2);var S=d(p.at,L,q);v.left+=S[0];v.top+=S[1];return this.each(function(){var f,l=a(this),g=l.outerWidth(),u=l.outerHeight(),h=parseInt(a.css(this,"marginLeft"),10)||0,m=parseInt(a.css(this,"marginTop"),10)||0,k=g+h+(parseInt(a.css(this,"marginRight"),10)||0)+C.width,z=u+m+(parseInt(a.css(this,"marginBottom"),10)||0)+C.height,M=a.extend({},v),x=d(p.my,l.outerWidth(),
l.outerHeight());"right"===b.my[0]?M.left-=g:"center"===b.my[0]&&(M.left-=g/2);"bottom"===b.my[1]?M.top-=u:"center"===b.my[1]&&(M.top-=u/2);M.left+=x[0];M.top+=x[1];var Z={marginLeft:h,marginTop:m};a.each(["left","top"],function(d,f){if(a.ui.position[n[d]])a.ui.position[n[d]][f](M,{targetWidth:L,targetHeight:q,elemWidth:g,elemHeight:u,collisionPosition:Z,collisionWidth:k,collisionHeight:z,offset:[S[0]+x[0],S[1]+x[1]],my:b.my,at:b.at,within:t,elem:l})});b.using&&(f=function(a){var d=y.left-M.left,
f=d+L-g,t=y.top-M.top,h=t+q-u,C={target:{element:r,left:y.left,top:y.top,width:L,height:q},element:{element:l,left:M.left,top:M.top,width:g,height:u},horizontal:0>f?"left":0<d?"right":"center",vertical:0>h?"top":0<t?"bottom":"middle"};L<g&&e(d+f)<L&&(C.horizontal="center");q<u&&e(t+h)<q&&(C.vertical="middle");c(e(d),e(f))>c(e(t),e(h))?C.important="horizontal":C.important="vertical";b.using.call(this,a,C)});l.offset(a.extend(M,{using:f}))})};a.ui.position={fit:{left:function(a,d){var f=d.within,b=
f.isWindow?f.scrollLeft:f.offset.left,l=f.width,r=a.left-d.collisionPosition.marginLeft;f=b-r;var t=r+d.collisionWidth-l-b;d.collisionWidth>l?0<f&&0>=t?(d=a.left+f+d.collisionWidth-l-b,a.left+=f-d):a.left=0<t&&0>=f?b:f>t?b+l-d.collisionWidth:b:a.left=0<f?a.left+f:0<t?a.left-t:c(a.left-r,a.left)},top:function(a,d){var f=d.within,b=f.isWindow?f.scrollTop:f.offset.top,l=d.within.height,r=a.top-d.collisionPosition.marginTop;f=b-r;var t=r+d.collisionHeight-l-b;d.collisionHeight>l?0<f&&0>=t?(d=a.top+f+
d.collisionHeight-l-b,a.top+=f-d):a.top=0<t&&0>=f?b:f>t?b+l-d.collisionHeight:b:a.top=0<f?a.top+f:0<t?a.top-t:c(a.top-r,a.top)}},flip:{left:function(a,d){var f=d.within,b=f.offset.left+f.scrollLeft,c=f.width,l=f.isWindow?f.scrollLeft:f.offset.left,r=a.left-d.collisionPosition.marginLeft;f=r-l;var t=r+d.collisionWidth-c-l;r="left"===d.my[0]?-d.elemWidth:"right"===d.my[0]?d.elemWidth:0;var g="left"===d.at[0]?d.targetWidth:"right"===d.at[0]?-d.targetWidth:0,u=-2*d.offset[0];if(0>f){if(d=a.left+r+g+u+
d.collisionWidth-c-b,0>d||d<e(f))a.left+=r+g+u}else 0<t&&(d=a.left-d.collisionPosition.marginLeft+r+g+u-l,0<d||e(d)<t)&&(a.left+=r+g+u)},top:function(a,d){var f=d.within,b=f.offset.top+f.scrollTop,c=f.height,l=f.isWindow?f.scrollTop:f.offset.top,r=a.top-d.collisionPosition.marginTop;f=r-l;var t=r+d.collisionHeight-c-l;r="top"===d.my[1]?-d.elemHeight:"bottom"===d.my[1]?d.elemHeight:0;var g="top"===d.at[1]?d.targetHeight:"bottom"===d.at[1]?-d.targetHeight:0,u=-2*d.offset[1];if(0>f){if(d=a.top+r+g+u+
d.collisionHeight-c-b,0>d||d<e(f))a.top+=r+g+u}else 0<t&&(d=a.top-d.collisionPosition.marginTop+r+g+u-l,0<d||e(d)<t)&&(a.top+=r+g+u)}},flipfit:{left:function(){a.ui.position.flip.left.apply(this,arguments);a.ui.position.fit.left.apply(this,arguments)},top:function(){a.ui.position.flip.top.apply(this,arguments);a.ui.position.fit.top.apply(this,arguments)}}}})();a.extend(a.expr.pseudos,{data:a.expr.createPseudo?a.expr.createPseudo(function(d){return function(f){return!!a.data(f,d)}}):function(d,f,b){return!!a.data(d,
b[3])}});a.fn.extend({disableSelection:function(){var a="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.on(a+".ui-disableSelection",function(a){a.preventDefault()})}}(),enableSelection:function(){return this.off(".ui-disableSelection")}});var z=a,n={},w=n.toString,I=/^([\-+])=\s*(\d+\.?\d*)/,D=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,
parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],a[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})?/,parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16),a[4]?(parseInt(a[4],16)/255).toFixed(2):1]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])([a-f0-9])?/,parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16),a[4]?(parseInt(a[4]+a[4],16)/255).toFixed(2):1]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,
space:"hsla",parse:function(a){return[a[1],a[2]/100,a[3]/100,a[4]]}}],K=z.Color=function(a,f,b,c){return new z.Color.fn.parse(a,f,b,c)},E={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},O={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},J=K.support={},V=z("<p>")[0],N=z.each;V.style.cssText="background-color:rgba(1,1,1,.5)";J.rgba=
-1<V.style.backgroundColor.indexOf("rgba");N(E,function(a,f){f.cache="_"+a;f.props.alpha={idx:3,type:"percent",def:1}});z.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(a,f){n["[object "+f+"]"]=f.toLowerCase()});K.fn=z.extend(K.prototype,{parse:function(a,f,b,t){if(void 0===a)return this._rgba=[null,null,null,null],this;if(a.jquery||a.nodeType)a=z(a).css(f),f=void 0;var d=this,r=k(a),g=this._rgba=[];void 0!==f&&(a=[a,f,b,t],r="array");if("string"===
r)return this.parse(e(a)||P._default);if("array"===r)return N(E.rgba.props,function(d,f){g[f.idx]=c(a[f.idx],f)}),this;if("object"===r)return a instanceof K?N(E,function(f,b){a[b.cache]&&(d[b.cache]=a[b.cache].slice())}):N(E,function(f,b){var l=b.cache;N(b.props,function(f,r){if(!d[l]&&b.to){if("alpha"===f||null==a[f])return;d[l]=b.to(d._rgba)}d[l][r.idx]=c(a[f],r,!0)});d[l]&&0>z.inArray(null,d[l].slice(0,3))&&(null==d[l][3]&&(d[l][3]=1),b.from&&(d._rgba=b.from(d[l])))}),this},is:function(a){var d=
K(a),b=!0,c=this;N(E,function(a,f){var r=d[f.cache];if(r){var l=c[f.cache]||f.to&&f.to(c._rgba)||[];N(f.props,function(a,d){if(null!=r[d.idx])return b=r[d.idx]===l[d.idx]})}return b});return b},_space:function(){var a=[],f=this;N(E,function(d,b){f[b.cache]&&a.push(d)});return a.pop()},transition:function(a,f){var d=K(a);a=d._space();var b=E[a],e=0===this.alpha()?K("transparent"):this,g=e[b.cache]||b.to(e._rgba),h=g.slice();d=d[b.cache];N(b.props,function(a,b){a=b.idx;var l=g[a],r=d[a],t=O[b.type]||
{};null!==r&&(null===l?h[a]=r:(t.mod&&(r-l>t.mod/2?l+=t.mod:l-r>t.mod/2&&(l-=t.mod)),h[a]=c((r-l)*f+l,b)))});return this[a](h)},blend:function(a){if(1===this._rgba[3])return this;var d=this._rgba.slice(),b=d.pop(),c=K(a)._rgba;return K(z.map(d,function(a,d){return(1-b)*c[d]+b*a}))},toRgbaString:function(){var a="rgba(",f=z.map(this._rgba,function(a,d){return null!=a?a:2<d?1:0});1===f[3]&&(f.pop(),a="rgb(");return a+f.join()+")"},toHslaString:function(){var a="hsla(",f=z.map(this.hsla(),function(a,
d){null==a&&(a=2<d?1:0);d&&3>d&&(a=Math.round(100*a)+"%");return a});1===f[3]&&(f.pop(),a="hsl(");return a+f.join()+")"},toHexString:function(a){var d=this._rgba.slice(),b=d.pop();a&&d.push(~~(255*b));return"#"+z.map(d,function(a){a=(a||0).toString(16);return 1===a.length?"0"+a:a}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}});K.fn.parse.prototype=K.fn;E.hsla.to=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var d=a[0]/255,
b=a[1]/255,c=a[2]/255;a=a[3];var e=Math.max(d,b,c),g=Math.min(d,b,c),h=e-g,l=e+g,u=.5*l;return[Math.round(g===e?0:d===e?60*(b-c)/h+360:b===e?60*(c-d)/h+120:60*(d-b)/h+240)%360,0===h?0:.5>=u?h/l:h/(2-l),u,null==a?1:a]};E.hsla.from=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var d=a[0]/360,c=a[1],t=a[2];a=a[3];c=.5>=t?t*(1+c):t+c-t*c;t=2*t-c;return[Math.round(255*b(t,c,d+1/3)),Math.round(255*b(t,c,d)),Math.round(255*b(t,c,d-1/3)),a]};N(E,function(a,f){var d=f.props,
b=f.cache,e=f.to,g=f.from;K.fn[a]=function(a){e&&!this[b]&&(this[b]=e(this._rgba));if(void 0===a)return this[b].slice();var f=k(a),r="array"===f||"object"===f?a:arguments,t=this[b].slice();N(d,function(a,d){a=r["object"===f?a:d.idx];null==a&&(a=t[d.idx]);t[d.idx]=c(a,d)});if(g){var h=K(g(t));h[b]=t;return h}return K(t)};N(d,function(d,f){K.fn[d]||(K.fn[d]=function(b){var c=k(b);var l="alpha"===d?this._hsla?"hsla":"rgba":a;var r=this[l]();var t=r[f.idx];if("undefined"===c)return t;"function"===c&&
(b=b.call(this,t),c=k(b));if(null==b&&f.empty)return this;"string"===c&&(c=I.exec(b))&&(b=t+parseFloat(c[2])*("+"===c[1]?1:-1));r[f.idx]=b;return this[l](r)})})});K.hook=function(a){a=a.split(" ");N(a,function(a,d){z.cssHooks[d]={set:function(a,f){var b,c="";if("transparent"!==f&&("string"!==k(f)||(b=e(f)))){f=K(b||f);if(!J.rgba&&1!==f._rgba[3]){for(b="backgroundColor"===d?a.parentNode:a;(""===c||"transparent"===c)&&b&&b.style;)try{c=z.css(b,"backgroundColor"),b=b.parentNode}catch(l){}f=f.blend(c&&
"transparent"!==c?c:"_default")}f=f.toRgbaString()}try{a.style[d]=f}catch(l){}}};z.fx.step[d]=function(a){a.colorInit||(a.start=K(a.elem,d),a.end=K(a.end),a.colorInit=!0);z.cssHooks[d].set(a.elem,a.start.transition(a.end,a.pos))}})};K.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor");z.cssHooks.borderColor={expand:function(a){var d={};N(["Top","Right","Bottom","Left"],function(f,b){d["border"+
b+"Color"]=a});return d}};var P=z.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"};a.effects={effect:{}};(function(){function d(a){return a.replace(/-([\da-z])/gi,function(a,d){return d.toUpperCase()})}function f(a){var f=a.ownerDocument.defaultView?
a.ownerDocument.defaultView.getComputedStyle(a,null):a.currentStyle,b={};if(f&&f.length&&f[0]&&f[f[0]])for(a=f.length;a--;){var c=f[a];"string"===typeof f[c]&&(b[d(c)]=f[c])}else for(c in f)"string"===typeof f[c]&&(b[c]=f[c]);return b}var b=["add","remove","toggle"],c={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};a.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(d,f){a.fx.step[f]=function(a){if("none"!==
a.end&&!a.setAttr||1===a.pos&&!a.setAttr)z.style(a.elem,f,a.end),a.setAttr=!0}});a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))});a.effects.animateClass=function(d,r,e,l){var t=a.speed(r,e,l);return this.queue(function(){var l=a(this),r=l.attr("class")||"",e=t.children?l.find("*").addBack():l;e=e.map(function(){return{el:a(this),start:f(this)}});var g=function(){a.each(b,function(a,f){if(d[f])l[f+"Class"](d[f])})};g();e=e.map(function(){this.end=
f(this.el[0]);var d=this.start,b=this.end,l={},r;for(r in b){var e=b[r];d[r]===e||c[r]||!a.fx.step[r]&&isNaN(parseFloat(e))||(l[r]=e)}this.diff=l;return this});l.attr("class",r);e=e.map(function(){var d=this,f=a.Deferred(),b=a.extend({},t,{queue:!1,complete:function(){f.resolve(d)}});this.el.animate(this.diff,b);return f.promise()});a.when.apply(a,e.get()).done(function(){g();a.each(arguments,function(){var d=this.el;a.each(this.diff,function(a){d.css(a,"")})});t.complete.call(l[0])})})};a.fn.extend({addClass:function(d){return function(f,
b,c,r){return b?a.effects.animateClass.call(this,{add:f},b,c,r):d.apply(this,arguments)}}(a.fn.addClass),removeClass:function(d){return function(f,b,c,r){return 1<arguments.length?a.effects.animateClass.call(this,{remove:f},b,c,r):d.apply(this,arguments)}}(a.fn.removeClass),toggleClass:function(d){return function(f,b,c,r,e){return"boolean"===typeof b||void 0===b?c?a.effects.animateClass.call(this,b?{add:f}:{remove:f},c,r,e):d.apply(this,arguments):a.effects.animateClass.call(this,{toggle:f},b,c,r)}}(a.fn.toggleClass),
switchClass:function(d,f,b,c,r){return a.effects.animateClass.call(this,{add:f,remove:d},b,c,r)}})})();(function(){function d(d,f,b,c){a.isPlainObject(d)&&(f=d,d=d.effect);d={effect:d};null==f&&(f={});"function"===typeof f&&(c=f,b=null,f={});if("number"===typeof f||a.fx.speeds[f])c=b,b=f,f={};"function"===typeof b&&(c=b,b=null);f&&a.extend(d,f);b=b||f.duration;d.duration=a.fx.off?0:"number"===typeof b?b:b in a.fx.speeds?a.fx.speeds[b]:a.fx.speeds._default;d.complete=c||f.complete;return d}function f(d){return!d||
"number"===typeof d||a.fx.speeds[d]||"string"===typeof d&&!a.effects.effect[d]||"function"===typeof d||"object"===typeof d&&!d.effect?!0:!1}function b(a,d){var f=d.outerWidth();d=d.outerHeight();a=/^rect\((-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto)\)$/.exec(a)||["",0,f,d,0];return{top:parseFloat(a[1])||0,right:"auto"===a[2]?f:parseFloat(a[2]),bottom:"auto"===a[3]?d:parseFloat(a[3]),left:parseFloat(a[4])||0}}a.expr&&a.expr.pseudos&&
a.expr.pseudos.animated&&(a.expr.pseudos.animated=function(d){return function(f){return!!a(f).data("ui-effects-animated")||d(f)}}(a.expr.pseudos.animated));!1!==a.uiBackCompat&&a.extend(a.effects,{save:function(a,d){for(var f=0,b=d.length;f<b;f++)null!==d[f]&&a.data("ui-effects-"+d[f],a[0].style[d[f]])},restore:function(a,d){for(var f,b=0,c=d.length;b<c;b++)null!==d[b]&&(f=a.data("ui-effects-"+d[b]),a.css(d[b],f))},setMode:function(a,d){"toggle"===d&&(d=a.is(":hidden")?"show":"hide");return d},createWrapper:function(d){if(d.parent().is(".ui-effects-wrapper"))return d.parent();
var f={width:d.outerWidth(!0),height:d.outerHeight(!0),"float":d.css("float")},b=a("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),c={width:d.width(),height:d.height()},l=document.activeElement;try{l.id}catch(u){l=document.body}d.wrap(b);(d[0]===l||a.contains(d[0],l))&&a(l).trigger("focus");b=d.parent();"static"===d.css("position")?(b.css({position:"relative"}),d.css({position:"relative"})):(a.extend(f,{position:d.css("position"),
zIndex:d.css("z-index")}),a.each(["top","left","bottom","right"],function(a,b){f[b]=d.css(b);isNaN(parseInt(f[b],10))&&(f[b]="auto")}),d.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"}));d.css(c);return b.css(f).show()},removeWrapper:function(d){var f=document.activeElement;d.parent().is(".ui-effects-wrapper")&&(d.parent().replaceWith(d),(d[0]===f||a.contains(d[0],f))&&a(f).trigger("focus"));return d}});a.extend(a.effects,{version:"1.13.1",define:function(d,f,b){b||(b=f,f="effect");
a.effects.effect[d]=b;a.effects.effect[d].mode=f;return b},scaledDimensions:function(a,d,f){if(0===d)return{height:0,width:0,outerHeight:0,outerWidth:0};var b="horizontal"!==f?(d||100)/100:1;d="vertical"!==f?(d||100)/100:1;return{height:a.height()*d,width:a.width()*b,outerHeight:a.outerHeight()*d,outerWidth:a.outerWidth()*b}},clipToBox:function(a){return{width:a.clip.right-a.clip.left,height:a.clip.bottom-a.clip.top,left:a.clip.left,top:a.clip.top}},unshift:function(a,d,f){var b=a.queue();1<d&&b.splice.apply(b,
[1,0].concat(b.splice(d,f)));a.dequeue()},saveStyle:function(a){a.data("ui-effects-style",a[0].style.cssText)},restoreStyle:function(a){a[0].style.cssText=a.data("ui-effects-style")||"";a.removeData("ui-effects-style")},mode:function(a,d){a=a.is(":hidden");"toggle"===d&&(d=a?"show":"hide");if(a?"hide"===d:"show"===d)d="none";return d},getBaseline:function(a,d){switch(a[0]){case "top":var f=0;break;case "middle":f=.5;break;case "bottom":f=1;break;default:f=a[0]/d.height}switch(a[1]){case "left":a=
0;break;case "center":a=.5;break;case "right":a=1;break;default:a=a[1]/d.width}return{x:a,y:f}},createPlaceholder:function(d){var f=d.css("position"),b=d.position();d.css({marginTop:d.css("marginTop"),marginBottom:d.css("marginBottom"),marginLeft:d.css("marginLeft"),marginRight:d.css("marginRight")}).outerWidth(d.outerWidth()).outerHeight(d.outerHeight());if(/^(static|relative)/.test(f)){f="absolute";var c=a("<"+d[0].nodeName+">").insertAfter(d).css({display:/^(inline|ruby)/.test(d.css("display"))?
"inline-block":"block",visibility:"hidden",marginTop:d.css("marginTop"),marginBottom:d.css("marginBottom"),marginLeft:d.css("marginLeft"),marginRight:d.css("marginRight"),"float":d.css("float")}).outerWidth(d.outerWidth()).outerHeight(d.outerHeight()).addClass("ui-effects-placeholder");d.data("ui-effects-placeholder",c)}d.css({position:f,left:b.left,top:b.top});return c},removePlaceholder:function(a){var d=a.data("ui-effects-placeholder");d&&(d.remove(),a.removeData("ui-effects-placeholder"))},cleanUp:function(d){a.effects.restoreStyle(d);
a.effects.removePlaceholder(d)},setTransition:function(d,f,b,c){c=c||{};a.each(f,function(a,f){a=d.cssUnit(f);0<a[0]&&(c[f]=a[0]*b+a[1])});return c}});a.fn.extend({effect:function(){function f(d){function f(){e.removeData("ui-effects-animated");a.effects.cleanUp(e);"hide"===b.mode&&e.hide();l()}function l(){"function"===typeof g&&g.call(e[0]);"function"===typeof d&&d()}var e=a(this);b.mode=n.shift();!1===a.uiBackCompat||r?"none"===b.mode?(e[h](),l()):c.call(e[0],b,f):(e.is(":hidden")?"hide"===h:"show"===
h)?(e[h](),l()):c.call(e[0],b,l)}var b=d.apply(this,arguments),c=a.effects.effect[b.effect],r=c.mode,l=b.queue,e=l||"fx",g=b.complete,h=b.mode,n=[],m=function(d){var f=a(this),b=a.effects.mode(f,h)||r;f.data("ui-effects-animated",!0);n.push(b);r&&("show"===b||b===r&&"hide"===b)&&f.show();r&&"none"===b||a.effects.saveStyle(f);"function"===typeof d&&d()};return a.fx.off||!c?h?this[h](b.duration,g):this.each(function(){g&&g.call(this)}):!1===l?this.each(m).each(f):this.queue(e,m).queue(e,f)},show:function(a){return function(b){if(f(b))return a.apply(this,
arguments);var c=d.apply(this,arguments);c.mode="show";return this.effect.call(this,c)}}(a.fn.show),hide:function(a){return function(b){if(f(b))return a.apply(this,arguments);var c=d.apply(this,arguments);c.mode="hide";return this.effect.call(this,c)}}(a.fn.hide),toggle:function(a){return function(b){if(f(b)||"boolean"===typeof b)return a.apply(this,arguments);var c=d.apply(this,arguments);c.mode="toggle";return this.effect.call(this,c)}}(a.fn.toggle),cssUnit:function(d){var f=this.css(d),b=[];a.each(["em",
"px","%","pt"],function(a,d){0<f.indexOf(d)&&(b=[parseFloat(f),d])});return b},cssClip:function(a){return a?this.css("clip","rect("+a.top+"px "+a.right+"px "+a.bottom+"px "+a.left+"px)"):b(this.css("clip"),this)},transfer:function(d,f){var b=a(this),c=a(d.to),l="fixed"===c.css("position"),r=a("body"),e=l?r.scrollTop():0;r=l?r.scrollLeft():0;var g=c.offset();c={top:g.top-e,left:g.left-r,height:c.innerHeight(),width:c.innerWidth()};g=b.offset();var t=a("<div class='ui-effects-transfer'></div>");t.appendTo("body").addClass(d.className).css({top:g.top-
e,left:g.left-r,height:b.innerHeight(),width:b.innerWidth(),position:l?"fixed":"absolute"}).animate(c,d.duration,d.easing,function(){t.remove();"function"===typeof f&&f()})}});a.fx.step.clip=function(d){d.clipInit||(d.start=a(d.elem).cssClip(),"string"===typeof d.end&&(d.end=b(d.end,d.elem)),d.clipInit=!0);a(d.elem).cssClip({top:d.pos*(d.end.top-d.start.top)+d.start.top,right:d.pos*(d.end.right-d.start.right)+d.start.right,bottom:d.pos*(d.end.bottom-d.start.bottom)+d.start.bottom,left:d.pos*(d.end.left-
d.start.left)+d.start.left})}})();(function(){var d={};a.each(["Quad","Cubic","Quart","Quint","Expo"],function(a,b){d[b]=function(d){return Math.pow(d,a+2)}});a.extend(d,{Sine:function(a){return 1-Math.cos(a*Math.PI/2)},Circ:function(a){return 1-Math.sqrt(1-a*a)},Elastic:function(a){return 0===a||1===a?a:-Math.pow(2,8*(a-1))*Math.sin((80*(a-1)-7.5)*Math.PI/15)},Back:function(a){return a*a*(3*a-2)},Bounce:function(a){for(var d,f=4;a<((d=Math.pow(2,--f))-1)/11;);return 1/Math.pow(4,3-f)-7.5625*Math.pow((3*
d-2)/22-a,2)}});a.each(d,function(d,b){a.easing["easeIn"+d]=b;a.easing["easeOut"+d]=function(a){return 1-b(1-a)};a.easing["easeInOut"+d]=function(a){return.5>a?b(2*a)/2:1-b(-2*a+2)/2}})})();a.effects.define("blind","hide",function(d,f){var b={up:["bottom","top"],vertical:["bottom","top"],down:["top","bottom"],left:["right","left"],horizontal:["right","left"],right:["left","right"]},c=a(this),e=d.direction||"up",g=c.cssClip(),h={clip:a.extend({},g)},l=a.effects.createPlaceholder(c);h.clip[b[e][0]]=
h.clip[b[e][1]];"show"===d.mode&&(c.cssClip(h.clip),l&&l.css(a.effects.clipToBox(h)),h.clip=g);l&&l.animate(a.effects.clipToBox(h),d.duration,d.easing);c.animate(h,{queue:!1,duration:d.duration,easing:d.easing,complete:f})});a.effects.define("bounce",function(d,f){var b=a(this),c=d.mode,e="hide"===c;var g="show"===c;var h=d.direction||"up";c=d.distance;var l=d.times||5,u=2*l+(g||e?1:0),n=d.duration/u;d=d.easing;var m="up"===h||"down"===h?"top":"left";h="up"===h||"left"===h;var p=0,k=b.queue().length;
a.effects.createPlaceholder(b);var q=b.css(m);c||(c=b["top"===m?"outerHeight":"outerWidth"]()/3);g&&(g={opacity:1},g[m]=q,b.css("opacity",0).css(m,h?2*-c:2*c).animate(g,n,d));e&&(c/=Math.pow(2,l-1));g={};for(g[m]=q;p<l;p++)q={},q[m]=(h?"-=":"+=")+c,b.animate(q,n,d).animate(g,n,d),c=e?2*c:c/2;e&&(q={opacity:0},q[m]=(h?"-=":"+=")+c,b.animate(q,n,d));b.queue(f);a.effects.unshift(b,k,u+1)});a.effects.define("clip","hide",function(d,f){var b={},c=a(this);var e=d.direction||"vertical";var g="both"===e,
h=g||"horizontal"===e;g=g||"vertical"===e;e=c.cssClip();b.clip={top:g?(e.bottom-e.top)/2:e.top,right:h?(e.right-e.left)/2:e.right,bottom:g?(e.bottom-e.top)/2:e.bottom,left:h?(e.right-e.left)/2:e.left};a.effects.createPlaceholder(c);"show"===d.mode&&(c.cssClip(b.clip),b.clip=e);c.animate(b,{queue:!1,duration:d.duration,easing:d.easing,complete:f})});a.effects.define("drop","hide",function(d,f){var b=a(this),c="show"===d.mode;var e=d.direction||"left";var g="up"===e||"down"===e?"top":"left",h="up"===
e||"left"===e?"-=":"+=",l="+="===h?"-=":"+=",u={opacity:0};a.effects.createPlaceholder(b);e=d.distance||b["top"===g?"outerHeight":"outerWidth"](!0)/2;u[g]=h+e;c&&(b.css(u),u[g]=l+e,u.opacity=1);b.animate(u,{queue:!1,duration:d.duration,easing:d.easing,complete:f})});a.effects.define("explode","hide",function(d,f){function b(){k.push(this);k.length===g*h&&(l.css({visibility:"visible"}),a(k).remove(),f())}var c,e,g=d.pieces?Math.round(Math.sqrt(d.pieces)):3,h=g,l=a(this),u="show"===d.mode,n=l.show().css("visibility",
"hidden").offset(),m=Math.ceil(l.outerWidth()/h),p=Math.ceil(l.outerHeight()/g),k=[];for(c=0;c<g;c++){var q=n.top+c*p;var v=c-(g-1)/2;for(e=0;e<h;e++){var y=n.left+e*m;var z=e-(h-1)/2;l.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-e*m,top:-c*p}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:m,height:p,left:y+(u?z*m:0),top:q+(u?v*p:0),opacity:u?0:1}).animate({left:y+(u?0:z*m),top:q+(u?0:v*p),opacity:u?1:
0},d.duration||500,d.easing,b)}}});a.effects.define("fade","toggle",function(d,f){var b="show"===d.mode;a(this).css("opacity",b?0:1).animate({opacity:b?1:0},{queue:!1,duration:d.duration,easing:d.easing,complete:f})});a.effects.define("fold","hide",function(d,f){var b=a(this),c=d.mode,e="show"===c;c="hide"===c;var g=d.size||15,h=/([0-9]+)%/.exec(g),l=d.horizFirst?["right","bottom"]:["bottom","right"],u=d.duration/2,n=a.effects.createPlaceholder(b),m=b.cssClip(),p={clip:a.extend({},m)},k={clip:a.extend({},
m)},q=[m[l[0]],m[l[1]]],v=b.queue().length;h&&(g=parseInt(h[1],10)/100*q[c?0:1]);p.clip[l[0]]=g;k.clip[l[0]]=g;k.clip[l[1]]=0;e&&(b.cssClip(k.clip),n&&n.css(a.effects.clipToBox(k)),k.clip=m);b.queue(function(f){n&&n.animate(a.effects.clipToBox(p),u,d.easing).animate(a.effects.clipToBox(k),u,d.easing);f()}).animate(p,u,d.easing).animate(k,u,d.easing).queue(f);a.effects.unshift(b,v,4)});a.effects.define("highlight","show",function(d,f){var b=a(this),c={backgroundColor:b.css("backgroundColor")};"hide"===
d.mode&&(c.opacity=0);a.effects.saveStyle(b);b.css({backgroundImage:"none",backgroundColor:d.color||"#ffff99"}).animate(c,{queue:!1,duration:d.duration,easing:d.easing,complete:f})});a.effects.define("size",function(d,f){var b=a(this),c=["fontSize"],e=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],g=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"];var h=d.mode;var l="effect"!==h,u=d.scale||"both";var n=d.origin||["middle","center"];var m=b.css("position"),p=
b.position(),k=a.effects.scaledDimensions(b),q=d.from||k,v=d.to||a.effects.scaledDimensions(b,0);a.effects.createPlaceholder(b);"show"===h&&(h=q,q=v,v=h);var y=q.height/k.height;var z=q.width/k.width;var x=v.height/k.height;var w=v.width/k.width;if("box"===u||"both"===u)y!==x&&(q=a.effects.setTransition(b,e,y,q),v=a.effects.setTransition(b,e,x,v)),z!==w&&(q=a.effects.setTransition(b,g,z,q),v=a.effects.setTransition(b,g,w,v));"content"!==u&&"both"!==u||y===x||(q=a.effects.setTransition(b,c,y,q),v=
a.effects.setTransition(b,c,x,v));n&&(n=a.effects.getBaseline(n,k),q.top=(k.outerHeight-q.outerHeight)*n.y+p.top,q.left=(k.outerWidth-q.outerWidth)*n.x+p.left,v.top=(k.outerHeight-v.outerHeight)*n.y+p.top,v.left=(k.outerWidth-v.outerWidth)*n.x+p.left);delete q.outerHeight;delete q.outerWidth;b.css(q);if("content"===u||"both"===u)e=e.concat(["marginTop","marginBottom"]).concat(c),g=g.concat(["marginLeft","marginRight"]),b.find("*[width]").each(function(){var f=a(this),b=a.effects.scaledDimensions(f),
c={height:b.height*y,width:b.width*z,outerHeight:b.outerHeight*y,outerWidth:b.outerWidth*z};b={height:b.height*x,width:b.width*w,outerHeight:b.height*x,outerWidth:b.width*w};y!==x&&(c=a.effects.setTransition(f,e,y,c),b=a.effects.setTransition(f,e,x,b));z!==w&&(c=a.effects.setTransition(f,g,z,c),b=a.effects.setTransition(f,g,w,b));l&&a.effects.saveStyle(f);f.css(c);f.animate(b,d.duration,d.easing,function(){l&&a.effects.restoreStyle(f)})});b.animate(v,{queue:!1,duration:d.duration,easing:d.easing,
complete:function(){var d=b.offset();0===v.opacity&&b.css("opacity",q.opacity);l||(b.css("position","static"===m?"relative":m).offset(d),a.effects.saveStyle(b));f()}})});a.effects.define("scale",function(d,f){var b=a(this),c=d.mode;c=parseInt(d.percent,10)||(0===parseInt(d.percent,10)?0:"effect"!==c?0:100);b=a.extend(!0,{from:a.effects.scaledDimensions(b),to:a.effects.scaledDimensions(b,c,d.direction||"both"),origin:d.origin||["middle","center"]},d);d.fade&&(b.from.opacity=1,b.to.opacity=0);a.effects.effect.size.call(this,
b,f)});a.effects.define("puff","hide",function(d,f){d=a.extend(!0,{},d,{fade:!0,percent:parseInt(d.percent,10)||150});a.effects.effect.scale.call(this,d,f)});a.effects.define("pulsate","show",function(d,f){var b=a(this),c=d.mode,e="show"===c;c=2*(d.times||5)+(e||"hide"===c?1:0);var g=d.duration/c,h=0,l=1,u=b.queue().length;if(e||!b.is(":visible"))b.css("opacity",0).show(),h=1;for(;l<c;l++)b.animate({opacity:h},g,d.easing),h=1-h;b.animate({opacity:h},g,d.easing);b.queue(f);a.effects.unshift(b,u,c+
1)});a.effects.define("shake",function(d,f){var b=1,c=a(this),e=d.direction||"left",g=d.distance||20,h=d.times||3,l=2*h+1,u=Math.round(d.duration/l),n="up"===e||"down"===e?"top":"left";e="up"===e||"left"===e;var m={},p={},k={},q=c.queue().length;a.effects.createPlaceholder(c);m[n]=(e?"-=":"+=")+g;p[n]=(e?"+=":"-=")+2*g;k[n]=(e?"-=":"+=")+2*g;for(c.animate(m,u,d.easing);b<h;b++)c.animate(p,u,d.easing).animate(k,u,d.easing);c.animate(p,u,d.easing).animate(m,u/2,d.easing).queue(f);a.effects.unshift(c,
q,l+1)});a.effects.define("slide","show",function(d,f){var b=a(this),c={up:["bottom","top"],down:["top","bottom"],left:["right","left"],right:["left","right"]},e=d.mode,g=d.direction||"left",h="up"===g||"down"===g?"top":"left",l="up"===g||"left"===g,u=d.distance||b["top"===h?"outerHeight":"outerWidth"](!0),n={};a.effects.createPlaceholder(b);var m=b.cssClip();var p=b.position()[h];n[h]=(l?-1:1)*u+p;n.clip=b.cssClip();n.clip[c[g][1]]=n.clip[c[g][0]];"show"===e&&(b.cssClip(n.clip),b.css(h,n[h]),n.clip=
m,n[h]=p);b.animate(n,{queue:!1,duration:d.duration,easing:d.easing,complete:f})});!1!==a.uiBackCompat&&a.effects.define("transfer",function(d,f){a(this).transfer(d,f)});a.ui.focusable=function(d,f){var b=d.nodeName.toLowerCase();if("area"===b){f=d.parentNode;b=f.name;if(!d.href||!b||"map"!==f.nodeName.toLowerCase())return!1;d=a("img[usemap='#"+b+"']");return 0<d.length&&d.is(":visible")}/^(input|select|textarea|button|object)$/.test(b)?(f=!d.disabled)&&(b=a(d).closest("fieldset")[0])&&(f=!b.disabled):
f="a"===b?d.href||f:f;if(f=f&&a(d).is(":visible")){d=a(d);for(f=d.css("visibility");"inherit"===f;)d=d.parent(),f=d.css("visibility");f="visible"===f}return f};a.extend(a.expr.pseudos,{focusable:function(d){return a.ui.focusable(d,null!=a.attr(d,"tabindex"))}});a.fn._form=function(){return"string"===typeof this[0].form?this.closest("form"):a(this[0].form)};a.ui.formResetMixin={_formResetHandler:function(){var d=a(this);setTimeout(function(){var f=d.data("ui-form-reset-instances");a.each(f,function(){this.refresh()})})},
_bindFormResetHandler:function(){this.form=this.element._form();if(this.form.length){var a=this.form.data("ui-form-reset-instances")||[];if(!a.length)this.form.on("reset.ui-form-reset",this._formResetHandler);a.push(this);this.form.data("ui-form-reset-instances",a)}},_unbindFormResetHandler:function(){if(this.form.length){var d=this.form.data("ui-form-reset-instances");d.splice(a.inArray(this,d),1);d.length?this.form.data("ui-form-reset-instances",d):this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset")}}};
a.expr.pseudos||(a.expr.pseudos=a.expr[":"]);a.uniqueSort||(a.uniqueSort=a.unique);if(!a.escapeSelector){var G=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g,Q=function(a,f){return f?"\x00"===a?"\ufffd":a.slice(0,-1)+"\\"+a.charCodeAt(a.length-1).toString(16)+" ":"\\"+a};a.escapeSelector=function(a){return(a+"").replace(G,Q)}}a.fn.even&&a.fn.odd||a.fn.extend({even:function(){return this.filter(function(a){return 0===a%2})},odd:function(){return this.filter(function(a){return 1===a%2})}});a.ui.keyCode=
{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38};a.fn.labels=function(){var d;if(!this.length)return this.pushStack([]);if(this[0].labels&&this[0].labels.length)return this.pushStack(this[0].labels);var f=this.eq(0).parents("label");if(d=this.attr("id")){var b=this.eq(0).parents().last();b=b.add(b.length?b.siblings():this.siblings());d="label[for='"+a.escapeSelector(d)+"']";f=f.add(b.find(d).addBack(d))}return this.pushStack(f)};
a.fn.scrollParent=function(d){var f=this.css("position"),b="absolute"===f,c=d?/(auto|scroll|hidden)/:/(auto|scroll)/;d=this.parents().filter(function(){var d=a(this);return b&&"static"===d.css("position")?!1:c.test(d.css("overflow")+d.css("overflow-y")+d.css("overflow-x"))}).eq(0);return"fixed"!==f&&d.length?d:a(this[0].ownerDocument||document)};a.extend(a.expr.pseudos,{tabbable:function(d){var f=a.attr(d,"tabindex"),b=null!=f;return(!b||0<=f)&&a.ui.focusable(d,b)}});a.fn.extend({uniqueId:function(){var a=
0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++a)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&a(this).removeAttr("id")})}});a.widget("ui.accordion",{version:"1.13.1",options:{active:0,animate:{},classes:{"ui-accordion-header":"ui-corner-top","ui-accordion-header-collapsed":"ui-corner-all","ui-accordion-content":"ui-corner-bottom"},collapsible:!1,event:"click",header:function(a){return a.find("> li > :first-child").add(a.find("> :not(li)").even())},
heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var d=this.options;this.prevShow=this.prevHide=a();this._addClass("ui-accordion","ui-widget ui-helper-reset");this.element.attr("role",
"tablist");d.collapsible||!1!==d.active&&null!=d.active||(d.active=0);this._processPanels();0>d.active&&(d.active+=this.headers.length);this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():a()}},_createIcons:function(){var d=this.options.icons;if(d){var f=a("<span>");this._addClass(f,"ui-accordion-header-icon","ui-icon "+d.header);f.prependTo(this.headers);f=this.active.children(".ui-accordion-header-icon");this._removeClass(f,d.header)._addClass(f,
null,d.activeHeader)._addClass(this.headers,"ui-accordion-icons")}},_destroyIcons:function(){this._removeClass(this.headers,"ui-accordion-icons");this.headers.children(".ui-accordion-header-icon").remove()},_destroy:function(){this.element.removeAttr("role");this.headers.removeAttr("role aria-expanded aria-selected aria-controls tabIndex").removeUniqueId();this._destroyIcons();var a=this.headers.next().css("display","").removeAttr("role aria-hidden aria-labelledby").removeUniqueId();"content"!==this.options.heightStyle&&
a.css("height","")},_setOption:function(a,f){"active"===a?this._activate(f):("event"===a&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(f)),this._super(a,f),"collapsible"!==a||f||!1!==this.options.active||this._activate(0),"icons"===a&&(this._destroyIcons(),f&&this._createIcons()))},_setOptionDisabled:function(a){this._super(a);this.element.attr("aria-disabled",a);this._toggleClass(null,"ui-state-disabled",!!a);this._toggleClass(this.headers.add(this.headers.next()),
null,"ui-state-disabled",!!a)},_keydown:function(d){if(!d.altKey&&!d.ctrlKey){var f=a.ui.keyCode,b=this.headers.length,c=this.headers.index(d.target),e=!1;switch(d.keyCode){case f.RIGHT:case f.DOWN:e=this.headers[(c+1)%b];break;case f.LEFT:case f.UP:e=this.headers[(c-1+b)%b];break;case f.SPACE:case f.ENTER:this._eventHandler(d);break;case f.HOME:e=this.headers[0];break;case f.END:e=this.headers[b-1]}e&&(a(d.target).attr("tabIndex",-1),a(e).attr("tabIndex",0),a(e).trigger("focus"),d.preventDefault())}},
_panelKeyDown:function(d){d.keyCode===a.ui.keyCode.UP&&d.ctrlKey&&a(d.currentTarget).prev().trigger("focus")},refresh:function(){var d=this.options;this._processPanels();!1===d.active&&!0===d.collapsible||!this.headers.length?(d.active=!1,this.active=a()):!1===d.active?this._activate(0):this.active.length&&!a.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(d.active=!1,this.active=a()):this._activate(Math.max(0,d.active-1)):d.active=this.headers.index(this.active);
this._destroyIcons();this._refresh()},_processPanels:function(){var a=this.headers,f=this.panels;this.headers="function"===typeof this.options.header?this.options.header(this.element):this.element.find(this.options.header);this._addClass(this.headers,"ui-accordion-header ui-accordion-header-collapsed","ui-state-default");this.panels=this.headers.next().filter(":not(.ui-accordion-content-active)").hide();this._addClass(this.panels,"ui-accordion-content","ui-helper-reset ui-widget-content");f&&(this._off(a.not(this.headers)),
this._off(f.not(this.panels)))},_refresh:function(){var d=this.options,f=d.heightStyle,b=this.element.parent();this.active=this._findActive(d.active);this._addClass(this.active,"ui-accordion-header-active","ui-state-active")._removeClass(this.active,"ui-accordion-header-collapsed");this._addClass(this.active.next(),"ui-accordion-content-active");this.active.next().show();this.headers.attr("role","tab").each(function(){var d=a(this),f=d.uniqueId().attr("id"),b=d.next(),c=b.uniqueId().attr("id");d.attr("aria-controls",
c);b.attr("aria-labelledby",f)}).next().attr("role","tabpanel");this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide();this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0);this._createIcons();this._setupEvents(d.event);if("fill"===f){var c=b.height();this.element.siblings(":visible").each(function(){var d=
a(this),f=d.css("position");"absolute"!==f&&"fixed"!==f&&(c-=d.outerHeight(!0))});this.headers.each(function(){c-=a(this).outerHeight(!0)});this.headers.next().each(function(){a(this).height(Math.max(0,c-a(this).innerHeight()+a(this).height()))}).css("overflow","auto")}else"auto"===f&&(c=0,this.headers.next().each(function(){var d=a(this).is(":visible");d||a(this).show();c=Math.max(c,a(this).css("height","").height());d||a(this).hide()}).height(c))},_activate:function(d){d=this._findActive(d)[0];
d!==this.active[0]&&(d=d||this.active[0],this._eventHandler({target:d,currentTarget:d,preventDefault:a.noop}))},_findActive:function(d){return"number"===typeof d?this.headers.eq(d):a()},_setupEvents:function(d){var f={keydown:"_keydown"};d&&a.each(d.split(" "),function(a,d){f[d]="_eventHandler"});this._off(this.headers.add(this.headers.next()));this._on(this.headers,f);this._on(this.headers.next(),{keydown:"_panelKeyDown"});this._hoverable(this.headers);this._focusable(this.headers)},_eventHandler:function(d){var f,
b=this.options,c=this.active,e=a(d.currentTarget),g=(f=e[0]===c[0])&&b.collapsible,h=g?a():e.next(),l=c.next();h={oldHeader:c,oldPanel:l,newHeader:g?a():e,newPanel:h};d.preventDefault();f&&!b.collapsible||!1===this._trigger("beforeActivate",d,h)||(b.active=g?!1:this.headers.index(e),this.active=f?a():e,this._toggle(h),this._removeClass(c,"ui-accordion-header-active","ui-state-active"),b.icons&&(d=c.children(".ui-accordion-header-icon"),this._removeClass(d,null,b.icons.activeHeader)._addClass(d,null,
b.icons.header)),f||(this._removeClass(e,"ui-accordion-header-collapsed")._addClass(e,"ui-accordion-header-active","ui-state-active"),b.icons&&(f=e.children(".ui-accordion-header-icon"),this._removeClass(f,null,b.icons.header)._addClass(f,null,b.icons.activeHeader)),this._addClass(e.next(),"ui-accordion-content-active")))},_toggle:function(d){var f=d.newPanel,b=this.prevShow.length?this.prevShow:d.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0);this.prevShow=f;this.prevHide=b;this.options.animate?
this._animate(f,b,d):(b.hide(),f.show(),this._toggleComplete(d));b.attr({"aria-hidden":"true"});b.prev().attr({"aria-selected":"false","aria-expanded":"false"});f.length&&b.length?b.prev().attr({tabIndex:-1,"aria-expanded":"false"}):f.length&&this.headers.filter(function(){return 0===parseInt(a(this).attr("tabIndex"),10)}).attr("tabIndex",-1);f.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(a,f,b){var d,c,e=this,r=0,l=a.css("box-sizing"),
g=a.length&&(!f.length||a.index()<f.index()),h=this.options.animate||{};g=g&&h.down||h;var n=function(){e._toggleComplete(b)};"number"===typeof g&&(c=g);"string"===typeof g&&(d=g);d=d||g.easing||h.easing;c=c||g.duration||h.duration;if(!f.length)return a.animate(this.showProps,c,d,n);if(!a.length)return f.animate(this.hideProps,c,d,n);var m=a.show().outerHeight();f.animate(this.hideProps,{duration:c,easing:d,step:function(a,d){d.now=Math.round(a)}});a.hide().animate(this.showProps,{duration:c,easing:d,
complete:n,step:function(a,d){d.now=Math.round(a);"height"!==d.prop?"content-box"===l&&(r+=d.now):"content"!==e.options.heightStyle&&(d.now=Math.round(m-f.outerHeight()-r),r=0)}})},_toggleComplete:function(a){var d=a.oldPanel,b=d.prev();this._removeClass(d,"ui-accordion-content-active");this._removeClass(b,"ui-accordion-header-active")._addClass(b,"ui-accordion-header-collapsed");d.length&&(d.parent()[0].className=d.parent()[0].className);this._trigger("activate",null,a)}});a.ui.safeActiveElement=
function(a){try{var d=a.activeElement}catch(r){d=a.body}d||(d=a.body);d.nodeName||(d=a.body);return d};a.widget("ui.menu",{version:"1.13.1",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element;this.mouseHandled=!1;this.lastMousePosition={x:null,y:null};this.element.uniqueId().attr({role:this.options.role,tabIndex:0});this._addClass("ui-menu",
"ui-widget ui-widget-content");this._on({"mousedown .ui-menu-item":function(a){a.preventDefault();this._activateItem(a)},"click .ui-menu-item":function(d){var f=a(d.target),b=a(a.ui.safeActiveElement(this.document[0]));!this.mouseHandled&&f.not(".ui-state-disabled").length&&(this.select(d),d.isPropagationStopped()||(this.mouseHandled=!0),f.has(".ui-menu").length?this.expand(d):!this.element.is(":focus")&&b.closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&
clearTimeout(this.timer)))},"mouseenter .ui-menu-item":"_activateItem","mousemove .ui-menu-item":"_activateItem",mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(a,f){var d=this.active||this._menuItems().first();f||this.focus(a,d)},blur:function(d){this._delay(function(){a.contains(this.element[0],a.ui.safeActiveElement(this.document[0]))||this.collapseAll(d)})},keydown:"_keydown"});this.refresh();this._on(this.document,{click:function(a){this._closeOnDocumentClick(a)&&
this.collapseAll(a,!0);this.mouseHandled=!1}})},_activateItem:function(d){if(!this.previousFilter&&(d.clientX!==this.lastMousePosition.x||d.clientY!==this.lastMousePosition.y)){this.lastMousePosition={x:d.clientX,y:d.clientY};var f=a(d.target).closest(".ui-menu-item"),b=a(d.currentTarget);f[0]!==b[0]||b.is(".ui-state-active")||(this._removeClass(b.siblings().children(".ui-state-active"),null,"ui-state-active"),this.focus(d,b))}},_destroy:function(){var d=this.element.find(".ui-menu-item").removeAttr("role aria-disabled").children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");
this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show();d.children().each(function(){var d=a(this);d.data("ui-menu-submenu-caret")&&d.remove()})},_keydown:function(d){var f=!0;switch(d.keyCode){case a.ui.keyCode.PAGE_UP:this.previousPage(d);break;case a.ui.keyCode.PAGE_DOWN:this.nextPage(d);break;case a.ui.keyCode.HOME:this._move("first","first",d);break;case a.ui.keyCode.END:this._move("last",
"last",d);break;case a.ui.keyCode.UP:this.previous(d);break;case a.ui.keyCode.DOWN:this.next(d);break;case a.ui.keyCode.LEFT:this.collapse(d);break;case a.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(d);break;case a.ui.keyCode.ENTER:case a.ui.keyCode.SPACE:this._activate(d);break;case a.ui.keyCode.ESCAPE:this.collapse(d);break;default:f=!1;var b=this.previousFilter||"";var c=!1;var e=96<=d.keyCode&&105>=d.keyCode?(d.keyCode-96).toString():String.fromCharCode(d.keyCode);
clearTimeout(this.filterTimer);e===b?c=!0:e=b+e;b=this._filterMenuItems(e);b=c&&-1!==b.index(this.active.next())?this.active.nextAll(".ui-menu-item"):b;b.length||(e=String.fromCharCode(d.keyCode),b=this._filterMenuItems(e));b.length?(this.focus(d,b),this.previousFilter=e,this.filterTimer=this._delay(function(){delete this.previousFilter},1E3)):delete this.previousFilter}f&&d.preventDefault()},_activate:function(a){this.active&&!this.active.is(".ui-state-disabled")&&(this.active.children("[aria-haspopup='true']").length?
this.expand(a):this.select(a))},refresh:function(){var d=this,f=this.options.icons.submenu;var b=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length);var c=b.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var b=a(this),c=b.prev(),l=a("<span>").data("ui-menu-submenu-caret",!0);d._addClass(l,"ui-menu-icon","ui-icon "+f);c.attr("aria-haspopup","true").prepend(l);
b.attr("aria-labelledby",c.attr("id"))});this._addClass(c,"ui-menu","ui-widget ui-widget-content ui-front");c=b.add(this.element).find(this.options.items);c.not(".ui-menu-item").each(function(){var f=a(this);d._isDivider(f)&&d._addClass(f,"ui-menu-divider","ui-widget-content")});b=c.not(".ui-menu-item, .ui-menu-divider");var e=b.children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()});this._addClass(b,"ui-menu-item")._addClass(e,"ui-menu-item-wrapper");c.filter(".ui-state-disabled").attr("aria-disabled",
"true");this.active&&!a.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(a,f){if("icons"===a){var d=this.element.find(".ui-menu-icon");this._removeClass(d,null,this.options.icons.submenu)._addClass(d,null,f.submenu)}this._super(a,f)},_setOptionDisabled:function(a){this._super(a);this.element.attr("aria-disabled",String(a));this._toggleClass(null,"ui-state-disabled",!!a)},focus:function(a,f){this.blur(a,
a&&"focus"===a.type);this._scrollIntoView(f);this.active=f.first();var d=this.active.children(".ui-menu-item-wrapper");this._addClass(d,null,"ui-state-active");this.options.role&&this.element.attr("aria-activedescendant",d.attr("id"));d=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper");this._addClass(d,null,"ui-state-active");a&&"keydown"===a.type?this._close():this.timer=this._delay(function(){this._close()},this.delay);d=f.children(".ui-menu");d.length&&a&&/^mouse/.test(a.type)&&
this._startOpening(d);this.activeMenu=f.parent();this._trigger("focus",a,{item:f})},_scrollIntoView:function(d){if(this._hasScroll()){var f=parseFloat(a.css(this.activeMenu[0],"borderTopWidth"))||0;var b=parseFloat(a.css(this.activeMenu[0],"paddingTop"))||0;f=d.offset().top-this.activeMenu.offset().top-f-b;b=this.activeMenu.scrollTop();var c=this.activeMenu.height();d=d.outerHeight();0>f?this.activeMenu.scrollTop(b+f):f+d>c&&this.activeMenu.scrollTop(b+f-c+d)}},blur:function(a,f){f||clearTimeout(this.timer);
this.active&&(this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active"),this._trigger("blur",a,{item:this.active}),this.active=null)},_startOpening:function(a){clearTimeout(this.timer);"true"===a.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close();this._open(a)},this.delay))},_open:function(d){var f=a.extend({of:this.active},this.options.position);clearTimeout(this.timer);this.element.find(".ui-menu").not(d.parents(".ui-menu")).hide().attr("aria-hidden",
"true");d.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(f)},collapseAll:function(d,f){clearTimeout(this.timer);this.timer=this._delay(function(){var b=f?this.element:a(d&&d.target).closest(this.element.find(".ui-menu"));b.length||(b=this.element);this._close(b);this.blur(d);this._removeClass(b.find(".ui-state-active"),null,"ui-state-active");this.activeMenu=b},f?0:this.delay)},_close:function(a){a||(a=this.active?this.active.parent():this.element);a.find(".ui-menu").hide().attr("aria-hidden",
"true").attr("aria-expanded","false")},_closeOnDocumentClick:function(d){return!a(d.target).closest(".ui-menu").length},_isDivider:function(a){return!/[^\-\u2014\u2013\s]/.test(a.text())},collapse:function(a){var d=this.active&&this.active.parent().closest(".ui-menu-item",this.element);d&&d.length&&(this._close(),this.focus(a,d))},expand:function(a){var d=this.active&&this._menuItems(this.active.children(".ui-menu")).first();d&&d.length&&(this._open(d.parent()),this._delay(function(){this.focus(a,
d)}))},next:function(a){this._move("next","first",a)},previous:function(a){this._move("prev","last",a)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_menuItems:function(a){return(a||this.element).find(this.options.items).filter(".ui-menu-item")},_move:function(a,f,b){var d;this.active&&(d="first"===a||"last"===a?this.active["first"===a?"prevAll":"nextAll"](".ui-menu-item").last():
this.active[a+"All"](".ui-menu-item").first());d&&d.length&&this.active||(d=this._menuItems(this.activeMenu)[f]());this.focus(b,d)},nextPage:function(d){var f;if(!this.active)this.next(d);else if(!this.isLastItem())if(this._hasScroll()){var b=this.active.offset().top;var c=this.element.innerHeight();0===a.fn.jquery.indexOf("3.2.")&&(c+=this.element[0].offsetHeight-this.element.outerHeight());this.active.nextAll(".ui-menu-item").each(function(){f=a(this);return 0>f.offset().top-b-c});this.focus(d,
f)}else this.focus(d,this._menuItems(this.activeMenu)[this.active?"last":"first"]())},previousPage:function(d){var f;if(!this.active)this.next(d);else if(!this.isFirstItem())if(this._hasScroll()){var b=this.active.offset().top;var c=this.element.innerHeight();0===a.fn.jquery.indexOf("3.2.")&&(c+=this.element[0].offsetHeight-this.element.outerHeight());this.active.prevAll(".ui-menu-item").each(function(){f=a(this);return 0<f.offset().top-b+c});this.focus(d,f)}else this.focus(d,this._menuItems(this.activeMenu).first())},
_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(d){this.active=this.active||a(d.target).closest(".ui-menu-item");var f={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(d,!0);this._trigger("select",d,f)},_filterMenuItems:function(d){d=d.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");var f=new RegExp("^"+d,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return f.test(String.prototype.trim.call(a(this).children(".ui-menu-item-wrapper").text()))})}});
a.widget("ui.autocomplete",{version:"1.13.1",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,liveRegionTimer:null,_create:function(){var d,f,b,c=this.element[0].nodeName.toLowerCase(),e="textarea"===c;c="input"===c;this.isMultiLine=e||!c&&this._isContentEditable(this.element);this.valueMethod=
this.element[e||c?"val":"text"];this.isNewMenu=!0;this._addClass("ui-autocomplete-input");this.element.attr("autocomplete","off");this._on(this.element,{keydown:function(c){if(this.element.prop("readOnly"))f=b=d=!0;else{f=b=d=!1;var e=a.ui.keyCode;switch(c.keyCode){case e.PAGE_UP:d=!0;this._move("previousPage",c);break;case e.PAGE_DOWN:d=!0;this._move("nextPage",c);break;case e.UP:d=!0;this._keyEvent("previous",c);break;case e.DOWN:d=!0;this._keyEvent("next",c);break;case e.ENTER:this.menu.active&&
(d=!0,c.preventDefault(),this.menu.select(c));break;case e.TAB:this.menu.active&&this.menu.select(c);break;case e.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(c),c.preventDefault());break;default:f=!0,this._searchTimeout(c)}}},keypress:function(b){if(d)d=!1,this.isMultiLine&&!this.menu.element.is(":visible")||b.preventDefault();else if(!f){var c=a.ui.keyCode;switch(b.keyCode){case c.PAGE_UP:this._move("previousPage",b);break;case c.PAGE_DOWN:this._move("nextPage",
b);break;case c.UP:this._keyEvent("previous",b);break;case c.DOWN:this._keyEvent("next",b)}}},input:function(a){b?(b=!1,a.preventDefault()):this._searchTimeout(a)},focus:function(){this.selectedItem=null;this.previous=this._value()},blur:function(a){clearTimeout(this.searching);this.close(a);this._change(a)}});this._initSource();this.menu=a("<ul>").appendTo(this._appendTo()).menu({role:null}).hide().attr({unselectable:"on"}).menu("instance");this._addClass(this.menu.element,"ui-autocomplete","ui-front");
this._on(this.menu.element,{mousedown:function(a){a.preventDefault()},menufocus:function(d,f){var b;if(this.isNewMenu&&(this.isNewMenu=!1,d.originalEvent&&/^mouse/.test(d.originalEvent.type))){this.menu.blur();this.document.one("mousemove",function(){a(d.target).trigger(d.originalEvent)});return}var c=f.item.data("ui-autocomplete-item");!1!==this._trigger("focus",d,{item:c})&&d.originalEvent&&/^key/.test(d.originalEvent.type)&&this._value(c.value);(b=f.item.attr("aria-label")||c.value)&&String.prototype.trim.call(b).length&&
(clearTimeout(this.liveRegionTimer),this.liveRegionTimer=this._delay(function(){this.liveRegion.html(a("<div>").text(b))},100))},menuselect:function(d,f){var b=f.item.data("ui-autocomplete-item"),c=this.previous;this.element[0]!==a.ui.safeActiveElement(this.document[0])&&(this.element.trigger("focus"),this.previous=c,this._delay(function(){this.previous=c;this.selectedItem=b}));!1!==this._trigger("select",d,{item:b})&&this._value(b.value);this.term=this._value();this.close(d);this.selectedItem=b}});
this.liveRegion=a("<div>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body);this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible");this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching);this.element.removeAttr("autocomplete");this.menu.element.remove();this.liveRegion.remove()},_setOption:function(a,f){this._super(a,f);"source"===a&&this._initSource();
"appendTo"===a&&this.menu.element.appendTo(this._appendTo());"disabled"===a&&f&&this.xhr&&this.xhr.abort()},_isEventTargetInWidget:function(d){var f=this.menu.element[0];return d.target===this.element[0]||d.target===f||a.contains(f,d.target)},_closeOnClickOutside:function(a){this._isEventTargetInWidget(a)||this.close()},_appendTo:function(){var d=this.options.appendTo;d&&(d=d.jquery||d.nodeType?a(d):this.document.find(d).eq(0));d&&d[0]||(d=this.element.closest(".ui-front, dialog"));d.length||(d=this.document[0].body);
return d},_initSource:function(){var d=this;if(Array.isArray(this.options.source)){var f=this.options.source;this.source=function(d,b){b(a.ui.autocomplete.filter(f,d.term))}}else if("string"===typeof this.options.source){var b=this.options.source;this.source=function(f,c){d.xhr&&d.xhr.abort();d.xhr=a.ajax({url:b,data:f,dataType:"json",success:function(a){c(a)},error:function(){c([])}})}}else this.source=this.options.source},_searchTimeout:function(a){clearTimeout(this.searching);this.searching=this._delay(function(){var d=
this.term===this._value(),b=this.menu.element.is(":visible"),c=a.altKey||a.ctrlKey||a.metaKey||a.shiftKey;if(!d||d&&!b&&!c)this.selectedItem=null,this.search(null,a)},this.options.delay)},search:function(a,f){a=null!=a?a:this._value();this.term=this._value();if(a.length<this.options.minLength)return this.close(f);if(!1!==this._trigger("search",f))return this._search(a)},_search:function(a){this.pending++;this._addClass("ui-autocomplete-loading");this.cancelSearch=!1;this.source({term:a},this._response())},
_response:function(){var a=++this.requestIndex;return function(d){a===this.requestIndex&&this.__response(d);this.pending--;this.pending||this._removeClass("ui-autocomplete-loading")}.bind(this)},__response:function(a){a&&(a=this._normalize(a));this._trigger("response",null,{content:a});!this.options.disabled&&a&&a.length&&!this.cancelSearch?(this._suggest(a),this._trigger("open")):this._close()},close:function(a){this.cancelSearch=!0;this._close(a)},_close:function(a){this._off(this.document,"mousedown");
this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",a))},_change:function(a){this.previous!==this._value()&&this._trigger("change",a,{item:this.selectedItem})},_normalize:function(d){return d.length&&d[0].label&&d[0].value?d:a.map(d,function(d){return"string"===typeof d?{label:d,value:d}:a.extend({},d,{label:d.label||d.value,value:d.value||d.label})})},_suggest:function(d){var f=this.menu.element.empty();this._renderMenu(f,d);this.isNewMenu=
!0;this.menu.refresh();f.show();this._resizeMenu();f.position(a.extend({of:this.element},this.options.position));this.options.autoFocus&&this.menu.next();this._on(this.document,{mousedown:"_closeOnClickOutside"})},_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(d,f){var b=this;a.each(f,function(a,f){b._renderItemData(d,f)})},_renderItemData:function(a,f){return this._renderItem(a,f).data("ui-autocomplete-item",
f)},_renderItem:function(d,f){return a("<li>").append(a("<div>").text(f.label)).appendTo(d)},_move:function(a,f){if(this.menu.element.is(":visible"))if(this.menu.isFirstItem()&&/^previous/.test(a)||this.menu.isLastItem()&&/^next/.test(a))this.isMultiLine||this._value(this.term),this.menu.blur();else this.menu[a](f);else this.search(null,f)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(a,f){if(!this.isMultiLine||
this.menu.element.is(":visible"))this._move(a,f),f.preventDefault()},_isContentEditable:function(a){if(!a.length)return!1;var d=a.prop("contentEditable");return"inherit"===d?this._isContentEditable(a.parent()):"true"===d}});a.extend(a.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(d,f){var b=new RegExp(a.ui.autocomplete.escapeRegex(f),"i");return a.grep(d,function(a){return b.test(a.label||a.value||a)})}});a.widget("ui.autocomplete",
a.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(a){return a+(1<a?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(d){this._superApply(arguments);if(!this.options.disabled&&!this.cancelSearch){var f=d&&d.length?this.options.messages.results(d.length):this.options.messages.noResults;clearTimeout(this.liveRegionTimer);this.liveRegionTimer=this._delay(function(){this.liveRegion.html(a("<div>").text(f))},100)}}});
var T=/ui-corner-([a-z]){2,6}/g;a.widget("ui.controlgroup",{version:"1.13.1",defaultElement:"<div>",options:{direction:"horizontal",disabled:null,onlyVisible:!0,items:{button:"input[type=button], input[type=submit], input[type=reset], button, a",controlgroupLabel:".ui-controlgroup-label",checkboxradio:"input[type='checkbox'], input[type='radio']",selectmenu:"select",spinner:".ui-spinner-input"}},_create:function(){this._enhance()},_enhance:function(){this.element.attr("role","toolbar");this.refresh()},
_destroy:function(){this._callChildMethod("destroy");this.childWidgets.removeData("ui-controlgroup-data");this.element.removeAttr("role");this.options.items.controlgroupLabel&&this.element.find(this.options.items.controlgroupLabel).find(".ui-controlgroup-label-contents").contents().unwrap()},_initWidgets:function(){var d=this,f=[];a.each(this.options.items,function(b,c){var e={};c&&("controlgroupLabel"===b?(c=d.element.find(c),c.each(function(){var d=a(this);d.children(".ui-controlgroup-label-contents").length||
d.contents().wrapAll("<span class='ui-controlgroup-label-contents'></span>")}),d._addClass(c,null,"ui-widget ui-widget-content ui-state-default"),f=f.concat(c.get())):a.fn[b]&&(e=d["_"+b+"Options"]?d["_"+b+"Options"]("middle"):{classes:{}},d.element.find(c).each(function(){var c=a(this),g=c[b]("instance"),l=a.widget.extend({},e);"button"===b&&c.parent(".ui-spinner").length||(g||(g=c[b]()[b]("instance")),g&&(l.classes=d._resolveClassesValues(l.classes,g)),c[b](l),l=c[b]("widget"),a.data(l[0],"ui-controlgroup-data",
g?g:c[b]("instance")),f.push(l[0]))})))});this.childWidgets=a(a.uniqueSort(f));this._addClass(this.childWidgets,"ui-controlgroup-item")},_callChildMethod:function(d){this.childWidgets.each(function(){var f=a(this).data("ui-controlgroup-data");if(f&&f[d])f[d]()})},_updateCornerClass:function(a,f){f=this._buildSimpleOptions(f,"label").classes.label;this._removeClass(a,null,"ui-corner-top ui-corner-bottom ui-corner-left ui-corner-right ui-corner-all");this._addClass(a,null,f)},_buildSimpleOptions:function(a,
f){var d="vertical"===this.options.direction,b={classes:{}};b.classes[f]={middle:"",first:"ui-corner-"+(d?"top":"left"),last:"ui-corner-"+(d?"bottom":"right"),only:"ui-corner-all"}[a];return b},_spinnerOptions:function(a){a=this._buildSimpleOptions(a,"ui-spinner");a.classes["ui-spinner-up"]="";a.classes["ui-spinner-down"]="";return a},_buttonOptions:function(a){return this._buildSimpleOptions(a,"ui-button")},_checkboxradioOptions:function(a){return this._buildSimpleOptions(a,"ui-checkboxradio-label")},
_selectmenuOptions:function(a){var d="vertical"===this.options.direction;return{width:d?"auto":!1,classes:{middle:{"ui-selectmenu-button-open":"","ui-selectmenu-button-closed":""},first:{"ui-selectmenu-button-open":"ui-corner-"+(d?"top":"tl"),"ui-selectmenu-button-closed":"ui-corner-"+(d?"top":"left")},last:{"ui-selectmenu-button-open":d?"":"ui-corner-tr","ui-selectmenu-button-closed":"ui-corner-"+(d?"bottom":"right")},only:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"}}[a]}},
_resolveClassesValues:function(d,f){var b={};a.each(d,function(a){var c=f.options.classes[a]||"";c=String.prototype.trim.call(c.replace(T,""));b[a]=(c+" "+d[a]).replace(/\s+/g," ")});return b},_setOption:function(a,f){"direction"===a&&this._removeClass("ui-controlgroup-"+this.options.direction);this._super(a,f);"disabled"===a?this._callChildMethod(f?"disable":"enable"):this.refresh()},refresh:function(){var d=this;this._addClass("ui-controlgroup ui-controlgroup-"+this.options.direction);"horizontal"===
this.options.direction&&this._addClass(null,"ui-helper-clearfix");this._initWidgets();var f=this.childWidgets;this.options.onlyVisible&&(f=f.filter(":visible"));f.length&&(a.each(["first","last"],function(a,b){(a=f[b]().data("ui-controlgroup-data"))&&d["_"+a.widgetName+"Options"]?(b=d["_"+a.widgetName+"Options"](1===f.length?"only":b),b.classes=d._resolveClassesValues(b.classes,a),a.element[a.widgetName](b)):d._updateCornerClass(f[b](),b)}),this._callChildMethod("refresh"))}});a.widget("ui.checkboxradio",
[a.ui.formResetMixin,{version:"1.13.1",options:{disabled:null,label:null,icon:!0,classes:{"ui-checkboxradio-label":"ui-corner-all","ui-checkboxradio-icon":"ui-corner-all"}},_getCreateOptions:function(){var d=this,f=this._super()||{};this._readType();var b=this.element.labels();this.label=a(b[b.length-1]);this.label.length||a.error("No label found for checkboxradio widget");this.originalLabel="";this.label.contents().not(this.element[0]).each(function(){d.originalLabel+=3===this.nodeType?a(this).text():
this.outerHTML});this.originalLabel&&(f.label=this.originalLabel);b=this.element[0].disabled;null!=b&&(f.disabled=b);return f},_create:function(){var a=this.element[0].checked;this._bindFormResetHandler();null==this.options.disabled&&(this.options.disabled=this.element[0].disabled);this._setOption("disabled",this.options.disabled);this._addClass("ui-checkboxradio","ui-helper-hidden-accessible");this._addClass(this.label,"ui-checkboxradio-label","ui-button ui-widget");"radio"===this.type&&this._addClass(this.label,
"ui-checkboxradio-radio-label");this.options.label&&this.options.label!==this.originalLabel?this._updateLabel():this.originalLabel&&(this.options.label=this.originalLabel);this._enhance();a&&this._addClass(this.label,"ui-checkboxradio-checked","ui-state-active");this._on({change:"_toggleClasses",focus:function(){this._addClass(this.label,null,"ui-state-focus ui-visual-focus")},blur:function(){this._removeClass(this.label,null,"ui-state-focus ui-visual-focus")}})},_readType:function(){var d=this.element[0].nodeName.toLowerCase();
this.type=this.element[0].type;"input"===d&&/radio|checkbox/.test(this.type)||a.error("Can't create checkboxradio on element.nodeName="+d+" and element.type="+this.type)},_enhance:function(){this._updateIcon(this.element[0].checked)},widget:function(){return this.label},_getRadioGroup:function(){var d=this.element[0].name,f="input[name='"+a.escapeSelector(d)+"']";return d?(this.form.length?a(this.form[0].elements).filter(f):a(f).filter(function(){return 0===a(this)._form().length})).not(this.element):
a([])},_toggleClasses:function(){var d=this.element[0].checked;this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",d);this.options.icon&&"checkbox"===this.type&&this._toggleClass(this.icon,null,"ui-icon-check ui-state-checked",d)._toggleClass(this.icon,null,"ui-icon-blank",!d);"radio"===this.type&&this._getRadioGroup().each(function(){var d=a(this).checkboxradio("instance");d&&d._removeClass(d.label,"ui-checkboxradio-checked","ui-state-active")})},_destroy:function(){this._unbindFormResetHandler();
this.icon&&(this.icon.remove(),this.iconSpace.remove())},_setOption:function(a,b){if("label"!==a||b)this._super(a,b),"disabled"===a?(this._toggleClass(this.label,null,"ui-state-disabled",b),this.element[0].disabled=b):this.refresh()},_updateIcon:function(d){var b="ui-icon ui-icon-background ";this.options.icon?(this.icon||(this.icon=a("<span>"),this.iconSpace=a("<span> </span>"),this._addClass(this.iconSpace,"ui-checkboxradio-icon-space")),"checkbox"===this.type?(b+=d?"ui-icon-check ui-state-checked":
"ui-icon-blank",this._removeClass(this.icon,null,d?"ui-icon-blank":"ui-icon-check")):b+="ui-icon-blank",this._addClass(this.icon,"ui-checkboxradio-icon",b),d||this._removeClass(this.icon,null,"ui-icon-check ui-state-checked"),this.icon.prependTo(this.label).after(this.iconSpace)):void 0!==this.icon&&(this.icon.remove(),this.iconSpace.remove(),delete this.icon)},_updateLabel:function(){var a=this.label.contents().not(this.element[0]);this.icon&&(a=a.not(this.icon[0]));this.iconSpace&&(a=a.not(this.iconSpace[0]));
a.remove();this.label.append(this.options.label)},refresh:function(){var a=this.element[0].checked,b=this.element[0].disabled;this._updateIcon(a);this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",a);null!==this.options.label&&this._updateLabel();b!==this.options.disabled&&this._setOptions({disabled:b})}}]);a.widget("ui.button",{version:"1.13.1",defaultElement:"<button>",options:{classes:{"ui-button":"ui-corner-all"},disabled:null,icon:null,iconPosition:"beginning",label:null,
showLabel:!0},_getCreateOptions:function(){var a=this._super()||{};this.isInput=this.element.is("input");var b=this.element[0].disabled;null!=b&&(a.disabled=b);if(this.originalLabel=this.isInput?this.element.val():this.element.html())a.label=this.originalLabel;return a},_create:function(){!this.option.showLabel&!this.options.icon&&(this.options.showLabel=!0);null==this.options.disabled&&(this.options.disabled=this.element[0].disabled||!1);this.hasTitle=!!this.element.attr("title");this.options.label&&
this.options.label!==this.originalLabel&&(this.isInput?this.element.val(this.options.label):this.element.html(this.options.label));this._addClass("ui-button","ui-widget");this._setOption("disabled",this.options.disabled);this._enhance();this.element.is("a")&&this._on({keyup:function(d){d.keyCode===a.ui.keyCode.SPACE&&(d.preventDefault(),this.element[0].click?this.element[0].click():this.element.trigger("click"))}})},_enhance:function(){this.element.is("button")||this.element.attr("role","button");
this.options.icon&&(this._updateIcon("icon",this.options.icon),this._updateTooltip())},_updateTooltip:function(){this.title=this.element.attr("title");this.options.showLabel||this.title||this.element.attr("title",this.options.label)},_updateIcon:function(d,b){var f=(d="iconPosition"!==d)?this.options.iconPosition:b,c="top"===f||"bottom"===f;this.icon?d&&this._removeClass(this.icon,null,this.options.icon):(this.icon=a("<span>"),this._addClass(this.icon,"ui-button-icon","ui-icon"),this.options.showLabel||
this._addClass("ui-button-icon-only"));d&&this._addClass(this.icon,null,b);this._attachIcon(f);c?(this._addClass(this.icon,null,"ui-widget-icon-block"),this.iconSpace&&this.iconSpace.remove()):(this.iconSpace||(this.iconSpace=a("<span> </span>"),this._addClass(this.iconSpace,"ui-button-icon-space")),this._removeClass(this.icon,null,"ui-wiget-icon-block"),this._attachIconSpace(f))},_destroy:function(){this.element.removeAttr("role");this.icon&&this.icon.remove();this.iconSpace&&this.iconSpace.remove();
this.hasTitle||this.element.removeAttr("title")},_attachIconSpace:function(a){this.icon[/^(?:end|bottom)/.test(a)?"before":"after"](this.iconSpace)},_attachIcon:function(a){this.element[/^(?:end|bottom)/.test(a)?"append":"prepend"](this.icon)},_setOptions:function(a){var d=void 0===a.icon?this.options.icon:a.icon;(void 0===a.showLabel?this.options.showLabel:a.showLabel)||d||(a.showLabel=!0);this._super(a)},_setOption:function(a,b){"icon"===a&&(b?this._updateIcon(a,b):this.icon&&(this.icon.remove(),
this.iconSpace&&this.iconSpace.remove()));"iconPosition"===a&&this._updateIcon(a,b);"showLabel"===a&&(this._toggleClass("ui-button-icon-only",null,!b),this._updateTooltip());"label"===a&&(this.isInput?this.element.val(b):(this.element.html(b),this.icon&&(this._attachIcon(this.options.iconPosition),this._attachIconSpace(this.options.iconPosition))));this._super(a,b);"disabled"===a&&(this._toggleClass(null,"ui-state-disabled",b),(this.element[0].disabled=b)&&this.element.trigger("blur"))},refresh:function(){var a=
this.element.is("input, button")?this.element[0].disabled:this.element.hasClass("ui-button-disabled");a!==this.options.disabled&&this._setOptions({disabled:a});this._updateTooltip()}});!1!==a.uiBackCompat&&(a.widget("ui.button",a.ui.button,{options:{text:!0,icons:{primary:null,secondary:null}},_create:function(){this.options.showLabel&&!this.options.text&&(this.options.showLabel=this.options.text);!this.options.showLabel&&this.options.text&&(this.options.text=this.options.showLabel);this.options.icon||
!this.options.icons.primary&&!this.options.icons.secondary?this.options.icon&&(this.options.icons.primary=this.options.icon):this.options.icons.primary?this.options.icon=this.options.icons.primary:(this.options.icon=this.options.icons.secondary,this.options.iconPosition="end");this._super()},_setOption:function(a,b){"text"===a?this._super("showLabel",b):("showLabel"===a&&(this.options.text=b),"icon"===a&&(this.options.icons.primary=b),"icons"===a&&(b.primary?(this._super("icon",b.primary),this._super("iconPosition",
"beginning")):b.secondary&&(this._super("icon",b.secondary),this._super("iconPosition","end"))),this._superApply(arguments))}}),a.fn.button=function(d){return function(b){var f="string"===typeof b,c=Array.prototype.slice.call(arguments,1),e=this;f?this.length||"instance"!==b?this.each(function(){var d=a(this).attr("type");var f=a.data(this,"ui-"+("checkbox"!==d&&"radio"!==d?"button":"checkboxradio"));if("instance"===b)return e=f,!1;if(!f)return a.error("cannot call methods on button prior to initialization; attempted to call method '"+
b+"'");if("function"!==typeof f[b]||"_"===b.charAt(0))return a.error("no such method '"+b+"' for button widget instance");d=f[b].apply(f,c);if(d!==f&&void 0!==d)return e=d&&d.jquery?e.pushStack(d.get()):d,!1}):e=void 0:(c.length&&(b=a.widget.extend.apply(null,[b].concat(c))),this.each(function(){var f=a(this).attr("type");f="checkbox"!==f&&"radio"!==f?"button":"checkboxradio";var c=a.data(this,"ui-"+f);c?(c.option(b||{}),c._init&&c._init()):"button"===f?d.call(a(this),b):a(this).checkboxradio(a.extend({icon:!1},
b))}));return e}}(a.fn.button),a.fn.buttonset=function(){a.ui.controlgroup||a.error("Controlgroup widget missing");if("option"===arguments[0]&&"items"===arguments[1]&&arguments[2])return this.controlgroup.apply(this,[arguments[0],"items.button",arguments[2]]);if("option"===arguments[0]&&"items"===arguments[1])return this.controlgroup.apply(this,[arguments[0],"items.button"]);"object"===typeof arguments[0]&&arguments[0].items&&(arguments[0].items={button:arguments[0].items});return this.controlgroup.apply(this,
arguments)});a.extend(a.ui,{datepicker:{version:"1.13.1"}});var U;a.extend(m.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(a){x(this._defaults,a||{});return this},_attachDatepicker:function(d,b){var f=d.nodeName.toLowerCase();var c="div"===f||"span"===f;d.id||(this.uuid+=1,d.id="dp"+this.uuid);var e=this._newInst(a(d),c);e.settings=a.extend({},b||{});"input"===f?this._connectDatepicker(d,e):c&&this._inlineDatepicker(d,e)},
_newInst:function(d,b){return{id:d[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1"),input:d,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:b,dpDiv:b?g(a("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(d,b){var f=a(d);b.append=a([]);b.trigger=a([]);f.hasClass(this.markerClassName)||(this._attachments(f,b),f.addClass(this.markerClassName).on("keydown",this._doKeyDown).on("keypress",
this._doKeyPress).on("keyup",this._doKeyUp),this._autoSize(b),a.data(d,"datepicker",b),b.settings.disabled&&this._disableDatepicker(d))},_attachments:function(d,b){var f=this._get(b,"appendText");var c=this._get(b,"isRTL");b.append&&b.append.remove();f&&(b.append=a("<span>").addClass(this._appendClass).text(f),d[c?"before":"after"](b.append));d.off("focus",this._showDatepicker);b.trigger&&b.trigger.remove();f=this._get(b,"showOn");if("focus"===f||"both"===f)d.on("focus",this._showDatepicker);if("button"===
f||"both"===f){f=this._get(b,"buttonText");var e=this._get(b,"buttonImage");this._get(b,"buttonImageOnly")?b.trigger=a("<img>").addClass(this._triggerClass).attr({src:e,alt:f,title:f}):(b.trigger=a("<button type='button'>").addClass(this._triggerClass),e?b.trigger.html(a("<img>").attr({src:e,alt:f,title:f})):b.trigger.text(f));d[c?"before":"after"](b.trigger);b.trigger.on("click",function(){a.datepicker._datepickerShowing&&a.datepicker._lastInput===d[0]?a.datepicker._hideDatepicker():(a.datepicker._datepickerShowing&&
a.datepicker._lastInput!==d[0]&&a.datepicker._hideDatepicker(),a.datepicker._showDatepicker(d[0]));return!1})}},_autoSize:function(a){if(this._get(a,"autoSize")&&!a.inline){var d,b,c,e=new Date(2009,11,20),g=this._get(a,"dateFormat");if(g.match(/[DM]/)){var h=function(a){for(c=b=d=0;c<a.length;c++)a[c].length>d&&(d=a[c].length,b=c);return b};e.setMonth(h(this._get(a,g.match(/MM/)?"monthNames":"monthNamesShort")));e.setDate(h(this._get(a,g.match(/DD/)?"dayNames":"dayNamesShort"))+20-e.getDay())}a.input.attr("size",
this._formatDate(a,e).length)}},_inlineDatepicker:function(d,b){var f=a(d);f.hasClass(this.markerClassName)||(f.addClass(this.markerClassName).append(b.dpDiv),a.data(d,"datepicker",b),this._setDate(b,this._getDefaultDate(b),!0),this._updateDatepicker(b),this._updateAlternate(b),b.settings.disabled&&this._disableDatepicker(d),b.dpDiv.css("display","block"))},_dialogDatepicker:function(d,b,c,e,g){d=this._dialogInst;d||(this.uuid+=1,d="dp"+this.uuid,this._dialogInput=a("<input type='text' id='"+d+"' style='position: absolute; top: -100px; width: 0px;'/>"),
this._dialogInput.on("keydown",this._doKeyDown),a("body").append(this._dialogInput),d=this._dialogInst=this._newInst(this._dialogInput,!1),d.settings={},a.data(this._dialogInput[0],"datepicker",d));x(d.settings,e||{});b=b&&b.constructor===Date?this._formatDate(d,b):b;this._dialogInput.val(b);this._pos=g?g.length?g:[g.pageX,g.pageY]:null;if(!this._pos){b=document.documentElement.clientWidth;e=document.documentElement.clientHeight;g=document.documentElement.scrollLeft||document.body.scrollLeft;var f=
document.documentElement.scrollTop||document.body.scrollTop;this._pos=[b/2-100+g,e/2-150+f]}this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px");d.settings.onSelect=c;this._inDialog=!0;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);a.blockUI&&a.blockUI(this.dpDiv);a.data(this._dialogInput[0],"datepicker",d);return this},_destroyDatepicker:function(d){var b=a(d),c=a.data(d,"datepicker");if(b.hasClass(this.markerClassName)){var e=d.nodeName.toLowerCase();
a.removeData(d,"datepicker");"input"===e?(c.append.remove(),c.trigger.remove(),b.removeClass(this.markerClassName).off("focus",this._showDatepicker).off("keydown",this._doKeyDown).off("keypress",this._doKeyPress).off("keyup",this._doKeyUp)):"div"!==e&&"span"!==e||b.removeClass(this.markerClassName).empty();U===c&&(this._curInst=U=null)}},_enableDatepicker:function(d){var b=a(d),c=a.data(d,"datepicker");if(b.hasClass(this.markerClassName)){var e=d.nodeName.toLowerCase();if("input"===e)d.disabled=!1,
c.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if("div"===e||"span"===e)e=b.children("."+this._inlineClass),e.children().removeClass("ui-state-disabled"),e.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1);this._disabledInputs=a.map(this._disabledInputs,function(a){return a===d?null:a})}},_disableDatepicker:function(d){var b=a(d),c=a.data(d,"datepicker");if(b.hasClass(this.markerClassName)){var e=
d.nodeName.toLowerCase();if("input"===e)d.disabled=!0,c.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if("div"===e||"span"===e)e=b.children("."+this._inlineClass),e.children().addClass("ui-state-disabled"),e.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0);this._disabledInputs=a.map(this._disabledInputs,function(a){return a===d?null:a});this._disabledInputs[this._disabledInputs.length]=d}},
_isDisabledDatepicker:function(a){if(!a)return!1;for(var d=0;d<this._disabledInputs.length;d++)if(this._disabledInputs[d]===a)return!0;return!1},_getInst:function(d){try{return a.data(d,"datepicker")}catch(f){throw"Missing instance data for this datepicker";}},_optionDatepicker:function(d,b,c){var f=this._getInst(d);if(2===arguments.length&&"string"===typeof b)return"defaults"===b?a.extend({},a.datepicker._defaults):f?"all"===b?a.extend({},f.settings):this._get(f,b):null;var e=b||{};"string"===typeof b&&
(e={},e[b]=c);if(f){this._curInst===f&&this._hideDatepicker();var g=this._getDateDatepicker(d,!0);var r=this._getMinMaxDate(f,"min");var l=this._getMinMaxDate(f,"max");x(f.settings,e);null!==r&&void 0!==e.dateFormat&&void 0===e.minDate&&(f.settings.minDate=this._formatDate(f,r));null!==l&&void 0!==e.dateFormat&&void 0===e.maxDate&&(f.settings.maxDate=this._formatDate(f,l));"disabled"in e&&(e.disabled?this._disableDatepicker(d):this._enableDatepicker(d));this._attachments(a(d),f);this._autoSize(f);
this._setDate(f,g);this._updateAlternate(f);this._updateDatepicker(f)}},_changeDatepicker:function(a,b,c){this._optionDatepicker(a,b,c)},_refreshDatepicker:function(a){(a=this._getInst(a))&&this._updateDatepicker(a)},_setDateDatepicker:function(a,b){if(a=this._getInst(a))this._setDate(a,b),this._updateDatepicker(a),this._updateAlternate(a)},_getDateDatepicker:function(a,b){(a=this._getInst(a))&&!a.inline&&this._setDateFromField(a,b);return a?this._getDate(a):null},_doKeyDown:function(d){var b=a.datepicker._getInst(d.target);
var c=!0;var e=b.dpDiv.is(".ui-datepicker-rtl");b._keyEvent=!0;if(a.datepicker._datepickerShowing)switch(d.keyCode){case 9:a.datepicker._hideDatepicker();c=!1;break;case 13:return c=a("td."+a.datepicker._dayOverClass+":not(."+a.datepicker._currentClass+")",b.dpDiv),c[0]&&a.datepicker._selectDay(d.target,b.selectedMonth,b.selectedYear,c[0]),(d=a.datepicker._get(b,"onSelect"))?(c=a.datepicker._formatDate(b),d.apply(b.input?b.input[0]:null,[c,b])):a.datepicker._hideDatepicker(),!1;case 27:a.datepicker._hideDatepicker();
break;case 33:a.datepicker._adjustDate(d.target,d.ctrlKey?-a.datepicker._get(b,"stepBigMonths"):-a.datepicker._get(b,"stepMonths"),"M");break;case 34:a.datepicker._adjustDate(d.target,d.ctrlKey?+a.datepicker._get(b,"stepBigMonths"):+a.datepicker._get(b,"stepMonths"),"M");break;case 35:(d.ctrlKey||d.metaKey)&&a.datepicker._clearDate(d.target);c=d.ctrlKey||d.metaKey;break;case 36:(d.ctrlKey||d.metaKey)&&a.datepicker._gotoToday(d.target);c=d.ctrlKey||d.metaKey;break;case 37:(d.ctrlKey||d.metaKey)&&a.datepicker._adjustDate(d.target,
e?1:-1,"D");c=d.ctrlKey||d.metaKey;d.originalEvent.altKey&&a.datepicker._adjustDate(d.target,d.ctrlKey?-a.datepicker._get(b,"stepBigMonths"):-a.datepicker._get(b,"stepMonths"),"M");break;case 38:(d.ctrlKey||d.metaKey)&&a.datepicker._adjustDate(d.target,-7,"D");c=d.ctrlKey||d.metaKey;break;case 39:(d.ctrlKey||d.metaKey)&&a.datepicker._adjustDate(d.target,e?-1:1,"D");c=d.ctrlKey||d.metaKey;d.originalEvent.altKey&&a.datepicker._adjustDate(d.target,d.ctrlKey?+a.datepicker._get(b,"stepBigMonths"):+a.datepicker._get(b,
"stepMonths"),"M");break;case 40:(d.ctrlKey||d.metaKey)&&a.datepicker._adjustDate(d.target,7,"D");c=d.ctrlKey||d.metaKey;break;default:c=!1}else 36===d.keyCode&&d.ctrlKey?a.datepicker._showDatepicker(this):c=!1;c&&(d.preventDefault(),d.stopPropagation())},_doKeyPress:function(d){var b=a.datepicker._getInst(d.target);if(a.datepicker._get(b,"constrainInput")){b=a.datepicker._possibleChars(a.datepicker._get(b,"dateFormat"));var c=String.fromCharCode(null==d.charCode?d.keyCode:d.charCode);return d.ctrlKey||
d.metaKey||" ">c||!b||-1<b.indexOf(c)}},_doKeyUp:function(d){var b;d=a.datepicker._getInst(d.target);if(d.input.val()!==d.lastVal)try{if(b=a.datepicker.parseDate(a.datepicker._get(d,"dateFormat"),d.input?d.input.val():null,a.datepicker._getFormatConfig(d)))a.datepicker._setDateFromField(d),a.datepicker._updateAlternate(d),a.datepicker._updateDatepicker(d)}catch(r){}return!0},_showDatepicker:function(d){d=d.target||d;"input"!==d.nodeName.toLowerCase()&&(d=a("input",d.parentNode)[0]);if(!a.datepicker._isDisabledDatepicker(d)&&
a.datepicker._lastInput!==d){var b=a.datepicker._getInst(d);a.datepicker._curInst&&a.datepicker._curInst!==b&&(a.datepicker._curInst.dpDiv.stop(!0,!0),b&&a.datepicker._datepickerShowing&&a.datepicker._hideDatepicker(a.datepicker._curInst.input[0]));var c=(c=a.datepicker._get(b,"beforeShow"))?c.apply(d,[d,b]):{};if(!1!==c){x(b.settings,c);b.lastVal=null;a.datepicker._lastInput=d;a.datepicker._setDateFromField(b);a.datepicker._inDialog&&(d.value="");a.datepicker._pos||(a.datepicker._pos=a.datepicker._findPos(d),
a.datepicker._pos[1]+=d.offsetHeight);var e=!1;a(d).parents().each(function(){e|="fixed"===a(this).css("position");return!e});c={left:a.datepicker._pos[0],top:a.datepicker._pos[1]};a.datepicker._pos=null;b.dpDiv.empty();b.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});a.datepicker._updateDatepicker(b);c=a.datepicker._checkOffset(b,c,e);b.dpDiv.css({position:a.datepicker._inDialog&&a.blockUI?"static":e?"fixed":"absolute",display:"none",left:c.left+"px",top:c.top+"px"});if(!b.inline){c=
a.datepicker._get(b,"showAnim");var g=a.datepicker._get(b,"duration");b.dpDiv.css("z-index",h(a(d))+1);a.datepicker._datepickerShowing=!0;if(a.effects&&a.effects.effect[c])b.dpDiv.show(c,a.datepicker._get(b,"showOptions"),g);else b.dpDiv[c||"show"](c?g:null);a.datepicker._shouldFocusInput(b)&&b.input.trigger("focus");a.datepicker._curInst=b}}}},_updateDatepicker:function(d){this.maxRows=4;U=d;d.dpDiv.empty().append(this._generateHTML(d));this._attachHandlers(d);var b=this._getNumberOfMonths(d),c=
b[1],e=d.dpDiv.find("."+this._dayOverClass+" a"),g=a.datepicker._get(d,"onUpdateDatepicker");0<e.length&&v.apply(e.get(0));d.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");1<c&&d.dpDiv.addClass("ui-datepicker-multi-"+c).css("width",17*c+"em");d.dpDiv[(1!==b[0]||1!==b[1]?"add":"remove")+"Class"]("ui-datepicker-multi");d.dpDiv[(this._get(d,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");d===a.datepicker._curInst&&a.datepicker._datepickerShowing&&
a.datepicker._shouldFocusInput(d)&&d.input.trigger("focus");if(d.yearshtml){var h=d.yearshtml;setTimeout(function(){h===d.yearshtml&&d.yearshtml&&d.dpDiv.find("select.ui-datepicker-year").first().replaceWith(d.yearshtml);h=d.yearshtml=null},0)}g&&g.apply(d.input?d.input[0]:null,[d])},_shouldFocusInput:function(a){return a.input&&a.input.is(":visible")&&!a.input.is(":disabled")&&!a.input.is(":focus")},_checkOffset:function(d,b,c){var f=d.dpDiv.outerWidth(),e=d.dpDiv.outerHeight(),g=d.input?d.input.outerWidth():
0,r=d.input?d.input.outerHeight():0,l=document.documentElement.clientWidth+(c?0:a(document).scrollLeft()),h=document.documentElement.clientHeight+(c?0:a(document).scrollTop());b.left-=this._get(d,"isRTL")?f-g:0;b.left-=c&&b.left===d.input.offset().left?a(document).scrollLeft():0;b.top-=c&&b.top===d.input.offset().top+r?a(document).scrollTop():0;b.left-=Math.min(b.left,b.left+f>l&&l>f?Math.abs(b.left+f-l):0);b.top-=Math.min(b.top,b.top+e>h&&h>e?Math.abs(e+r):0);return b},_findPos:function(d){var b=
this._getInst(d);for(b=this._get(b,"isRTL");d&&("hidden"===d.type||1!==d.nodeType||a.expr.pseudos.hidden(d));)d=d[b?"previousSibling":"nextSibling"];d=a(d).offset();return[d.left,d.top]},_hideDatepicker:function(d){var b=this._curInst;if(b&&(!d||b===a.data(d,"datepicker"))&&this._datepickerShowing){d=this._get(b,"showAnim");var c=this._get(b,"duration");var e=function(){a.datepicker._tidyDialog(b)};if(a.effects&&(a.effects.effect[d]||a.effects[d]))b.dpDiv.hide(d,a.datepicker._get(b,"showOptions"),
c,e);else b.dpDiv["slideDown"===d?"slideUp":"fadeIn"===d?"fadeOut":"hide"](d?c:null,e);d||e();this._datepickerShowing=!1;(d=this._get(b,"onClose"))&&d.apply(b.input?b.input[0]:null,[b.input?b.input.val():"",b]);this._lastInput=null;this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),a.blockUI&&(a.unblockUI(),a("body").append(this.dpDiv)));this._inDialog=!1}},_tidyDialog:function(a){a.dpDiv.removeClass(this._dialogClass).off(".ui-datepicker-calendar")},_checkExternalClick:function(d){if(a.datepicker._curInst){d=
a(d.target);var b=a.datepicker._getInst(d[0]);(!(d[0].id===a.datepicker._mainDivId||0!==d.parents("#"+a.datepicker._mainDivId).length||d.hasClass(a.datepicker.markerClassName)||d.closest("."+a.datepicker._triggerClass).length||!a.datepicker._datepickerShowing||a.datepicker._inDialog&&a.blockUI)||d.hasClass(a.datepicker.markerClassName)&&a.datepicker._curInst!==b)&&a.datepicker._hideDatepicker()}},_adjustDate:function(d,b,c){d=a(d);var f=this._getInst(d[0]);this._isDisabledDatepicker(d[0])||(this._adjustInstDate(f,
b,c),this._updateDatepicker(f))},_gotoToday:function(d){var b=a(d),c=this._getInst(b[0]);this._get(c,"gotoCurrent")&&c.currentDay?(c.selectedDay=c.currentDay,c.drawMonth=c.selectedMonth=c.currentMonth,c.drawYear=c.selectedYear=c.currentYear):(d=new Date,c.selectedDay=d.getDate(),c.drawMonth=c.selectedMonth=d.getMonth(),c.drawYear=c.selectedYear=d.getFullYear());this._notifyChange(c);this._adjustDate(b)},_selectMonthYear:function(d,b,c){d=a(d);var f=this._getInst(d[0]);f["selected"+("M"===c?"Month":
"Year")]=f["draw"+("M"===c?"Month":"Year")]=parseInt(b.options[b.selectedIndex].value,10);this._notifyChange(f);this._adjustDate(d)},_selectDay:function(d,b,c,e){var f=a(d);a(e).hasClass(this._unselectableClass)||this._isDisabledDatepicker(f[0])||(f=this._getInst(f[0]),f.selectedDay=f.currentDay=parseInt(a("a",e).attr("data-date")),f.selectedMonth=f.currentMonth=b,f.selectedYear=f.currentYear=c,this._selectDate(d,this._formatDate(f,f.currentDay,f.currentMonth,f.currentYear)))},_clearDate:function(d){d=
a(d);this._selectDate(d,"")},_selectDate:function(d,b){d=a(d);var f=this._getInst(d[0]);b=null!=b?b:this._formatDate(f);f.input&&f.input.val(b);this._updateAlternate(f);(d=this._get(f,"onSelect"))?d.apply(f.input?f.input[0]:null,[b,f]):f.input&&f.input.trigger("change");f.inline?this._updateDatepicker(f):(this._hideDatepicker(),this._lastInput=f.input[0],"object"!==typeof f.input[0]&&f.input.trigger("focus"),this._lastInput=null)},_updateAlternate:function(d){var b=this._get(d,"altField");if(b){var c=
this._get(d,"altFormat")||this._get(d,"dateFormat");var e=this._getDate(d);d=this.formatDate(c,e,this._getFormatConfig(d));a(document).find(b).val(d)}},noWeekends:function(a){a=a.getDay();return[0<a&&6>a,""]},iso8601Week:function(a){var d=new Date(a.getTime());d.setDate(d.getDate()+4-(d.getDay()||7));a=d.getTime();d.setMonth(0);d.setDate(1);return Math.floor(Math.round((a-d)/864E5)/7)+1},parseDate:function(d,b,c){if(null==d||null==b)throw"Invalid arguments";b="object"===typeof b?b.toString():b+"";
if(""===b)return null;var f,e=0;var g=(c?c.shortYearCutoff:null)||this._defaults.shortYearCutoff;g="string"!==typeof g?g:(new Date).getFullYear()%100+parseInt(g,10);var r=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort;var l=(c?c.dayNames:null)||this._defaults.dayNames,h=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort,n=(c?c.monthNames:null)||this._defaults.monthNames,m=c=-1,p=-1,k=-1,q=!1,v=function(a){(a=f+1<d.length&&d.charAt(f+1)===a)&&f++;return a},y=function(a){var d=v(a);
d="@"===a?14:"!"===a?20:"y"===a&&d?4:"o"===a?3:2;a=new RegExp("^\\d{"+("y"===a?d:1)+","+d+"}");a=b.substring(e).match(a);if(!a)throw"Missing number at position "+e;e+=a[0].length;return parseInt(a[0],10)},z=function(d,f,c){var l=-1;d=a.map(v(d)?c:f,function(a,d){return[[d,a]]}).sort(function(a,d){return-(a[1].length-d[1].length)});a.each(d,function(a,d){a=d[1];if(b.substr(e,a.length).toLowerCase()===a.toLowerCase())return l=d[0],e+=a.length,!1});if(-1!==l)return l+1;throw"Unknown name at position "+
e;},x=function(){if(b.charAt(e)!==d.charAt(f))throw"Unexpected literal at position "+e;e++};for(f=0;f<d.length;f++)if(q)"'"!==d.charAt(f)||v("'")?x():q=!1;else switch(d.charAt(f)){case "d":p=y("d");break;case "D":z("D",r,l);break;case "o":k=y("o");break;case "m":m=y("m");break;case "M":m=z("M",h,n);break;case "y":c=y("y");break;case "@":var w=new Date(y("@"));c=w.getFullYear();m=w.getMonth()+1;p=w.getDate();break;case "!":w=new Date((y("!")-this._ticksTo1970)/1E4);c=w.getFullYear();m=w.getMonth()+
1;p=w.getDate();break;case "'":v("'")?x():q=!0;break;default:x()}if(e<b.length&&(r=b.substr(e),!/^\s+/.test(r)))throw"Extra/unparsed characters found in date: "+r;-1===c?c=(new Date).getFullYear():100>c&&(c+=(new Date).getFullYear()-(new Date).getFullYear()%100+(c<=g?0:-100));if(-1<k){m=1;p=k;do{g=this._getDaysInMonth(c,m-1);if(p<=g)break;m++;p-=g}while(1)}w=this._daylightSavingAdjust(new Date(c,m-1,p));if(w.getFullYear()!==c||w.getMonth()+1!==m||w.getDate()!==p)throw"Invalid date";return w},ATOM:"yy-mm-dd",
COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864E9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(a,b,c){if(!b)return"";var d,f=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,e=(c?c.dayNames:null)||this._defaults.dayNames,g=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort;c=(c?c.monthNames:
null)||this._defaults.monthNames;var l=function(b){(b=d+1<a.length&&a.charAt(d+1)===b)&&d++;return b},r=function(a,d,b){d=""+d;if(l(a))for(;d.length<b;)d="0"+d;return d},h=function(a,d,b,f){return l(a)?f[d]:b[d]},n="",m=!1;if(b)for(d=0;d<a.length;d++)if(m)"'"!==a.charAt(d)||l("'")?n+=a.charAt(d):m=!1;else switch(a.charAt(d)){case "d":n+=r("d",b.getDate(),2);break;case "D":n+=h("D",b.getDay(),f,e);break;case "o":n+=r("o",Math.round(((new Date(b.getFullYear(),b.getMonth(),b.getDate())).getTime()-(new Date(b.getFullYear(),
0,0)).getTime())/864E5),3);break;case "m":n+=r("m",b.getMonth()+1,2);break;case "M":n+=h("M",b.getMonth(),g,c);break;case "y":n+=l("y")?b.getFullYear():(10>b.getFullYear()%100?"0":"")+b.getFullYear()%100;break;case "@":n+=b.getTime();break;case "!":n+=1E4*b.getTime()+this._ticksTo1970;break;case "'":l("'")?n+="'":m=!0;break;default:n+=a.charAt(d)}return n},_possibleChars:function(a){var d,b="",c=!1,e=function(b){(b=d+1<a.length&&a.charAt(d+1)===b)&&d++;return b};for(d=0;d<a.length;d++)if(c)"'"!==
a.charAt(d)||e("'")?b+=a.charAt(d):c=!1;else switch(a.charAt(d)){case "d":case "m":case "y":case "@":b+="0123456789";break;case "D":case "M":return null;case "'":e("'")?b+="'":c=!0;break;default:b+=a.charAt(d)}return b},_get:function(a,b){return void 0!==a.settings[b]?a.settings[b]:this._defaults[b]},_setDateFromField:function(a,b){if(a.input.val()!==a.lastVal){var d=this._get(a,"dateFormat"),f=a.lastVal=a.input?a.input.val():null,c=this._getDefaultDate(a),e=c,g=this._getFormatConfig(a);try{e=this.parseDate(d,
f,g)||c}catch(l){f=b?"":f}a.selectedDay=e.getDate();a.drawMonth=a.selectedMonth=e.getMonth();a.drawYear=a.selectedYear=e.getFullYear();a.currentDay=f?e.getDate():0;a.currentMonth=f?e.getMonth():0;a.currentYear=f?e.getFullYear():0;this._adjustInstDate(a)}},_getDefaultDate:function(a){return this._restrictMinMax(a,this._determineDate(a,this._get(a,"defaultDate"),new Date))},_determineDate:function(d,b,c){var f=function(a){var d=new Date;d.setDate(d.getDate()+a);return d},e=function(b){try{return a.datepicker.parseDate(a.datepicker._get(d,
"dateFormat"),b,a.datepicker._getFormatConfig(d))}catch(da){}var f=(b.toLowerCase().match(/^c/)?a.datepicker._getDate(d):null)||new Date,c=f.getFullYear(),e=f.getMonth();f=f.getDate();for(var g=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,r=g.exec(b);r;){switch(r[2]||"d"){case "d":case "D":f+=parseInt(r[1],10);break;case "w":case "W":f+=7*parseInt(r[1],10);break;case "m":case "M":e+=parseInt(r[1],10);f=Math.min(f,a.datepicker._getDaysInMonth(c,e));break;case "y":case "Y":c+=parseInt(r[1],10),f=Math.min(f,
a.datepicker._getDaysInMonth(c,e))}r=g.exec(b)}return new Date(c,e,f)};if(b=(b=null==b||""===b?c:"string"===typeof b?e(b):"number"===typeof b?isNaN(b)?c:f(b):new Date(b.getTime()))&&"Invalid Date"===b.toString()?c:b)b.setHours(0),b.setMinutes(0),b.setSeconds(0),b.setMilliseconds(0);return this._daylightSavingAdjust(b)},_daylightSavingAdjust:function(a){if(!a)return null;a.setHours(12<a.getHours()?a.getHours()+2:0);return a},_setDate:function(a,b,c){var d=!b,f=a.selectedMonth,e=a.selectedYear;b=this._restrictMinMax(a,
this._determineDate(a,b,new Date));a.selectedDay=a.currentDay=b.getDate();a.drawMonth=a.selectedMonth=a.currentMonth=b.getMonth();a.drawYear=a.selectedYear=a.currentYear=b.getFullYear();f===a.selectedMonth&&e===a.selectedYear||c||this._notifyChange(a);this._adjustInstDate(a);a.input&&a.input.val(d?"":this._formatDate(a))},_getDate:function(a){return!a.currentYear||a.input&&""===a.input.val()?null:this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay))},_attachHandlers:function(d){var b=
this._get(d,"stepMonths"),c="#"+d.id.replace(/\\\\/g,"\\");d.dpDiv.find("[data-handler]").map(function(){a(this).on(this.getAttribute("data-event"),{prev:function(){a.datepicker._adjustDate(c,-b,"M")},next:function(){a.datepicker._adjustDate(c,+b,"M")},hide:function(){a.datepicker._hideDatepicker()},today:function(){a.datepicker._gotoToday(c)},selectDay:function(){a.datepicker._selectDay(c,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this);return!1},selectMonth:function(){a.datepicker._selectMonthYear(c,
this,"M");return!1},selectYear:function(){a.datepicker._selectMonthYear(c,this,"Y");return!1}}[this.getAttribute("data-handler")])})},_generateHTML:function(d){var b,c,e,g,h=new Date;h=this._daylightSavingAdjust(new Date(h.getFullYear(),h.getMonth(),h.getDate()));var n=this._get(d,"isRTL");var l=this._get(d,"showButtonPanel");var u=this._get(d,"hideIfNoPrevNext");var m=this._get(d,"navigationAsDateFormat");var p=this._getNumberOfMonths(d),k=this._get(d,"showCurrentAtPos");var q=this._get(d,"stepMonths");
var v=1!==p[0]||1!==p[1],y=this._daylightSavingAdjust(d.currentDay?new Date(d.currentYear,d.currentMonth,d.currentDay):new Date(9999,9,9)),z=this._getMinMaxDate(d,"min"),x=this._getMinMaxDate(d,"max");k=d.drawMonth-k;var w=d.drawYear;0>k&&(k+=12,w--);if(x){var A=this._daylightSavingAdjust(new Date(x.getFullYear(),x.getMonth()-p[0]*p[1]+1,x.getDate()));for(A=z&&A<z?z:A;this._daylightSavingAdjust(new Date(w,k,1))>A;)k--,0>k&&(k=11,w--)}d.drawMonth=k;d.drawYear=w;A=this._get(d,"prevText");A=m?this.formatDate(A,
this._daylightSavingAdjust(new Date(w,k-q,1)),this._getFormatConfig(d)):A;A=this._canAdjustMonth(d,-1,w,k)?a("<a>").attr({"class":"ui-datepicker-prev ui-corner-all","data-handler":"prev","data-event":"click",title:A}).append(a("<span>").addClass("ui-icon ui-icon-circle-triangle-"+(n?"e":"w")).text(A))[0].outerHTML:u?"":a("<a>").attr({"class":"ui-datepicker-prev ui-corner-all ui-state-disabled",title:A}).append(a("<span>").addClass("ui-icon ui-icon-circle-triangle-"+(n?"e":"w")).text(A))[0].outerHTML;
var G=this._get(d,"nextText");G=m?this.formatDate(G,this._daylightSavingAdjust(new Date(w,k+q,1)),this._getFormatConfig(d)):G;u=this._canAdjustMonth(d,1,w,k)?a("<a>").attr({"class":"ui-datepicker-next ui-corner-all","data-handler":"next","data-event":"click",title:G}).append(a("<span>").addClass("ui-icon ui-icon-circle-triangle-"+(n?"w":"e")).text(G))[0].outerHTML:u?"":a("<a>").attr({"class":"ui-datepicker-next ui-corner-all ui-state-disabled",title:G}).append(a("<span>").attr("class","ui-icon ui-icon-circle-triangle-"+
(n?"w":"e")).text(G))[0].outerHTML;q=this._get(d,"currentText");G=this._get(d,"gotoCurrent")&&d.currentDay?y:h;q=m?this.formatDate(q,G,this._getFormatConfig(d)):q;var E="";d.inline||(E=a("<button>").attr({type:"button","class":"ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all","data-handler":"hide","data-event":"click"}).text(this._get(d,"closeText"))[0].outerHTML);m="";l&&(m=a("<div class='ui-datepicker-buttonpane ui-widget-content'>").append(n?E:"").append(this._isInRange(d,
G)?a("<button>").attr({type:"button","class":"ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all","data-handler":"today","data-event":"click"}).text(q):"").append(n?"":E)[0].outerHTML);l=parseInt(this._get(d,"firstDay"),10);l=isNaN(l)?0:l;q=this._get(d,"showWeek");G=this._get(d,"dayNames");E=this._get(d,"dayNamesMin");var T=this._get(d,"monthNames");var K=this._get(d,"monthNamesShort");var I=this._get(d,"beforeShowDay");var Q=this._get(d,"showOtherMonths");var V=this._get(d,
"selectOtherMonths");var U=this._getDefaultDate(d);var D="";for(b=0;b<p[0];b++){var O="";this.maxRows=4;for(c=0;c<p[1];c++){var N=this._daylightSavingAdjust(new Date(w,k,d.selectedDay));var J=" ui-corner-all";var F="";if(v){F+="<div class='ui-datepicker-group";if(1<p[1])switch(c){case 0:F+=" ui-datepicker-group-first";J=" ui-corner-"+(n?"right":"left");break;case p[1]-1:F+=" ui-datepicker-group-last";J=" ui-corner-"+(n?"left":"right");break;default:F+=" ui-datepicker-group-middle",J=""}F+="'>"}F+=
"<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+J+"'>"+(/all|left/.test(J)&&0===b?n?u:A:"")+(/all|right/.test(J)&&0===b?n?A:u:"")+this._generateMonthYearHeader(d,k,w,z,x,0<b||0<c,T,K)+"</div><table class='ui-datepicker-calendar'><thead><tr>";var P=q?"<th class='ui-datepicker-week-col'>"+this._get(d,"weekHeader")+"</th>":"";for(J=0;7>J;J++){var X=(J+l)%7;P+="<th scope='col'"+(5<=(J+l+6)%7?" class='ui-datepicker-week-end'":"")+"><span title='"+G[X]+"'>"+E[X]+"</span></th>"}F+=
P+"</tr></thead><tbody>";P=this._getDaysInMonth(w,k);w===d.selectedYear&&k===d.selectedMonth&&(d.selectedDay=Math.min(d.selectedDay,P));J=(this._getFirstDayOfMonth(w,k)-l+7)%7;P=Math.ceil((J+P)/7);this.maxRows=P=v?this.maxRows>P?this.maxRows:P:P;X=this._daylightSavingAdjust(new Date(w,k,1-J));for(e=0;e<P;e++){F+="<tr>";var ha=q?"<td class='ui-datepicker-week-col'>"+this._get(d,"calculateWeek")(X)+"</td>":"";for(J=0;7>J;J++){var ua=I?I.apply(d.input?d.input[0]:null,[X]):[!0,""];var ta=(g=X.getMonth()!==
k)&&!V||!ua[0]||z&&X<z||x&&X>x;ha+="<td class='"+(5<=(J+l+6)%7?" ui-datepicker-week-end":"")+(g?" ui-datepicker-other-month":"")+(X.getTime()===N.getTime()&&k===d.selectedMonth&&d._keyEvent||U.getTime()===X.getTime()&&U.getTime()===N.getTime()?" "+this._dayOverClass:"")+(ta?" "+this._unselectableClass+" ui-state-disabled":"")+(g&&!Q?"":" "+ua[1]+(X.getTime()===y.getTime()?" "+this._currentClass:"")+(X.getTime()===h.getTime()?" ui-datepicker-today":""))+"'"+(g&&!Q||!ua[2]?"":" title='"+ua[2].replace(/'/g,
"&#39;")+"'")+(ta?"":" data-handler='selectDay' data-event='click' data-month='"+X.getMonth()+"' data-year='"+X.getFullYear()+"'")+">"+(g&&!Q?"&#xa0;":ta?"<span class='ui-state-default'>"+X.getDate()+"</span>":"<a class='ui-state-default"+(X.getTime()===h.getTime()?" ui-state-highlight":"")+(X.getTime()===y.getTime()?" ui-state-active":"")+(g?" ui-priority-secondary":"")+"' href='#' aria-current='"+(X.getTime()===y.getTime()?"true":"false")+"' data-date='"+X.getDate()+"'>"+X.getDate()+"</a>")+"</td>";
X.setDate(X.getDate()+1);X=this._daylightSavingAdjust(X)}F+=ha+"</tr>"}k++;11<k&&(k=0,w++);F+="</tbody></table>"+(v?"</div>"+(0<p[0]&&c===p[1]-1?"<div class='ui-datepicker-row-break'></div>":""):"");O+=F}D+=O}d._keyEvent=!1;return D+m},_generateMonthYearHeader:function(a,b,c,e,g,h,n,l){var d=this._get(a,"changeMonth"),f=this._get(a,"changeYear"),r=this._get(a,"showMonthAfterYear");var t=this._get(a,"selectMonthLabel");var m=this._get(a,"selectYearLabel"),p="<div class='ui-datepicker-title'>",k="";
if(h||!d)k+="<span class='ui-datepicker-month'>"+n[b]+"</span>";else{n=e&&e.getFullYear()===c;var q=g&&g.getFullYear()===c;k+="<select class='ui-datepicker-month' aria-label='"+t+"' data-handler='selectMonth' data-event='change'>";for(t=0;12>t;t++)(!n||t>=e.getMonth())&&(!q||t<=g.getMonth())&&(k+="<option value='"+t+"'"+(t===b?" selected='selected'":"")+">"+l[t]+"</option>");k+="</select>"}r||(p+=k+(!h&&d&&f?"":"&#xa0;"));if(!a.yearshtml)if(a.yearshtml="",h||!f)p+="<span class='ui-datepicker-year'>"+
c+"</span>";else{l=this._get(a,"yearRange").split(":");var v=(new Date).getFullYear();n=function(a){a=a.match(/c[+\-].*/)?c+parseInt(a.substring(1),10):a.match(/[+\-].*/)?v+parseInt(a,10):parseInt(a,10);return isNaN(a)?v:a};b=n(l[0]);l=Math.max(b,n(l[1]||""));b=e?Math.max(b,e.getFullYear()):b;l=g?Math.min(l,g.getFullYear()):l;for(a.yearshtml+="<select class='ui-datepicker-year' aria-label='"+m+"' data-handler='selectYear' data-event='change'>";b<=l;b++)a.yearshtml+="<option value='"+b+"'"+(b===c?
" selected='selected'":"")+">"+b+"</option>";a.yearshtml+="</select>";p+=a.yearshtml;a.yearshtml=null}p+=this._get(a,"yearSuffix");r&&(p+=(!h&&d&&f?"":"&#xa0;")+k);return p+"</div>"},_adjustInstDate:function(a,b,c){var d=a.selectedYear+("Y"===c?b:0),f=a.selectedMonth+("M"===c?b:0);b=Math.min(a.selectedDay,this._getDaysInMonth(d,f))+("D"===c?b:0);d=this._restrictMinMax(a,this._daylightSavingAdjust(new Date(d,f,b)));a.selectedDay=d.getDate();a.drawMonth=a.selectedMonth=d.getMonth();a.drawYear=a.selectedYear=
d.getFullYear();"M"!==c&&"Y"!==c||this._notifyChange(a)},_restrictMinMax:function(a,b){var d=this._getMinMaxDate(a,"min");a=this._getMinMaxDate(a,"max");b=d&&b<d?d:b;return a&&b>a?a:b},_notifyChange:function(a){var d=this._get(a,"onChangeMonthYear");d&&d.apply(a.input?a.input[0]:null,[a.selectedYear,a.selectedMonth+1,a])},_getNumberOfMonths:function(a){a=this._get(a,"numberOfMonths");return null==a?[1,1]:"number"===typeof a?[1,a]:a},_getMinMaxDate:function(a,b){return this._determineDate(a,this._get(a,
b+"Date"),null)},_getDaysInMonth:function(a,b){return 32-this._daylightSavingAdjust(new Date(a,b,32)).getDate()},_getFirstDayOfMonth:function(a,b){return(new Date(a,b,1)).getDay()},_canAdjustMonth:function(a,b,c,e){var d=this._getNumberOfMonths(a);c=this._daylightSavingAdjust(new Date(c,e+(0>b?b:d[0]*d[1]),1));0>b&&c.setDate(this._getDaysInMonth(c.getFullYear(),c.getMonth()));return this._isInRange(a,c)},_isInRange:function(a,b){var d=this._getMinMaxDate(a,"min"),f=this._getMinMaxDate(a,"max"),c=
null,e=null;if(a=this._get(a,"yearRange")){a=a.split(":");var g=(new Date).getFullYear();c=parseInt(a[0],10);e=parseInt(a[1],10);a[0].match(/[+\-].*/)&&(c+=g);a[1].match(/[+\-].*/)&&(e+=g)}return(!d||b.getTime()>=d.getTime())&&(!f||b.getTime()<=f.getTime())&&(!c||b.getFullYear()>=c)&&(!e||b.getFullYear()<=e)},_getFormatConfig:function(a){var d=this._get(a,"shortYearCutoff");d="string"!==typeof d?d:(new Date).getFullYear()%100+parseInt(d,10);return{shortYearCutoff:d,dayNamesShort:this._get(a,"dayNamesShort"),
dayNames:this._get(a,"dayNames"),monthNamesShort:this._get(a,"monthNamesShort"),monthNames:this._get(a,"monthNames")}},_formatDate:function(a,b,c,e){b||(a.currentDay=a.selectedDay,a.currentMonth=a.selectedMonth,a.currentYear=a.selectedYear);b=b?"object"===typeof b?b:this._daylightSavingAdjust(new Date(e,c,b)):this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return this.formatDate(this._get(a,"dateFormat"),b,this._getFormatConfig(a))}});a.fn.datepicker=function(d){if(!this.length)return this;
a.datepicker.initialized||(a(document).on("mousedown",a.datepicker._checkExternalClick),a.datepicker.initialized=!0);0===a("#"+a.datepicker._mainDivId).length&&a("body").append(a.datepicker.dpDiv);var b=Array.prototype.slice.call(arguments,1);return"string"===typeof d&&("isDisabled"===d||"getDate"===d||"widget"===d)||"option"===d&&2===arguments.length&&"string"===typeof arguments[1]?a.datepicker["_"+d+"Datepicker"].apply(a.datepicker,[this[0]].concat(b)):this.each(function(){"string"===typeof d?a.datepicker["_"+
d+"Datepicker"].apply(a.datepicker,[this].concat(b)):a.datepicker._attachDatepicker(this,d)})};a.datepicker=new m;a.datepicker.initialized=!1;a.datepicker.uuid=(new Date).getTime();a.datepicker.version="1.13.1";a.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());var F=!1;a(document).on("mouseup",function(){F=!1});a.widget("ui.mouse",{version:"1.13.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var d=this;this.element.on("mousedown."+
this.widgetName,function(a){return d._mouseDown(a)}).on("click."+this.widgetName,function(b){if(!0===a.data(b.target,d.widgetName+".preventClickEvent"))return a.removeData(b.target,d.widgetName+".preventClickEvent"),b.stopImmediatePropagation(),!1});this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName);this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(d){if(!F){this._mouseMoved=
!1;this._mouseStarted&&this._mouseUp(d);this._mouseDownEvent=d;var b=this,c=1===d.which,e="string"===typeof this.options.cancel&&d.target.nodeName?a(d.target).closest(this.options.cancel).length:!1;if(!c||e||!this._mouseCapture(d))return!0;this.mouseDelayMet=!this.options.delay;this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){b.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(d)&&this._mouseDelayMet(d)&&(this._mouseStarted=!1!==this._mouseStart(d),!this._mouseStarted))return d.preventDefault(),
!0;!0===a.data(d.target,this.widgetName+".preventClickEvent")&&a.removeData(d.target,this.widgetName+".preventClickEvent");this._mouseMoveDelegate=function(a){return b._mouseMove(a)};this._mouseUpDelegate=function(a){return b._mouseUp(a)};this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate);d.preventDefault();return F=!0}},_mouseMove:function(d){if(this._mouseMoved){if(a.ui.ie&&(!document.documentMode||9>document.documentMode)&&
!d.button)return this._mouseUp(d);if(!d.which)if(d.originalEvent.altKey||d.originalEvent.ctrlKey||d.originalEvent.metaKey||d.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(d)}if(d.which||d.button)this._mouseMoved=!0;if(this._mouseStarted)return this._mouseDrag(d),d.preventDefault();this._mouseDistanceMet(d)&&this._mouseDelayMet(d)&&((this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,d))?this._mouseDrag(d):this._mouseUp(d));return!this._mouseStarted},
_mouseUp:function(d){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate);this._mouseStarted&&(this._mouseStarted=!1,d.target===this._mouseDownEvent.target&&a.data(d.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(d));this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer);F=this.ignoreMissingWhich=!1;d.preventDefault()},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-
a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}});a.ui.plugin={add:function(d,b,c){var f;d=a.ui[d].prototype;for(f in c)d.plugins[f]=d.plugins[f]||[],d.plugins[f].push([b,c[f]])},call:function(a,b,c,e){if((b=a.plugins[b])&&(e||a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType))for(e=0;e<b.length;e++)a.options[b[e][0]]&&
b[e][1].apply(a.element,c)}};a.ui.safeBlur=function(d){d&&"body"!==d.nodeName.toLowerCase()&&a(d).trigger("blur")};a.widget("ui.draggable",a.ui.mouse,{version:"1.13.1",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,
stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative();this.options.addClasses&&this._addClass("ui-draggable");this._setHandleClassName();this._mouseInit()},_setOption:function(a,b){this._super(a,b);"handle"===a&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){(this.helper||this.element).is(".ui-draggable-dragging")?this.destroyOnClear=!0:(this._removeHandleClassName(),this._mouseDestroy())},
_mouseCapture:function(d){var b=this.options;if(this.helper||b.disabled||0<a(d.target).closest(".ui-resizable-handle").length)return!1;this.handle=this._getHandle(d);if(!this.handle)return!1;this._blurActiveElement(d);this._blockFrames(!0===b.iframeFix?"iframe":b.iframeFix);return!0},_blockFrames:function(d){this.iframeBlocks=this.document.find(d).map(function(){var d=a(this);return a("<div>").css("position","absolute").appendTo(d.parent()).outerWidth(d.outerWidth()).outerHeight(d.outerHeight()).offset(d.offset())[0]})},
_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(d){var b=a.ui.safeActiveElement(this.document[0]);a(d.target).closest(b).length||a.ui.safeBlur(b)},_mouseStart:function(d){var b=this.options;this.helper=this._createHelper(d);this._addClass(this.helper,"ui-draggable-dragging");this._cacheHelperProportions();a.ui.ddmanager&&(a.ui.ddmanager.current=this);this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=
this.helper.scrollParent(!0);this.offsetParent=this.helper.offsetParent();this.hasFixedAncestor=0<this.helper.parents().filter(function(){return"fixed"===a(this).css("position")}).length;this.positionAbs=this.element.offset();this._refreshOffsets(d);this.originalPosition=this.position=this._generatePosition(d,!1);this.originalPageX=d.pageX;this.originalPageY=d.pageY;b.cursorAt&&this._adjustOffsetFromHelper(b.cursorAt);this._setContainment();if(!1===this._trigger("start",d))return this._clear(),!1;
this._cacheHelperProportions();a.ui.ddmanager&&!b.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,d);this._mouseDrag(d,!0);a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,d);return!0},_refreshOffsets:function(a){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()};this.offset.click={left:a.pageX-this.offset.left,top:a.pageY-this.offset.top}},_mouseDrag:function(d,b){this.hasFixedAncestor&&
(this.offset.parent=this._getParentOffset());this.position=this._generatePosition(d,!0);this.positionAbs=this._convertPositionTo("absolute");if(!b){b=this._uiHash();if(!1===this._trigger("drag",d,b))return this._mouseUp(new a.Event("mouseup",d)),!1;this.position=b.position}this.helper[0].style.left=this.position.left+"px";this.helper[0].style.top=this.position.top+"px";a.ui.ddmanager&&a.ui.ddmanager.drag(this,d);return!1},_mouseStop:function(d){var b=this,c=!1;a.ui.ddmanager&&!this.options.dropBehaviour&&
(c=a.ui.ddmanager.drop(this,d));this.dropped&&(c=this.dropped,this.dropped=!1);"invalid"===this.options.revert&&!c||"valid"===this.options.revert&&c||!0===this.options.revert||"function"===typeof this.options.revert&&this.options.revert.call(this.element,c)?a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==b._trigger("stop",d)&&b._clear()}):!1!==this._trigger("stop",d)&&this._clear();return!1},_mouseUp:function(d){this._unblockFrames();a.ui.ddmanager&&
a.ui.ddmanager.dragStop(this,d);this.handleElement.is(d.target)&&this.element.trigger("focus");return a.ui.mouse.prototype._mouseUp.call(this,d)},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp(new a.Event("mouseup",{target:this.element[0]})):this._clear();return this},_getHandle:function(d){return this.options.handle?!!a(d.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):
this.element;this._addClass(this.handleElement,"ui-draggable-handle")},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle")},_createHelper:function(d){var b=this.options,c="function"===typeof b.helper;d=c?a(b.helper.apply(this.element[0],[d])):"clone"===b.helper?this.element.clone().removeAttr("id"):this.element;d.parents("body").length||d.appendTo("parent"===b.appendTo?this.element[0].parentNode:b.appendTo);c&&d[0]===this.element[0]&&this._setPositionRelative();
d[0]===this.element[0]||/(fixed|absolute)/.test(d.css("position"))||d.css("position","absolute");return d},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(a){"string"===typeof a&&(a=a.split(" "));Array.isArray(a)&&(a={left:+a[0],top:+a[1]||0});"left"in a&&(this.offset.click.left=a.left+this.margins.left);"right"in a&&(this.offset.click.left=this.helperProportions.width-a.right+this.margins.left);
"top"in a&&(this.offset.click.top=a.top+this.margins.top);"bottom"in a&&(this.offset.click.top=this.helperProportions.height-a.bottom+this.margins.top)},_isRootNode:function(a){return/(html|body)/i.test(a.tagName)||a===this.document[0]},_getParentOffset:function(){var d=this.offsetParent.offset(),b=this.document[0];"absolute"===this.cssPosition&&this.scrollParent[0]!==b&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(d.left+=this.scrollParent.scrollLeft(),d.top+=this.scrollParent.scrollTop());
this._isRootNode(this.offsetParent[0])&&(d={top:0,left:0});return{top:d.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:d.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var a=this.element.position(),b=this._isRootNode(this.scrollParent[0]);return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+(b?0:this.scrollParent.scrollTop()),left:a.left-(parseInt(this.helper.css("left"),
10)||0)+(b?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var d;var b=this.options;var c=this.document[0];this.relativeContainer=
null;if(b.containment)if("window"===b.containment)this.containment=[a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,a(window).scrollLeft()+a(window).width()-this.helperProportions.width-this.margins.left,a(window).scrollTop()+(a(window).height()||c.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];else if("document"===b.containment)this.containment=[0,0,a(c).width()-this.helperProportions.width-
this.margins.left,(a(c).height()||c.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];else if(b.containment.constructor===Array)this.containment=b.containment;else{if("parent"===b.containment&&(b.containment=this.helper[0].parentNode),c=a(b.containment),d=c[0])b=/(scroll|auto)/.test(c.css("overflow")),this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),
10)||0),(b?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(b?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=c}else this.containment=null},_convertPositionTo:function(a,
b){b||(b=this.position);a="absolute"===a?1:-1;var d=this._isRootNode(this.scrollParent[0]);return{top:b.top+this.offset.relative.top*a+this.offset.parent.top*a-("fixed"===this.cssPosition?-this.offset.scroll.top:d?0:this.offset.scroll.top)*a,left:b.left+this.offset.relative.left*a+this.offset.parent.left*a-("fixed"===this.cssPosition?-this.offset.scroll.left:d?0:this.offset.scroll.left)*a}},_generatePosition:function(a,b){var d=this.options,f=this._isRootNode(this.scrollParent[0]);var c=a.pageX;var e=
a.pageY;f&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()});if(b){if(this.containment){if(this.relativeContainer){var g=this.relativeContainer.offset();g=[this.containment[0]+g.left,this.containment[1]+g.top,this.containment[2]+g.left,this.containment[3]+g.top]}else g=this.containment;a.pageX-this.offset.click.left<g[0]&&(c=g[0]+this.offset.click.left);a.pageY-this.offset.click.top<g[1]&&(e=g[1]+this.offset.click.top);a.pageX-this.offset.click.left>
g[2]&&(c=g[2]+this.offset.click.left);a.pageY-this.offset.click.top>g[3]&&(e=g[3]+this.offset.click.top)}d.grid&&(e=d.grid[1]?this.originalPageY+Math.round((e-this.originalPageY)/d.grid[1])*d.grid[1]:this.originalPageY,e=g?e-this.offset.click.top>=g[1]||e-this.offset.click.top>g[3]?e:e-this.offset.click.top>=g[1]?e-d.grid[1]:e+d.grid[1]:e,c=d.grid[0]?this.originalPageX+Math.round((c-this.originalPageX)/d.grid[0])*d.grid[0]:this.originalPageX,c=g?c-this.offset.click.left>=g[0]||c-this.offset.click.left>
g[2]?c:c-this.offset.click.left>=g[0]?c-d.grid[0]:c+d.grid[0]:c);"y"===d.axis&&(c=this.originalPageX);"x"===d.axis&&(e=this.originalPageY)}return{top:e-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:f?0:this.offset.scroll.top),left:c-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:f?0:this.offset.scroll.left)}},_clear:function(){this._removeClass(this.helper,
"ui-draggable-dragging");this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove();this.helper=null;this.cancelHelperRemoval=!1;this.destroyOnClear&&this.destroy()},_trigger:function(d,b,c){c=c||this._uiHash();a.ui.plugin.call(this,d,[b,c,this],!0);/^(drag|start|stop)/.test(d)&&(this.positionAbs=this._convertPositionTo("absolute"),c.offset=this.positionAbs);return a.Widget.prototype._trigger.call(this,d,b,c)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,
originalPosition:this.originalPosition,offset:this.positionAbs}}});a.ui.plugin.add("draggable","connectToSortable",{start:function(d,b,c){var f=a.extend({},b,{item:c.element});c.sortables=[];a(c.options.connectToSortable).each(function(){var b=a(this).sortable("instance");b&&!b.options.disabled&&(c.sortables.push(b),b.refreshPositions(),b._trigger("activate",d,f))})},stop:function(d,b,c){var f=a.extend({},b,{item:c.element});c.cancelHelperRemoval=!1;a.each(c.sortables,function(){this.isOver?(this.isOver=
0,c.cancelHelperRemoval=!0,this.cancelHelperRemoval=!1,this._storedCSS={position:this.placeholder.css("position"),top:this.placeholder.css("top"),left:this.placeholder.css("left")},this._mouseStop(d),this.options.helper=this.options._helper):(this.cancelHelperRemoval=!0,this._trigger("deactivate",d,f))})},drag:function(d,b,c){a.each(c.sortables,function(){var f=!1,e=this;e.positionAbs=c.positionAbs;e.helperProportions=c.helperProportions;e.offset.click=c.offset.click;e._intersectsWith(e.containerCache)&&
(f=!0,a.each(c.sortables,function(){this.positionAbs=c.positionAbs;this.helperProportions=c.helperProportions;this.offset.click=c.offset.click;this!==e&&this._intersectsWith(this.containerCache)&&a.contains(e.element[0],this.element[0])&&(f=!1);return f}));f?(e.isOver||(e.isOver=1,c._parent=b.helper.parent(),e.currentItem=b.helper.appendTo(e.element).data("ui-sortable-item",!0),e.options._helper=e.options.helper,e.options.helper=function(){return b.helper[0]},d.target=e.currentItem[0],e._mouseCapture(d,
!0),e._mouseStart(d,!0,!0),e.offset.click.top=c.offset.click.top,e.offset.click.left=c.offset.click.left,e.offset.parent.left-=c.offset.parent.left-e.offset.parent.left,e.offset.parent.top-=c.offset.parent.top-e.offset.parent.top,c._trigger("toSortable",d),c.dropped=e.element,a.each(c.sortables,function(){this.refreshPositions()}),c.currentItem=c.element,e.fromOutside=c),e.currentItem&&(e._mouseDrag(d),b.position=e.position)):e.isOver&&(e.isOver=0,e.cancelHelperRemoval=!0,e.options._revert=e.options.revert,
e.options.revert=!1,e._trigger("out",d,e._uiHash(e)),e._mouseStop(d,!0),e.options.revert=e.options._revert,e.options.helper=e.options._helper,e.placeholder&&e.placeholder.remove(),b.helper.appendTo(c._parent),c._refreshOffsets(d),b.position=c._generatePosition(d,!0),c._trigger("fromSortable",d),c.dropped=!1,a.each(c.sortables,function(){this.refreshPositions()}))})}});a.ui.plugin.add("draggable","cursor",{start:function(d,b,c){d=a("body");c=c.options;d.css("cursor")&&(c._cursor=d.css("cursor"));d.css("cursor",
c.cursor)},stop:function(d,b,c){d=c.options;d._cursor&&a("body").css("cursor",d._cursor)}});a.ui.plugin.add("draggable","opacity",{start:function(d,b,c){d=a(b.helper);c=c.options;d.css("opacity")&&(c._opacity=d.css("opacity"));d.css("opacity",c.opacity)},stop:function(d,b,c){d=c.options;d._opacity&&a(b.helper).css("opacity",d._opacity)}});a.ui.plugin.add("draggable","scroll",{start:function(a,b,c){c.scrollParentNotHidden||(c.scrollParentNotHidden=c.helper.scrollParent(!1));c.scrollParentNotHidden[0]!==
c.document[0]&&"HTML"!==c.scrollParentNotHidden[0].tagName&&(c.overflowOffset=c.scrollParentNotHidden.offset())},drag:function(d,b,c){b=c.options;var f=!1,e=c.scrollParentNotHidden[0],g=c.document[0];e!==g&&"HTML"!==e.tagName?(b.axis&&"x"===b.axis||(c.overflowOffset.top+e.offsetHeight-d.pageY<b.scrollSensitivity?e.scrollTop=f=e.scrollTop+b.scrollSpeed:d.pageY-c.overflowOffset.top<b.scrollSensitivity&&(e.scrollTop=f=e.scrollTop-b.scrollSpeed)),b.axis&&"y"===b.axis||(c.overflowOffset.left+e.offsetWidth-
d.pageX<b.scrollSensitivity?e.scrollLeft=f=e.scrollLeft+b.scrollSpeed:d.pageX-c.overflowOffset.left<b.scrollSensitivity&&(e.scrollLeft=f=e.scrollLeft-b.scrollSpeed))):(b.axis&&"x"===b.axis||(d.pageY-a(g).scrollTop()<b.scrollSensitivity?f=a(g).scrollTop(a(g).scrollTop()-b.scrollSpeed):a(window).height()-(d.pageY-a(g).scrollTop())<b.scrollSensitivity&&(f=a(g).scrollTop(a(g).scrollTop()+b.scrollSpeed))),b.axis&&"y"===b.axis||(d.pageX-a(g).scrollLeft()<b.scrollSensitivity?f=a(g).scrollLeft(a(g).scrollLeft()-
b.scrollSpeed):a(window).width()-(d.pageX-a(g).scrollLeft())<b.scrollSensitivity&&(f=a(g).scrollLeft(a(g).scrollLeft()+b.scrollSpeed))));!1!==f&&a.ui.ddmanager&&!b.dropBehaviour&&a.ui.ddmanager.prepareOffsets(c,d)}});a.ui.plugin.add("draggable","snap",{start:function(d,b,c){d=c.options;c.snapElements=[];a(d.snap.constructor!==String?d.snap.items||":data(ui-draggable)":d.snap).each(function(){var d=a(this),b=d.offset();this!==c.element[0]&&c.snapElements.push({item:this,width:d.outerWidth(),height:d.outerHeight(),
top:b.top,left:b.left})})},drag:function(d,b,c){var f,e=c.options,g=e.snapTolerance,h=b.offset.left,l=h+c.helperProportions.width,u=b.offset.top,r=u+c.helperProportions.height;for(f=c.snapElements.length-1;0<=f;f--){var n=c.snapElements[f].left-c.margins.left;var m=n+c.snapElements[f].width;var p=c.snapElements[f].top-c.margins.top;var k=p+c.snapElements[f].height;if(l<n-g||h>m+g||r<p-g||u>k+g||!a.contains(c.snapElements[f].item.ownerDocument,c.snapElements[f].item))c.snapElements[f].snapping&&c.options.snap.release&&
c.options.snap.release.call(c.element,d,a.extend(c._uiHash(),{snapItem:c.snapElements[f].item})),c.snapElements[f].snapping=!1;else{if("inner"!==e.snapMode){var q=Math.abs(p-r)<=g;var v=Math.abs(k-u)<=g;var y=Math.abs(n-l)<=g;var z=Math.abs(m-h)<=g;q&&(b.position.top=c._convertPositionTo("relative",{top:p-c.helperProportions.height,left:0}).top);v&&(b.position.top=c._convertPositionTo("relative",{top:k,left:0}).top);y&&(b.position.left=c._convertPositionTo("relative",{top:0,left:n-c.helperProportions.width}).left);
z&&(b.position.left=c._convertPositionTo("relative",{top:0,left:m}).left)}var x=q||v||y||z;"outer"!==e.snapMode&&(q=Math.abs(p-u)<=g,v=Math.abs(k-r)<=g,y=Math.abs(n-h)<=g,z=Math.abs(m-l)<=g,q&&(b.position.top=c._convertPositionTo("relative",{top:p,left:0}).top),v&&(b.position.top=c._convertPositionTo("relative",{top:k-c.helperProportions.height,left:0}).top),y&&(b.position.left=c._convertPositionTo("relative",{top:0,left:n}).left),z&&(b.position.left=c._convertPositionTo("relative",{top:0,left:m-
c.helperProportions.width}).left));!c.snapElements[f].snapping&&(q||v||y||z||x)&&c.options.snap.snap&&c.options.snap.snap.call(c.element,d,a.extend(c._uiHash(),{snapItem:c.snapElements[f].item}));c.snapElements[f].snapping=q||v||y||z||x}}}});a.ui.plugin.add("draggable","stack",{start:function(d,b,c){d=a.makeArray(a(c.options.stack)).sort(function(d,b){return(parseInt(a(d).css("zIndex"),10)||0)-(parseInt(a(b).css("zIndex"),10)||0)});if(d.length){var f=parseInt(a(d[0]).css("zIndex"),10)||0;a(d).each(function(d){a(this).css("zIndex",
f+d)});this.css("zIndex",f+d.length)}}});a.ui.plugin.add("draggable","zIndex",{start:function(d,b,c){d=a(b.helper);c=c.options;d.css("zIndex")&&(c._zIndex=d.css("zIndex"));d.css("zIndex",c.zIndex)},stop:function(d,b,c){d=c.options;d._zIndex&&a(b.helper).css("zIndex",d._zIndex)}});a.widget("ui.resizable",a.ui.mouse,{version:"1.13.1",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},
containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(a){return parseFloat(a)||0},_isNumber:function(a){return!isNaN(parseFloat(a))},_hasScroll:function(d,b){if("hidden"===a(d).css("overflow"))return!1;b=b&&"left"===b?"scrollLeft":"scrollTop";var f=!1;if(0<d[b])return!0;try{d[b]=1,f=0<d[b],d[b]=0}catch(t){}return f},_create:function(){var d=this.options,b=this;this._addClass("ui-resizable");
a.extend(this,{_aspectRatio:!!d.aspectRatio,aspectRatio:d.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:d.helper||d.ghost||d.animate?d.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)){this.element.wrap(a("<div class='ui-wrapper'></div>").css({overflow:"hidden",position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));
this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance"));this.elementIsWrapper=!0;var c={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")};this.element.css(c);this.originalElement.css("margin",0);this.originalResizeStyle=this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",
zoom:1,display:"block"}));this.originalElement.css(c);this._proportionallyResize()}this._setupHandles();if(d.autoHide)a(this.element).on("mouseenter",function(){d.disabled||(b._removeClass("ui-resizable-autohide"),b._handles.show())}).on("mouseleave",function(){d.disabled||b.resizing||(b._addClass("ui-resizable-autohide"),b._handles.hide())});this._mouseInit()},_destroy:function(){this._mouseDestroy();this._addedHandles.remove();var d=function(d){a(d).removeData("resizable").removeData("ui-resizable").off(".resizable")};
if(this.elementIsWrapper){d(this.element);var b=this.element;this.originalElement.css({position:b.css("position"),width:b.outerWidth(),height:b.outerHeight(),top:b.css("top"),left:b.css("left")}).insertAfter(b);b.remove()}this.originalElement.css("resize",this.originalResizeStyle);d(this.originalElement);return this},_setOption:function(a,b){this._super(a,b);switch(a){case "handles":this._removeHandles();this._setupHandles();break;case "aspectRatio":this._aspectRatio=!!b}},_setupHandles:function(){var d=
this.options,b,c=this;this.handles=d.handles||(a(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se");this._handles=a();this._addedHandles=a();if(this.handles.constructor===String){"all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw");var e=this.handles.split(",");this.handles={};for(b=0;b<e.length;b++){var g=String.prototype.trim.call(e[b]);
var h="ui-resizable-"+g;var n=a("<div>");this._addClass(n,"ui-resizable-handle "+h);n.css({zIndex:d.zIndex});this.handles[g]=".ui-resizable-"+g;this.element.children(this.handles[g]).length||(this.element.append(n),this._addedHandles=this._addedHandles.add(n))}}this._renderAxis=function(d){var b;d=d||this.element;for(b in this.handles){if(this.handles[b].constructor===String)this.handles[b]=this.element.children(this.handles[b]).first().show();else if(this.handles[b].jquery||this.handles[b].nodeType)this.handles[b]=
a(this.handles[b]),this._on(this.handles[b],{mousedown:c._mouseDown});if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)){var f=a(this.handles[b],this.element);var l=/sw|ne|nw|se|n|s/.test(b)?f.outerHeight():f.outerWidth();f=["padding",/ne|nw|n/.test(b)?"Top":/se|sw|s/.test(b)?"Bottom":/^e$/.test(b)?"Right":"Left"].join("");d.css(f,l);this._proportionallyResize()}this._handles=this._handles.add(this.handles[b])}};this._renderAxis(this.element);this._handles=
this._handles.add(this.element.find(".ui-resizable-handle"));this._handles.disableSelection();this._handles.on("mouseover",function(){c.resizing||(this.className&&(n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),c.axis=n&&n[1]?n[1]:"se")});d.autoHide&&(this._handles.hide(),this._addClass("ui-resizable-autohide"))},_removeHandles:function(){this._addedHandles.remove()},_mouseCapture:function(d){var b,c=!1;for(b in this.handles){var e=a(this.handles[b])[0];if(e===d.target||a.contains(e,
d.target))c=!0}return!this.options.disabled&&c},_mouseStart:function(d){var b=this.options,c=this.element;this.resizing=!0;this._renderProxy();var e=this._num(this.helper.css("left"));var g=this._num(this.helper.css("top"));b.containment&&(e+=a(b.containment).scrollLeft()||0,g+=a(b.containment).scrollTop()||0);this.offset=this.helper.offset();this.position={left:e,top:g};this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:c.width(),height:c.height()};this.originalSize=
this._helper?{width:c.outerWidth(),height:c.outerHeight()}:{width:c.width(),height:c.height()};this.sizeDiff={width:c.outerWidth()-c.width(),height:c.outerHeight()-c.height()};this.originalPosition={left:e,top:g};this.originalMousePosition={left:d.pageX,top:d.pageY};this.aspectRatio="number"===typeof b.aspectRatio?b.aspectRatio:this.originalSize.width/this.originalSize.height||1;e=a(".ui-resizable-"+this.axis).css("cursor");a("body").css("cursor","auto"===e?this.axis+"-resize":e);this._addClass("ui-resizable-resizing");
this._propagate("start",d);return!0},_mouseDrag:function(d){var b=this.originalMousePosition;var c=d.pageX-b.left||0;b=d.pageY-b.top||0;var e=this._change[this.axis];this._updatePrevProperties();if(!e)return!1;c=e.apply(this,[d,c,b]);this._updateVirtualBoundaries(d.shiftKey);if(this._aspectRatio||d.shiftKey)c=this._updateRatio(c,d);c=this._respectSize(c,d);this._updateCache(c);this._propagate("resize",d);c=this._applyChanges();!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize();
a.isEmptyObject(c)||(this._updatePrevProperties(),this._trigger("resize",d,this.ui()),this._applyChanges());return!1},_mouseStop:function(d){this.resizing=!1;var b,c=this.options;if(this._helper){var e=this._proportionallyResizeElements;e=(b=e.length&&/textarea/i.test(e[0].nodeName))&&this._hasScroll(e[0],"left")?0:this.sizeDiff.height;b=b?0:this.sizeDiff.width;b={width:this.helper.width()-b,height:this.helper.height()-e};e=parseFloat(this.element.css("left"))+(this.position.left-this.originalPosition.left)||
null;var g=parseFloat(this.element.css("top"))+(this.position.top-this.originalPosition.top)||null;c.animate||this.element.css(a.extend(b,{top:g,left:e}));this.helper.height(this.size.height);this.helper.width(this.size.width);this._helper&&!c.animate&&this._proportionallyResize()}a("body").css("cursor","auto");this._removeClass("ui-resizable-resizing");this._propagate("stop",d);this._helper&&this.helper.remove();return!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,
left:this.position.left};this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var a={};this.position.top!==this.prevPosition.top&&(a.top=this.position.top+"px");this.position.left!==this.prevPosition.left&&(a.left=this.position.left+"px");this.size.width!==this.prevSize.width&&(a.width=this.size.width+"px");this.size.height!==this.prevSize.height&&(a.height=this.size.height+"px");this.helper.css(a);return a},_updateVirtualBoundaries:function(a){var d=this.options;
d={minWidth:this._isNumber(d.minWidth)?d.minWidth:0,maxWidth:this._isNumber(d.maxWidth)?d.maxWidth:Infinity,minHeight:this._isNumber(d.minHeight)?d.minHeight:0,maxHeight:this._isNumber(d.maxHeight)?d.maxHeight:Infinity};if(this._aspectRatio||a){a=d.minHeight*this.aspectRatio;var b=d.minWidth/this.aspectRatio;var c=d.maxHeight*this.aspectRatio;var e=d.maxWidth/this.aspectRatio;a>d.minWidth&&(d.minWidth=a);b>d.minHeight&&(d.minHeight=b);c<d.maxWidth&&(d.maxWidth=c);e<d.maxHeight&&(d.maxHeight=e)}this._vBoundaries=
d},_updateCache:function(a){this.offset=this.helper.offset();this._isNumber(a.left)&&(this.position.left=a.left);this._isNumber(a.top)&&(this.position.top=a.top);this._isNumber(a.height)&&(this.size.height=a.height);this._isNumber(a.width)&&(this.size.width=a.width)},_updateRatio:function(a){var d=this.position,b=this.size,c=this.axis;this._isNumber(a.height)?a.width=a.height*this.aspectRatio:this._isNumber(a.width)&&(a.height=a.width/this.aspectRatio);"sw"===c&&(a.left=d.left+(b.width-a.width),a.top=
null);"nw"===c&&(a.top=d.top+(b.height-a.height),a.left=d.left+(b.width-a.width));return a},_respectSize:function(a){var d=this._vBoundaries,b=this.axis,c=this._isNumber(a.width)&&d.maxWidth&&d.maxWidth<a.width,e=this._isNumber(a.height)&&d.maxHeight&&d.maxHeight<a.height,g=this._isNumber(a.width)&&d.minWidth&&d.minWidth>a.width,h=this._isNumber(a.height)&&d.minHeight&&d.minHeight>a.height,l=this.originalPosition.left+this.originalSize.width,u=this.originalPosition.top+this.originalSize.height,n=
/sw|nw|w/.test(b);b=/nw|ne|n/.test(b);g&&(a.width=d.minWidth);h&&(a.height=d.minHeight);c&&(a.width=d.maxWidth);e&&(a.height=d.maxHeight);g&&n&&(a.left=l-d.minWidth);c&&n&&(a.left=l-d.maxWidth);h&&b&&(a.top=u-d.minHeight);e&&b&&(a.top=u-d.maxHeight);a.width||a.height||a.left||!a.top?a.width||a.height||a.top||!a.left||(a.left=null):a.top=null;return a},_getPaddingPlusBorderDimensions:function(a){var d=0,b=[],c=[a.css("borderTopWidth"),a.css("borderRightWidth"),a.css("borderBottomWidth"),a.css("borderLeftWidth")];
for(a=[a.css("paddingTop"),a.css("paddingRight"),a.css("paddingBottom"),a.css("paddingLeft")];4>d;d++)b[d]=parseFloat(c[d])||0,b[d]+=parseFloat(a[d])||0;return{height:b[0]+b[2],width:b[1]+b[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var a,b=0,c=this.helper||this.element;b<this._proportionallyResizeElements.length;b++)a=this._proportionallyResizeElements[b],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(a)),a.css({height:c.height()-
this.outerDimensions.height||0,width:c.width()-this.outerDimensions.width||0})},_renderProxy:function(){var d=this.options;this.elementOffset=this.element.offset();this._helper?(this.helper=this.helper||a("<div></div>").css({overflow:"hidden"}),this._addClass(this.helper,this._helper),this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++d.zIndex}),this.helper.appendTo("body").disableSelection()):
this.helper=this.element},_change:{e:function(a,b){return{width:this.originalSize.width+b}},w:function(a,b){return{left:this.originalPosition.left+b,width:this.originalSize.width-b}},n:function(a,b,c){return{top:this.originalPosition.top+c,height:this.originalSize.height-c}},s:function(a,b,c){return{height:this.originalSize.height+c}},se:function(d,b,c){return a.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[d,b,c]))},sw:function(d,b,c){return a.extend(this._change.s.apply(this,
arguments),this._change.w.apply(this,[d,b,c]))},ne:function(d,b,c){return a.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[d,b,c]))},nw:function(d,b,c){return a.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[d,b,c]))}},_propagate:function(d,b){a.ui.plugin.call(this,d,[b,this.ui()]);"resize"!==d&&this._trigger(d,b,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,
size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});a.ui.plugin.add("resizable","animate",{stop:function(d){var b=a(this).resizable("instance"),c=b.options,e=b._proportionallyResizeElements,g=e.length&&/textarea/i.test(e[0].nodeName),h=g&&b._hasScroll(e[0],"left")?0:b.sizeDiff.height;g={width:b.size.width-(g?0:b.sizeDiff.width),height:b.size.height-h};h=parseFloat(b.element.css("left"))+(b.position.left-b.originalPosition.left)||null;var n=parseFloat(b.element.css("top"))+
(b.position.top-b.originalPosition.top)||null;b.element.animate(a.extend(g,n&&h?{top:n,left:h}:{}),{duration:c.animateDuration,easing:c.animateEasing,step:function(){var c={width:parseFloat(b.element.css("width")),height:parseFloat(b.element.css("height")),top:parseFloat(b.element.css("top")),left:parseFloat(b.element.css("left"))};e&&e.length&&a(e[0]).css({width:c.width,height:c.height});b._updateCache(c);b._propagate("resize",d)}})}});a.ui.plugin.add("resizable","containment",{start:function(){var d=
a(this).resizable("instance"),b=d.element;var c=d.options.containment;if(b=c instanceof a?c.get(0):/parent/.test(c)?b.parent().get(0):c)if(d.containerElement=a(b),/document/.test(c)||c===document)d.containerOffset={left:0,top:0},d.containerPosition={left:0,top:0},d.parentData={element:a(document),left:0,top:0,width:a(document).width(),height:a(document).height()||document.body.parentNode.scrollHeight};else{var e=a(b);var g=[];a(["Top","Right","Left","Bottom"]).each(function(a,b){g[a]=d._num(e.css("padding"+
b))});d.containerOffset=e.offset();d.containerPosition=e.position();d.containerSize={height:e.innerHeight()-g[3],width:e.innerWidth()-g[1]};c=d.containerOffset;var h=d.containerSize.height;var n=d.containerSize.width;n=d._hasScroll(b,"left")?b.scrollWidth:n;h=d._hasScroll(b)?b.scrollHeight:h;d.parentData={element:b,left:c.left,top:c.top,width:n,height:h}}},resize:function(d){var b=a(this).resizable("instance");var c=b.options;var e=b.containerOffset;var g=b.position;d=b._aspectRatio||d.shiftKey;var h=
{top:0,left:0},n=b.containerElement,l=!0;n[0]!==document&&/static/.test(n.css("position"))&&(h=e);g.left<(b._helper?e.left:0)&&(b.size.width+=b._helper?b.position.left-e.left:b.position.left-h.left,d&&(b.size.height=b.size.width/b.aspectRatio,l=!1),b.position.left=c.helper?e.left:0);g.top<(b._helper?e.top:0)&&(b.size.height+=b._helper?b.position.top-e.top:b.position.top,d&&(b.size.width=b.size.height*b.aspectRatio,l=!1),b.position.top=b._helper?e.top:0);c=b.containerElement.get(0)===b.element.parent().get(0);
g=/relative|absolute/.test(b.containerElement.css("position"));c&&g?(b.offset.left=b.parentData.left+b.position.left,b.offset.top=b.parentData.top+b.position.top):(b.offset.left=b.element.offset().left,b.offset.top=b.element.offset().top);c=Math.abs(b.sizeDiff.width+(b._helper?b.offset.left-h.left:b.offset.left-e.left));e=Math.abs(b.sizeDiff.height+(b._helper?b.offset.top-h.top:b.offset.top-e.top));c+b.size.width>=b.parentData.width&&(b.size.width=b.parentData.width-c,d&&(b.size.height=b.size.width/
b.aspectRatio,l=!1));e+b.size.height>=b.parentData.height&&(b.size.height=b.parentData.height-e,d&&(b.size.width=b.size.height*b.aspectRatio,l=!1));l||(b.position.left=b.prevPosition.left,b.position.top=b.prevPosition.top,b.size.width=b.prevSize.width,b.size.height=b.prevSize.height)},stop:function(){var d=a(this).resizable("instance"),b=d.options,c=d.containerOffset,e=d.containerPosition,g=d.containerElement,h=a(d.helper),n=h.offset(),l=h.outerWidth()-d.sizeDiff.width;h=h.outerHeight()-d.sizeDiff.height;
d._helper&&!b.animate&&/relative/.test(g.css("position"))&&a(this).css({left:n.left-e.left-c.left,width:l,height:h});d._helper&&!b.animate&&/static/.test(g.css("position"))&&a(this).css({left:n.left-e.left-c.left,width:l,height:h})}});a.ui.plugin.add("resizable","alsoResize",{start:function(){var d=a(this).resizable("instance").options;a(d.alsoResize).each(function(){var d=a(this);d.data("ui-resizable-alsoresize",{width:parseFloat(d.width()),height:parseFloat(d.height()),left:parseFloat(d.css("left")),
top:parseFloat(d.css("top"))})})},resize:function(d,b){d=a(this).resizable("instance");var c=d.originalSize,f=d.originalPosition,e={height:d.size.height-c.height||0,width:d.size.width-c.width||0,top:d.position.top-f.top||0,left:d.position.left-f.left||0};a(d.options.alsoResize).each(function(){var d=a(this),c=a(this).data("ui-resizable-alsoresize"),f={},g=d.parents(b.originalElement[0]).length?["width","height"]:["width","height","top","left"];a.each(g,function(a,d){(a=(c[d]||0)+(e[d]||0))&&0<=a&&
(f[d]=a||null)});d.css(f)})},stop:function(){a(this).removeData("ui-resizable-alsoresize")}});a.ui.plugin.add("resizable","ghost",{start:function(){var d=a(this).resizable("instance"),b=d.size;d.ghost=d.originalElement.clone();d.ghost.css({opacity:.25,display:"block",position:"relative",height:b.height,width:b.width,margin:0,left:0,top:0});d._addClass(d.ghost,"ui-resizable-ghost");!1!==a.uiBackCompat&&"string"===typeof d.options.ghost&&d.ghost.addClass(this.options.ghost);d.ghost.appendTo(d.helper)},
resize:function(){var d=a(this).resizable("instance");d.ghost&&d.ghost.css({position:"relative",height:d.size.height,width:d.size.width})},stop:function(){var d=a(this).resizable("instance");d.ghost&&d.helper&&d.helper.get(0).removeChild(d.ghost.get(0))}});a.ui.plugin.add("resizable","grid",{resize:function(){var d=a(this).resizable("instance"),b=d.options,c=d.size,e=d.originalSize,g=d.originalPosition,h=d.axis,n="number"===typeof b.grid?[b.grid,b.grid]:b.grid,l=n[0]||1,u=n[1]||1,m=Math.round((c.width-
e.width)/l)*l;c=Math.round((c.height-e.height)/u)*u;var p=e.width+m,k=e.height+c,q=b.maxWidth&&b.maxWidth<p,v=b.maxHeight&&b.maxHeight<k,y=b.minWidth&&b.minWidth>p,z=b.minHeight&&b.minHeight>k;b.grid=n;y&&(p+=l);z&&(k+=u);q&&(p-=l);v&&(k-=u);if(/^(se|s|e)$/.test(h))d.size.width=p,d.size.height=k;else if(/^(ne)$/.test(h))d.size.width=p,d.size.height=k,d.position.top=g.top-c;else if(/^(sw)$/.test(h))d.size.width=p,d.size.height=k,d.position.left=g.left-m;else{if(0>=k-u||0>=p-l)var x=d._getPaddingPlusBorderDimensions(this);
0<k-u?(d.size.height=k,d.position.top=g.top-c):(k=u-x.height,d.size.height=k,d.position.top=g.top+e.height-k);0<p-l?(d.size.width=p,d.position.left=g.left-m):(p=l-x.width,d.size.width=p,d.position.left=g.left+e.width-p)}}});a.widget("ui.dialog",{version:"1.13.1",options:{appendTo:"body",autoOpen:!0,buttons:[],classes:{"ui-dialog":"ui-corner-all","ui-dialog-titlebar":"ui-corner-all"},closeOnEscape:!0,closeText:"Close",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,
minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(d){var b=a(this).css(d).offset().top;0>b&&a(this).css("top",d.top-b)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,
minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height};this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)};this.originalTitle=this.element.attr("title");null==this.options.title&&null!=this.originalTitle&&(this.options.title=this.originalTitle);this.options.disabled&&
(this.options.disabled=!1);this._createWrapper();this.element.show().removeAttr("title").appendTo(this.uiDialog);this._addClass("ui-dialog-content","ui-widget-content");this._createTitlebar();this._createButtonPane();this.options.draggable&&a.fn.draggable&&this._makeDraggable();this.options.resizable&&a.fn.resizable&&this._makeResizable();this._isOpen=!1;this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var d=this.options.appendTo;return d&&(d.jquery||d.nodeType)?
a(d):this.document.find(d||"body").eq(0)},_destroy:function(){var a=this.originalPosition;this._untrackInstance();this._destroyOverlay();this.element.removeUniqueId().css(this.originalCss).detach();this.uiDialog.remove();this.originalTitle&&this.element.attr("title",this.originalTitle);var b=a.parent.children().eq(a.index);b.length&&b[0]!==this.element[0]?b.before(this.element):a.parent.append(this.element)},widget:function(){return this.uiDialog},disable:a.noop,enable:a.noop,close:function(d){var b=
this;this._isOpen&&!1!==this._trigger("beforeClose",d)&&(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),this.opener.filter(":focusable").trigger("focus").length||a.ui.safeBlur(a.ui.safeActiveElement(this.document[0])),this._hide(this.uiDialog,this.options.hide,function(){b._trigger("close",d)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(d,b){var c=!1,f=this.uiDialog.siblings(".ui-front:visible").map(function(){return+a(this).css("z-index")}).get();
f=Math.max.apply(null,f);f>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",f+1),c=!0);c&&!b&&this._trigger("focus",d);return c},open:function(){var d=this;this._isOpen?this._moveToTop()&&this._focusTabbable():(this._isOpen=!0,this.opener=a(a.ui.safeActiveElement(this.document[0])),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){d._focusTabbable();
d._trigger("focus")}),this._makeFocusTarget(),this._trigger("open"))},_focusTabbable:function(){var a=this._focusedElement;a||(a=this.element.find("[autofocus]"));a.length||(a=this.element.find(":tabbable"));a.length||(a=this.uiDialogButtonPane.find(":tabbable"));a.length||(a=this.uiDialogTitlebarClose.filter(":tabbable"));a.length||(a=this.uiDialog);a.eq(0).trigger("focus")},_restoreTabbableFocus:function(){var d=a.ui.safeActiveElement(this.document[0]);this.uiDialog[0]===d||a.contains(this.uiDialog[0],
d)||this._focusTabbable()},_keepFocus:function(a){a.preventDefault();this._restoreTabbableFocus();this._delay(this._restoreTabbableFocus)},_createWrapper:function(){this.uiDialog=a("<div>").hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo());this._addClass(this.uiDialog,"ui-dialog","ui-widget ui-widget-content ui-front");this._on(this.uiDialog,{keydown:function(d){if(this.options.closeOnEscape&&!d.isDefaultPrevented()&&d.keyCode&&d.keyCode===a.ui.keyCode.ESCAPE)d.preventDefault(),
this.close(d);else if(d.keyCode===a.ui.keyCode.TAB&&!d.isDefaultPrevented()){var b=this.uiDialog.find(":tabbable"),c=b.first(),e=b.last();d.target!==e[0]&&d.target!==this.uiDialog[0]||d.shiftKey?d.target!==c[0]&&d.target!==this.uiDialog[0]||!d.shiftKey||(this._delay(function(){e.trigger("focus")}),d.preventDefault()):(this._delay(function(){c.trigger("focus")}),d.preventDefault())}},mousedown:function(a){this._moveToTop(a)&&this._focusTabbable()}});this.element.find("[aria-describedby]").length||
this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){this.uiDialogTitlebar=a("<div>");this._addClass(this.uiDialogTitlebar,"ui-dialog-titlebar","ui-widget-header ui-helper-clearfix");this._on(this.uiDialogTitlebar,{mousedown:function(d){a(d.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.trigger("focus")}});this.uiDialogTitlebarClose=a("<button type='button'></button>").button({label:a("<a>").text(this.options.closeText).html(),icon:"ui-icon-closethick",
showLabel:!1}).appendTo(this.uiDialogTitlebar);this._addClass(this.uiDialogTitlebarClose,"ui-dialog-titlebar-close");this._on(this.uiDialogTitlebarClose,{click:function(a){a.preventDefault();this.close(a)}});var d=a("<span>").uniqueId().prependTo(this.uiDialogTitlebar);this._addClass(d,"ui-dialog-title");this._title(d);this.uiDialogTitlebar.prependTo(this.uiDialog);this.uiDialog.attr({"aria-labelledby":d.attr("id")})},_title:function(a){this.options.title?a.text(this.options.title):a.html("&#160;")},
_createButtonPane:function(){this.uiDialogButtonPane=a("<div>");this._addClass(this.uiDialogButtonPane,"ui-dialog-buttonpane","ui-widget-content ui-helper-clearfix");this.uiButtonSet=a("<div>").appendTo(this.uiDialogButtonPane);this._addClass(this.uiButtonSet,"ui-dialog-buttonset");this._createButtons()},_createButtons:function(){var d=this,b=this.options.buttons;this.uiDialogButtonPane.remove();this.uiButtonSet.empty();a.isEmptyObject(b)||Array.isArray(b)&&!b.length?this._removeClass(this.uiDialog,
"ui-dialog-buttons"):(a.each(b,function(b,c){c="function"===typeof c?{click:c,text:b}:c;c=a.extend({type:"button"},c);var f=c.click;b={icon:c.icon,iconPosition:c.iconPosition,showLabel:c.showLabel,icons:c.icons,text:c.text};delete c.click;delete c.icon;delete c.iconPosition;delete c.showLabel;delete c.icons;"boolean"===typeof c.text&&delete c.text;a("<button></button>",c).button(b).appendTo(d.uiButtonSet).on("click",function(){f.apply(d.element[0],arguments)})}),this._addClass(this.uiDialog,"ui-dialog-buttons"),
this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function d(a){return{position:a.position,offset:a.offset}}var b=this,c=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(c,f){b._addClass(a(this),"ui-dialog-dragging");b._blockFrames();b._trigger("dragStart",c,d(f))},drag:function(a,c){b._trigger("drag",a,d(c))},stop:function(f,e){var g=e.offset.left-b.document.scrollLeft(),
h=e.offset.top-b.document.scrollTop();c.position={my:"left top",at:"left"+(0<=g?"+":"")+g+" top"+(0<=h?"+":"")+h,of:b.window};b._removeClass(a(this),"ui-dialog-dragging");b._unblockFrames();b._trigger("dragStop",f,d(e))}})},_makeResizable:function(){function d(a){return{originalPosition:a.originalPosition,originalSize:a.originalSize,position:a.position,size:a.size}}var b=this,c=this.options,e=c.resizable,g=this.uiDialog.css("position");e="string"===typeof e?e:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",
containment:"document",alsoResize:this.element,maxWidth:c.maxWidth,maxHeight:c.maxHeight,minWidth:c.minWidth,minHeight:this._minHeight(),handles:e,start:function(c,f){b._addClass(a(this),"ui-dialog-resizing");b._blockFrames();b._trigger("resizeStart",c,d(f))},resize:function(a,c){b._trigger("resize",a,d(c))},stop:function(f,e){var l=b.uiDialog.offset(),g=l.left-b.document.scrollLeft();l=l.top-b.document.scrollTop();c.height=b.uiDialog.height();c.width=b.uiDialog.width();c.position={my:"left top",
at:"left"+(0<=g?"+":"")+g+" top"+(0<=l?"+":"")+l,of:b.window};b._removeClass(a(this),"ui-dialog-resizing");b._unblockFrames();b._trigger("resizeStop",f,d(e))}}).css("position",g)},_trackFocus:function(){this._on(this.widget(),{focusin:function(d){this._makeFocusTarget();this._focusedElement=a(d.target)}})},_makeFocusTarget:function(){this._untrackInstance();this._trackingInstances().unshift(this)},_untrackInstance:function(){var d=this._trackingInstances(),b=a.inArray(this,d);-1!==b&&d.splice(b,1)},
_trackingInstances:function(){var a=this.document.data("ui-dialog-instances");a||(a=[],this.document.data("ui-dialog-instances",a));return a},_minHeight:function(){var a=this.options;return"auto"===a.height?a.minHeight:Math.min(a.minHeight,a.height)},_position:function(){var a=this.uiDialog.is(":visible");a||this.uiDialog.show();this.uiDialog.position(this.options.position);a||this.uiDialog.hide()},_setOptions:function(d){var b=this,c=!1,e={};a.each(d,function(a,d){b._setOption(a,d);a in b.sizeRelatedOptions&&
(c=!0);a in b.resizableRelatedOptions&&(e[a]=d)});c&&(this._size(),this._position());this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",e)},_setOption:function(d,b){var c,f=this.uiDialog;"disabled"!==d&&(this._super(d,b),"appendTo"===d&&this.uiDialog.appendTo(this._appendTo()),"buttons"===d&&this._createButtons(),"closeText"===d&&this.uiDialogTitlebarClose.button({label:a("<a>").text(""+this.options.closeText).html()}),"draggable"===d&&((c=f.is(":data(ui-draggable)"))&&!b&&
f.draggable("destroy"),!c&&b&&this._makeDraggable()),"position"===d&&this._position(),"resizable"===d&&((c=f.is(":data(ui-resizable)"))&&!b&&f.resizable("destroy"),c&&"string"===typeof b&&f.resizable("option","handles",b),c||!1===b||this._makeResizable()),"title"===d&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var a=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0});a.minWidth>a.width&&(a.width=a.minWidth);var b=this.uiDialog.css({height:"auto",
width:a.width}).outerHeight();var c=Math.max(0,a.minHeight-b);var e="number"===typeof a.maxHeight?Math.max(0,a.maxHeight-b):"none";"auto"===a.height?this.element.css({minHeight:c,maxHeight:e,height:"auto"}):this.element.height(Math.max(0,a.height-b));this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var d=a(this);return a("<div>").css({position:"absolute",width:d.outerWidth(),
height:d.outerHeight()}).appendTo(d.parent()).offset(d.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(d){return a(d.target).closest(".ui-dialog").length?!0:!!a(d.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var d=a.fn.jquery.substring(0,4),b=!0;this._delay(function(){b=!1});if(!this.document.data("ui-dialog-overlays"))this.document.on("focusin.ui-dialog",function(a){if(!b){var c=
this._trackingInstances()[0];c._allowInteraction(a)||(a.preventDefault(),c._focusTabbable(),"3.4."!==d&&"3.5."!==d||c._delay(c._restoreTabbableFocus))}}.bind(this));this.overlay=a("<div>").appendTo(this._appendTo());this._addClass(this.overlay,null,"ui-widget-overlay ui-front");this._on(this.overlay,{mousedown:"_keepFocus"});this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var a=this.document.data("ui-dialog-overlays")-
1;a?this.document.data("ui-dialog-overlays",a):(this.document.off("focusin.ui-dialog"),this.document.removeData("ui-dialog-overlays"));this.overlay.remove();this.overlay=null}}});!1!==a.uiBackCompat&&a.widget("ui.dialog",a.ui.dialog,{options:{dialogClass:""},_createWrapper:function(){this._super();this.uiDialog.addClass(this.options.dialogClass)},_setOption:function(a,b){"dialogClass"===a&&this.uiDialog.removeClass(this.options.dialogClass).addClass(b);this._superApply(arguments)}});a.widget("ui.droppable",
{version:"1.13.1",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var a,b=this.options,c=b.accept;this.isover=!1;this.isout=!0;this.accept="function"===typeof c?c:function(a){return a.is(c)};this.proportions=function(){if(arguments.length)a=arguments[0];else return a?a:a={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}};this._addToManager(b.scope);
b.addClasses&&this._addClass("ui-droppable")},_addToManager:function(d){a.ui.ddmanager.droppables[d]=a.ui.ddmanager.droppables[d]||[];a.ui.ddmanager.droppables[d].push(this)},_splice:function(a){for(var d=0;d<a.length;d++)a[d]===this&&a.splice(d,1)},_destroy:function(){this._splice(a.ui.ddmanager.droppables[this.options.scope])},_setOption:function(d,b){"accept"===d?this.accept="function"===typeof b?b:function(a){return a.is(b)}:"scope"===d&&(this._splice(a.ui.ddmanager.droppables[this.options.scope]),
this._addToManager(b));this._super(d,b)},_activate:function(d){var b=a.ui.ddmanager.current;this._addActiveClass();b&&this._trigger("activate",d,this.ui(b))},_deactivate:function(d){var b=a.ui.ddmanager.current;this._removeActiveClass();b&&this._trigger("deactivate",d,this.ui(b))},_over:function(d){var b=a.ui.ddmanager.current;b&&(b.currentItem||b.element)[0]!==this.element[0]&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this._addHoverClass(),this._trigger("over",d,this.ui(b)))},
_out:function(d){var b=a.ui.ddmanager.current;b&&(b.currentItem||b.element)[0]!==this.element[0]&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this._removeHoverClass(),this._trigger("out",d,this.ui(b)))},_drop:function(d,b){var c=b||a.ui.ddmanager.current,f=!1;if(!c||(c.currentItem||c.element)[0]===this.element[0])return!1;this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var b=a(this).droppable("instance");if(b.options.greedy&&!b.options.disabled&&
b.options.scope===c.options.scope&&b.accept.call(b.element[0],c.currentItem||c.element)&&a.ui.intersect(c,a.extend(b,{offset:b.element.offset()}),b.options.tolerance,d))return f=!0,!1});return f?!1:this.accept.call(this.element[0],c.currentItem||c.element)?(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",d,this.ui(c)),this.element):!1},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},
_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}});a.ui.intersect=function(){return function(a,b,c,e){if(!b.offset)return!1;var d=(a.positionAbs||a.position.absolute).left+a.margins.left,f=(a.positionAbs||a.position.absolute).top+a.margins.top,g=d+a.helperProportions.width,l=f+a.helperProportions.height,h=b.offset.left,n=b.offset.top,r=h+b.proportions().width,
m=n+b.proportions().height;switch(c){case "fit":return h<=d&&g<=r&&n<=f&&l<=m;case "intersect":return h<d+a.helperProportions.width/2&&g-a.helperProportions.width/2<r&&n<f+a.helperProportions.height/2&&l-a.helperProportions.height/2<m;case "pointer":a=e.pageY;c=b.proportions().height;if(n=a>=n&&a<n+c)e=e.pageX,b=b.proportions().width,n=e>=h&&e<h+b;return n;case "touch":return(f>=n&&f<=m||l>=n&&l<=m||f<n&&l>m)&&(d>=h&&d<=r||g>=h&&g<=r||d<h&&g>r);default:return!1}}}();a.ui.ddmanager={current:null,droppables:{"default":[]},
prepareOffsets:function(d,b){var c,f=a.ui.ddmanager.droppables[d.options.scope]||[],e=b?b.type:null,g=(d.currentItem||d.element).find(":data(ui-droppable)").addBack();var h=0;a:for(;h<f.length;h++)if(!(f[h].options.disabled||d&&!f[h].accept.call(f[h].element[0],d.currentItem||d.element))){for(c=0;c<g.length;c++)if(g[c]===f[h].element[0]){f[h].proportions().height=0;continue a}f[h].visible="none"!==f[h].element.css("display");f[h].visible&&("mousedown"===e&&f[h]._activate.call(f[h],b),f[h].offset=
f[h].element.offset(),f[h].proportions({width:f[h].element[0].offsetWidth,height:f[h].element[0].offsetHeight}))}},drop:function(d,b){var c=!1;a.each((a.ui.ddmanager.droppables[d.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&a.ui.intersect(d,this,this.options.tolerance,b)&&(c=this._drop.call(this,b)||c),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],d.currentItem||d.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,
b)))});return c},dragStart:function(d,b){d.element.parentsUntil("body").on("scroll.droppable",function(){d.options.refreshPositions||a.ui.ddmanager.prepareOffsets(d,b)})},drag:function(d,b){d.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(d,b);a.each(a.ui.ddmanager.droppables[d.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var c=a.ui.intersect(d,this,this.options.tolerance,b);var f=!c&&this.isover?"isout":c&&!this.isover?"isover":null;if(f){if(this.options.greedy){var e=
this.options.scope;c=this.element.parents(":data(ui-droppable)").filter(function(){return a(this).droppable("instance").options.scope===e});if(c.length){var g=a(c[0]).droppable("instance");g.greedyChild="isover"===f}}g&&"isover"===f&&(g.isover=!1,g.isout=!0,g._out.call(g,b));this[f]=!0;this["isout"===f?"isover":"isout"]=!1;this["isover"===f?"_over":"_out"].call(this,b);g&&"isout"===f&&(g.isout=!1,g.isover=!0,g._over.call(g,b))}}})},dragStop:function(d,b){d.element.parentsUntil("body").off("scroll.droppable");
d.options.refreshPositions||a.ui.ddmanager.prepareOffsets(d,b)}};!1!==a.uiBackCompat&&a.widget("ui.droppable",a.ui.droppable,{options:{hoverClass:!1,activeClass:!1},_addActiveClass:function(){this._super();this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super();this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super();this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},
_removeHoverClass:function(){this._super();this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}});a.widget("ui.progressbar",{version:"1.13.1",options:{classes:{"ui-progressbar":"ui-corner-all","ui-progressbar-value":"ui-corner-left","ui-progressbar-complete":"ui-corner-right"},max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue();this.element.attr({role:"progressbar","aria-valuemin":this.min});this._addClass("ui-progressbar",
"ui-widget ui-widget-content");this.valueDiv=a("<div>").appendTo(this.element);this._addClass(this.valueDiv,"ui-progressbar-value","ui-widget-header");this._refreshValue()},_destroy:function(){this.element.removeAttr("role aria-valuemin aria-valuemax aria-valuenow");this.valueDiv.remove()},value:function(a){if(void 0===a)return this.options.value;this.options.value=this._constrainedValue(a);this._refreshValue()},_constrainedValue:function(a){void 0===a&&(a=this.options.value);this.indeterminate=!1===
a;"number"!==typeof a&&(a=0);return this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,a))},_setOptions:function(a){var d=a.value;delete a.value;this._super(a);this.options.value=this._constrainedValue(d);this._refreshValue()},_setOption:function(a,b){"max"===a&&(b=Math.max(this.min,b));this._super(a,b)},_setOptionDisabled:function(a){this._super(a);this.element.attr("aria-disabled",a);this._toggleClass(null,"ui-state-disabled",!!a)},_percentage:function(){return this.indeterminate?
100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var d=this.options.value,b=this._percentage();this.valueDiv.toggle(this.indeterminate||d>this.min).width(b.toFixed(0)+"%");this._toggleClass(this.valueDiv,"ui-progressbar-complete",null,d===this.options.max)._toggleClass("ui-progressbar-indeterminate",null,this.indeterminate);this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=a("<div>").appendTo(this.valueDiv),this._addClass(this.overlayDiv,
"ui-progressbar-overlay"))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":d}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null));this.oldValue!==d&&(this.oldValue=d,this._trigger("change"));d===this.options.max&&this._trigger("complete")}});a.widget("ui.selectable",a.ui.mouse,{version:"1.13.1",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var d=
this;this._addClass("ui-selectable");this.dragged=!1;this.refresh=function(){d.elementPos=a(d.element[0]).offset();d.selectees=a(d.options.filter,d.element[0]);d._addClass(d.selectees,"ui-selectee");d.selectees.each(function(){var b=a(this),c=b.offset(),e=c.left-d.elementPos.left;c=c.top-d.elementPos.top;a.data(this,"selectable-item",{element:this,$element:b,left:e,top:c,right:e+b.outerWidth(),bottom:c+b.outerHeight(),startselected:!1,selected:b.hasClass("ui-selected"),selecting:b.hasClass("ui-selecting"),
unselecting:b.hasClass("ui-unselecting")})})};this.refresh();this._mouseInit();this.helper=a("<div>");this._addClass(this.helper,"ui-selectable-helper")},_destroy:function(){this.selectees.removeData("selectable-item");this._mouseDestroy()},_mouseStart:function(d){var b=this,c=this.options;this.opos=[d.pageX,d.pageY];this.elementPos=a(this.element[0]).offset();this.options.disabled||(this.selectees=a(c.filter,this.element[0]),this._trigger("start",d),a(c.appendTo).append(this.helper),this.helper.css({left:d.pageX,
top:d.pageY,width:0,height:0}),c.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var c=a.data(this,"selectable-item");c.startselected=!0;d.metaKey||d.ctrlKey||(b._removeClass(c.$element,"ui-selected"),c.selected=!1,b._addClass(c.$element,"ui-unselecting"),c.unselecting=!0,b._trigger("unselecting",d,{unselecting:c.element}))}),a(d.target).parents().addBack().each(function(){var c=a.data(this,"selectable-item");if(c){var f=!d.metaKey&&!d.ctrlKey||!c.$element.hasClass("ui-selected");
b._removeClass(c.$element,f?"ui-unselecting":"ui-selected")._addClass(c.$element,f?"ui-selecting":"ui-unselecting");c.unselecting=!f;c.selecting=f;(c.selected=f)?b._trigger("selecting",d,{selecting:c.element}):b._trigger("unselecting",d,{unselecting:c.element});return!1}}))},_mouseDrag:function(d){this.dragged=!0;if(!this.options.disabled){var b=this,c=this.options,e=this.opos[0],g=this.opos[1],h=d.pageX,n=d.pageY;if(e>h){var l=h;h=e;e=l}g>n&&(l=n,n=g,g=l);this.helper.css({left:e,top:g,width:h-e,
height:n-g});this.selectees.each(function(){var f=a.data(this,"selectable-item"),l=!1;if(f&&f.element!==b.element[0]){var m=f.left+b.elementPos.left;var r=f.right+b.elementPos.left;var p=f.top+b.elementPos.top;var k=f.bottom+b.elementPos.top;"touch"===c.tolerance?l=!(m>h||r<e||p>n||k<g):"fit"===c.tolerance&&(l=m>e&&r<h&&p>g&&k<n);l?(f.selected&&(b._removeClass(f.$element,"ui-selected"),f.selected=!1),f.unselecting&&(b._removeClass(f.$element,"ui-unselecting"),f.unselecting=!1),f.selecting||(b._addClass(f.$element,
"ui-selecting"),f.selecting=!0,b._trigger("selecting",d,{selecting:f.element}))):(f.selecting&&((d.metaKey||d.ctrlKey)&&f.startselected?(b._removeClass(f.$element,"ui-selecting"),f.selecting=!1,b._addClass(f.$element,"ui-selected"),f.selected=!0):(b._removeClass(f.$element,"ui-selecting"),f.selecting=!1,f.startselected&&(b._addClass(f.$element,"ui-unselecting"),f.unselecting=!0),b._trigger("unselecting",d,{unselecting:f.element}))),!f.selected||d.metaKey||d.ctrlKey||f.startselected||(b._removeClass(f.$element,
"ui-selected"),f.selected=!1,b._addClass(f.$element,"ui-unselecting"),f.unselecting=!0,b._trigger("unselecting",d,{unselecting:f.element})))}});return!1}},_mouseStop:function(d){var b=this;this.dragged=!1;a(".ui-unselecting",this.element[0]).each(function(){var c=a.data(this,"selectable-item");b._removeClass(c.$element,"ui-unselecting");c.unselecting=!1;c.startselected=!1;b._trigger("unselected",d,{unselected:c.element})});a(".ui-selecting",this.element[0]).each(function(){var c=a.data(this,"selectable-item");
b._removeClass(c.$element,"ui-selecting")._addClass(c.$element,"ui-selected");c.selecting=!1;c.selected=!0;c.startselected=!0;b._trigger("selected",d,{selected:c.element})});this._trigger("stop",d);this.helper.remove();return!1}});a.widget("ui.selectmenu",[a.ui.formResetMixin,{version:"1.13.1",defaultElement:"<select>",options:{appendTo:null,classes:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"},disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",
at:"left bottom",collision:"none"},width:!1,change:null,close:null,focus:null,open:null,select:null},_create:function(){var d=this.element.uniqueId().attr("id");this.ids={element:d,button:d+"-button",menu:d+"-menu"};this._drawButton();this._drawMenu();this._bindFormResetHandler();this._rendered=!1;this.menuItems=a()},_drawButton:function(){var d=this,b=this._parseOption(this.element.find("option:selected"),this.element[0].selectedIndex);this.labels=this.element.labels().attr("for",this.ids.button);
this._on(this.labels,{click:function(a){this.button.trigger("focus");a.preventDefault()}});this.element.hide();this.button=a("<span>",{tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true",title:this.element.attr("title")}).insertAfter(this.element);this._addClass(this.button,"ui-selectmenu-button ui-selectmenu-button-closed","ui-button ui-widget");var c=a("<span>").appendTo(this.button);
this._addClass(c,"ui-selectmenu-icon","ui-icon "+this.options.icons.button);this.buttonItem=this._renderButtonItem(b).appendTo(this.button);!1!==this.options.width&&this._resizeButton();this._on(this.button,this._buttonEvents);this.button.one("focusin",function(){d._rendered||d._refreshMenu()})},_drawMenu:function(){var d=this;this.menu=a("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu});this.menuWrap=a("<div>").append(this.menu);this._addClass(this.menuWrap,"ui-selectmenu-menu",
"ui-front");this.menuWrap.appendTo(this._appendTo());this.menuInstance=this.menu.menu({classes:{"ui-menu":"ui-corner-bottom"},role:"listbox",select:function(a,b){a.preventDefault();d._setSelection();d._select(b.item.data("ui-selectmenu-item"),a)},focus:function(a,b){b=b.item.data("ui-selectmenu-item");null!=d.focusIndex&&b.index!==d.focusIndex&&(d._trigger("focus",a,{item:b}),d.isOpen||d._select(b,a));d.focusIndex=b.index;d.button.attr("aria-activedescendant",d.menuItems.eq(b.index).attr("id"))}}).menu("instance");
this.menuInstance._off(this.menu,"mouseleave");this.menuInstance._closeOnDocumentClick=function(){return!1};this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu();this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(this._getSelectedItem().data("ui-selectmenu-item")||{}));null===this.options.width&&this._resizeButton()},_refreshMenu:function(){var a=this.element.find("option");this.menu.empty();this._parseOptions(a);this._renderMenu(this.menu,this.items);
this.menuInstance.refresh();this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup").find(".ui-menu-item-wrapper");this._rendered=!0;a.length&&(a=this._getSelectedItem(),this.menuInstance.focus(null,a),this._setAria(a.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(a){this.options.disabled||(this._rendered?(this._removeClass(this.menu.find(".ui-state-active"),null,"ui-state-active"),this.menuInstance.focus(null,this._getSelectedItem())):
this._refreshMenu(),this.menuItems.length&&(this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",a)))},_position:function(){this.menuWrap.position(a.extend({of:this.button},this.options.position))},close:function(a){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",a))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderButtonItem:function(d){var b=
a("<span>");this._setText(b,d.label);this._addClass(b,"ui-selectmenu-text");return b},_renderMenu:function(d,b){var c=this,f="";a.each(b,function(b,e){e.optgroup!==f&&(b=a("<li>",{text:e.optgroup}),c._addClass(b,"ui-selectmenu-optgroup","ui-menu-divider"+(e.element.parent("optgroup").prop("disabled")?" ui-state-disabled":"")),b.appendTo(d),f=e.optgroup);c._renderItemData(d,e)})},_renderItemData:function(a,b){return this._renderItem(a,b).data("ui-selectmenu-item",b)},_renderItem:function(d,b){var c=
a("<li>"),f=a("<div>",{title:b.element.attr("title")});b.disabled&&this._addClass(c,null,"ui-state-disabled");this._setText(f,b.label);return c.append(f).appendTo(d)},_setText:function(a,b){b?a.text(b):a.html("&#160;")},_move:function(a,b){var d=".ui-menu-item";if(this.isOpen)var c=this.menuItems.eq(this.focusIndex).parent("li");else c=this.menuItems.eq(this.element[0].selectedIndex).parent("li"),d+=":not(.ui-state-disabled)";a="first"===a||"last"===a?c["first"===a?"prevAll":"nextAll"](d).eq(-1):
c[a+"All"](d).eq(0);a.length&&this.menuInstance.focus(b,a)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex).parent("li")},_toggle:function(a){this[this.isOpen?"close":"open"](a)},_setSelection:function(){if(this.range){if(window.getSelection){var a=window.getSelection();a.removeAllRanges();a.addRange(this.range)}else this.range.select();this.button.focus()}},_documentClick:{mousedown:function(d){this.isOpen&&(a(d.target).closest(".ui-selectmenu-menu, #"+a.escapeSelector(this.ids.button)).length||
this.close(d))}},_buttonEvents:{mousedown:function(){if(window.getSelection){var a=window.getSelection();a.rangeCount&&(this.range=a.getRangeAt(0))}else this.range=document.selection.createRange()},click:function(a){this._setSelection();this._toggle(a)},keydown:function(d){var b=!0;switch(d.keyCode){case a.ui.keyCode.TAB:case a.ui.keyCode.ESCAPE:this.close(d);b=!1;break;case a.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(d);break;case a.ui.keyCode.UP:d.altKey?this._toggle(d):this._move("prev",
d);break;case a.ui.keyCode.DOWN:d.altKey?this._toggle(d):this._move("next",d);break;case a.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(d):this._toggle(d);break;case a.ui.keyCode.LEFT:this._move("prev",d);break;case a.ui.keyCode.RIGHT:this._move("next",d);break;case a.ui.keyCode.HOME:case a.ui.keyCode.PAGE_UP:this._move("first",d);break;case a.ui.keyCode.END:case a.ui.keyCode.PAGE_DOWN:this._move("last",d);break;default:this.menu.trigger(d),b=!1}b&&d.preventDefault()}},_selectFocusedItem:function(a){var d=
this.menuItems.eq(this.focusIndex).parent("li");d.hasClass("ui-state-disabled")||this._select(d.data("ui-selectmenu-item"),a)},_select:function(a,b){var d=this.element[0].selectedIndex;this.element[0].selectedIndex=a.index;this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(a));this._setAria(a);this._trigger("select",b,{item:a});a.index!==d&&this._trigger("change",b,{item:a});this.close(b)},_setAria:function(a){a=this.menuItems.eq(a.index).attr("id");this.button.attr({"aria-labelledby":a,
"aria-activedescendant":a});this.menu.attr("aria-activedescendant",a)},_setOption:function(a,b){if("icons"===a){var d=this.button.find("span.ui-icon");this._removeClass(d,null,this.options.icons.button)._addClass(d,null,b.button)}this._super(a,b);"appendTo"===a&&this.menuWrap.appendTo(this._appendTo());"width"===a&&this._resizeButton()},_setOptionDisabled:function(a){this._super(a);this.menuInstance.option("disabled",a);this.button.attr("aria-disabled",a);this._toggleClass(this.button,null,"ui-state-disabled",
a);this.element.prop("disabled",a);a?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)},_appendTo:function(){var d=this.options.appendTo;d&&(d=d.jquery||d.nodeType?a(d):this.document.find(d).eq(0));d&&d[0]||(d=this.element.closest(".ui-front, dialog"));d.length||(d=this.document[0].body);return d},_toggleAttr:function(){this.button.attr("aria-expanded",this.isOpen);this._removeClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"closed":"open"))._addClass(this.button,
"ui-selectmenu-button-"+(this.isOpen?"open":"closed"))._toggleClass(this.menuWrap,"ui-selectmenu-open",null,this.isOpen);this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var a=this.options.width;!1===a?this.button.css("width",""):(null===a&&(a=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(a))},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){var a=this._super();
a.disabled=this.element.prop("disabled");return a},_parseOptions:function(d){var b=this,c=[];d.each(function(d,f){f.hidden||c.push(b._parseOption(a(f),d))});this.items=c},_parseOption:function(a,b){var d=a.parent("optgroup");return{element:a,index:b,value:a.val(),label:a.text(),optgroup:d.attr("label")||"",disabled:d.prop("disabled")||a.prop("disabled")}},_destroy:function(){this._unbindFormResetHandler();this.menuWrap.remove();this.button.remove();this.element.show();this.element.removeUniqueId();
this.labels.attr("for",this.ids.element)}}]);a.widget("ui.slider",a.ui.mouse,{version:"1.13.1",widgetEventPrefix:"slide",options:{animate:!1,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._mouseSliding=this._keySliding=!1;this._animateOff=!0;this._handleIndex=
null;this._detectOrientation();this._mouseInit();this._calculateNewMax();this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content");this._refresh();this._animateOff=!1},_refresh:function(){this._createRange();this._createHandles();this._setupEvents();this._refreshValue()},_createHandles:function(){var d=this.options;var b=this.element.find(".ui-slider-handle"),c=[];var e=d.values&&d.values.length||1;b.length>e&&(b.slice(e).remove(),b=b.slice(0,e));for(d=b.length;d<e;d++)c.push("<span tabindex='0'></span>");
this.handles=b.add(a(c.join("")).appendTo(this.element));this._addClass(this.handles,"ui-slider-handle","ui-state-default");this.handle=this.handles.eq(0);this.handles.each(function(d){a(this).data("ui-slider-handle-index",d).attr("tabIndex",0)})},_createRange:function(){var d=this.options;d.range?(!0===d.range&&(d.values?d.values.length&&2!==d.values.length?d.values=[d.values[0],d.values[0]]:Array.isArray(d.values)&&(d.values=d.values.slice(0)):d.values=[this._valueMin(),this._valueMin()]),this.range&&
this.range.length?(this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max"),this.range.css({left:"",bottom:""})):(this.range=a("<div>").appendTo(this.element),this._addClass(this.range,"ui-slider-range")),"min"!==d.range&&"max"!==d.range||this._addClass(this.range,"ui-slider-range-"+d.range)):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles);this._on(this.handles,this._handleEvents);this._hoverable(this.handles);this._focusable(this.handles)},
_destroy:function(){this.handles.remove();this.range&&this.range.remove();this._mouseDestroy()},_mouseCapture:function(d){var b,c,e=this,g=this.options;if(g.disabled)return!1;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();var h=this._normValueFromMouse({x:d.pageX,y:d.pageY});var n=this._valueMax()-this._valueMin()+1;this.handles.each(function(d){var f=Math.abs(h-e.values(d));if(n>f||n===f&&(d===e._lastChangedValue||e.values(d)===
g.min))n=f,b=a(this),c=d});if(!1===this._start(d,c))return!1;this._mouseSliding=!0;this._handleIndex=c;this._addClass(b,null,"ui-state-active");b.trigger("focus");var l=b.offset();this._clickOffset=a(d.target).parents().addBack().is(".ui-slider-handle")?{left:d.pageX-l.left-b.width()/2,top:d.pageY-l.top-b.height()/2-(parseInt(b.css("borderTopWidth"),10)||0)-(parseInt(b.css("borderBottomWidth"),10)||0)+(parseInt(b.css("marginTop"),10)||0)}:{left:0,top:0};this.handles.hasClass("ui-state-hover")||this._slide(d,
c,h);return this._animateOff=!0},_mouseStart:function(){return!0},_mouseDrag:function(a){var d=this._normValueFromMouse({x:a.pageX,y:a.pageY});this._slide(a,this._handleIndex,d);return!1},_mouseStop:function(a){this._removeClass(this.handles,null,"ui-state-active");this._mouseSliding=!1;this._stop(a,this._handleIndex);this._change(a,this._handleIndex);this._clickOffset=this._handleIndex=null;return this._animateOff=!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?
"vertical":"horizontal"},_normValueFromMouse:function(a){if("horizontal"===this.orientation){var d=this.elementSize.width;a=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else d=this.elementSize.height,a=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0);d=a/d;1<d&&(d=1);0>d&&(d=0);"vertical"===this.orientation&&(d=1-d);a=this._valueMax()-this._valueMin();d=this._valueMin()+d*a;return this._trimAlignValue(d)},_uiHash:function(a,b,c){var d={handle:this.handles[a],
handleIndex:a,value:void 0!==b?b:this.value()};this._hasMultipleValues()&&(d.value=void 0!==b?b:this.values(a),d.values=c||this.values());return d},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(a,b){return this._trigger("start",a,this._uiHash(b))},_slide:function(a,b,c){var d=this.value(),f=this.values();if(this._hasMultipleValues()){var e=this.values(b?0:1);d=this.values(b);2===this.options.values.length&&!0===this.options.range&&(c=0===b?Math.min(e,
c):Math.max(e,c));f[b]=c}c!==d&&!1!==this._trigger("slide",a,this._uiHash(b,c,f))&&(this._hasMultipleValues()?this.values(b,c):this.value(c))},_stop:function(a,b){this._trigger("stop",a,this._uiHash(b))},_change:function(a,b){this._keySliding||this._mouseSliding||(this._lastChangedValue=b,this._trigger("change",a,this._uiHash(b)))},value:function(a){if(arguments.length)this.options.value=this._trimAlignValue(a),this._refreshValue(),this._change(null,0);else return this._value()},values:function(a,
b){var d;if(1<arguments.length)this.options.values[a]=this._trimAlignValue(b),this._refreshValue(),this._change(null,a);else if(arguments.length)if(Array.isArray(arguments[0])){var c=this.options.values;var f=arguments[0];for(d=0;d<c.length;d+=1)c[d]=this._trimAlignValue(f[d]),this._change(null,d);this._refreshValue()}else return this._hasMultipleValues()?this._values(a):this.value();else return this._values()},_setOption:function(a,b){var d=0;"range"===a&&!0===this.options.range&&("min"===b?(this.options.value=
this._values(0),this.options.values=null):"max"===b&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null));Array.isArray(this.options.values)&&(d=this.options.values.length);this._super(a,b);switch(a){case "orientation":this._detectOrientation();this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation);this._refreshValue();this.options.range&&this._refreshRange(b);this.handles.css("horizontal"===b?"bottom":"left","");
break;case "value":this._animateOff=!0;this._refreshValue();this._change(null,0);this._animateOff=!1;break;case "values":this._animateOff=!0;this._refreshValue();for(a=d-1;0<=a;a--)this._change(null,a);this._animateOff=!1;break;case "step":case "min":case "max":this._animateOff=!0;this._calculateNewMax();this._refreshValue();this._animateOff=!1;break;case "range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_setOptionDisabled:function(a){this._super(a);this._toggleClass(null,"ui-state-disabled",
!!a)},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a)},_values:function(a){var d;if(arguments.length){var b=this.options.values[a];return b=this._trimAlignValue(b)}if(this._hasMultipleValues()){b=this.options.values.slice();for(d=0;d<b.length;d+=1)b[d]=this._trimAlignValue(b[d]);return b}return[]},_trimAlignValue:function(a){if(a<=this._valueMin())return this._valueMin();if(a>=this._valueMax())return this._valueMax();var d=0<this.options.step?this.options.step:1,b=(a-this._valueMin())%
d;a-=b;2*Math.abs(b)>=d&&(a+=0<b?d:-d);return parseFloat(a.toFixed(5))},_calculateNewMax:function(){var a=this.options.max,b=this._valueMin(),c=this.options.step;a=Math.round((a-b)/c)*c+b;a>this.options.max&&(a-=c);this.max=parseFloat(a.toFixed(this._precision()))},_precision:function(){var a=this._precisionOf(this.options.step);null!==this.options.min&&(a=Math.max(a,this._precisionOf(this.options.min)));return a},_precisionOf:function(a){a=a.toString();var d=a.indexOf(".");return-1===d?0:a.length-
d-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshRange:function(a){"vertical"===a&&this.range.css({width:"",left:""});"horizontal"===a&&this.range.css({height:"",bottom:""})},_refreshValue:function(){var d,b=this.options.range,c=this.options,e=this,g=this._animateOff?!1:c.animate,h={};if(this._hasMultipleValues())this.handles.each(function(b){m=(e.values(b)-e._valueMin())/(e._valueMax()-e._valueMin())*100;h["horizontal"===e.orientation?"left":"bottom"]=
m+"%";a(this).stop(1,1)[g?"animate":"css"](h,c.animate);if(!0===e.options.range)if("horizontal"===e.orientation){if(0===b)e.range.stop(1,1)[g?"animate":"css"]({left:m+"%"},c.animate);if(1===b)e.range[g?"animate":"css"]({width:m-d+"%"},{queue:!1,duration:c.animate})}else{if(0===b)e.range.stop(1,1)[g?"animate":"css"]({bottom:m+"%"},c.animate);if(1===b)e.range[g?"animate":"css"]({height:m-d+"%"},{queue:!1,duration:c.animate})}d=m});else{var n=this.value();var l=this._valueMin();var u=this._valueMax();
var m=u!==l?(n-l)/(u-l)*100:0;h["horizontal"===this.orientation?"left":"bottom"]=m+"%";this.handle.stop(1,1)[g?"animate":"css"](h,c.animate);if("min"===b&&"horizontal"===this.orientation)this.range.stop(1,1)[g?"animate":"css"]({width:m+"%"},c.animate);if("max"===b&&"horizontal"===this.orientation)this.range.stop(1,1)[g?"animate":"css"]({width:100-m+"%"},c.animate);if("min"===b&&"vertical"===this.orientation)this.range.stop(1,1)[g?"animate":"css"]({height:m+"%"},c.animate);if("max"===b&&"vertical"===
this.orientation)this.range.stop(1,1)[g?"animate":"css"]({height:100-m+"%"},c.animate)}},_handleEvents:{keydown:function(d){var b,c=a(d.target).data("ui-slider-handle-index");switch(d.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(d.preventDefault(),!this._keySliding){this._keySliding=!0;this._addClass(a(d.target),null,"ui-state-active");var e=
this._start(d,c);if(!1===e)return}}var g=this.options.step;e=this._hasMultipleValues()?b=this.values(c):b=this.value();switch(d.keyCode){case a.ui.keyCode.HOME:b=this._valueMin();break;case a.ui.keyCode.END:b=this._valueMax();break;case a.ui.keyCode.PAGE_UP:b=this._trimAlignValue(e+(this._valueMax()-this._valueMin())/this.numPages);break;case a.ui.keyCode.PAGE_DOWN:b=this._trimAlignValue(e-(this._valueMax()-this._valueMin())/this.numPages);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(e===
this._valueMax())return;b=this._trimAlignValue(e+g);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(e===this._valueMin())return;b=this._trimAlignValue(e-g)}this._slide(d,c,b)},keyup:function(d){var b=a(d.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(d,b),this._change(d,b),this._removeClass(a(d.target),null,"ui-state-active"))}}});a.widget("ui.sortable",a.ui.mouse,{version:"1.13.1",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,
connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1E3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(a,b,c){return a>=b&&a<b+c},_isFloating:function(a){return/left|right/.test(a.css("float"))||
/inline|table-cell/.test(a.css("display"))},_create:function(){this.containerCache={};this._addClass("ui-sortable");this.refresh();this.offset=this.element.offset();this._mouseInit();this._setHandleClassName();this.ready=!0},_setOption:function(a,b){this._super(a,b);"handle"===a&&this._setHandleClassName()},_setHandleClassName:function(){var d=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle");a.each(this.items,function(){d._addClass(this.instance.options.handle?
this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")})},_destroy:function(){this._mouseDestroy();for(var a=this.items.length-1;0<=a;a--)this.items[a].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(d,b){var c=null,f=!1,e=this;if(this.reverting||this.options.disabled||"static"===this.options.type)return!1;this._refreshItems(d);a(d.target).parents().each(function(){if(a.data(this,e.widgetName+"-item")===e)return c=a(this),!1});a.data(d.target,e.widgetName+
"-item")===e&&(c=a(d.target));if(!c||this.options.handle&&!b&&(a(this.options.handle,c).find("*").addBack().each(function(){this===d.target&&(f=!0)}),!f))return!1;this.currentItem=c;this._removeCurrentsFromItems();return!0},_mouseStart:function(d,b,c){b=this.options;this.currentContainer=this;this.refreshPositions();this.appendTo=a("parent"!==b.appendTo?b.appendTo:this.currentItem.parent());this.helper=this._createHelper(d);this._cacheHelperProportions();this._cacheMargins();this.offset=this.currentItem.offset();
this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};a.extend(this.offset,{click:{left:d.pageX-this.offset.left,top:d.pageY-this.offset.top},relative:this._getRelativeOffset()});this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");b.cursorAt&&this._adjustOffsetFromHelper(b.cursorAt);this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};this.helper[0]!==this.currentItem[0]&&this.currentItem.hide();
this._createPlaceholder();this.scrollParent=this.placeholder.scrollParent();a.extend(this.offset,{parent:this._getParentOffset()});b.containment&&this._setContainment();if(b.cursor&&"auto"!==b.cursor){var f=this.document.find("body");this.storedCursor=f.css("cursor");f.css("cursor",b.cursor);this.storedStylesheet=a("<style>*{ cursor: "+b.cursor+" !important; }</style>").appendTo(f)}b.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",b.zIndex));
b.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",b.opacity));this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset());this._trigger("start",d,this._uiHash());this._preserveHelperProportions||this._cacheHelperProportions();if(!c)for(c=this.containers.length-1;0<=c;c--)this.containers[c]._trigger("activate",d,this._uiHash(this));a.ui.ddmanager&&(a.ui.ddmanager.current=
this);a.ui.ddmanager&&!b.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,d);this.dragging=!0;this._addClass(this.helper,"ui-sortable-helper");this.helper.parent().is(this.appendTo)||(this.helper.detach().appendTo(this.appendTo),this.offset.parent=this._getParentOffset());this.position=this.originalPosition=this._generatePosition(d);this.originalPageX=d.pageX;this.originalPageY=d.pageY;this.lastPositionAbs=this.positionAbs=this._convertPositionTo("absolute");this._mouseDrag(d);return!0},_scroll:function(a){var d=
this.options,b=!1;this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-a.pageY<d.scrollSensitivity?this.scrollParent[0].scrollTop=b=this.scrollParent[0].scrollTop+d.scrollSpeed:a.pageY-this.overflowOffset.top<d.scrollSensitivity&&(this.scrollParent[0].scrollTop=b=this.scrollParent[0].scrollTop-d.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-a.pageX<d.scrollSensitivity?this.scrollParent[0].scrollLeft=
b=this.scrollParent[0].scrollLeft+d.scrollSpeed:a.pageX-this.overflowOffset.left<d.scrollSensitivity&&(this.scrollParent[0].scrollLeft=b=this.scrollParent[0].scrollLeft-d.scrollSpeed)):(a.pageY-this.document.scrollTop()<d.scrollSensitivity?b=this.document.scrollTop(this.document.scrollTop()-d.scrollSpeed):this.window.height()-(a.pageY-this.document.scrollTop())<d.scrollSensitivity&&(b=this.document.scrollTop(this.document.scrollTop()+d.scrollSpeed)),a.pageX-this.document.scrollLeft()<d.scrollSensitivity?
b=this.document.scrollLeft(this.document.scrollLeft()-d.scrollSpeed):this.window.width()-(a.pageX-this.document.scrollLeft())<d.scrollSensitivity&&(b=this.document.scrollLeft(this.document.scrollLeft()+d.scrollSpeed)));return b},_mouseDrag:function(d){var b;var c=this.options;this.position=this._generatePosition(d);this.positionAbs=this._convertPositionTo("absolute");this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px");this.options.axis&&"x"===this.options.axis||
(this.helper[0].style.top=this.position.top+"px");c.scroll&&!1!==this._scroll(d)&&(this._refreshItemPositions(!0),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,d));this.dragDirection={vertical:this._getDragVerticalDirection(),horizontal:this._getDragHorizontalDirection()};for(c=this.items.length-1;0<=c;c--){var e=this.items[c];var g=e.item[0];if((b=this._intersectsWithPointer(e))&&e.instance===this.currentContainer&&g!==this.currentItem[0]&&this.placeholder[1===b?"next":"prev"]()[0]!==
g&&!a.contains(this.placeholder[0],g)&&("semi-dynamic"===this.options.type?!a.contains(this.element[0],g):1)){this.direction=1===b?"down":"up";if("pointer"===this.options.tolerance||this._intersectsWithSides(e))this._rearrange(d,e);else break;this._trigger("change",d,this._uiHash());break}}this._contactContainers(d);a.ui.ddmanager&&a.ui.ddmanager.drag(this,d);this._trigger("sort",d,this._uiHash());this.lastPositionAbs=this.positionAbs;return!1},_mouseStop:function(d,b){if(d){a.ui.ddmanager&&!this.options.dropBehaviour&&
a.ui.ddmanager.drop(this,d);if(this.options.revert){var c=this;b=this.placeholder.offset();var f=this.options.axis,e={};f&&"x"!==f||(e.left=b.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft));f&&"y"!==f||(e.top=b.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop));this.reverting=!0;a(this.helper).animate(e,parseInt(this.options.revert,10)||500,function(){c._clear(d)})}else this._clear(d,
b);return!1}},cancel:function(){if(this.dragging){this._mouseUp(new a.Event("mouseup",{target:null}));"original"===this.options.helper?(this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")):this.currentItem.show();for(var d=this.containers.length-1;0<=d;d--)this.containers[d]._trigger("deactivate",null,this._uiHash(this)),this.containers[d].containerCache.over&&(this.containers[d]._trigger("out",null,this._uiHash(this)),this.containers[d].containerCache.over=
0)}this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),a.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):a(this.domPosition.parent).prepend(this.currentItem));return this},serialize:function(d){var b=this._getItemsAsjQuery(d&&d.connected),c=[];d=d||{};
a(b).each(function(){var b=(a(d.item||this).attr(d.attribute||"id")||"").match(d.expression||/(.+)[\-=_](.+)/);b&&c.push((d.key||b[1]+"[]")+"="+(d.key&&d.expression?b[1]:b[2]))});!c.length&&d.key&&c.push(d.key+"=");return c.join("&")},toArray:function(d){var b=this._getItemsAsjQuery(d&&d.connected),c=[];d=d||{};b.each(function(){c.push(a(d.item||this).attr(d.attribute||"id")||"")});return c},_intersectsWith:function(a){var b=this.positionAbs.left,d=b+this.helperProportions.width,c=this.positionAbs.top,
e=c+this.helperProportions.height,g=a.left,h=g+a.width,l=a.top,u=l+a.height,n=this.offset.click.top,m=this.offset.click.left;n="x"===this.options.axis||c+n>l&&c+n<u;m="y"===this.options.axis||b+m>g&&b+m<h;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?n&&m:g<b+this.helperProportions.width/2&&d-this.helperProportions.width/2<h&&l<c+this.helperProportions.height/
2&&e-this.helperProportions.height/2<u},_intersectsWithPointer:function(a){var b="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,a.top,a.height);a="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,a.left,a.width);if(!b||!a)return!1;b=this.dragDirection.vertical;a=this.dragDirection.horizontal;return this.floating?"right"===a||"down"===b?2:1:b&&("down"===b?2:1)},_intersectsWithSides:function(a){var b=this._isOverAxis(this.positionAbs.top+
this.offset.click.top,a.top+a.height/2,a.height);a=this._isOverAxis(this.positionAbs.left+this.offset.click.left,a.left+a.width/2,a.width);var d=this.dragDirection.vertical,c=this.dragDirection.horizontal;return this.floating&&c?"right"===c&&a||"left"===c&&!a:d&&("down"===d&&b||"up"===d&&!b)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return 0!==a&&(0<a?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;
return 0!==a&&(0<a?"right":"left")},refresh:function(a){this._refreshItems(a);this._setHandleClassName();this.refreshPositions();return this},_connectWith:function(){var a=this.options;return a.connectWith.constructor===String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){function d(){g.push(this)}var c,e,g=[],h=[],n=this._connectWith();if(n&&b)for(b=n.length-1;0<=b;b--){var l=a(n[b],this.document[0]);for(c=l.length-1;0<=c;c--)(e=a.data(l[c],this.widgetFullName))&&e!==this&&!e.options.disabled&&
h.push(["function"===typeof e.options.items?e.options.items.call(e.element):a(e.options.items,e.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),e])}h.push(["function"===typeof this.options.items?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(b=h.length-1;0<=b;b--)h[b][0].each(d);return a(g)},_removeCurrentsFromItems:function(){var b=
this.currentItem.find(":data("+this.widgetName+"-item)");this.items=a.grep(this.items,function(a){for(var d=0;d<b.length;d++)if(b[d]===a.item[0])return!1;return!0})},_refreshItems:function(b){this.items=[];this.containers=[this];var d,c,e,g,h=this.items,n=[["function"===typeof this.options.items?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),this]];if((g=this._connectWith())&&this.ready)for(d=g.length-1;0<=d;d--){var l=a(g[d],this.document[0]);
for(c=l.length-1;0<=c;c--)(e=a.data(l[c],this.widgetFullName))&&e!==this&&!e.options.disabled&&(n.push(["function"===typeof e.options.items?e.options.items.call(e.element[0],b,{item:this.currentItem}):a(e.options.items,e.element),e]),this.containers.push(e))}for(d=n.length-1;0<=d;d--)for(b=n[d][1],l=n[d][0],c=0,g=l.length;c<g;c++)e=a(l[c]),e.data(this.widgetName+"-item",b),h.push({item:e,instance:b,width:0,height:0,left:0,top:0})},_refreshItemPositions:function(b){var d;for(d=this.items.length-1;0<=
d;d--){var c=this.items[d];if(!this.currentContainer||c.instance===this.currentContainer||c.item[0]===this.currentItem[0]){var e=this.options.toleranceElement?a(this.options.toleranceElement,c.item):c.item;b||(c.width=e.outerWidth(),c.height=e.outerHeight());e=e.offset();c.left=e.left;c.top=e.top}}},refreshPositions:function(a){this.floating=this.items.length?"x"===this.options.axis||this._isFloating(this.items[0].item):!1;this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());
this._refreshItemPositions(a);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(a=this.containers.length-1;0<=a;a--){var b=this.containers[a].element.offset();this.containers[a].containerCache.left=b.left;this.containers[a].containerCache.top=b.top;this.containers[a].containerCache.width=this.containers[a].element.outerWidth();this.containers[a].containerCache.height=this.containers[a].element.outerHeight()}return this},_createPlaceholder:function(b){b=
b||this;var d=b.options;if(!d.placeholder||d.placeholder.constructor===String){var c=d.placeholder;var e=b.currentItem[0].nodeName.toLowerCase();d.placeholder={element:function(){var d=a("<"+e+">",b.document[0]);b._addClass(d,"ui-sortable-placeholder",c||b.currentItem[0].className)._removeClass(d,"ui-sortable-helper");"tbody"===e?b._createTrPlaceholder(b.currentItem.find("tr").eq(0),a("<tr>",b.document[0]).appendTo(d)):"tr"===e?b._createTrPlaceholder(b.currentItem,d):"img"===e&&d.attr("src",b.currentItem.attr("src"));
c||d.css("visibility","hidden");return d},update:function(a,f){if(!c||d.forcePlaceholderSize)f.height()&&(!d.forcePlaceholderSize||"tbody"!==e&&"tr"!==e)||f.height(b.currentItem.innerHeight()-parseInt(b.currentItem.css("paddingTop")||0,10)-parseInt(b.currentItem.css("paddingBottom")||0,10)),f.width()||f.width(b.currentItem.innerWidth()-parseInt(b.currentItem.css("paddingLeft")||0,10)-parseInt(b.currentItem.css("paddingRight")||0,10))}}}b.placeholder=a(d.placeholder.element.call(b.element,b.currentItem));
b.currentItem.after(b.placeholder);d.placeholder.update(b,b.placeholder)},_createTrPlaceholder:function(b,c){var d=this;b.children().each(function(){a("<td>&#160;</td>",d.document[0]).attr("colspan",a(this).attr("colspan")||1).appendTo(c)})},_contactContainers:function(b){var d,c,e,g=e=null;for(d=this.containers.length-1;0<=d;d--)a.contains(this.currentItem[0],this.containers[d].element[0])||(this._intersectsWith(this.containers[d].containerCache)?e&&a.contains(this.containers[d].element[0],e.element[0])||
(e=this.containers[d],g=d):this.containers[d].containerCache.over&&(this.containers[d]._trigger("out",b,this._uiHash(this)),this.containers[d].containerCache.over=0));if(e)if(1===this.containers.length)this.containers[g].containerCache.over||(this.containers[g]._trigger("over",b,this._uiHash(this)),this.containers[g].containerCache.over=1);else{d=1E4;var h=null;e=(c=e.floating||this._isFloating(this.currentItem))?"left":"top";var n=c?"width":"height";var l=c?"pageX":"pageY";for(c=this.items.length-
1;0<=c;c--)if(a.contains(this.containers[g].element[0],this.items[c].item[0])&&this.items[c].item[0]!==this.currentItem[0]){var u=this.items[c].item.offset()[e];var m=!1;b[l]-u>this.items[c][n]/2&&(m=!0);Math.abs(b[l]-u)<d&&(d=Math.abs(b[l]-u),h=this.items[c],this.direction=m?"up":"down")}if(h||this.options.dropOnEmpty)this.currentContainer===this.containers[g]?this.currentContainer.containerCache.over||(this.containers[g]._trigger("over",b,this._uiHash()),this.currentContainer.containerCache.over=
1):(h?this._rearrange(b,h,null,!0):this._rearrange(b,null,this.containers[g].element,!0),this._trigger("change",b,this._uiHash()),this.containers[g]._trigger("change",b,this._uiHash(this)),this.currentContainer=this.containers[g],this.options.placeholder.update(this.currentContainer,this.placeholder),this.scrollParent=this.placeholder.scrollParent(),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this.containers[g]._trigger("over",
b,this._uiHash(this)),this.containers[g].containerCache.over=1)}},_createHelper:function(b){var d=this.options;b="function"===typeof d.helper?a(d.helper.apply(this.element[0],[b,this.currentItem])):"clone"===d.helper?this.currentItem.clone():this.currentItem;b.parents("body").length||this.appendTo[0].appendChild(b[0]);b[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),
left:this.currentItem.css("left")});b[0].style.width&&!d.forceHelperSize||b.width(this.currentItem.width());b[0].style.height&&!d.forceHelperSize||b.height(this.currentItem.height());return b},_adjustOffsetFromHelper:function(a){"string"===typeof a&&(a=a.split(" "));Array.isArray(a)&&(a={left:+a[0],top:+a[1]||0});"left"in a&&(this.offset.click.left=a.left+this.margins.left);"right"in a&&(this.offset.click.left=this.helperProportions.width-a.right+this.margins.left);"top"in a&&(this.offset.click.top=
a.top+this.margins.top);"bottom"in a&&(this.offset.click.top=this.helperProportions.height-a.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&
"html"===this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,
left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;"parent"===b.containment&&(b.containment=this.helper[0].parentNode);if("document"===b.containment||"window"===b.containment)this.containment=[0-this.offset.relative.left-
this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===b.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===b.containment?this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)){var c=a(b.containment)[0];b=a(b.containment).offset();
var e="hidden"!==a(c).css("overflow");this.containment=[b.left+(parseInt(a(c).css("borderLeftWidth"),10)||0)+(parseInt(a(c).css("paddingLeft"),10)||0)-this.margins.left,b.top+(parseInt(a(c).css("borderTopWidth"),10)||0)+(parseInt(a(c).css("paddingTop"),10)||0)-this.margins.top,b.left+(e?Math.max(c.scrollWidth,c.offsetWidth):c.offsetWidth)-(parseInt(a(c).css("borderLeftWidth"),10)||0)-(parseInt(a(c).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,b.top+(e?Math.max(c.scrollHeight,
c.offsetHeight):c.offsetHeight)-(parseInt(a(c).css("borderTopWidth"),10)||0)-(parseInt(a(c).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(b,c){c||(c=this.position);b="absolute"===b?1:-1;var d="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,f=/(html|body)/i.test(d[0].tagName);return{top:c.top+this.offset.relative.top*b+this.offset.parent.top*
b-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():f?0:d.scrollTop())*b,left:c.left+this.offset.relative.left*b+this.offset.parent.left*b-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():f?0:d.scrollLeft())*b}},_generatePosition:function(b){var d=this.options;var c=b.pageX;var e=b.pageY;var g="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(g[0].tagName);
"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset());this.originalPosition&&(this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(c=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(e=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(c=this.containment[2]+this.offset.click.left),
b.pageY-this.offset.click.top>this.containment[3]&&(e=this.containment[3]+this.offset.click.top)),d.grid&&(e=this.originalPageY+Math.round((e-this.originalPageY)/d.grid[1])*d.grid[1],e=this.containment?e-this.offset.click.top>=this.containment[1]&&e-this.offset.click.top<=this.containment[3]?e:e-this.offset.click.top>=this.containment[1]?e-d.grid[1]:e+d.grid[1]:e,c=this.originalPageX+Math.round((c-this.originalPageX)/d.grid[0])*d.grid[0],c=this.containment?c-this.offset.click.left>=this.containment[0]&&
c-this.offset.click.left<=this.containment[2]?c:c-this.offset.click.left>=this.containment[0]?c-d.grid[0]:c+d.grid[0]:c));return{top:e-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():h?0:g.scrollTop()),left:c-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():h?0:g.scrollLeft())}},_rearrange:function(a,b,c,e){c?c[0].appendChild(this.placeholder[0]):
b.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?b.item[0]:b.item[0].nextSibling);var d=this.counter=this.counter?++this.counter:1;this._delay(function(){d===this.counter&&this.refreshPositions(!e)})},_clear:function(a,b){function d(a,b,d){return function(c){d._trigger(a,c,b._uiHash(b))}}this.reverting=!1;var c,f=[];!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem);this._noFinalSort=null;if(this.helper[0]===this.currentItem[0]){for(c in this._storedCSS)if("auto"===
this._storedCSS[c]||"static"===this._storedCSS[c])this._storedCSS[c]="";this.currentItem.css(this._storedCSS);this._removeClass(this.currentItem,"ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!b&&f.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))});!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||b||f.push(function(a){this._trigger("update",a,this._uiHash())});
this===this.currentContainer||b||(f.push(function(a){this._trigger("remove",a,this._uiHash())}),f.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.currentContainer)),f.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.currentContainer)));for(c=this.containers.length-1;0<=c;c--)b||f.push(d("deactivate",this,this.containers[c])),this.containers[c].containerCache.over&&(f.push(d("out",this,this.containers[c])),
this.containers[c].containerCache.over=0);this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove());this._storedOpacity&&this.helper.css("opacity",this._storedOpacity);this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex);this.dragging=!1;b||this._trigger("beforeStop",a,this._uiHash());this.placeholder[0].parentNode.removeChild(this.placeholder[0]);this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&
this.helper.remove(),this.helper=null);if(!b){for(c=0;c<f.length;c++)f[c].call(this,a);this._trigger("stop",a,this._uiHash())}this.fromOutside=!1;return!this.cancelHelperRemoval},_trigger:function(){!1===a.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(b){var d=b||this;return{helper:d.helper,placeholder:d.placeholder||a([]),position:d.position,originalPosition:d.originalPosition,offset:d.positionAbs,item:d.currentItem,sender:b?b.element:null}}});a.widget("ui.spinner",
{version:"1.13.1",defaultElement:"<input>",widgetEventPrefix:"spin",options:{classes:{"ui-spinner":"ui-corner-all","ui-spinner-down":"ui-corner-br","ui-spinner-up":"ui-corner-tr"},culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max);this._setOption("min",this.options.min);this._setOption("step",this.options.step);
""!==this.value()&&this._value(this.element.val(),!0);this._draw();this._on(this._events);this._refresh();this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var b=this._super(),c=this.element;a.each(["min","max","step"],function(a,d){a=c.attr(d);null!=a&&a.length&&(b[d]=a)});return b},_events:{keydown:function(a){this._start(a)&&this._keydown(a)&&a.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},
blur:function(a){this.cancelBlur?delete this.cancelBlur:(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",a))},mousewheel:function(b,c){var d=a.ui.safeActiveElement(this.document[0]);if(this.element[0]===d&&c){if(!this.spinning&&!this._start(b))return!1;this._spin((0<c?1:-1)*this.options.step,b);clearTimeout(this.mousewheelTimer);this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(b)},100);b.preventDefault()}},"mousedown .ui-spinner-button":function(b){function d(){this.element[0]!==
a.ui.safeActiveElement(this.document[0])&&(this.element.trigger("focus"),this.previous=c,this._delay(function(){this.previous=c}))}var c=this.element[0]===a.ui.safeActiveElement(this.document[0])?this.previous:this.element.val();b.preventDefault();d.call(this);this.cancelBlur=!0;this._delay(function(){delete this.cancelBlur;d.call(this)});!1!==this._start(b)&&this._repeat(null,a(b.currentTarget).hasClass("ui-spinner-up")?1:-1,b)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(b){if(a(b.currentTarget).hasClass("ui-state-active")){if(!1===
this._start(b))return!1;this._repeat(null,a(b.currentTarget).hasClass("ui-spinner-up")?1:-1,b)}},"mouseleave .ui-spinner-button":"_stop"},_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap("<span>").parent().append("<a></a><a></a>")},_draw:function(){this._enhance();this._addClass(this.uiSpinner,"ui-spinner","ui-widget ui-widget-content");this._addClass("ui-spinner-input");this.element.attr("role","spinbutton");this.buttons=this.uiSpinner.children("a").attr("tabIndex",
-1).attr("aria-hidden",!0).button({classes:{"ui-button":""}});this._removeClass(this.buttons,"ui-corner-all");this._addClass(this.buttons.first(),"ui-spinner-button ui-spinner-up");this._addClass(this.buttons.last(),"ui-spinner-button ui-spinner-down");this.buttons.first().button({icon:this.options.icons.up,showLabel:!1});this.buttons.last().button({icon:this.options.icons.down,showLabel:!1});this.buttons.height()>Math.ceil(.5*this.uiSpinner.height())&&0<this.uiSpinner.height()&&this.uiSpinner.height(this.uiSpinner.height())},
_keydown:function(b){var d=this.options,c=a.ui.keyCode;switch(b.keyCode){case c.UP:return this._repeat(null,1,b),!0;case c.DOWN:return this._repeat(null,-1,b),!0;case c.PAGE_UP:return this._repeat(null,d.page,b),!0;case c.PAGE_DOWN:return this._repeat(null,-d.page,b),!0}return!1},_start:function(a){if(!this.spinning&&!1===this._trigger("start",a))return!1;this.counter||(this.counter=1);return this.spinning=!0},_repeat:function(a,b,c){a=a||500;clearTimeout(this.timer);this.timer=this._delay(function(){this._repeat(40,
b,c)},a);this._spin(b*this.options.step,c)},_spin:function(a,b){var d=this.value()||0;this.counter||(this.counter=1);d=this._adjustValue(d+a*this._increment(this.counter));this.spinning&&!1===this._trigger("spin",b,{value:d})||(this._value(d),this.counter++)},_increment:function(a){var b=this.options.incremental;return b?"function"===typeof b?b(a):Math.floor(a*a*a/5E4-a*a/500+17*a/200+1):1},_precision:function(){var a=this._precisionOf(this.options.step);null!==this.options.min&&(a=Math.max(a,this._precisionOf(this.options.min)));
return a},_precisionOf:function(a){a=a.toString();var b=a.indexOf(".");return-1===b?0:a.length-b-1},_adjustValue:function(a){var b=this.options;var d=null!==b.min?b.min:0;a=d+Math.round((a-d)/b.step)*b.step;a=parseFloat(a.toFixed(this._precision()));return null!==b.max&&a>b.max?b.max:null!==b.min&&a<b.min?b.min:a},_stop:function(a){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",a))},_setOption:function(a,b){if("culture"===
a||"numberFormat"===a){var d=this._parse(this.element.val());this.options[a]=b;this.element.val(this._format(d))}else"max"!==a&&"min"!==a&&"step"!==a||"string"!==typeof b||(b=this._parse(b)),"icons"===a&&(d=this.buttons.first().find(".ui-icon"),this._removeClass(d,null,this.options.icons.up),this._addClass(d,null,b.up),d=this.buttons.last().find(".ui-icon"),this._removeClass(d,null,this.options.icons.down),this._addClass(d,null,b.down)),this._super(a,b)},_setOptionDisabled:function(a){this._super(a);
this._toggleClass(this.uiSpinner,null,"ui-state-disabled",!!a);this.element.prop("disabled",!!a);this.buttons.button(a?"disable":"enable")},_setOptions:p(function(a){this._super(a)}),_parse:function(a){"string"===typeof a&&""!==a&&(a=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(a,10,this.options.culture):+a);return""===a||isNaN(a)?null:a},_format:function(a){return""===a?"":window.Globalize&&this.options.numberFormat?Globalize.format(a,this.options.numberFormat,this.options.culture):
a},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var a=this.value();return null===a?!1:a===this._adjustValue(a)},_value:function(a,b){if(""!==a){var d=this._parse(a);null!==d&&(b||(d=this._adjustValue(d)),a=this._format(d))}this.element.val(a);this._refresh()},_destroy:function(){this.element.prop("disabled",!1).removeAttr("autocomplete role aria-valuemin aria-valuemax aria-valuenow");
this.uiSpinner.replaceWith(this.element)},stepUp:p(function(a){this._stepUp(a)}),_stepUp:function(a){this._start()&&(this._spin((a||1)*this.options.step),this._stop())},stepDown:p(function(a){this._stepDown(a)}),_stepDown:function(a){this._start()&&(this._spin((a||1)*-this.options.step),this._stop())},pageUp:p(function(a){this._stepUp((a||1)*this.options.page)}),pageDown:p(function(a){this._stepDown((a||1)*this.options.page)}),value:function(a){if(!arguments.length)return this._parse(this.element.val());
p(this._value).call(this,a)},widget:function(){return this.uiSpinner}});!1!==a.uiBackCompat&&a.widget("ui.spinner",a.ui.spinner,{_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml())},_uiSpinnerHtml:function(){return"<span>"},_buttonHtml:function(){return"<a></a><a></a>"}});a.widget("ui.tabs",{version:"1.13.1",delay:300,options:{active:null,classes:{"ui-tabs":"ui-corner-all","ui-tabs-nav":"ui-corner-all","ui-tabs-panel":"ui-corner-bottom",
"ui-tabs-tab":"ui-corner-top"},collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var a=/#.*$/;return function(b){var d=b.href.replace(a,"");var c=location.href.replace(a,"");try{d=decodeURIComponent(d)}catch(C){}try{c=decodeURIComponent(c)}catch(C){}return 1<b.hash.length&&d===c}}(),_create:function(){var b=this,c=this.options;this.running=!1;this._addClass("ui-tabs","ui-widget ui-widget-content");
this._toggleClass("ui-tabs-collapsible",null,c.collapsible);this._processTabs();c.active=this._initialActive();Array.isArray(c.disabled)&&(c.disabled=a.uniqueSort(c.disabled.concat(a.map(this.tabs.filter(".ui-state-disabled"),function(a){return b.tabs.index(a)}))).sort());this.active=!1!==this.options.active&&this.anchors.length?this._findActive(c.active):a();this._refresh();this.active.length&&this.load(c.active)},_initialActive:function(){var b=this.options.active,c=this.options.collapsible,e=location.hash.substring(1);
null===b&&(e&&this.tabs.each(function(d,c){if(a(c).attr("aria-controls")===e)return b=d,!1}),null===b&&(b=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),null===b||-1===b)&&(b=this.tabs.length?0:!1);!1!==b&&(b=this.tabs.index(this.tabs.eq(b)),-1===b&&(b=c?!1:0));!c&&!1===b&&this.anchors.length&&(b=0);return b},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):a()}},_tabKeydown:function(b){var d=a(a.ui.safeActiveElement(this.document[0])).closest("li"),
c=this.tabs.index(d),e=!0;if(!this._handlePageNav(b)){switch(b.keyCode){case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:c++;break;case a.ui.keyCode.UP:case a.ui.keyCode.LEFT:e=!1;c--;break;case a.ui.keyCode.END:c=this.anchors.length-1;break;case a.ui.keyCode.HOME:c=0;break;case a.ui.keyCode.SPACE:b.preventDefault();clearTimeout(this.activating);this._activate(c);return;case a.ui.keyCode.ENTER:b.preventDefault();clearTimeout(this.activating);this._activate(c===this.options.active?!1:c);return;default:return}b.preventDefault();
clearTimeout(this.activating);c=this._focusNextTab(c,e);b.ctrlKey||b.metaKey||(d.attr("aria-selected","false"),this.tabs.eq(c).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",c)},this.delay))}},_panelKeydown:function(b){!this._handlePageNav(b)&&b.ctrlKey&&b.keyCode===a.ui.keyCode.UP&&(b.preventDefault(),this.active.trigger("focus"))},_handlePageNav:function(b){if(b.altKey&&b.keyCode===a.ui.keyCode.PAGE_UP)return this._activate(this._focusNextTab(this.options.active-
1,!1)),!0;if(b.altKey&&b.keyCode===a.ui.keyCode.PAGE_DOWN)return this._activate(this._focusNextTab(this.options.active+1,!0)),!0},_findNextTab:function(b,c){function d(){b>f&&(b=0);0>b&&(b=f);return b}for(var f=this.tabs.length-1;-1!==a.inArray(d(),this.options.disabled);)b=c?b+1:b-1;return b},_focusNextTab:function(a,b){a=this._findNextTab(a,b);this.tabs.eq(a).trigger("focus");return a},_setOption:function(a,b){"active"===a?this._activate(b):(this._super(a,b),"collapsible"===a&&(this._toggleClass("ui-tabs-collapsible",
null,b),b||!1!==this.options.active||this._activate(0)),"event"===a&&this._setupEvents(b),"heightStyle"===a&&this._setupHeightStyle(b))},_sanitizeSelector:function(a){return a?a.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var b=this.options,c=this.tablist.children(":has(a[href])");b.disabled=a.map(c.filter(".ui-state-disabled"),function(a){return c.index(a)});this._processTabs();!1!==b.active&&this.anchors.length?this.active.length&&!a.contains(this.tablist[0],this.active[0])?
this.tabs.length===b.disabled.length?(b.active=!1,this.active=a()):this._activate(this._findNextTab(Math.max(0,b.active-1),!1)):b.active=this.tabs.index(this.active):(b.active=!1,this.active=a());this._refresh()},_refresh:function(){this._setOptionDisabled(this.options.disabled);this._setupEvents(this.options.event);this._setupHeightStyle(this.options.heightStyle);this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1});this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"});
this.active.length?(this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._addClass(this.active,"ui-tabs-active","ui-state-active"),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var b=this,c=this.tabs,e=this.anchors,g=this.panels;this.tablist=this._getList().attr("role","tablist");this._addClass(this.tablist,"ui-tabs-nav","ui-helper-reset ui-helper-clearfix ui-widget-header");this.tablist.on("mousedown"+
this.eventNamespace,"> li",function(b){a(this).is(".ui-state-disabled")&&b.preventDefault()}).on("focus"+this.eventNamespace,".ui-tabs-anchor",function(){a(this).closest("li").is(".ui-state-disabled")&&this.blur()});this.tabs=this.tablist.find("> li:has(a[href])").attr({role:"tab",tabIndex:-1});this._addClass(this.tabs,"ui-tabs-tab","ui-state-default");this.anchors=this.tabs.map(function(){return a("a",this)[0]}).attr({tabIndex:-1});this._addClass(this.anchors,"ui-tabs-anchor");this.panels=a();this.anchors.each(function(d,
c){var f=a(c).uniqueId().attr("id"),e=a(c).closest("li"),g=e.attr("aria-controls");if(b._isLocal(c)){d=c.hash;c=d.substring(1);var h=b.element.find(b._sanitizeSelector(d))}else c=e.attr("aria-controls")||a({}).uniqueId()[0].id,h=b.element.find("#"+c),h.length||(h=b._createPanel(c),h.insertAfter(b.panels[d-1]||b.tablist)),h.attr("aria-live","polite");h.length&&(b.panels=b.panels.add(h));g&&e.data("ui-tabs-aria-controls",g);e.attr({"aria-controls":c,"aria-labelledby":f});h.attr("aria-labelledby",f)});
this.panels.attr("role","tabpanel");this._addClass(this.panels,"ui-tabs-panel","ui-widget-content");c&&(this._off(c.not(this.tabs)),this._off(e.not(this.anchors)),this._off(g.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol, ul").eq(0)},_createPanel:function(b){return a("<div>").attr("id",b).data("ui-tabs-destroy",!0)},_setOptionDisabled:function(b){var d,c;Array.isArray(b)&&(b.length?b.length===this.anchors.length&&(b=!0):b=!1);for(c=0;d=this.tabs[c];c++)d=a(d),
!0===b||-1!==a.inArray(c,b)?(d.attr("aria-disabled","true"),this._addClass(d,null,"ui-state-disabled")):(d.removeAttr("aria-disabled"),this._removeClass(d,null,"ui-state-disabled"));this.options.disabled=b;this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!0===b)},_setupEvents:function(b){var d={};b&&a.each(b.split(" "),function(a,b){d[b]="_eventHandler"});this._off(this.anchors.add(this.tabs).add(this.panels));this._on(!0,this.anchors,{click:function(a){a.preventDefault()}});this._on(this.anchors,
d);this._on(this.tabs,{keydown:"_tabKeydown"});this._on(this.panels,{keydown:"_panelKeydown"});this._focusable(this.tabs);this._hoverable(this.tabs)},_setupHeightStyle:function(b){var d=this.element.parent();if("fill"===b){var c=d.height();c-=this.element.outerHeight()-this.element.height();this.element.siblings(":visible").each(function(){var b=a(this),d=b.css("position");"absolute"!==d&&"fixed"!==d&&(c-=b.outerHeight(!0))});this.element.children().not(this.panels).each(function(){c-=a(this).outerHeight(!0)});
this.panels.each(function(){a(this).height(Math.max(0,c-a(this).innerHeight()+a(this).height()))}).css("overflow","auto")}else"auto"===b&&(c=0,this.panels.each(function(){c=Math.max(c,a(this).height("").height())}).height(c))},_eventHandler:function(b){var d=this.options,c=this.active,e=a(b.currentTarget).closest("li"),g=e[0]===c[0],h=g&&d.collapsible,n=h?a():this._getPanelForTab(e),l=c.length?this._getPanelForTab(c):a();c={oldTab:c,oldPanel:l,newTab:h?a():e,newPanel:n};b.preventDefault();e.hasClass("ui-state-disabled")||
e.hasClass("ui-tabs-loading")||this.running||g&&!d.collapsible||!1===this._trigger("beforeActivate",b,c)||(d.active=h?!1:this.tabs.index(e),this.active=g?a():e,this.xhr&&this.xhr.abort(),l.length||n.length||a.error("jQuery UI Tabs: Mismatching fragment identifier."),n.length&&this.load(this.tabs.index(e),b),this._toggle(b,c))},_toggle:function(b,c){function d(){e.running=!1;e._trigger("activate",b,c)}function f(){e._addClass(c.newTab.closest("li"),"ui-tabs-active","ui-state-active");g.length&&e.options.show?
e._show(g,e.options.show,d):(g.show(),d())}var e=this,g=c.newPanel,h=c.oldPanel;this.running=!0;h.length&&this.options.hide?this._hide(h,this.options.hide,function(){e._removeClass(c.oldTab.closest("li"),"ui-tabs-active","ui-state-active");f()}):(this._removeClass(c.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),h.hide(),f());h.attr("aria-hidden","true");c.oldTab.attr({"aria-selected":"false","aria-expanded":"false"});g.length&&h.length?c.oldTab.attr("tabIndex",-1):g.length&&this.tabs.filter(function(){return 0===
a(this).attr("tabIndex")}).attr("tabIndex",-1);g.attr("aria-hidden","false");c.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(b){b=this._findActive(b);b[0]!==this.active[0]&&(b.length||(b=this.active),b=b.find(".ui-tabs-anchor")[0],this._eventHandler({target:b,currentTarget:b,preventDefault:a.noop}))},_findActive:function(b){return!1===b?a():this.tabs.eq(b)},_getIndex:function(b){"string"===typeof b&&(b=this.anchors.index(this.anchors.filter("[href$='"+
a.escapeSelector(b)+"']")));return b},_destroy:function(){this.xhr&&this.xhr.abort();this.tablist.removeAttr("role").off(this.eventNamespace);this.anchors.removeAttr("role tabIndex").removeUniqueId();this.tabs.add(this.panels).each(function(){a.data(this,"ui-tabs-destroy")?a(this).remove():a(this).removeAttr("role tabIndex aria-live aria-busy aria-selected aria-labelledby aria-hidden aria-expanded")});this.tabs.each(function(){var b=a(this),c=b.data("ui-tabs-aria-controls");c?b.attr("aria-controls",
c).removeData("ui-tabs-aria-controls"):b.removeAttr("aria-controls")});this.panels.show();"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(b){var d=this.options.disabled;!1!==d&&(void 0===b?d=!1:(b=this._getIndex(b),d=Array.isArray(d)?a.map(d,function(a){return a!==b?a:null}):a.map(this.tabs,function(a,d){return d!==b?d:null})),this._setOptionDisabled(d))},disable:function(b){var d=this.options.disabled;if(!0!==d){if(void 0===b)d=!0;else{b=this._getIndex(b);if(-1!==
a.inArray(b,d))return;d=Array.isArray(d)?a.merge([b],d).sort():[b]}this._setOptionDisabled(d)}},load:function(b,c){b=this._getIndex(b);var d=this,f=this.tabs.eq(b);b=f.find(".ui-tabs-anchor");var e=this._getPanelForTab(f),g={tab:f,panel:e},h=function(a,b){"abort"===b&&d.panels.stop(!1,!0);d._removeClass(f,"ui-tabs-loading");e.removeAttr("aria-busy");a===d.xhr&&delete d.xhr};this._isLocal(b[0])||(this.xhr=a.ajax(this._ajaxSettings(b,c,g)))&&"canceled"!==this.xhr.statusText&&(this._addClass(f,"ui-tabs-loading"),
e.attr("aria-busy","true"),this.xhr.done(function(a,b,f){setTimeout(function(){e.html(a);d._trigger("load",c,g);h(f,b)},1)}).fail(function(a,b){setTimeout(function(){h(a,b)},1)}))},_ajaxSettings:function(b,c,e){var d=this;return{url:b.attr("href").replace(/#.*$/,""),beforeSend:function(b,f){return d._trigger("beforeLoad",c,a.extend({jqXHR:b,ajaxSettings:f},e))}}},_getPanelForTab:function(b){b=a(b).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+b))}});!1!==a.uiBackCompat&&
a.widget("ui.tabs",a.ui.tabs,{_processTabs:function(){this._superApply(arguments);this._addClass(this.tabs,"ui-tab")}});a.widget("ui.tooltip",{version:"1.13.1",options:{classes:{"ui-tooltip":"ui-corner-all ui-widget-shadow"},content:function(){var b=a(this).attr("title");return a("<a>").text(b).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,track:!1,close:null,open:null},_addDescribedBy:function(a,b){var d=(a.attr("aria-describedby")||
"").split(/\s+/);d.push(b);a.data("ui-tooltip-id",b).attr("aria-describedby",String.prototype.trim.call(d.join(" ")))},_removeDescribedBy:function(b){var d=b.data("ui-tooltip-id"),c=(b.attr("aria-describedby")||"").split(/\s+/);d=a.inArray(d,c);-1!==d&&c.splice(d,1);b.removeData("ui-tooltip-id");(c=String.prototype.trim.call(c.join(" ")))?b.attr("aria-describedby",c):b.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"});this.tooltips={};this.parents={};this.liveRegion=
a("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body);this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible");this.disabledTitles=a([])},_setOption:function(b,c){var d=this;this._super(b,c);"content"===b&&a.each(this.tooltips,function(a,b){d._updateContent(b.element)})},_setOptionDisabled:function(a){this[a?"_disable":"_enable"]()},_disable:function(){var b=this;a.each(this.tooltips,function(d,c){d=a.Event("blur");d.target=d.currentTarget=
c.element[0];b.close(d,!0)});this.disabledTitles=this.disabledTitles.add(this.element.find(this.options.items).addBack().filter(function(){var b=a(this);if(b.is("[title]"))return b.data("ui-tooltip-title",b.attr("title")).removeAttr("title")}))},_enable:function(){this.disabledTitles.each(function(){var b=a(this);b.data("ui-tooltip-title")&&b.attr("title",b.data("ui-tooltip-title"))});this.disabledTitles=a([])},open:function(b){var d=this,c=a(b?b.target:this.element).closest(this.options.items);c.length&&
!c.data("ui-tooltip-id")&&(c.attr("title")&&c.data("ui-tooltip-title",c.attr("title")),c.data("ui-tooltip-open",!0),b&&"mouseover"===b.type&&c.parents().each(function(){var b=a(this);if(b.data("ui-tooltip-open")){var c=a.Event("blur");c.target=c.currentTarget=this;d.close(c,!0)}b.attr("title")&&(b.uniqueId(),d.parents[this.id]={element:this,title:b.attr("title")},b.attr("title",""))}),this._registerCloseHandlers(b,c),this._updateContent(c,b))},_updateContent:function(a,b){var d=this.options.content;
var c=this,e=b?b.type:null;if("string"===typeof d||d.nodeType||d.jquery)return this._open(b,a,d);(d=d.call(a[0],function(d){c._delay(function(){a.data("ui-tooltip-open")&&(b&&(b.type=e),this._open(b,a,d))})}))&&this._open(b,a,d)},_open:function(b,c,e){function d(a){g.of=a;h.is(":hidden")||h.position(g)}var f,g=a.extend({},this.options.position);if(e)if(f=this._find(c))f.tooltip.find(".ui-tooltip-content").html(e);else{c.is("[title]")&&(b&&"mouseover"===b.type?c.attr("title",""):c.removeAttr("title"));
f=this._tooltip(c);var h=f.tooltip;this._addDescribedBy(c,h.attr("id"));h.find(".ui-tooltip-content").html(e);this.liveRegion.children().hide();e=a("<div>").html(h.find(".ui-tooltip-content").html());e.removeAttr("name").find("[name]").removeAttr("name");e.removeAttr("id").find("[id]").removeAttr("id");e.appendTo(this.liveRegion);this.options.track&&b&&/^mouse/.test(b.type)?(this._on(this.document,{mousemove:d}),d(b)):h.position(a.extend({of:c},this.options.position));h.hide();this._show(h,this.options.show);
if(this.options.track&&this.options.show&&this.options.show.delay)var l=this.delayedShow=setInterval(function(){h.is(":visible")&&(d(g.of),clearInterval(l))},13);this._trigger("open",b,{tooltip:h})}},_registerCloseHandlers:function(b,c){var d={keyup:function(b){b.keyCode===a.ui.keyCode.ESCAPE&&(b=a.Event(b),b.currentTarget=c[0],this.close(b,!0))}};c[0]!==this.element[0]&&(d.remove=function(){var a=this._find(c);a&&this._removeTooltip(a.tooltip)});b&&"mouseover"!==b.type||(d.mouseleave="close");b&&
"focusin"!==b.type||(d.focusout="close");this._on(!0,c,d)},close:function(b){var d=this,c=a(b?b.currentTarget:this.element),e=this._find(c);if(e){var g=e.tooltip;e.closing||(clearInterval(this.delayedShow),c.data("ui-tooltip-title")&&!c.attr("title")&&c.attr("title",c.data("ui-tooltip-title")),this._removeDescribedBy(c),e.hiding=!0,g.stop(!0),this._hide(g,this.options.hide,function(){d._removeTooltip(a(this))}),c.removeData("ui-tooltip-open"),this._off(c,"mouseleave focusout keyup"),c[0]!==this.element[0]&&
this._off(c,"remove"),this._off(this.document,"mousemove"),b&&"mouseleave"===b.type&&a.each(this.parents,function(b,c){a(c.element).attr("title",c.title);delete d.parents[b]}),e.closing=!0,this._trigger("close",b,{tooltip:g}),e.hiding||(e.closing=!1))}else c.removeData("ui-tooltip-open")},_tooltip:function(b){var d=a("<div>").attr("role","tooltip"),c=a("<div>").appendTo(d),e=d.uniqueId().attr("id");this._addClass(c,"ui-tooltip-content");this._addClass(d,"ui-tooltip","ui-widget ui-widget-content");
d.appendTo(this._appendTo(b));return this.tooltips[e]={element:b,tooltip:d}},_find:function(a){return(a=a.data("ui-tooltip-id"))?this.tooltips[a]:null},_removeTooltip:function(a){clearInterval(this.delayedShow);a.remove();delete this.tooltips[a.attr("id")]},_appendTo:function(a){a=a.closest(".ui-front, dialog");a.length||(a=this.document[0].body);return a},_destroy:function(){var b=this;a.each(this.tooltips,function(d,c){var e=a.Event("blur");c=c.element;e.target=e.currentTarget=c[0];b.close(e,!0);
a("#"+d).remove();c.data("ui-tooltip-title")&&(c.attr("title")||c.attr("title",c.data("ui-tooltip-title")),c.removeData("ui-tooltip-title"))});this.liveRegion.remove()}});!1!==a.uiBackCompat&&a.widget("ui.tooltip",a.ui.tooltip,{options:{tooltipClass:null},_tooltip:function(){var a=this._superApply(arguments);this.options.tooltipClass&&a.tooltip.addClass(this.options.tooltipClass);return a}})});/*
 jQuery UI Touch Punch 0.2.3

 Copyright 2011?2014, Dave Furfero
 Dual licensed under the MIT or GPL Version 2 licenses.

 Depends:
  jquery.ui.widget.js
  jquery.ui.mouse.js
*/
!function(a){function k(a,b){if(!(1<a.originalEvent.touches.length)){a.preventDefault();var c=a.originalEvent.changedTouches[0],e=document.createEvent("MouseEvents");e.initMouseEvent(b,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null);a.target.dispatchEvent(e)}}if(a.support.touch="ontouchend"in document,a.support.touch){var c,e=a.ui.mouse.prototype,b=e._mouseInit,h=e._mouseDestroy;e._touchStart=function(a){!c&&this._mouseCapture(a.originalEvent.changedTouches[0])&&(c=!0,this._touchMoved=
!1,k(a,"mouseover"),k(a,"mousemove"),k(a,"mousedown"))};e._touchMove=function(a){c&&(this._touchMoved=!0,k(a,"mousemove"))};e._touchEnd=function(a){c&&(k(a,"mouseup"),k(a,"mouseout"),this._touchMoved||k(a,"click"),c=!1)};e._mouseInit=function(){this.element.bind({touchstart:a.proxy(this,"_touchStart"),touchmove:a.proxy(this,"_touchMove"),touchend:a.proxy(this,"_touchEnd")});b.call(this)};e._mouseDestroy=function(){this.element.unbind({touchstart:a.proxy(this,"_touchStart"),touchmove:a.proxy(this,
"_touchMove"),touchend:a.proxy(this,"_touchEnd")});h.call(this)}}}(jQuery);window.TOONTALK||(window.TOONTALK={});window.TOONTALK.creators_from_json={};window.TOONTALK.create_function_table=function(a){return function(){var k={};return{check_message:function(c){var e={};if(!c.is_box())return this.report_error("Function birds can only respond to boxes. One was given "+a.UTILITIES.add_a_or_an(c.get_type_name()));e.box_size=c.get_size();if(1>e.box_size)return this.report_error("Function birds can only respond to boxes with holes.");var b=c.get_hole_contents(0);if(!b)return this.report_error("Function birds can only respond to boxes with something in the first hole.");
if(b.is_box()){e.bird=b.get_hole_contents(0);if(2<b.get_size()&&(e.error_bird=b.get_hole_contents(2),e.error_bird&&!e.error_bird.is_bird()))return this.report_error("A function bird received a box with a box in its first hole that should only contain birds. It contains "+a.UTILITIES.add_a_or_an(e.message_return_bird.get_type_name())+".",e.bird.is_bird()&&e);if(!e.bird)return this.report_error("Function birds can only respond to boxes with a box in the first hole if the box's first hole contains a bird. It is empty.",
e);if(!e.bird.is_bird())return this.report_error("Function birds can only respond to boxes with a box in the first hole if the box's first hole contains a bird. The first hole contains "+a.UTILITIES.add_a_or_an(e.bird.get_type_name())+".",e);if(1<b.get_size()&&(e.message_return_bird=b.get_hole_contents(1),e.message_return_bird&&!e.message_return_bird.is_bird()))return this.report_error("A function bird received a box with a box in its first hole that should only contain birds. It contains "+a.UTILITIES.add_a_or_an(e.message_return_bird.get_type_name())+
".",e)}else if(b.is_bird())e.bird=b;else return this.report_error("Function birds can only respond to boxes with a bird in the first hole. The first hole contains "+a.UTILITIES.add_a_or_an(b.get_type_name())+".",e);e.message=c;return e},report_error:function(c,e){a.UTILITIES.display_message(c);e&&(e.error_bird||e.bird)&&(e.error_bird||e.bird).widget_side_dropped_on_me(a.element.create(c),{});e&&e.message_return_bird&&e.message_return_bird.widget_side_dropped_on_me(e.message,void 0);return c},process_response:function(a,
e,b,h){a&&(h.do_not_run_next_step=!0,h.by_function_bird=!0,e.message_return_bird||(h.temporary_bird=!0),e.bird.widget_side_dropped_on_me(a,h),e&&e.message_return_bird&&e.message_return_bird.widget_side_dropped_on_me(e.message,h));e.message_return_bird||b.remove({do_not_remove_children:!0,remove_backside:!0})},process_message:function(a,e,b){var c=this.check_message(a);if("string"!==typeof c)return e=e(c,b),!c.message_return_bird&&1<a.get_size()&&a.get_hole_contents(1)&&a.get_hole_contents(1).is_nest()&&
a.get_hole_contents(1).has_contents()&&(b.do_not_remove_children=!0,b.do_not_remove_frontside=!0,a.get_hole_contents(1).dereference().remove(b)),this.process_response(e,c,a,b),e},type_check:function(c,e,b,h,m,g){if(e.is_nest()&&!e.has_contents())throw a.sounds&&a.sounds.bird_fly.pause(),g&&g.make_message_nests_delivery_targets&&(e.set_visible(!0),a.UTILITIES.set_css(e.get_element(),$(m.message.get_element()).offset())),{wait_for_nest_to_receive_something:e};return c?e?e.dereference().is_of_type(c)?
!0:this.report_error("The '"+b+"' bird can only respond to boxes with "+a.UTILITIES.add_a_or_an(c)+" in the "+a.UTILITIES.ordinal(h)+" hole. The "+a.UTILITIES.ordinal(h)+" hole contains "+a.UTILITIES.add_a_or_an(e.get_type_name()+"."),m):this.report_error("The '"+b+"' bird can only respond to boxes with "+a.UTILITIES.add_a_or_an(c)+" in the "+a.UTILITIES.ordinal(h)+" hole. The "+a.UTILITIES.ordinal(h)+" hole is empty.",m):!0},number_check:function(a,e,b,h,m){return this.type_check("number",a,e,b,
h,m)},n_ary_widget_function:function(c,e,b,h,m){var g=function(g,m){var p;if(1===g.box_size)return e();var k=1;if(p=c.get_hole_contents(k)){if(p=p.dereference(),!0===this.number_check(p,h,k,g,m)){g.message_return_bird&&(p=p.copy());for(k++;k<g.box_size;){m=c.get_hole_contents(k);if(!m){this.report_error("The '"+h+"' bird could not work because the "+a.UTILITIES.ordinal(k-1)+" number is missing.",g);return}m=m.dereference();if(!0!==this.number_check(m,h,k,g))return;b.call(p,m);k++}return p}}else this.report_error("The '"+
h+"' bird could not work because the first number is missing.",g)}.bind(this);return this.process_message(c,g,m)},n_ary_function:function(c,e,b,h,m){var g=function(g){var m,k;if(g.box_size<b+1)this.report_error("The '"+h+"' bird can only respond to boxes with at least "+(b+1)+" holes. Not "+g.box_size+" holes.",g);else{var q=[];for(m=1;m<g.box_size;){var v=c.get_hole_contents(m);if(!v){this.report_error("The '"+h+"' bird stopped becaused the "+a.UTILITIES.ordinal(m)+" hole is empty.",g);return}v=
v.dereference();if(!0!==this.number_check(v,h,m,g))return;v.get_approximate&&v.get_approximate()&&(k=!0);q.push(v.get_value());m++}g=e.apply(null,q);k&&(g.set_approximate(!0),g.set_format("decimal"));return g}}.bind(this);return this.process_message(c,g,m)},typed_bird_function:function(c,e,b,h,m,g,k){var v=function(p){var q,v;if(0<=g&&p.box_size<g+1)this.report_error("The '"+h+"' bird can only respond to boxes with "+(g+1)+" or more holes. Not "+p.box_size+" holes.",p);else{var y=[];var z=1;for(q=
k?k:p.box_size-1;z<q+1;){var n=c.get_hole_contents(z);if(z<=g&&!n){this.report_error("The '"+h+"' bird found nothing in the "+a.UTILITIES.ordinal(z)+" hole.",p);return}if(n){n=n.dereference();z<=b.length&&(v=b[z-1]);if(!0!==this.type_check(v,n,h,z,p,m))return;y.push(n)}else y.push(void 0);z++}y.push(p);return e.apply(c,y)}}.bind(this);return this.process_message(c,v,m)},numeric_javascript_function_to_widget_function:function(c,e,b){return function(){var h=a.number.ZERO(a.number.function_bird_results_default_format);
h.set_value_from_decimal(c.apply(null,a.UTILITIES.map_arguments(arguments,b||bigrat.toDecimal)));e&&(h.set_approximate(!0),h.set_format("decimal"));return h}},bigrat_function_to_widget_function:function(c,e){return function(){var b=a.number.create_from_bigrat(c.apply(null,arguments));e&&e(arguments)&&(b.set_approximate(!0),b.set_format("decimal"));return b}},add_function_object:function(c,e,b,h,m){k[c]={name:c,short_name:h||c,respond_to_message:e,get_description:m?1===m.length?function(){return"If you give me a box with another bird and "+
a.UTILITIES.add_a_or_an(m[0])+" then "+a.UTILITIES.lower_case_first_letter(this.title)+"\nOn my backside you can change me to compute other functions."}:function(){return"If you give me a box with another bird, "+a.UTILITIES.conjunction(m,!0)+" then "+a.UTILITIES.lower_case_first_letter(this.title)+"\nOn my backside you can change me to compute other functions."}:function(){return"If you give me a box with another bird and some numbers then "+a.UTILITIES.lower_case_first_letter(this.title)+"\nOn my backside you can change me to compute other functions."},
toString:function(){return a.UTILITIES.add_a_or_an("'"+this.name+"' function bird")},title:b}},get_function_table:function(){return k}}}}(window.TOONTALK);window.TOONTALK.widget=function(a){var k=function(a){if(a=this.get_frontside(a))return a.get_element()};a.creators_from_json.top_level=function(c){c=a.widget.create_top_level_widget(c.settings);c.get_backside(!0);return c};return{add_standard_widget_functionality:function(c){var e=function(){return!1},b;this.add_sides_functionality(c);this.runnable(c);this.stackable(c);this.animatable(c);this.has_title(c);this.has_parent(c);this.has_backside_widgets(c);this.has_description(c);this.has_listeners(c);
this.droppable(c);this.erasable(c);c.this_and_walk_children=function(a){a(c)&&c.walk_children&&c.walk_children(a)};c.walk_children&&(c.walk_children_now_or_later=function(b,c){c&&c>a.maximum_recursion_depth?setTimeout(function(){this.walk_children(function(a){return b(a,0)})}.bind(this)):this.walk_children(function(a){return b(a,c?c+1:1)})}.bind(this));c.top_level_widget=function(){var c;if(b)return b;if(this.is_top_level())return this;if(b=a.UTILITIES.widget_side_of_jquery($(this.get_frontside_element()).closest(".toontalk-backside-of-top-level")))return b=
b.get_widget();if(c=this.get_parent_of_frontside()||this.get_parent_of_backside())return b=c.get_widget().top_level_widget();c=$(".toontalk-backside-of-top-level");if(0<c.length)return b=a.UTILITIES.widget_side_of_element(a.UTILITIES.closest_element(c,$(this.get_frontside_element()).offset())).get_widget();console.log("Could not find top_level_widget of "+this+". Created one instead");return b=this.create_top_level_widget()};c.is_of_type||(c.is_of_type=function(a){return this.get_type_name()===a});
c.dereference||(c.dereference=function(){return this});c.get_default_description||(c.get_default_description=function(){return a.UTILITIES.add_a_or_an(this.get_type_name())+"."});c.is_number||(c.is_number=e);c.is_box||(c.is_box=e);c.is_empty_hole||(c.is_empty_hole=e);c.is_hole||(c.is_hole=e);c.is_scale||(c.is_scale=e);c.is_bird||(c.is_bird=e);c.is_nest||(c.is_nest=e);c.is_robot||(c.is_robot=e);c.is_element||(c.is_element=e);c.is_sensor||(c.is_sensor=e);c.is_function_nest||(c.is_function_nest=e);c.is_plain_text_element||
(c.is_plain_text_element=e);c.is_attribute_widget||(c.is_attribute_widget=e);c.maintain_proportional_dimensions||(c.maintain_proportional_dimensions=e);c.ok_to_set_dimensions=function(){return!this.is_plain_text_element()};c.set_name&&(c.receive_name_from_dropped=function(a){if(a.get_text&&(a=a.get_text(),this.set_name(a,!0)))return this.get_name()});!a.debugging&&!a.logging||c.to_debug_string||(c.to_debug_string=function(a){var b=this.get_parent_widget_of_frontside(),c=this._debug_id,e=this.get_description();
e=e?e+" ":"";c||(c=b&&b.id?"id of parent is "+b.id:"");e&&(e+=" ");return(this.toString({plain_text:!0})+" ("+e+(this.get_name&&this.get_name()+" "||"")+c+")").substring(0,a)});c.is_top_level=e;c.is_widget=!0},erasable:function(a){var c;a.get_erased||(a.get_erased=function(){return c});a.set_erased||(a.set_erased=function(a,e){c=a;e&&this.rerender()})},add_sides_functionality:function(c){var e,b,h;c.get_frontside||(c.get_frontside=function(b){b&&!e&&(e=a.frontside.create(c));return e},c.is_resizable||
(c.is_resizable=function(){return!1}),c.save_dimensions=function(){return this.save_dimensions_of(this)},c.save_dimensions_of=function(a){if(a.is_resizable()){if(a.is_element()){if(!this.get_original_width())return;var b=a.get_attribute("width");a=a.get_attribute("height")}else a=a.get_frontside_element(),b=$(a).width(),a=$(a).height();0<b&&(this.saved_width=b);0<a&&(this.saved_height=a);return!0}},c.restore_dimensions=function(){var b=this.get_frontside_element(!0);if(0<this.saved_width){if(this.ok_to_set_dimensions())this.use_scaling_transform?
this.use_scaling_transform({width:this.saved_width,height:this.saved_height}):this.set_size_attributes?this.set_size_attributes(this.saved_width,this.saved_height):a.UTILITIES.set_css(b,{width:this.saved_width,height:this.saved_height});else{var c={width:"",height:""};a.UTILITIES.set_css_transform(c,"");a.UTILITIES.set_css(b,c)}this.saved_height=this.saved_width=void 0}else b&&(this.is_bird()||this.is_nest()||this.is_robot())&&a.UTILITIES.set_css(b,{width:"",height:""})},c.get_width=function(){return a.UTILITIES.get_element_width(c.get_frontside_element())},
c.get_height=function(){return a.UTILITIES.get_element_height(c.get_frontside_element())});c.get_backside||(c.get_backside=function(a){a&&!b&&(b=this.create_backside(),this.backside_widgets_json_views&&b.add_backside_widgets(this.get_backside_widgets(),this.backside_widgets_json_views));return b});c.set_backside||(c.set_backside=function(a){b=a});c.forget_backside||(c.forget_backside=function(){var a;if(b){if(a=b.get_element())$(a).remove(),a.toontalk_widget_side=void 0;b=void 0}});c.create_backside||
(c.create_backside=function(){return a.backside.create(c)});c.get_open_backside_only_if_stopped||(c.get_open_backside_only_if_stopped=function(){return h});c.set_open_backside_only_if_stopped||(c.set_open_backside_only_if_stopped=function(a){h=a})},runnable:function(c){var e=!1,b=!1;c.get_running||(c.get_running=function(a){var b=!1;if(a)return e;if(e)if(a=this.get_backside_widgets(),0===a.length)e=!1;else for(a.some(function(a){if(a&&a.get_widget().get_running())return b=!0}),a=this.get_parent_of_frontside();a;){if(a.is_backside())return a.get_widget().get_running(!0);
if(a.get_running&&a.get_running(!0))return!0;a=a.get_parent_of_frontside()}return b});c.is_ok_to_run||(c.is_ok_to_run=function(){return b},c.set_ok_to_run=function(a){b=a});c.set_running||(c.set_running=function(h,m,g){var k=e===h,x;b=h;var p=this.get_backside_widgets();(e=h)&&a.logging&&0<=a.logging.indexOf("running")&&console.log(this._debug_string.substring(0,100)+" running.");this.get_backside()&&!k&&this.get_backside().run_status_changed(e);0<p.length&&a.UTILITIES.set_timeout(function(){a.UTILITIES.for_each_batch(p,
function(b){b&&(x=b.get_widget(),b.is_backside()&&(0<=this.get_backside_widgets().indexOf(x)||!b.is_primary_backside())||(!x.is_robot()||x.being_trained||x.get_body().is_empty()?x.set_running&&(!m&&b.is_backside()&&"top-level"!==c.get_type_name()?x.set_running(h,c,!0):x.set_running(h)):e?(e&&a.logging&&0<=a.logging.indexOf("running")&&console.log(x._debug_string.substring(0,100)+" running."),x.set_stopped(!1),x.run(c,g,m),x.set_ok_to_run(!0)):(x.set_stopped(!0),x.set_running(!1)),x.rerender()))}.bind(this))}.bind(this));
this.walk_children&&this.walk_children(function(a){a.set_running&&a.set_running(e);return!0});this.is_robot()&&!this.get_body().is_empty()&&(e?c.get_parent_of_backside()&&(this.set_stopped(!1),this.run(c.get_parent_of_backside().get_widget())):this.set_stopped(!0));k||this.rerender()})},droppable:function(a){a.drop_on||(a.drop_on=function(a,b){if(a.widget_side_dropped_on_me)return a.widget_side_dropped_on_me(this,b);console.log("No handler for drop of '"+this+"' on '"+a+"'")})},stackable:function(a){var c=
!1;a.get_infinite_stack||(a.get_infinite_stack=function(){return c});a.set_infinite_stack||(a.set_infinite_stack=function(b){var e=a.get_backside_element(),m=a.get_frontside_element();c=b;e&&$(e).find(".toontalk-infinite-stack-check-box").prop("checked",b);m&&(b?$(m).addClass("toontalk-infinite-stack"):$(m).removeClass("toontalk-infinite-stack"))})},animatable:function(c){if(!c.animate_to_widget){var e=function(b,c){var e=b.get_element();e&&(b.is_backside()||a.UTILITIES.visible_element(e))||(e=a.UTILITIES.find_resource_equal_to_widget(b,
c));return e};c.animate_to_widget=function(a,c,m,g,k,x,p,q){var b=function(){this.animate_to_element(e(a,q),c,m,g,k,x,p&&Math.max(0,p-100));this.rerender()}.bind(this);p?setTimeout(b,100):b()}}c.animate_to_element||(c.animate_to_element=function(b,c,e,g,k,x,p){var h=$(b).offset(),m=this.get_frontside_element(),y=$(b).is(".toontalk-backside");if(b&&a.UTILITIES.visible_element(b)&&0!==e){if("number"===typeof b.animation_left_offset)g=b.animation_left_offset;else if("undefined"===typeof g||y)g=(a.UTILITIES.get_element_width(b)-
a.UTILITIES.get_element_width(m))*Math.random();if("number"===typeof b.animation_top_offset)k=b.animation_top_offset;else if("undefined"===typeof k||y)k=(a.UTILITIES.get_element_height(b)-a.UTILITIES.get_element_height(m))*Math.random();h=h?{left:h.left+g,top:h.top+k}:{left:0,top:0};this.animate_to_absolute_position(h,c,e,x,p)}else c&&c()});c.animate_to_absolute_position||(c.animate_to_absolute_position=function(b,c,e,g,k){a.UTILITIES.animate_to_absolute_position(this.get_frontside_element(),b,c,
e,g,k)})},has_title:function(c){c.get_title||(c.get_title=function(){var c=this.get_type_name(),b=this.get_backside(),h=this.get_frontside_element(),m=this.get_description(),g="";$(h).is(".toontalk-top-level-resource")?g=this.can_run&&this.can_run()?this.get_running()?"Click elsewhere to stop me from running. Click on it to start me up again.":"Click to start me running. Click elsewhere to stop me.":"Drag me to a work area.":b&&b.get_element()&&a.UTILITIES.visible_element(b.get_element())||a.open_backside_only_if_alt_key||
(g=this.can_run&&this.can_run({widgets_considered:[],robots_only:!0})?this.get_running()?"Robots on my back are running (or waiting to run).\nTo see them click the stop sign "+a.UTILITIES.encode_HTML_for_title("<span class='toontalk-stop-sign-icon'></span>")+" and then click on me.":"There are robots on my back.\nTo see them in action click me to open my backside and then click the green flag "+a.UTILITIES.encode_HTML_for_title("<span class='toontalk-green-flag-icon'></span>")+".":"Click to see my backside.");
m&&(m="I'm "+m,g=g?m+"\n"+g:m);if(this.get_erased())return this.get_title_of_erased_widget();g=this.get_custom_title_prefix&&!$(h).is(".toontalk-top-level-resource")?this.get_custom_title_prefix()+"\n"+g:"I'm "+a.UTILITIES.add_a_or_an(c)+". "+g;g=g.trim();0>".?!".indexOf(g[g.length-1])&&(g+=".");return g});c.update_title=function(){var c=this.get_frontside_element();c&&a.UTILITIES.give_tooltip(c,this.get_title())}},inside_conditions_container:function(){return $(this.get_frontside_element()).closest(".toontalk-conditions-container").is("*")},
directly_inside_conditions_container:function(){return $(this.get_frontside_element()).parent(".toontalk-conditions-container").is("*")},get_title_of_erased_widget:function(){var a=this.get_type_name();return this.inside_conditions_container()?"I'm an erased "+a+".\nI'll match with any other "+a+".":"I'm an erased "+a+".\nDusty the Vacuum can restore me to normal."},has_parent:function(c){var e=[],b,h,m,g;c.get_parent_of_frontside=function(){return m&&b?b.get_backside(!0):b};c.get_parent_widget_of_frontside=
function(){return b};c.get_containing_widget=function(){return b&&b.is_hole()?b.get_parent_widget_of_frontside():this.get_parent_of_frontside()||this};c.parent_of_frontside_is_backside=function(){return m};c.set_parent_of_frontside=function(a,c,g){var h=b;m=c;b!==a&&(b=a,!h||g||c||(h.get_widget().remove_backside_widget(this,!0),a&&a.add_backside_widget&&a.add_backside_widget(this)),e.forEach(function(a){a(h,b)}))};c.add_parent_of_frontside_change_listener=function(a){e.push(a)};c.remove_parent_of_frontside_change_listener=
function(a){a=e.indexOf(a);0<=a&&e.splice(a,1)};c.get_parent_of_backside=function(){return g&&h?h.get_backside(!0):h};c.set_parent_of_backside=function(a,b,c){void 0===a&&!c&&g&&h&&h.get_widget().remove_backside_widget(this.get_backside(),!0);h=a;g=b};c.parent_of_backside_is_backside=function(){return g};c.closest_visible_ancestor=function(){for(var a=this;a&&!a.visible();)a=a.is_backside()?a.get_parent_of_backside():a.get_parent_of_frontside();return a||this};c.closest_visible_ancestor_or_frontside=
function(){for(var b=this,c;b&&!a.UTILITIES.visible_element(b.get_frontside_element());)c=b,b.is_backside()?(b=b.get_parent_of_backside())||(b=c.get_widget()):b=b.get_parent_of_frontside();return b||this};c.ancestor_of_type=function(a){for(var b=this;b&&!b.is_of_type(a);)b=b.is_backside()?b.get_widget().get_parent_of_backside():b.get_parent_of_frontside();return b};c.has_ancestor=function(a){var b;return this===a?!0:(b=this.get_parent_of_frontside())?b.has_ancestor(a):!1};c.has_ancestor_either_side=
function(b){var c;if(this===b||this===b.get_backside())return!0;if(c=this.get_parent_of_frontside())return c.has_ancestor_either_side(b);if(c=this.get_parent_of_backside())try{return c.has_ancestor_either_side(b)}catch(p){if(a.UTILITIES.is_stack_overflow(error))return!1;console.error("widget.has_ancestor_either_side encountered this error: "+p.message)}return!1};c.remove_from_parent_of_frontside=function(a){b&&(b.is_backside()?b.remove_backside_widget(this,!a):b.removed_from_container?m?b.remove_backside_widget(this,
!0):b.removed_from_container(this,a):b.get_backside()&&b.remove_backside_widget(this,!a))}},has_description:function(a){var c;a.get_description||(a.get_description=function(){return c});a.set_description||(a.set_description=function(a,e,m){if(c===a||!c&&""===a)return!1;c=a;e&&this.rerender();m&&this.robot_in_training()&&this.robot_in_training().edited(this,{setter_name:"set_description",argument_1:a,toString:"change the description to '"+a+"'' of the "+this.get_type_name(),button_selector:".toontalk-description-input"});
return!0});a.receive_description_from_dropped=function(a){if(a.get_text&&(a=a.get_text(),this.set_description(a,!0)))return this.get_description()}},has_name:function(c){var e;c.get_name||(c.get_name=function(){"string"!==typeof e&&c.generate_name&&(e=c.generate_name());return e});c.set_name||(c.set_name=function(b,c,m){if(e===b||"string"!==typeof b)return!1;e=b;a.UTILITIES.set_css(this.get_element(),{"font-size":this.name_font_size()});c&&this.rerender();m&&this.robot_in_training()&&this.robot_in_training().edited(this,
{setter_name:"set_name",argument_1:b,toString:"change the name of the "+this.get_type_name()+' to "'+e+'"',button_selector:".toontalk-name-input"});return!0});this.has_name_font_size(c)},has_name_font_size:function(c){c.get_name_width||(c.get_name_width=function(a){return.5*(a||this.get_width())});c.get_name_height||(c.get_name_height=function(a){return.5*(a||this.get_height())});c.name_font_size||(c.name_font_size=function(c,b){return a.UTILITIES.font_size(this.get_name(),this.get_name_width(c),
{height:this.get_name_height(b)})})},has_listeners:function(c){var e={};c.add_listener||(c.add_listener=function(a,c){var b=e[a];b?0>b.indexOf(c)&&b.push(c):e[a]=[c]});c.remove_listener||(c.remove_listener=function(b,c,m){if(b=e[b])if(c=b.indexOf(c),0<=c){b.splice(c,1);return}!m&&a.debugging&&console.log("Listener of type "+type_name+" could not be removed.")});c.get_listeners||(c.get_listeners=function(a){return e[a]})},add_speech_listeners:function(c){a.listen&&(c.widget=this,this.add_listener("picked up",
function(){a.UTILITIES.listen_for_speech(c)}),this.add_listener("dropped",function(){a.UTILITIES.stop_listening_for_speech()}))},get_full_description:function(a){if(this.get_erased&&this.get_erased())return a&&"conditions"===a.role?"any "+this.get_type_name():"erased "+this.get_type_name();var c=this.get_description(a);a=this.toString(a);return c?a+" ("+c+")":a},remove:function(a){var c=this.get_backside(),b=this.get_frontside(),h=this.get_parent_of_frontside(),m=function(b){a.do_not_remove_children?
(b.hide_backside&&b.hide_backside(),b.walk_children&&b.walk_children(m)):b.remove&&b.remove(a);return!0};a||(a={});c&&(a.remove_backside||this.get_parent_of_backside()&&this.get_parent_of_backside().is_top_level())&&c.hide_backside();b&&!a.do_not_remove_frontside&&b.remove();h&&this.remove_from_parent_of_frontside(a.event);this.get_running()&&this.set_running(!1);this.set_visible(!1);this.walk_children&&this.walk_children(m)},get_frontside_element:k,get_element:k,get_backside_element:function(a){if(a=
this.get_backside&&this.get_backside(a))return a.get_element()},add_to_json:function(c,e){var b,h;if(c){if(c.view){var m=c;e=c.view;c=c.semantic}else e={},m={semantic:c,view:e};m.version=1;this.get_erased&&this.get_erased()&&(c.erased=!0);this.get_infinite_stack&&this.get_infinite_stack()&&(c.infinite_stack=!0);this.get_open_backside_only_if_stopped&&this.get_open_backside_only_if_stopped()&&(c.open_backside_only_if_stopped=!0);this.get_running&&this.get_running()&&(c.running=!0);var g=this.get_parent_widget_of_frontside();
if(!g||this.parent_of_frontside_is_backside()||g.is_element())if(h=this.get_frontside_element&&this.get_frontside_element()){var k=$(h).width();0!==k&&this.is_resizable()&&!$(h).is(".toontalk-plain-text-element")&&(e.frontside_width=$(h).width(),e.frontside_height=$(h).height());0!==k&&(e.frontside_left=a.UTILITIES.get_style_numeric_property(h,"left"),e.frontside_top=a.UTILITIES.get_style_numeric_property(h,"top")||b&&b.frontside_top,void 0===e.frontside_left&&(b=g&&g.get_widget().get_backside_widgets_json_views()))&&
(h=this.get_parent_of_frontside().get_backside_widgets().indexOf(this),0<=h&&b[h]&&(e.frontside_left=b[h].frontside_left,e.frontside_top=b[h].frontside_top))}if(h=this.get_backside()){if(g=h.get_element()){if(h.get_backside_dimensions()||h.is_top_level())e.backside_width=$(g).width(),e.backside_height=$(g).height();e.backside_left||(h.json_view&&"undefined"!==typeof h.json_view.backside_left?(e.backside_left=h.json_view.backside_left,e.backside_top=h.json_view.backside_top):(b=$(g).position(),e.backside_left=
b.left,e.backside_top=b.top),"&lt;"===$(g).find(".toontalk-settings-backside-button").html()&&(e.advanced_settings_open=!0))}h.get_backside_dimensions()&&(e.backside_geometry=h.get_backside_dimensions())}!e.backside_geometry&&this.backside_geometry&&(e.backside_geometry=this.backside_geometry);void 0===e.frontside_left&&this.json_view&&(e.frontside_left=this.json_view.frontside_left,e.frontside_top=this.json_view.frontside_top);c.description=this.get_description&&this.get_description();e.saved_width=
this.saved_width;e.saved_height=this.saved_height;return m}console.log("get_json not defined");return{}},add_backside_widgets_to_json:function(c,e,b,h,m){var g=this.get_backside_widgets(),k,x;m>=a.maximum_recursion_depth?a.UTILITIES.avoid_stack_overflow(function(){this.add_backside_widgets_to_json(c,e,b,Date.now(),0)}.bind(this)):0<g.length?(c.semantic.backside_widgets=[],(k=this.get_backside_widgets_json_views())&&k.forEach(function(a,b){if(x=c.semantic.backside_widgets[b]){if(0<=x.widget.shared_widget_index){b=
e.widgets_encountered.indexOf(e.shared_widgets[x.widget.shared_widget_index]);if(!e.json_of_widgets_encountered[b])return;b=e.json_of_widgets_encountered[b].view}else b=x.widget.view;x.is_backside?a.backside_left&&(b.backside_left=a.backside_left,b.backside_top=a.backside_top):a.frontside_left&&(b.frontside_left=a.frontside_left,b.frontside_top=a.frontside_top)}else g[b].json_view=k[b]}),a.UTILITIES.get_json_of_array(g,c.semantic.backside_widgets,0,e,b,h,m+1)):b(m+1)},has_backside_widgets:function(c){var e=
[];c.get_backside_widgets=function(){return e};c.add_backside_widget=function(b,c){if(b){var h=this.get_backside(!0);if(a.debugging){if(b===this){a.UTILITIES.report_internal_error("Adding a widget to the list of its backside widgets!");return}if(b.get_widget()===this){a.UTILITIES.report_internal_error("Adding the backside of a widget to the list of its backside widgets!");return}}e?0>e.indexOf(b)&&e.push(b):e=[b];a.logging&&0<=a.logging.indexOf("backside-widgets")&&console.log("Added "+b+" to backside widgets of "+
this+". Number of backside widgets is "+e.length);b.is_backside()?b.set_parent_of_backside(h,!0):b.set_parent_of_frontside(this,!0);!h.visible()||c&&c.robot&&!c.robot.visible()||b.set_visible(!0)}else a.debugging&&a.UTILITIES.report_internal_error("adding undefined to backside widgets.")};c.remove_all_backside_widgets=function(){e&&a.UTILITIES.for_each_batch(e.slice(),function(a){a.remove()})};c.remove_backside_widget=function(b,c){var h=e.indexOf(b);0>h?c||a.UTILITIES.report_internal_error("Couldn't find a widget to remove it from backside widgets. "+
b.get_widget()+" ("+b.get_widget()._debug_id+")"):(e.splice(h,1),a.logging&&0<=a.logging.indexOf("backside-widgets")&&console.log("Removed "+b+" from backside widgets of "+this+". Number of backside widgets is "+e.length),this.backside_widgets_json_views&&this.backside_widgets_json_views.splice(h,1),b.is_backside()?(c=b.get_parent())&&c.get_widget()===this&&b.set_parent_of_backside(void 0,!0,!0):(c=b.get_parent_of_frontside())&&c.get_widget()===this&&b.set_parent_of_frontside(void 0,void 0,!0),b.set_visible(!1))};
c.set_backside_widgets=function(b,c){var h=this.get_backside(),g=h&&h.visible();e=b;a.logging&&0<=a.logging.indexOf("backside-widgets")&&console.log("Set backside widgets "+e.length+" widgets of "+(g?"visible ":"invisible ")+this);0<e.length&&(h?h.add_backside_widgets(e,c):this.backside_widgets_json_views=c,a.UTILITIES.for_each_batch(e,function(a){a&&(a.is_backside()?a.set_parent_of_backside(this,!0):a.set_parent_of_frontside(this,!0),g&&a.set_visible(g))}.bind(this)))}},get_backside_widgets_json_views:function(a){!this.backside_widgets_json_views&&
a&&(this.backside_widgets_json_views=[]);return this.backside_widgets_json_views},can_run:function(a){var c=!1,b;this.get_backside_widgets().some(function(e){if(!e)return!1;b=e.get_widget();if(b.get_body&&!b.get_body().is_empty())return c=!0;a?a.depth?(a=Object.assign?Object.assign({},a):a,a.depth++):a.depth=1:a={depth:1};if(b.can_run(a))return c=!0});this.walk_children_now_or_later&&this.walk_children_now_or_later(function(b,e){a?(a=Object.assign?Object.assign({},a):a,a.depth=e):a={depth:e};if(b.can_run&&
b.can_run(a))c=!0;else return!0},a&&a.depth);return c},add_to_copy:function(c,e){this.get_erased&&this.get_erased()&&(c.set_erased||a.widget.erasable(c),c.set_erased(this.get_erased()));if(!e||!e.just_value){var b=this.get_backside_widgets();0<b.length&&c.set_backside_widgets(a.UTILITIES.copy_widget_sides(b,e),this.get_backside_widgets_json_views())}c.set_running(this.get_running());return c},get_type_name:function(){return""},copy:function(){console.assert(!1,"copy not implemented")},add_copy_to_container:function(c,
e,b){var h=this.visible();c||(c=this.copy({}));var k=this.get_frontside_element(h);var g=c.get_element(h);var v=$(k).closest(".toontalk-backside");var x=c.ok_to_set_dimensions();0===v.length&&(v=$(this.top_level_widget().get_backside_element()));var p=a.UTILITIES.widget_side_of_jquery(v);h&&("undefined"===typeof e&&(e=30),"undefined"===typeof b&&(b=30),h=a.UTILITIES.relative_position(k,v.get(0)),0<v.length&&v.get(0).appendChild(g),k={width:x?$(k).width():"",height:x?$(k).height():"","z-index":a.UTILITIES.next_z_index()},
e=h.left+e,b=h.top+b,c.is_plain_text_element()?c.set_location_attributes(e,b):(k.left=e,k.top=b),a.UTILITIES.set_css(g,k));p&&p.add_backside_widget(c);return c},visible:function(){var a;return document.hidden?!1:(a=this.get_frontside())?a.visible():!1},set_visible:function(a,e){var b=this.get_frontside(a);b&&b.set_visible(a,e)},is_backside:function(){return!1},get_parent:function(){return this.get_parent_of_frontside()},set_parent:function(a){this.set_parent_of_frontside(a)},drag_started:function(a,
e){this.robot_in_training()&&this.robot_in_training().picked_up(this,a,e)},match:function(a){console.assert(!1,"match not implemented for "+a.toString())},removed:function(c){a.UTILITIES.report_internal_error("removed not implemented")},equals_box:function(){return!1},equals_number:function(){return!1},open_backside:function(c,e){var b=this.get_backside();if(b&&a.UTILITIES.visible_element(b.get_element()))$(b.get_element()).css({opacity:1}),c&&c();else{var h=c&&function(){setTimeout(c)};var k=function(b,
c){a.UTILITIES.set_timeout(function(){$(b).addClass("toontalk-side-appearing");"number"!==typeof e&&(e=0);a.UTILITIES.add_one_shot_event_handler(b,"transitionend",e||2500,function(){$(b).removeClass("toontalk-side-appearing");h&&h()});$(b).css({left:y,top:z,opacity:c});this.apply_backside_geometry()}.bind(this))}.bind(this);var g=this.get_frontside_element(!0);var v=$(g).parent();for(b=$(g);0<v.length&&!v.is(".toontalk-backside");)b=v,v=v.parent();b.get(0);b=this.get_backside(!0);var x=b.get_element();
x.toontalk_widget_side=b;var p=$(g).offset();var q=v.offset();var A=v.width();q||(q={left:0,top:0});$(x).css({left:p.left-q.left,top:p.top-q.top,opacity:.01});0<v.length?v.get(0).appendChild(x):($(x).css({textAlign:"left"}),g.appendChild(x));(v=a.UTILITIES.widget_side_of_jquery(v))&&v.add_backside_widget(b);v=this.is_element()?this.get_attribute("height"):$(g).height();g=$(x).width();var y=p.left-q.left;y+g>A&&(y=Math.max(0,A-g));var z=p.top-q.top+v+34;this.is_box()&&(z+=28);k(x,"inherit");b.set_visible(!0);
var n=this.get_backside_widgets();0<n.length&&n.forEach(function(b){if(b.is_backside()&&0<=n.indexOf(b.get_widget()))b.hide_backside();else{b.set_visible(!0);var c=b.get_element(!0);c.remove();try{x.appendChild(c)}catch(D){a.UTILITIES.report_internal_error("A backside is contained in one its backside widgets. This makes no sense. "+this+" should not be part of "+b+". "+D+" In open_backside. ")}}}.bind(this));return b}},hide_backside:function(){var a=this.get_backside();a&&a.hide_backside()},apply_backside_geometry:function(){var a=
this.get_backside(!0),e=a.get_element();this.backside_geometry&&e&&(a.scale_backside(e,this.backside_geometry.x_scale,this.backside_geometry.y_scale,this.backside_geometry.original_width,this.backside_geometry.original_height),a.set_dimensions(this.backside_geometry))},robot_in_training:function(){return this.top_level_widget().robot_in_training()},robot_training_this_robot:function(){return this.top_level_widget().robot_training_this_robot()},robot_started_training:function(a){this.top_level_widget().robot_started_training(a)},
robot_finished_training:function(){this.top_level_widget().robot_finished_training()},backup_all:function(a){var c=this.top_level_widget();c&&c.save(a)},render:function(){a.DISPLAY_UPDATES.pending_update(this)},rerender:function(){this.visible()&&this.render()},hide:function(){$(this.get_frontside_element()).hide()},constrained_by_container:function(){var a;return this.is_nest()||this.being_dragged?!1:(a=this.get_parent_of_frontside())&&(a.is_hole()||a.is_nest()||a.is_robot())?!0:!1},close_button_ok:function(a){return"top-level"!==
this.get_type_name()&&!$(a).is(".toontalk-top-level-resource")&&!$(a).closest(".toontalk-conditions-panel").is("*")},get_widget:function(){return this},add_to_top_level_backside:function(a,e){var b=this.top_level_widget();a||(a=this);var c=a.get_element(!0);b.add_backside_widget(a);b.get_backside_element().appendChild(c);a.render();e&&this.robot_in_training()&&this.robot_in_training().dropped_on(a,b);return c},get_selection:function(){return this},display_message:function(c,e){e||(e={});e.display_on_backside_if_possible?
(e.element=this.get_backside_element(),e.second_choice_element=this.get_frontside_element()):e.element=this.get_frontside_element();a.UTILITIES.display_message(c,e);return c},get_speak_function:function(c){return function(e,b){var h,k,g,v,x;if(window.speechSynthesis){var p=c.check_message(e);if("string"!==typeof p)if(2>p.box_size)c.report_error("Speaking birds need a box with two or more holes.",p);else return(h=e.get_hole_contents(2))&&(h=h.to_float&&h.to_float()),(k=e.get_hole_contents(3))&&(k=
k.to_float&&k.to_float()),(g=e.get_hole_contents(4))&&(g=g.to_float&&g.to_float()),(v=e.get_hole_contents(5))&&(v=v.to_float&&v.to_float()),(x=e.get_hole_contents(6))&&(x=x.get_text&&x.get_text()),function(m){if(m){m=m.get_widget();var q=m.get_text?m.get_text(!0):m.toString();if(a.TRANSLATION_ENABLED)a.UTILITIES.translate(q,function(m){y=function(g){var h=a.element.create(m,[],"a response to speaking '"+q+"'");b.event=g;c.process_response(h,p,e,b)};a.UTILITIES.speak(m,{when_finished:y,volume:h,pitch:k,
rate:g,voice_number:v,language:x,no_translation:!0})});else{var y=function(g){var h=a.element.create(q,[],"a response to speaking '"+q+"'");b.event=g;c.process_response(h,p,e,b)};a.UTILITIES.speak(q,{when_finished:y,volume:h,pitch:k,rate:g,voice_number:v,language:x})}}else c.report_error("Speaking birds need something in the second box hole that they can speak.",p)}(e.get_hole_contents(1)),!0}else c.report_error("This browser doesn't support speech output. Try another browser such as Chrome.",p)}},
get_listen_function:function(c,e){return function(b,h){var k,g;if(window.webkitSpeechRecognition||window.SpeechRecognition){var v=c.check_message(b);if("string"!==typeof v)if(1>v.box_size)c.report_error("Listening birds need a box with one or two holes.",v);else{if(k=b.get_hole_contents(1))k=k&&k.to_float&&k.to_float(),0>k?k=0:1<k&&(k=1);e||(g=b.get_hole_contents(2))&&(g=g.get_text());var x=e?function(e){e=parseFloat(e);isNaN(e)||(e=a.number.create_from_bigrat(bigrat.fromDecimal(e)),e.set_description("a number that was heard"),
c.process_response(e,v,b,h),a.UTILITIES.stop_listening_for_speech())}:function(e){e=a.element.create(e,[],"what was spoken");c.process_response(e,v,b,h);a.UTILITIES.stop_listening_for_speech()};a.UTILITIES.listen_for_speech({commands:g,minimum_confidence:k,numbers_acceptable:e,success_callback:x,fail_callback:function(b){c.report_error(b.error,v);a.UTILITIES.stop_listening_for_speech()}});return!0}}else c.report_error("A listening bird can't listen because this browser doesn't support speech input. Try another browser such as Chrome.",
v)}},get_description_function:function(c){return function(e,b){var h=c.check_message(e);if("string"!==typeof h)if(1>h.box_size)c.report_error("Listening birds need a box with two holes.",h);else return function(k){var g=function(g){g=a.element.create(g,[],k.toString());c.process_response(g,h,e,b)};k=k.get_widget();var m=k.get_text?k.get_text(!0):k.toString();a.TRANSLATION_ENABLED?a.UTILITIES.translate(m,function(a){g(a)}):g(m)}(e.get_hole_contents(1)),!0}},create_top_level_widget:function(c){var e=
Object.create(a.widget),b=[],h=function(){return!1},k=!1;c||(c={});e.is_top_level=function(){return!0};e.is_number=h;e.is_box=h;e.is_empty_hole=h;e.is_scale=h;e.is_bird=h;e.is_nest=h;e.is_robot=h;e.is_element=h;e.is_sensor=h;e.is_function_nest=h;e.is_hole=h;e.is_plain_text_element=h;e.is_attribute_widget=h;e.ok_to_set_dimensions=h;e.get_json=function(a,b,e,h){a=this.get_backside(!0).get_element();a=document.defaultView.getComputedStyle(a,null).getPropertyValue("background-color");b({semantic:{type:"top_level",
settings:c},view:{background_color:a}},e,h+1)};e.get_type_name=function(){return"top-level"};e.is_of_type=function(a){return"top-level"===a};e.toString=function(){return"top level widget"};e.get_description=function(){};e.match=function(){return"matched"};e.update_display=function(){this.get_backside_widgets()&&a.UTILITIES.for_each_batch(this.get_backside_widgets().filter(function(a){return a&&a.visible()}),function(a){a.render()})};e.copy=function(){return this};e.visible=function(){return!document.hidden};
e.get_parent_of_frontside=function(){};e.get_parent_of_backside=function(){};e.closest_visible_ancestor=function(){return this};e.get_infinite_stack=function(){return!1};e.get_listeners=function(){return[]};e.top_level_widget=function(){return this};if(a.debugging||a.logging)e.to_debug_string=function(a){var b=$(this.get_backside_element()).offset();return("top-level widget at "+Math.round(b.left)+", "+Math.round(b.top)).substring(0,a)};e.add_sides_functionality(e);e.runnable(e);e.has_parent(e);e.has_backside_widgets(e);
e.removed_from_container=function(a,b){this.robot_in_training()||this.remove_backside_widget(a,!0)};e.widget_side_dropped_on_me=function(a,b){return this.get_backside().widget_side_dropped_on_me(a,b)};e.get_element=function(){return this.get_backside().get_element()};e.get_setting=function(b,e){"undefined"!==typeof c[b]||e||(c[b]=a.DEFAULT_SETTINGS&&a.DEFAULT_SETTINGS[b]);return c[b]};e.set_setting=function(a,b){c[a]=b};e.open_settings=function(){a.SETTINGS.open(e)};e.robot_in_training=function(){if(0<
b.length)return b[b.length-1]};e.robot_training_this_robot=function(){if(1<b.length)return b[b.length-2]};e.robot_started_training=function(a){b.push(a)};e.robot_finished_training=function(){b.pop()};e.save=function(b,c,e){var g=this.get_setting("program_name",a.reset),h=function(b){k=!1;if(m)if(y=a.google_drive.get_status(),"Ready"===y){try{var h=JSON.stringify(b,a.UTILITIES.clean_JSON)}catch(w){a.UTILITIES.is_stack_overflow(w)?a.UTILITIES.display_message("Unable to store your project because the depth of widget nesting exceeds the size of the stack.  Perhaps you can launch this browser or another with a larger stack size.",
{only_if_new:!0}):a.UTILITIES.display_message("Unable to store your project because of the error: "+w.message,{only_if_new:!0})}a.google_drive.upload_file(g,"json",h,e);e=void 0}else a.google_drive.connection_to_google_drive_possible()&&("Need to authorize"===y?(a.UTILITIES.display_message("Unable to save to your Google Drive because you need to log in. Click on the settings icon <span class='toontalk-settings-icon'></span> to log in.",{only_if_new:!0}),a.UTILITIES.display_tooltip($(".toontalk-settings-button"))):
console.log("Unable to save to Google Drive because: "+y));c.local_storage&&this.save_to_local_storage(b);e&&e()}.bind(this),m,y;!k&&g&&(c||(c={}),"undefined"===typeof c.google_drive&&(c.google_drive=a.google_drive&&this.get_setting("save_to_google_drive")&&this.get_setting("auto_save_to_cloud")),"undefined"===typeof c.local_storage&&(c.local_storage=this.get_setting("auto_save_to_local_storage")),b?(m=c.google_drive&&!this.get_setting("google_drive_unavailable"))||c.local_storage?(k=!0,a.UTILITIES.get_json_top_level(this,
h)):e&&e():setTimeout(function(){this.save(!0,c,e)}.bind(this),100))};e.publish=function(b,c){a.publish.publish_widget(this.get_setting("program_name"),this,c,b)};e.save_to_local_storage=function(b,c){var e=this.get_setting("program_name"),g=a.UTILITIES.local_storage_program_key(e),h=a.UTILITIES.local_storage_program_meta_data_key(e),k=function(k){m=JSON.stringify(b,a.UTILITIES.clean_json);k||(k={created:c});k.last_modified=c;k.file_size=m.length;a.UTILITIES.store_object(h,k);a.UTILITIES.store_string(g,
m);a.UTILITIES.store_string("toontalk-last-key",g);a.UTILITIES.get_all_locally_stored_program_names(function(b){0>b.indexOf(e)&&(b.push(e),a.UTILITIES.set_all_locally_stored_program_names(b))})},m;c||(c=Date.now());try{a.UTILITIES.retrieve_object(h,k)}catch(z){k=m?"Failed to save state to local storage since it requires "+m.length+" bytes. Error message is "+z:"Error while saving to local storage. Error message is "+z,a.UTILITIES.is_internet_explorer()?console.error("Unresolved difficulties using window.localStorage in IE11: "+
k):a.UTILITIES.display_message(k),this.last_local_storage_error=k}};e.load=function(b,c,e){var g=this.get_setting("program_name"),h=g+".json",k=a.UTILITIES.local_storage_program_key(g),m=this.download_callback(c,e);c=function(b){b?a.google_drive.download_file(b,m):a.UTILITIES.retrieve_string(k,m)};b&&a.google_drive&&"Ready"===a.google_drive.get_status()?a.google_drive.get_toontalk_program_file(h,c):a.UTILITIES.retrieve_string(k,m)};e.download_callback=function(b,c){return function(e){if(e)try{var g=
a.UTILITIES.parse_json(e);this.remove_all_backside_widgets();a.UTILITIES.add_backside_widgets_from_json(this,g.semantic.backside_widgets,{json_of_shared_widgets:g.shared_widgets,shared_widgets:[],shared_html:g.shared_html});b&&b()}catch(q){a.UTILITIES.display_message("Error encountered loading "+e+": "+q)}else c&&c()}.bind(this)};e.walk_children=function(){};e.render=function(){};e.constrained_by_container=function(){return!1};e.dereference=function(){return this};e.is_widget=!0;a.debugging&&(e._debug_id=
a.UTILITIES.generate_unique_id(),e._debug_string="Top-level widget");e.get_backside(!0).set_visible(!0);return e}}}(window.TOONTALK);window.TOONTALK.backside=function(a){var k=function(c){var e=c.get_widget(),b=e.get_backside_widgets(),h=e.get_backside_widgets_json_views(!0);c.get_backside_dimensions();var m=c.get_element();a.UTILITIES.for_each_batch(b,function(b,c){var e=b.get_element();if(e){h[c]||(h[c]={});if(b.start_offset&&e.parentElement){var g=a.UTILITIES.relative_position_from_absolute_position(e.parentElement,b.start_offset);b.start_offset=void 0}else g=$(e).position();b.is_backside()?(h[c].backside_left=a.UTILITIES.left_as_percent(g.left,
e),h[c].backside_top=a.UTILITIES.top_as_percent(g.top,e),k(b)):(h[c].frontside_left=a.UTILITIES.left_as_percent(g.left,e,m),h[c].frontside_top=a.UTILITIES.top_as_percent(g.top,e,m))}})};return{create:function(c){var e=Object.create(this),b=document.createElement("div"),h=$(b),k=1,g=1,v=document.createElement("div"),x=document.createElement("div"),p=c.get_help_URL&&c.get_help_URL(),q=function(a){a?($(v).addClass("toontalk-green-flag-active toontalk-button").removeClass("toontalk-green-flag-inactive toontalk-button"),
$(x).addClass("toontalk-stop-sign-inactive toontalk-button").removeClass("toontalk-stop-sign-active toontalk-button")):($(v).addClass("toontalk-green-flag-inactive toontalk-button").removeClass("toontalk-green-flag-active toontalk-button"),$(x).addClass("toontalk-stop-sign-active toontalk-button").removeClass("toontalk-stop-sign-inactive toontalk-button"))},A=this.create_description_label(e,c),y=function(){var b=c.get_running()?"To stop this click on the stop sign "+a.UTILITIES.encode_HTML_for_title("<span class='toontalk-stop-sign-icon'></span>"):
c.can_run()?"Click this to start this running.":"There is nothing to run on this.";a.UTILITIES.give_tooltip(v,b)},z=function(){var b=c.get_running()?"Click to stop this from running.":c.can_run()?"This has stopped. Click on the flag "+a.UTILITIES.encode_HTML_for_title("<span class='toontalk-green-flag-icon'></span>")+" to start running it.":"There is nothing to run here.";a.UTILITIES.give_tooltip(x,b)},n=function(b){d?(a.UTILITIES.add_iframe_popup(p),b.stopPropagation()):(f.href=p,f.target="_blank")},
w=!1,I,D,K,E,O,J,V,N,P,G,Q;a.TRANSLATION_ENABLED&&p&&(p=a.UTILITIES.add_URL_parameter(p,"translate","1"));if(c.close_button_ok(b)){var T=function(d){var f=function(){c.robot_in_training()&&c.robot_in_training()!==c&&c.robot_in_training().backside_closed(e);e.is_primary_backside()?e.hide_backside(d):e.remove()},g;if(c.get_running()){var n=c.get_backside_widgets();n.some(function(a){a=a.get_widget();if(a.is_robot())return a.finish_cycle_immediately(f),g=a,!0});g?(g.add_body_finished_listener(function(){g.visible()?
h.css({opacity:1}):(c.forget_backside(),a.DEFAULT_QUEUE.start());f()}),e.set_visible(!1)):f();h.css({opacity:1});h.addClass("toontalk-animating-element");h.css({opacity:0});a.UTILITIES.add_one_shot_event_handler(b,"transitionend",2E3,function(){c.forget_backside()})}else f();d.stopPropagation()};var U=(U=c.get_description())?"the "+c.get_type_name()+" who "+U:"the "+c.get_type_name();var F=a.UTILITIES.create_close_button(T,"Click to remove this backside of "+U+".");b.appendChild(F)}$(v).addClass("toontalk-green-flag toontalk-green-flag-inactive");
v.addEventListener("click",function(b){c.can_run()?(q(!0),c.set_running(!0),z(),a.DEFAULT_QUEUE.start()):c.is_top_level()?a.UTILITIES.display_message("There is nothing to run.",{element:b.target}):a.UTILITIES.display_message("This "+c.get_type_name()+" has nothing to run. Add some robots on the back.",{element:b.target});c.robot_in_training()&&c.robot_in_training().button_clicked(".toontalk-green-flag",c);b.stopPropagation()});v.addEventListener("mouseenter",z);$(x).addClass("toontalk-stop-sign toontalk-stop-sign-active");
x.addEventListener("click",function(b){q(!1);c.set_running(!1);y();c.robot_in_training()&&c.robot_in_training().button_clicked(".toontalk-stop-sign",c);b.stopPropagation();c.is_top_level()&&a.UTILITIES.stop_audio_objects();c.backup_all()});x.addEventListener("mouseenter",y);b.appendChild(v);b.appendChild(x);a.UTILITIES.use_custom_tooltip(v);a.UTILITIES.use_custom_tooltip(x);if(p){var d=0>p.indexOf("://");var f=document.createElement(d?"div":"a");$(f).addClass("toontalk-help-button notranslate toontalk-widget-help-button");
f.addEventListener("click",n);f.innerHTML="i";f.translate=!1;a.UTILITIES.give_tooltip(f,"Click to learn more about "+c.get_type_name(!0,!0)+".");b.appendChild(f)}A&&b.appendChild(A);if(c.is_top_level()){var r=document.createElement("div");$(r).addClass("toontalk-settings-button");r.addEventListener("click",function(a){c.open_settings();a.stopPropagation()});b.appendChild(r);a.UTILITIES.give_tooltip(r,"Click to change settings or open a different program.")}h.addClass("toontalk-backside toontalk-side toontalk-backside-of-"+
c.get_type_name());h.css({"z-index":a.UTILITIES.next_z_index()});a.UTILITIES.when_attached(b,function(){if(e.inside_conditions_container()){$(v).hide();$(x).hide();$(f).hide();$(F).hide();var d="This will match "+e.toString()+".";e.rerender()}else c.is_robot()?d="On the back of the robot you can change the conditions and setting of the robot.":c.is_top_level()?d="This is a work area where you can drag things.":(Q=c.toString({inside_tool_tip:!0}),d="You are pointing to the back of "+a.UTILITIES.add_a_or_an(Q)+
" You can put robots on the back to make it come 'alive'.");a.UTILITIES.give_tooltip(b,d)});e.get_element=function(){return b};e.get_backside_element=function(){return b};e.get_widget=function(){return c};e.is_resizable=function(){return!0};e.visible=function(){return document.hidden?!1:E};e.set_visible=function(a,b){E=a;!c.is_top_level()&&this.is_primary_backside()&&(this.get_backside_widgets().forEach(function(d){d&&d!==this&&d.set_visible(a,b?b+1:1)}.bind(this)),E&&this.render())};e.get_erased=
function(){return I};e.set_erased=function(a,b,d){if(!a||d||this.inside_conditions_container())I=a,b&&this.rerender()};c.get_backside||(c.get_backside=function(){return e});e.is_primary_backside=function(){return this===this.get_widget().get_backside()};e.inside_conditions_container=function(){return $(this.get_element()).closest(".toontalk-conditions-panel, .toontalk-conditions-container").is("*")};e.get_width=function(){return a.UTILITIES.get_element_width(this.get_element())};e.get_height=function(){return a.UTILITIES.get_element_height(this.get_element())};
e.is_widget=!0;e.get_backside_widgets=function(){return c.get_backside_widgets()};e.get_parent_of_backside=function(){return this.is_primary_backside()?c.get_parent_of_backside():K&&D?D.get_backside(!0):D};e.set_parent_of_backside=function(a,b){!a&&D&&K&&D.remove_backside_widget(this,!0);this.is_primary_backside()&&c.set_parent_of_backside(a,b);D=a;K=b};e.get_parent_of_frontside=function(){return c.get_parent_of_frontside()};e.is_parent_backside=function(){return c.is_parent_backside()};e.get_frontside=
function(a){return c.get_frontside(a)};e.get_frontside_element=function(a){return c.get_frontside_element(a)};e.get_description_text_area=function(){return P};e.set_description_text_area=function(a){P=a};e.get_name_text_input=function(){return G};e.set_name_text_input=function(a){G=a};e.removed_from_container=function(a,b,d,c){e.get_widget().robot_in_training()||this.remove_backside_widget(a,c)};e.drop_on=function(a,b){return a.widget_side_dropped_on_me&&a.widget_side_dropped_on_me(this,b)};e.widget_side_dropped_on_me=
function(d,e){var f,g;if(d===this)return(this.get_parent()||this.top_level_widget().get_backside()).widget_side_dropped_on_me(d,e);if(e.robot&&e.robot.visible()&&!this.visible())this.add_backside_widget(d,e),d.dropped_on_other&&d.dropped_on_other(this,e);else{if(this.visible()&&(!e.robot||e.robot.visible())){a.sounds&&e.event&&a.sounds.drop.play();var l=d.get_element(this.visible());d.rerender();e.event?(b.appendChild(l),a.UTILITIES.set_position_is_absolute(l,!0,e.event)):(e.robot&&(f=$(e.robot.get_frontside_element()).offset()),
f||(f=$(l).offset()),b.appendChild(l),!f||0===f.left&&0===f.top||a.UTILITIES.set_absolute_position(l,f))}c.robot_in_training()&&!e.ignore_training&&e.event&&setTimeout(function(){c.robot_in_training()&&c.robot_in_training().dropped_on(d,this,e.event)}.bind(this));d.is_backside()&&d.get_widget().is_element()&&c.is_element()&&(f=d.get_widget(),f.set_backside(void 0),f.remove(e.event),f.set_backside(d));this.add_backside_widget(d,e);d.dropped_on_other&&d.dropped_on_other(this,e);e.event&&d.get_body&&
d.get_body().is_empty()&&!d.being_trained?setTimeout(function(){(g=d.open_backside())&&$(g.get_element()).find(".toontalk-train-backside-button").click()}):e.event&&!d.is_backside()&&this.get_frontside_element()&&!d.is_sensor()&&this.get_frontside_element().dispatchEvent(a.UTILITIES.create_event("widget added",{element_widget:l,where:"back"}));e.event&&d.get_widget().backup_all();e.event&&this.get_widget().is_top_level()&&!d.is_backside()&&!d.is_sensor()&&window.dispatchEvent(a.UTILITIES.create_event("widget added",
{element_widget:l,here:"back"}));e.robot&&!e.robot.visible()&&this.visible()&&e.robot.add_body_finished_listener(function(){var a=function(){c=d.get_element(!0);b.appendChild(c);d.set_visible(!0);d.update_display();$(c).css(this.get_free_location(d))}.bind(this),c;d.get_parent()===this&&(d.get_running()?setTimeout(function(){d.get_parent()&&a()},500):a())}.bind(this));!d.is_backside()&&d.is_robot()&&this.get_widget().get_running()&&!this.is_top_level()&&this.get_widget().set_running(!0);return!0}};
e.add_backside_widget=function(a,b){return this.get_widget().add_backside_widget(a,b)};e.add_backside_widgets=function(b,d){if(0!==b.length){a.logging&&0<=a.logging.indexOf("backside-widgets")&&console.log("Adding "+b.length+" backside widgets to "+this);var e=b.slice();a.UTILITIES.set_timeout(function(){var f=this.visible(),l=this.get_element(),g,h,n,k;a.UTILITIES.for_each_batch(e,function(e,u){if(e)if(a.debugging&&e.get_widget()===c)a.UTILITIES.report_internal_error("Adding to backside itself or its backside!"),
b.splice(u,1);else{d&&(n=d[u]);g=e.get_element(!0);if(!g.parentElement){try{l.appendChild(g)}catch(la){a.UTILITIES.report_internal_error("A backside is contained in one its backside widgets. This makes no sense. "+this+" should not be part of "+e+". "+la+" In add_backside_widgets. This has been delayed so possibily things have changed since scheduled. ")}a.logging&&0<=a.logging.indexOf("backside-widgets")&&console.log("Widget element added to backside element.")}g.toontalk_widget_side=e;n&&(e.is_backside()?
(h=e.get_widget().get_backside(!0),k={left:n.backside_left,top:n.backside_top},e.get_widget().apply_backside_geometry(),n.advanced_settings_open&&h.set_advanced_settings_showing(!0,h.get_element())):(0===n.frontside_width&&(n.frontside_width=""),0===n.frontside_height&&(n.frontside_height=""),k={left:n.frontside_left,top:n.frontside_top},!g.style.transform&&e.is_resizable()&&(k.width=n.frontside_width||n.saved_width,k.height=n.frontside_height||n.saved_height)),a.UTILITIES.constrain_css_to_fit_inside(l,
k),$(g).css(k));e.set_visible(f);e.get_widget().rerender()}}.bind(this))}.bind(this),100)}};e.get_backside_dimensions=function(){if(1!==k||1!==g)return{x_scale:k,y_scale:g,original_width:O,original_height:J}};e.set_dimensions=function(a){k=a.x_scale;g=a.y_scale;a.original_width&&(O=a.original_width);a.original_height&&(J=a.original_height)};e.scale_to_fit=function(b,d){b=a.UTILITIES.scale_to_fit(b,d,450,150);k=b.x_scale;g=b.y_scale};e.scale_to=function(b,d){b=a.UTILITIES.scale_element(this.get_element(!0),
b,d,450,150);k=b.x_scale;g=b.y_scale};e.get_original_width=function(){return O};e.get_original_height=function(){return J};e.get_advanced_settings_showing=function(){return w};e.set_advanced_settings_showing=function(b){var d=this.get_element(),c=$(d).children(".toontalk-settings-backside-button"),e=$(d).children(".toontalk-advanced-settings-table");0===e.length&&this.add_advanced_settings&&(this.add_advanced_settings(),e=$(d).children(".toontalk-advanced-settings-table"));(w=b)?(e.show(),$(d).addClass("toontalk-backside-showing-advanced-settings"),
c.html("<"),a.UTILITIES.give_tooltip(c.get(0),"Click to hide the advanced settings."),this.get_backside_widgets().forEach(function(a){$(a.get_element()).hide()}),d.saved_width=d.style.width,d.saved_height=d.style.height,$(d).css({width:"",height:""})):(e.hide(),$(d).removeClass("toontalk-backside-showing-advanced-settings"),c.html(">"),a.UTILITIES.give_tooltip(c.get(0),"Click to show the advanced settings."),this.get_backside_widgets().forEach(function(a){$(a.get_element()).show()}),$(d).css({width:d.saved_width,
height:d.saved_height}))};e.run_status_changed=function(a){q(a)};a.UTILITIES.when_attached(F||b,function(){a.UTILITIES.get_element_width(b);a.UTILITIES.get_element_height(b);var d=$(x).width();var c=(c=$(F).width())?c+14:0;$(x).css({right:c});$(v).css({right:c+d+6});var e=$(v).width();f&&($(f).css({right:c+d+e+12}),a.UTILITIES.use_custom_tooltip(f));if(r){var g=$(f).width()||0;$(r).css({right:c+d+e+g+12})}F&&a.UTILITIES.use_custom_tooltip(F)});e.save_dimensions=function(){V=k;N=g;return!0};e.restore_dimensions=
function(){this.get_element();V&&(k=V);N&&(g=N);this.render_current_scale()};e.render_current_scale=function(){this.scale_backside(b,k,g,O,J);$(".toontalk-text-area, .toontalk-radio-button, .toontalk-text-input").button();$(b).find("[title]").each(function(b,d){a.UTILITIES.use_custom_tooltip(d)})};e.compare_with=function(a){return this.get_widget().compare_with&&this.get_widget().compare_with(a)};if(a.debugging||a.logging)e.to_debug_string=function(a){return("backside of "+this.get_widget().to_debug_string()).substring(0,
a)};b.toontalk_widget_side=e;a.UTILITIES.drag_and_drop(b);a.UTILITIES.resizable_and_scalable(b,function(a,b){e.get_advanced_settings_showing()||(e.set_dimensions({x_scale:a,y_scale:b}),e.render_current_scale())},O,J);b.addEventListener("mouseenter",function(b){b=c.get_frontside();var d=c.get_parent_of_backside();!b||d&&!d.get_widget().is_top_level()?a.frontside.clear_selection_feedback_stack():a.UTILITIES.highlight_element(b.get_element())});b.addEventListener("mouseleave",function(b){c.is_top_level()||
a.UTILITIES.remove_highlight()});e.update_display=function(d){var c=this.get_description_text_area(),f=this.get_name_text_input(),g=b.getBoundingClientRect(),l;c&&(l=this.get_widget().get_description())&&(c.button.value=l);f&&(f.button.value=this.get_widget().get_name());this.get_erased()?$(b).find(":not(.ui-resizable-handle, .toontalk-green-flag, .toontalk-stop-sign, .toontalk-close-button, .toontalk-help-button)").hide():$(b).find().show();d&&a.UTILITIES.for_each_batch(this.get_backside_widgets().filter(function(a){return!a.get_frontside()}),
function(d){var c=d.get_element(!0);d.set_visible(!0);a.UTILITIES.set_css(c,{left:(g.width-50)*Math.random(),top:(g.height-50)*Math.random()});b.appendChild(c);d.update_display()});e.display_updated()};e.display_updated=function(){$(this.get_element());O||(O=a.UTILITIES.get_element_width(b));J||(J=a.UTILITIES.get_element_height(b))};e.add_to_top_level_backside=function(a,b){return this.get_widget().add_to_top_level_backside(a,b)};c.get_backside_widgets&&(A=c.get_backside_widgets(),e.add_backside_widgets(A,
c.get_backside_widgets_json_views()));if(a.debugging||a.together)b.id=c.get_frontside_element(!0).id+"_backside";a.debugging&&(e._debug_id=c._debug_id+"_backside",e._debug_string="backside of "+c._debug_string);return e},toString:function(){return this.get_erased()?"any backside":"backside of "+this.get_widget()},get_full_description:function(a){return this.get_erased()?"any backside":"backside of "+this.get_widget().get_full_description(a)},remove_element:function(){$(this.get_element()).remove()},
get_free_location:function(a,e){var b=this.get_element(),c=b.getBoundingClientRect(),k=$(b).position(),g=function(a,c){return b===document.elementFromPoint(a,c)&&b===document.elementFromPoint(a+x.width,c)&&b===document.elementFromPoint(a,c+x.height)&&b===document.elementFromPoint(a+x.width,c+x.height)},v;if(a){var x=a.get_element(!0).getBoundingClientRect();0===x.width&&(x=a.get_default_width?{width:a.get_default_width(),height:a.get_default_height()}:{width:e&&e.default_width||100,height:e&&e.default_height||
100})}else x={width:e&&e.default_width||100,height:e&&e.default_height||100};if(e&&e.try_first&&g(e.try_first.left+k.left-window.pageXOffset,e.try_first.top+k.top-window.pageYOffset))return e.try_first;a=e&&void 0!==e.margin_fraction?e.margin_fraction:.05;var p=1-2*a;e=k.left+c.width*a-window.pageXOffset;var q=k.top+c.height*a-window.pageYOffset;var A=e;var y=e+c.width*(1-a)-x.width;for(v=q+c.height*(1-a)-x.height;q<v;){if(g(e,q))return{left:e+window.pageXOffset-k.left,top:q+window.pageYOffset-k.top};
e+=1.2*x.width;e>y&&(e=A,q+=1.2*x.height)}return{left:c.width*a+Math.random()*(c.width-x.width)*p,top:c.height*a+Math.random()*(c.height-x.height)*p}},create_infinite_stack_check_box:function(c,e){c=a.UTILITIES.create_check_box(e.get_infinite_stack(),"toontalk-infinite-stack-check-box","Copy when dragged.","Check this if you want the "+e.get_type_name()+" to be copied instead of moved.");var b=function(a){var b=!e.get_infinite_stack();e.set_infinite_stack(b);if(e.robot_in_training()){var c=b?"change dragging to make a copy of ":
"change dragging back to moving for ";e.robot_in_training().edited(e,{setter_name:"set_infinite_stack",argument_1:b,toString:c,button_selector:".toontalk-infinite-stack-check-box"})}a.stopPropagation()};c.button.addEventListener("click",b);c.button.addEventListener("touchstart",b);return c},create_parent_selection_check_box:function(c,e){var b=function(){var a=e.get_parent();if(a&&(a.is_nest()||a.is_hole()||a.is_element()))return a.is_hole()?a.get_parent_of_frontside():a},h=b(),k=function(a){return"Drag the "+
a.get_type_name()+" I'm on when dragging"},g=function(a){return"Check this if you want to drag the "+a.get_type_name()+" when you move this widget."};if(h){var v=a.UTILITIES.create_check_box(e.get_infinite_stack(),"toontalk-parent-selection-check-box",k(h),g(h));var x=function(a){var c=b();c?(c!==a&&p(c),v.button.disabled=!1,$(v.label).removeClass("ui-state-disabled"),v.container.title=g(c)):A()},p=function(a){v.label.innerHTML=k(a);v.button.innerHTML=g(a)},q=function(){x();return e},A=function(){v.button.checked=
!1;v.button.disabled=!0;$(v.label).addClass("ui-state-disabled");v.container.title="Widget moved so this has been disabled. Close and re-open the backside to refresh."};v.button.checked=e!==e.get_selection();v.button.checked||(e.get_selection=q);v.button.addEventListener("click",function(a){var c=b();b()?(c!==h&&p(c),e.get_selection=v.button.checked?function(){var a=b();x();return a?a.get_selection():e}:q,a.stopPropagation()):A()});return v}},create_click_opens_backside_check_box:function(c,e){var b=
a.UTILITIES.create_check_box(e.get_open_backside_only_if_stopped(),"toontalk-click-opens-backside-check-box","Mouse click opens this backside only if I'm stopped.","Check this if you want my backside to open only when I'm stopped. Really useful if there are robots using click sensors.");c=function(a){var c=!e.get_open_backside_only_if_stopped();e.set_open_backside_only_if_stopped(c);b.button.checked=c;if(e.robot_in_training()){var g=c?"change the response to a mouse click to open only if stopped the backside of ":
"change the response to a mouse click to always open the backside of ";e.robot_in_training().edited(e,{setter_name:"set_open_backside_only_if_stopped",argument_1:c,toString:g,button_selector:".toontalk-click-opens-backside-check-box"})}a.stopPropagation()};b.button.addEventListener("click",c);b.button.addEventListener("touchstart",c);return b},create_description_label:function(c,e){if(c=e.get_description())return a.UTILITIES.create_text_element("I'm the backside of a "+e.get_type_name()+" that is "+
c)},add_description_setting:function(c){var e=this.get_widget(),b=e.get_type_name(),h=a.UTILITIES.create_text_area(e.get_description(),"toontalk-description-input","I'm ","Type here to provide additional information about this "+b+".",function(b){(b=a.UTILITIES.input_area_drop_handler(b,e.receive_description_from_dropped.bind(e),e))&&e.robot_in_training()&&e.robot_in_training().dropped_on_text_area(b,e,{area_selector:".toontalk-description-input",setter:"receive_description_from_dropped",toString:"for a widget's description"})});
b=function(){var a=h.button.value.trim();e.set_description(a,!0,!0)};$(h.button).val(e.get_description());h.button.addEventListener("change",b);h.button.addEventListener("mouseout",b);this.set_description_text_area(h);(c||this.get_backside_element(!0)).appendChild(a.UTILITIES.create_row(h.container));e.get_description()||h.button.setAttribute("placeholder",e.get_default_description())},add_name_setting:function(c){var e=this.get_widget(),b=e.get_type_name(),h=a.UTILITIES.create_text_input(e.get_name(),
"toontalk-name-input",e.get_name_input_label?e.get_name_input_label():"My name is ",e.get_name_input_title?e.get_name_input_title():"Edit the name of this "+b+". There is not much room so keep it short.",void 0,"text",function(b){(b=e.receive_name_from_dropped&&a.UTILITIES.input_area_drop_handler(b,e.receive_name_from_dropped.bind(e),e))&&e.robot_in_training()&&e.robot_in_training().dropped_on_text_area(b,e,{area_selector:".toontalk-name-input",setter:"receive_name_from_dropped",toString:"for a widget's name"})});
b=function(){e.set_name&&e.set_name(h.button.value.trim(),!0,!0)};h.button.addEventListener("change",b);h.button.addEventListener("mouseout",b);this.set_name_text_input(h);(c||this.get_backside_element(!0)).appendChild(a.UTILITIES.create_row(h.container))},add_advanced_settings:function(){var c=this.get_widget(),e=this.create_infinite_stack_check_box(this,c),b=this.create_parent_selection_check_box(this,c),h=this.create_click_opens_backside_check_box(this,c),k=c.get_type_name(),g=$("<button>Make a sensor nest</button>").button(),
v=$("<button>Make a function bird</button>").button(),x=document.createElement("table"),p=this.get_element(),q=function(b,e){var g=b.get_frontside_element(!0);c.add_to_top_level_backside(b,!1);b=e.offset();b.left-=120;0>b.left&&(b.left=0);a.UTILITIES.set_absolute_position(g,b)};$(p).find(".toontalk-settings-backside-button").get(0);var A;$(x).addClass("toontalk-advanced-settings-table");g.addClass("toontalk-make-sensor_nest_button toontalk-button");g.get(0).addEventListener("click",function(b){var e=
a.sensor.create("click","which",void 0,void 0,!0,c);q(e,g);c.robot_in_training()&&c.robot_in_training().created_widget(e,c,".toontalk-make-sensor_nest_button");b.stopPropagation()});g.attr("title","Click to create a nest which receives messages when events happen to this "+c.get_type_name()+".");v.addClass("toontalk-make-function_bird_button toontalk-button");v.get(0).addEventListener("click",function(b){var e=c.get_function_type&&c.get_function_type();e=a.bird.create_function(e||k);q(e,v);c.robot_in_training()&&
c.robot_in_training().created_widget(e,c,".toontalk-make-function_bird_button");b.stopPropagation()});c.is_number()||c.is_box()&&!c.is_scale()||c.is_element()?v.attr("title","Click to get a bird that flies to functions of "+c.get_type_name(!0)+"."):(v.attr("title","There are no functions that operate on "+c.get_type_name(!0)+" (yet)."),v.button("option","disabled",!0));if(0<arguments.length)for(A=0;A<arguments.length;A++)x.appendChild(arguments[A]);this.get_description_text_area()||this.add_description_setting(x);
c.set_name&&!this.get_name_text_input()&&this.add_name_setting(x);x.appendChild(a.UTILITIES.create_row(g.get(0),v.get(0),e.container,b&&b.container,h.container));this.is_primary_backside()||(e=$("<button>Remove me and my widget</button>").button(),e.get(0).addEventListener("click",function(){c.robot_in_training()&&(c.robot_in_training().removed(c),c.robot_in_training().removed(this));this.remove();c.remove()}.bind(this)),e.attr("title","Click to remove this "+c.get_type_name()+" and its backside."),
e.addClass("toontalk-remove-backside-and-widget-button"),a.UTILITIES.use_custom_tooltip(e.get(0)),x.appendChild(e.get(0)));a.UTILITIES.use_custom_tooltip(g.get(0));a.UTILITIES.use_custom_tooltip(v.get(0));p.appendChild(x)},get_type_name:function(){return"backside of "+a.UTILITIES.add_a_or_an(this.get_widget().get_type_name())},hide_backside:function(c){var e;var b=$(this.get_element());if(0!==b.length){var h=this.get_widget();(e=h.robot_in_training())&&e.get_training_context()===h&&(e.hide_backside(),
$(e.get_backside_element()).find(".toontalk-train-backside-button").click(),h.add_to_top_level_backside(e.get_first_in_team()));var m=h.get_frontside_element(c&&h.get_parent_of_frontside()&&h.get_parent_of_frontside().is_top_level());e=b.position();var g=b.parent().closest(".toontalk-backside");var v=function(b){var e=$(m).position(),g=function(){x&&(this.set_parent_of_backside(void 0,!0),x.is_backside()||x.removed_from_container(this,c,void 0,!0),h.forget_backside&&h.forget_backside());b.remove();
c&&h.backup_all()}.bind(this);a.UTILITIES.visible_element(b)?"0"===b.css("opacity")?(b.removeClass("toontalk-animating-element"),b.remove()):(b.addClass("toontalk-side-appearing"),a.UTILITIES.add_one_shot_event_handler(b.get(0),"transitionend",2500,g),a.UTILITIES.set_css(b,{left:e&&e.left,top:e&&e.top,opacity:.1})):g()}.bind(this);var x=h.get_parent_of_backside();a.UTILITIES.remove_highlight();k(this);h.backside_geometry=this.get_backside_dimensions();v(b);this.set_visible(!1);c&&m&&!a.UTILITIES.visible_element(m)&&
(e&&a.UTILITIES.set_css(m,{left:e.left,top:e.top}),!(b=a.UTILITIES.widget_side_of_jquery(g))||h.is_robot()&&b.get_widget().is_robot()&&h.get_first_in_team()===b.get_widget().get_first_in_team()||(b.widget_side_dropped_on_me(h,{event:c,ignore_training:!0}),h.render()));a.UTILITIES.for_each_batch(h.get_backside_widgets(),function(a){a.set_visible(!1)});if(h.on_backside_hidden)h.on_backside_hidden()}},create_advanced_settings_button:function(c,e){var b=document.createElement("div"),h=$(b);b.innerHTML=
"&gt;";h.addClass("toontalk-settings-backside-button toontalk-button toontalk-button-style");h.css({"z-index":a.UTILITIES.next_z_index()});b.addEventListener("click",function(a){c.set_advanced_settings_showing(!c.get_advanced_settings_showing(),c.get_element(),h);a.stopPropagation();e.robot_in_training()&&e.robot_in_training().button_clicked(".toontalk-settings-backside-button",e)});a.UTILITIES.give_tooltip(h.get(0),"Click to see the advanced settings of this "+e.get_type_name()+".");return b},scale_backside:function(c,
e,b,h,k){var g=Math.min(1,e,b);1===e&&1===b?!this.get_parent()||this.get_parent().is_backside()?a.UTILITIES.set_css(c,{width:h,height:k,transform:"","transform-origin":""}):a.UTILITIES.set_css(c,{width:"",height:""}):a.UTILITIES.set_css(c,{transform:"scale("+g+", "+g+")","transform-origin":"left top",width:h*e/g,height:k*b/g})},render:function(){a.DISPLAY_UPDATES.pending_update(this)},rerender:function(){this.visible()&&a.DISPLAY_UPDATES.pending_update(this)},remove_backside_widget:function(a,e){return this.get_widget().remove_backside_widget(a,
e)},top_level_widget:function(){return this.get_widget().top_level_widget()},robot_in_training:function(){return this.get_widget().robot_in_training()},remove:function(a){var c;this.is_primary_backside()?this.get_widget().remove():((c=this.get_parent_of_backside())&&(c.is_backside()?c.remove_backside_widget(this,!a):c.removed_from_container&&(c.is_backside()?c.remove_backside_widget(this,!0):c.removed_from_container(this,a))),this.set_parent_of_backside(void 0),(a=this.get_element())&&$(a).remove())},
match:function(a){if(a.is_backside()){if(this.get_erased())return"matched";var c=this.get_widget();a=c.match(a.get_widget());return a===c?this:a}a.last_match=this;return a},add_copy_to_container:function(a,e,b){return this.get_widget().add_copy_to_container(a||this.copy(),e,b)},has_ancestor:function(a){var c;return this===a?!0:(c=this.get_parent_of_backside())?c.has_ancestor(a):!1},has_ancestor_either_side:function(a){if(this===a||this===a.get_backside())return!0;var c=this.get_parent_of_frontside();
try{if(c||(c=this.get_parent_of_backside()))return c.has_ancestor_either_side(a)}catch(b){console.error("widget.has_ancestor_either_side encountered this error: "+b.message)}return!1},get_backside:function(){return this},copy:function(){return this.get_widget().create_backside()},is_backside:function(){return!0},get_parent:function(){return this.get_parent_of_backside()},set_parent:function(a){this.set_parent_of_backside(a)},maintain_proportional_dimensions:function(){return!1},constrained_by_container:function(){return!1},
set_running:function(){},can_run:function(a){return this.get_widget().can_run(a)},dereference:function(){return this},is_of_type:function(a){return this.get_widget().is_of_type(a)},is_top_level:function(){return this.get_widget().is_top_level()},ok_to_set_dimensions:function(){return!1},add_listener:function(a,e){this.get_widget().add_listener(a,e)},remove_listener:function(a,e,b){this.get_widget().remove_listener(a,e,b)},get_listeners:function(a){return this.get_widget().get_listeners(a)},is_hole:function(){return!1},
is_box:function(){return!1},is_element:function(){return!1},is_sensor:function(){return!1},is_plain_text_element:function(){return!1},is_nest:function(){return!1},is_robot:function(){return!1},save_dimensions:function(){return!1},show:function(){$(this.get_element()).show()},hide:function(){$(this.get_element()).hide()},get_infinite_stack:function(){return!1},drag_started:function(a,e){this.robot_in_training()&&this.robot_in_training().picked_up(this,a,e)},get_json:function(c,e,b,h){var m=this.get_backside_dimensions(),
g=$(this.get_element()).position();k(this);var v=m?{width:m.original_width,height:m.original_height,transform:"scale("+m.x_scale+", "+m.y_scale+")","transform-origin":"left top 0px",left:g.left,top:g.top}:g;m=function(a,b,c){e({type:"backside",my_widget:a,css:v,erased:this.get_erased(),view:{}},b,c+1)}.bind(this);a.UTILITIES.get_json(this.get_widget(),c,m,b,h+1)},get_selection:function(){return this}}}(window.TOONTALK);
TOONTALK.creators_from_json.backside=function(a,k){k=TOONTALK.UTILITIES.create_from_json(a.my_widget,k).create_backside();var c=k.get_element();TOONTALK.UTILITIES.set_css(c,a.css);a.erased&&k.set_erased(a.erased,!1,!0);return k};window.TOONTALK.frontside=function(a){var k=[];return{create:function(c){var e=Object.create(this),b=document.createElement("div"),h=$(b),m=function(b){if(!($(b.target).is(".ui-resizable-handle")||"click"===b.type&&1!==b.which||c.get_open_backside_only_if_stopped()&&c.get_running())){if(h.is(".toontalk-top-level-resource")&&!b.altKey)c.set_running(!c.get_running());else{if(a.open_backside_only_if_alt_key&&!b.altKey)return;c.open_backside(void 0,b.togetherjsInternal&&0);c.robot_in_training()&&c.robot_in_training().backside_opened(c);
c.backup_all()}b.stopPropagation()}},g=function(b,c){var e=b.get_backside();b=(b.is_empty_hole()?wiget.get_parent_of_frontside():b).get_selection().get_frontside_element();b=$(b);e&&a.UTILITIES.highlight_element(e.get_element());$(".toontalk-wiggle").removeClass("toontalk-wiggle");b.is(".toontalk-top-level-resource")||b.addClass("toontalk-wiggle");c.stopPropagation()},v;$(b).addClass("toontalk-frontside toontalk-side");c.get_infinite_stack()&&$(b).addClass("toontalk-infinite-stack");b.toontalk_widget_side=
c;a.UTILITIES.drag_and_drop(b);e.get_element=function(){return b};e.get_widget=function(){return c};e.visible=function(){return v};e.set_visible=function(b,c){var e=this.get_widget();(v=b)&&a.UTILITIES.when_attached(this.get_element(!0),e.render.bind(e));e.walk_children_now_or_later&&e.walk_children_now_or_later(function(a,c){a.set_visible(b,c);return!0},c)};b.addEventListener("click",m);b.addEventListener("touchstart",m);b.addEventListener("mouseenter",function(a){g(c,a);0<=k.indexOf(c)?k=[]:k.push(c)});
b.addEventListener("mouseleave",function(b){var e=c.get_backside(),h=c.is_empty_hole()?wiget.get_parent_of_frontside():c;e&&a.UTILITIES.remove_highlight();$(h.get_frontside_element()).removeClass("toontalk-wiggle");k.pop();0<k.length&&g(k[k.length-1],b)});a.debugging&&(b.id=c._debug_id);return e},update_display:function(){return this.get_widget().update_display()},remove:function(){var a=this.get_element();$(a).remove();a.toontalk_widget_side=null},clear_selection_feedback_stack:function(){k=[]}}}(window.TOONTALK);(function(a){var k=180/Math.PI,c=Math.log(10),e=bigrat.fromInteger(10),b=bigrat.fromValues(1,2),h=bigrat.fromValues(-1,2),m=bigrat.fromInteger(360),g=bigrat.fromDecimal(2*Math.PI),v=Math.log10?Math.log10:function(a){return Math.log(a)/c},x=function(a){var b=bigrat.fromValues(bigrat.toBigInteger(a),1);a=bigrat.subtract(bigrat.create(),a,b);return{integer_part:b,fractional_part:a}},p=function(b){var c=x(b),e=a.number.ZERO(a.number.function_bird_results_default_format),g=a.number.ZERO(a.number.function_bird_results_default_format);
e.set_value(c.integer_part);g.set_value(c.fractional_part);return a.box.create(2,!0,[e,g],"The integer and fraction parts of "+b.toString().replace(",","/"))},q=function(a,b){a=bigrat.divide(bigrat.create(),a,b);var c=x(a);return bigrat.multiply(a,c.fractional_part,b)},A=function(a){a=x(a);return bigrat.isLessThan(a.fractional_part,h)?bigrat.subtract(a.integer_part,a.integer_part,bigrat.ONE):bigrat.isLessThan(a.fractional_part,bigrat.ZERO)||bigrat.isLessThan(a.fractional_part,b)?a.integer_part:bigrat.add(a.integer_part,
a.integer_part,bigrat.ONE)},y=function(a){a=x(a);return bigrat.isLessThan(a.fractional_part,bigrat.ZERO)?bigrat.subtract(a.integer_part,a.integer_part,bigrat.ONE):a.integer_part},z=function(a){a=x(a);return bigrat.isLessThan(a.fractional_part,bigrat.ZERO)||bigrat.equals(a.fractional_part,bigrat.ZERO)?a.integer_part:bigrat.add(a.integer_part,a.integer_part,bigrat.ONE)};window.TOONTALK.number=function(){var b=Object.create(a.widget),c=function(a,b,c,e){var g="",d=100;c=50/c;b/=1+b;if(e)for(e=0;d>=c&&
e<a.length;)g=g+"<span class='toontalk-digit' style='font-size:"+d+"%'>"+a[e]+"</span>",e+=1,"-"!==a[e]&&(d*=b);else for(e=a.length-1;d>=c&&0<e;)g="<span class='toontalk-digit' style='font-size:"+d+"%'>"+a[e]+"</span>"+g,--e,"-"!==a[e]&&(d*=b);return g},g=function(a,b){return 0>a?0:Math.ceil(Math.log(.5/b)/Math.log(a/(1+a)))},h=function(a,b,e){if(a.length<=Math.round(b))return'<span class="toontalk-digit" style="font-size:100%">'+a+"</span>";if(1>b)return"";if(5>b)return"<span style='font-size: 80%'>"+
h(a,1.25*b,.8*e)+"</span>";b=b/2-1;return c(a,b,e,!0)+c(a,b,e,!1)},k=function(a){return 0<a.length&&"0"===a.charAt(a.length-1)?k(a.substring(0,a.length-1)):a},m=function(a,b){b||(b=1);if(!("number"!==typeof a&&"string"!==typeof a||"number"!==typeof b&&"string"!==typeof b))return bigrat.fromValues(a,b);var c=bigrat.create();1===b?bigrat.set(c,bigrat.toBigInteger(a.get_value()),BigInteger.ONE):a.get_value&&b.get_value?bigrat.set(c,bigrat.toBigInteger(a.get_value()),bigrat.toBigInteger(b.get_value())):
bigrat.set(c,a,b);return c},p=function(b){switch(b){case "+":return"";case "-":return"&minus;&thinsp;";case "*":return"&times;&thinsp;";case "/":return"&divide;&thinsp;";case "=":return"&equals;&thinsp;";case "^":return"^";default:return a.UTILITIES.report_internal_error("Number has an unsupported operator: "+b),""}},q=function(b){switch(b){case "+":return"toontalk-plus-radio-button";case "-":return"toontalk-minus-radio-button";case "*":return"toontalk-times-radio-button";case "/":return"toontalk-divide-radio-button";
case "=":return"toontalk-set-equal-radio-button";default:return a.UTILITIES.report_internal_error("Unsupported number operator: "+b),""}},y=function(b){switch(b){case "decimal":return"toontalk-decimal-radio-button";case "proper_fraction":return"toontalk-proper-fraction-radio-button";case "improper_fraction":return"toontalk-improper-fraction-radio-button";case "scientific_notation":return"toontalk-scientific-notation-radio-button";default:return a.UTILITIES.report_internal_error("Unsupported number format: "+
b),""}},z=function(a,b){switch(a){case "+":return"add "+b+" to";case "-":return"subtract "+b+" from";case "*":return"multiply "+b+" with";case "/":return"divide "+b+" into"}},x=function(b){switch(b){case "+":return"addition";case "-":return"subtraction";case "*":return"multiplication";case "/":return"division";case "=":return"equality";default:return a.UTILITIES.report_internal_error("Unsupported number operator: "+b),""}};b.default_format="mixed_number";b.function_bird_results_default_format="decimal";
b.create=function(c,e,g,h,n,d){var f=Object.create(b),k=m(c,e);g||(g="+");f.is_number=function(){return!0};f.set_value=function(b,d){if(d||!bigrat.equals(k,b))return this.fire_value_change_listeners(k,b),(d=this.get_frontside_element())&&d.dispatchEvent(a.UTILITIES.create_event("value changed",{old_value:k,new_value:b})),k=b,this.rerender(),a.debugging&&(this._debug_string=this.to_debug_string(),"0,0"===b.toString()&&a.UTILITIES.report_internal_error("Impossible numeric value -- can be caused by decimal string not being parsable as a number.")),
this};f.set_value_from_sub_classes=f.set_value;f.fire_value_change_listeners=function(a,b){var d=this.get_listeners("value_changed");if(d){var c={type:"value_changed",old_value:a,new_value:b};d.forEach(function(a){a(c)})}};f.get_value=function(){return k};f.set_value_from_decimal=function(b){this.set_value(bigrat.fromDecimal(b));a.debugging&&"0,0"===this.get_value().toString()&&a.UTILITIES.report_internal_error("Number being set to 0/0 from "+b)};f.copy=function(a){return this.add_to_copy(b.create(k[0],
k[1],g,h,n,d),a)};f.get_format=function(){return h||b.default_format};f.set_format=function(a,b,d){h=a;b&&this.rerender();d&&this.robot_in_training()&&this.robot_in_training().edited(this,{setter_name:"set_format",argument_1:a,toString:"by changing the format to "+a,button_selector:"."+y(a)});return this};f.get_operator=function(){return g};f.set_operator=function(a,b,d){g=a;b&&this.rerender();d&&this.robot_in_training()&&this.robot_in_training().edited(this,{setter_name:"set_operator",argument_1:a,
toString:"by changing the operator to "+x(a),button_selector:"."+q(a)});return this};f.get_approximate=function(){return d};f.set_approximate=function(a,b){d=a;b&&this.rerender();return this};b.add_standard_widget_functionality(f);f.set_description(n);if(a.listen){var p,z,v;f.add_speech_listeners({commands:"add | plus | sum | addition | subtract | subtraction | take away | times | multiply | multiplication | divide | division | equal | equals | decimal number | decimal | mixed number | mixed | improper fraction | improper | fraction | scientific notation | scientific",
numbers_acceptable:!0,descriptions_acceptable:!0,success_callback:function(b){var d=a.UTILITIES.get_dragee_copy()||f;switch(b){case "add":case "plus":case "sum":case "addition":d.set_operator("+",!0,!0);break;case "subtract":case "take away":case "subtraction":d.set_operator("-",!0,!0);break;case "times":case "multiply":case "multiplication":d.set_operator("*",!0,!0);break;case "divide":case "divides":case "divide by":case "division":d.set_operator("/",!0,!0);break;case "equal":case "equals":d.set_operator("=",
!0,!0);break;case "decimal number":case "decimal":d.set_format("decimal",!0,!0);break;case "mixed number":case "mixed":d.set_format("mixed_number",!0,!0);break;case "improper fraction":case "improper":case "fraction":d.set_format("improper_fraction",!0,!0);break;case "scientific notation":case "scientific":d.set_format("scientific_notation",!0,!0);break;default:p=parseFloat(b),isNaN(p)?console.log("did not understand spoken command: '"+b+"'"):(d.set_value_from_decimal(p),d.robot_in_training()&&d.robot_in_training().edited(d,
{setter_name:"set_value_from_decimal",argument_1:p,toString:"by changing its value to "+p,button_selector:".toontalk-numerator-input"}))}d.update_display();z="You are now holding "+d.get_text(!0);z!==v&&(f.display_message("You are now holding "+d.get_frontside_element(!0).innerHTML,{display_on_backside_if_possible:!0,duration:4E3,plain_text:z}),v=z)}})}a.debugging&&(f._debug_string=f.toString(),f._debug_id=a.UTILITIES.generate_unique_id(),k._debug_id_new=f._debug_id);return f};b.create_from_bigrat=
function(b){var c=a.number.ZERO();c.set_value(b);return c};b.create_backside=function(){return a.number_backside.create(this)};b.set_from_values=function(a,b){return this.set_value(m(a,b))};b.set_numerator=function(a){return this.set_value(m(a,this.get_value()[1].toString()))};b.set_numerator_to_float=function(a){return this.set_value(bigrat.divide(this.get_value(),bigrat.fromDecimal(a),this.denominator()),!0)};b.set_denominator=function(a){return this.set_value(m(this.get_value()[0].toString(),a))};
b.set_denominator_to_float=function(a){return this.set_value(bigrat.divide(this.get_value(),this.numerator(),bigrat.fromDecimal(a)),!0)};b.ONE=function(){return a.number.create(1)};b.ZERO=function(b){return a.number.create(0,void 0,void 0,b)};b.equals=function(a){return a.equals_number&&a.equals_number(this)};b.equals_number=function(a){return bigrat.equals(this.get_value(),a.get_value())};b.compare_with=function(a){if(a.compare_with_number)return-1*a.compare_with_number(this)};b.compare_with_number=
function(a){return bigrat.equals(this.get_value(),a.get_value())?0:bigrat.isGreaterThan(this.get_value(),a.get_value())?1:-1};b.update_display=function(){var b=this.get_frontside(!0),c=function(a,b){var d=a.indexOf('style="');return 0<=d?a.substring(0,d+7)+b+a.substring(d+7):a},e=28,g;a.logging&&0<=a.logging.indexOf("display")&&console.log("Updating display of "+this.to_debug_string(50));b=b.get_element();if($(b).is(".toontalk-conditions-contents"))var h=$(b);else if($(b).parent().is(".toontalk-backside, .toontalk-json, .toontalk-robot")){h=
$(b);var d=!0}else if($(b).parent().is(".toontalk-element-frontside")){h=$(b);var f=d=!0}else h=$(b).parent().is(".toontalk-scale-half")?$(b):$(b).parent();0===h.length&&(e=this.get_parent_of_frontside())&&(e.get_widget().is_hole()&&(e=e.get_parent_of_frontside()),h=$(e.get_frontside_element()));1===a.nest.CONTENTS_WIDTH_FACTOR&&1===a.nest.CONTENTS_HEIGHT_FACTOR&&h.is(".toontalk-nest")&&h.parent().is(".toontalk-box-hole")&&!h.parent().is(".toontalk-scale-half")&&(h=h.parent());if($(b).is(".toontalk-carried-by-bird"))var n=
g=100;else if($(b).is(".toontalk-element-attribute"))g=200,n=32;else if(d&&(b===h.get(0)||h.is(".toontalk-top-level-resource")))g=$(b).width(),n=$(b).height(),g&&n||(g=this.saved_width||this.get_default_width(),n=this.saved_heieght||this.get_default_height(),$(b).css({width:g,height:n}));else{0<h.length&&(g=h.width(),n=h.height());if(0===g||0===n||0===h.length){a.logging&&0<=a.logging.indexOf("display")&&0<h.length&&console.log("Container has zero dimensions so no display of "+this.to_debug_string());
a.UTILITIES.is_attached(b)||a.UTILITIES.when_attached(b,this.update_display.bind(this));return}h.is(".toontalk-nest")&&(g*=a.nest.CONTENTS_WIDTH_FACTOR,n*=a.nest.CONTENTS_HEIGHT_FACTOR)}var k=$(b).children(".toontalk-widget");k.is("*")?k=k.get(0):(k=document.createElement("div"),b.appendChild(k));$(b).removeClass("toontalk-number-eighth-size-border toontalk-number-quarter-size-border toontalk-number-half-size-border toontalk-number-full-size-border");e=this.get_border_size(g,n);f||(4===e?$(b).addClass("toontalk-number-eighth-size-border toontalk-number"):
8===e?$(b).addClass("toontalk-number-quarter-size-border toontalk-number"):16===e?$(b).addClass("toontalk-number-half-size-border toontalk-number"):$(b).addClass("toontalk-number-full-size-border toontalk-number"));f=n-2*e;d=this.to_HTML(g/(f*a.FONT_ASPECT_RATIO),g,n,f,this.get_format(),!0,this.get_operator(),d);a.UTILITIES.on_a_nest_in_a_box(b)&&(d=c(d,"width:"+(g-2*e)+"px;"),d=c(d,"height:"+(n-2*e)+"px;"));k.innerHTML=d;k.translate=!1;$(k).addClass("toontalk-widget notranslate");h.is(".toontalk-box-hole")&&
$(b).css({width:"",height:""});$(b).is(".toontalk-conditions-contents")&&$(b).css({width:a.UTILITIES.get_toontalk_css_numeric_attribute("width",".toontalk-conditions-container")-2*e,height:a.UTILITIES.get_toontalk_css_numeric_attribute("height",".toontalk-conditions-container")-2*e});a.UTILITIES.give_tooltip(b,this.get_title())};b.get_default_width=function(){return 76};b.get_default_height=function(){return 55};b.get_border_size=function(a,b){return 64>=a||64>=b?4:128>=a||128>=b?8:256>=a||256>=b?
16:32};b.to_HTML=function(b,n,m,q,y,d,f,z){var r=!1!==d?" toontalk-top-level-number":"",x=4,w=b,A;this.is_attribute_widget&&this.is_attribute_widget()?r+=" toontalk-attribute-number":this.get_approximate()&&!this.get_erased()&&(r+=" toontalk-approximate-number");z&&(r+=" toontalk-number-size-unconstrained-by-container");var l=f?p(f):"";w||(w=4);q||(q=16);if(this.get_erased&&this.get_erased())return'<div class="toontalk-number toontalk-integer'+r+'" style="font-size: '+q+'px;"></div>';if(0<l.length){--w;
if(A="-"===f&&(this.is_negative()||this.is_zero())&&(this.is_integer()||"improper_fraction"!==y&&"proper_fraction"!==y&&"mixed_number"!==y))--w,l+="&nbsp;";2>w&&(q*=Math.max(1,w)/2,w=2)}if(this.is_integer()&&"scientific_notation"!==y){try{var u=bigrat.toBigInteger(this.get_value()).toString()}catch(aa){a.UTILITIES.report_internal_error("Error converting number to a string: "+aa),u="0"}d=u.length;0<l.length&&d++;4>w&&d>w&&(y=Math.min(4,d),q*=w/y,w=y);return'<div class="toontalk-number toontalk-integer'+
r+'" style="font-size: '+q+'px;">'+l+h(u,w,q)+"</div>"}if(this.get_approximate()||this.is_attribute_widget()){if("decimal"===y)var L=bigrat.toDecimal(this.get_value()).toString();else if("scientific_notation"===y&&(L=bigrat.toDecimal(this.get_value()).toExponential(),u=L.indexOf("e"),0<=u)){var M=L.substring(u+1);L=L.substring(0,u)}if(L)return d=L.length,w>d&&(w=d),0<l.length&&d++,M&&(w-=3+M.length/2),"scientific_notation"===y&&(x+=2),w<x&&d>w&&(y=Math.min(x,d),q=0>=w?Math.max(1,w)/y*q:Math.max(2,
w)/y*q),w=M?'&times;10<sup style="font-size: '+q/2+'px;">'+M+"</sup>":"",q=Math.min(q,n/(a.FONT_ASPECT_RATIO*d)),'<div class="toontalk-number toontalk-approximate-number'+r+'" style="font-size: '+q+'px;">'+l+'<div style="margin-top: '+(m-q)/2+'px">'+L+"</div>"+w+"</div>"}L=' style="font-size:'+.45*q+'px;"';if("improper_fraction"===y||!y)return q='<table class="toontalk-number toontalk-improper-fraction'+r+'"'+L+'><tr class="toontalk-numerator"><td align="center" class="toontalk-number">'+h(this.numerator_string(),
2*w,q)+'</td></tr><tr class="toontalk-fraction-line-as-row"><td class="toontalk-fraction-line-as-table-entry"><div class="toontalk-fraction-line"></div></tr><tr class="toontalk-denominator"><td align="center" class="toontalk-number">'+h(this.denominator_string(),2*w,q)+"</td></tr></table>",""===l?q:"<table class='toontalk-operator-and-fraction'"+L+"><tr><td style='width: 20%;'>"+l+"</td><td>"+q+"</td></tr></table>";if("mixed_number"===y||"proper_fraction"===y){l=this.integer_part();if(l.is_zero())return this.to_HTML(w,
n,m,q,"improper_fraction",d,f);M=this.copy({just_value:!0}).subtract(l).absolute_value();return'<table class="toontalk-number toontalk-mixed-number'+r+'"'+L+'><tr><td class="toontalk-number toontalk-integer-part-of-mixed-number">'+l.to_HTML(w/2,n,m,q,"",!1,this.get_operator())+'</td><td class="toontalk-number toontalk-fraction-part-of-mixed-number">'+M.to_HTML(w/2,n,m,q,"improper_fraction",!1)+"</td></tr></table>"}if("decimal"===y)return 4>w&&(q*=Math.max(1,w)/4,w=4),'<div class="toontalk-number toontalk-decimal toontalk-top-level-decimal'+
r+'" style="font-size: '+q+'px;">'+l+this.decimal_string(w,q)+"</div>";if("scientific_notation"===y){x=bigrat.isNegative(this.get_value());u=this.get_value();A=bigrat.abs(bigrat.create(),u);M=bigrat.isLessThan(A,bigrat.ONE);if(bigrat.equals(u,bigrat.ZERO))M=0;else{if(M){var E=bigrat.divide(bigrat.create(),bigrat.ONE,A);u=bigrat.toBigInteger(E)}else u=bigrat.toBigInteger(A);u=u.toString();M=M?0===E[1].compare(BigInteger.ONE)?-u.length+1:-u.length:u.length-1}E=6+(0===M?1:Math.ceil(v(Math.abs(M)))/2);
x&&E++;if(b<E+1)return this.to_HTML(E+1,n,m,q*b/(E+1),y,d,f,z);n=g(w-(Math.min(E,w/2)+1),q);M<n?(m=bigrat.power(bigrat.create(),e,n-M),m=bigrat.multiply(bigrat.create(),this.get_value(),m),n=bigrat.toBigInteger(m).toString().substring(0,n+1)):n=bigrat.toBigInteger(this.get_value()).toString().substring(0,n+1);if(this.is_integer()||this.is_reciprocal_of_integer())n=k(n);x?(m=n.substring(0,2),n=n.substring(2)):(m=n.substring(0,1),n=n.substring(1));w=c(n,w*(1-E/w),q,!0);0<w.length&&(w="<span class='toontalk-decimal-point'>.</span>"+
w);return'<table class="toontalk-number toontalk-scientific_notation'+r+'"'+L+'><tr><td class="toontalk-number toontalk-significand-of-scientific-notation"><div class="toontalk-number toontalk-decimal'+r+'" style="font-size: '+.9*q+'px;">'+l+m+w+'</td><td class="toontalk-number toontalk-exponent-of-scientific-notation"><div style="font-size: '+q+'px;"> &times;10<sup style="font-size: '+q/2+'px;">'+M+"</sup></div></td></tr></table>"}};b.get_default_description=function(){return this.get_approximate()?
"a number from an approximate calculation.":"a number."};b.is_resizable=function(){return!0};b.drop_on=function(a,b){if(a.number_dropped_on_me)return a.number_dropped_on_me(this,b),!0;if(a.widget_side_dropped_on_me)return a.widget_side_dropped_on_me(this,b);console.log("No handler for drop of '"+this+"' on '"+a+"'")};b.number_dropped_on_me=function(b,c){var e;if(!b.is_backside()){if(b.visible()&&this.visible()&&(c.event||c.robot)){if(c.robot){if(!c.robot.animate_consequences_of_actions())return this.number_dropped_on_me_semantics(b,
c);b.robot_waiting_before_next_step=c.robot}var g=document.createElement("div");$(g).addClass("toontalk-bammer-down");var h=$(this.get_frontside_element()).closest(".toontalk-backside-of-top-level");g.style.left="-10px";g.style.top=h.height()+"px";0<h.length&&h.get(0).appendChild(g);var d=this.get_frontside_element();var f=$(d).offset();f.left-=.75*$(g).width();f.left+=.5*$(d).width()+.1*$(g).width();f.top-=.5*$(d).height()+.4*$(g).height();d=function(){a.sounds&&a.sounds.bammer_hammer.play();this.number_dropped_on_me_semantics(b,
c)&&c.robot&&(this.rerender(),c.robot.run_next_step());c.event&&this.backup_all();$(g).removeClass("toontalk-bammer-down");a.UTILITIES.set_timeout(function(){var b=h.offset();b||(b={left:0,top:0});$(g).addClass("toontalk-bammer-away");f.left=b.left+h.width()-100;f.top=b.top+h.height()+100;e=function(){$(g).remove()};a.UTILITIES.animate_to_absolute_position(g,f,e,c.robot&&c.robot.transform_animation_speed(a.animation_settings.BAMMER_ANIMATION_SPEED));$(g).css({opacity:.01})})}.bind(this);a.UTILITIES.animate_to_absolute_position(g,
f,d,c.robot&&c.robot.transform_animation_speed(a.animation_settings.BAMMER_ANIMATION_SPEED));$(b.get_frontside_element(!0)).css({"z-index":a.UTILITIES.next_z_index()});$(g).css({opacity:1,"z-index":a.UTILITIES.next_z_index()+100});return this}return this.number_dropped_on_me_semantics(b,c)}};b.number_dropped_on_me_semantics=function(b,c){c&&c.event&&this.robot_in_training()&&this.robot_in_training().dropped_on(b,this);b.get_approximate()&&this.set_approximate(!0);b.remove({remove_backside:!0});switch(b.get_operator()){case "+":return this.add(b);
case "-":return this.subtract(b);case "*":return this.multiply(b);case "/":return this.divide(b,c);case "=":return this.set_value(b.get_value());case "^":return this.power(b);default:a.UTILITIES.report_internal_error("Number received a number with unsupported operator: "+b.get_operator())}};b.widget_side_dropped_on_me=function(b,c){if(b.number_dropped_on_me)return this.number_dropped_on_me(b,c);(b=b.get_frontside_element())&&this.get_frontside_element().dispatchEvent(a.UTILITIES.create_event("widget added",
{element_widget:b,where:"front"}));return!1};b.add=function(a){this.set_value(bigrat.add(this.get_value(),this.get_value(),a.get_value()),!0);return this};b.subtract=function(a){this.set_value(bigrat.subtract(this.get_value(),this.get_value(),a.get_value()),!0);return this};b.multiply=function(a){this.set_value(bigrat.multiply(this.get_value(),this.get_value(),a.get_value()),!0);return this};b.divide=function(b,c){if(b.is_zero())return b="Can't divide by zero. Operation ignored.",c&&c.robot&&(b+=
" Caused by the robot who "+c.robot),a.UTILITIES.display_message(b),this;this.set_value(bigrat.divide(this.get_value(),this.get_value(),b.get_value()),!0);return this};b.minimum=function(a){this.set_value(bigrat.min(this.get_value(),this.get_value(),a.get_value()),!0);return this};b.maximum=function(a){this.set_value(bigrat.max(this.get_value(),this.get_value(),a.get_value()),!0);return this};b.power=function(a){this.set_value(bigrat.power(this.get_value(),this.get_value(),bigrat.toInteger(a.get_value())),
!0);return this};b.absolute_value=function(){this.set_value(bigrat.abs(this.get_value(),this.get_value()),!0);return this};b.is_zero=function(){return bigrat.equals(this.get_value(),bigrat.ZERO)};b.is_negative=function(){return bigrat.isNegative(this.get_value())};b.toString=function(a){var b="";if(this.get_erased())return"erased number";"+"===this.get_operator()||a&&a.without_operator||(b=this.get_operator());return b+bigrat.str(this.get_value())};b.get_text=function(b){var c=this.get_format(),e=
"";switch(this.get_operator()){case "-":e="subtract ";break;case "*":e="multiply by ";break;case "/":e="divide by ";break;case "=":e="make what I'm dropped on equal to "}if(this.get_approximate()||this.is_attribute_widget&&this.is_attribute_widget())return"approximately "+bigrat.toDecimal(this.get_value()).toString();if(this.is_integer()||"improper_fraction"===c)return b?e+a.UTILITIES.number_to_words(this.toString({without_operator:!0})):e+this.toString({without_operator:!0});c=this.integer_part();
if(c.is_zero())return b?e+a.UTILITIES.number_to_words(this.toString({without_operator:!0})):e+this.toString({without_operator:!0});var g=this.copy({just_value:!0}).subtract(c).absolute_value();return b?e+a.UTILITIES.number_to_words(c.toString({without_operator:!0}))+(b?" and ":" ")+a.UTILITIES.number_to_words(g.toString({without_operator:!0})):e+c+" "+g};b.to_float=function(){return bigrat.toDecimal(this.get_value())};b.get_type_name=function(a){return a?"numbers":"number"};b.get_help_URL=function(){return"docs/manual/numbers.html"};
b.get_json=function(b,c,e,g){c({type:"number",operator:this.get_operator(),numerator:a.UTILITIES.string_to_array(this.numerator_string(),100),denominator:a.UTILITIES.string_to_array(this.denominator_string(),100),format:this.get_format(),approximate:this.get_approximate()},e,g+1)};a.creators_from_json.number=function(a){if(a)return Array.isArray(a.numerator)&&(a.numerator=a.numerator.join("")),Array.isArray(a.denominator)&&(a.denominator=a.denominator.join("")),b.create(a.numerator,a.denominator,
a.operator,a.format,a.description,a.approximate)};b.is_integer=function(){return 0===this.get_value()[1].compare(BigInteger.ONE)||0===this.get_value()[0].compare(BigInteger.ZERO)};b.is_reciprocal_of_integer=function(){return 0===this.get_value()[0].compare(BigInteger.ONE)&&0!==this.get_value()[1].compare(BigInteger.ONE)};b.numerator=function(){var a=bigrat.create();return bigrat.set(a,this.get_value()[0],BigInteger.ONE)};b.denominator=function(){var a=bigrat.create();return bigrat.set(a,this.get_value()[1],
BigInteger.ONE)};b.numerator_string=function(){return this.get_value()[0].toString()};b.denominator_string=function(){return this.get_value()[1].toString()};b.integer_part=function(){return this.create(this)};b.decimal_string=function(a,n){if(this.is_integer())return this.numerator_string();var m=this.get_value();var p=b.create(m[0],m[1]);var q=p.integer_part();m=q.toString();"0"===m&&this.is_negative()&&(m="-"+m);var d=p.get_value();bigrat.subtract(d,d,q.get_value());q=a-(Math.min(m.length,a/2)+
1);p=g(q,n);a=Math.min(m.length,a/2);bigrat.isNegative(d)&&bigrat.abs(d,d);var f=bigrat.fromValues(d[0],1);d=bigrat.fromValues(d[1],1);if(bigrat.equals(f,bigrat.ZERO))p="0";else{var y="",z=bigrat.create();bigrat.create();var v=bigrat.create();for(bigrat.multiply(f,f,e);p>y.length;){if(bigrat.isLessThan(f,d))y+="0";else{bigrat.divide(z,f,d);var x=bigrat.toBigInteger(z);y+=x.toString();bigrat.subtract(v,z,bigrat.fromValues(x,1));bigrat.multiply(f,v,d);if(bigrat.equals(f,bigrat.ZERO)){y=k(y);break}}bigrat.multiply(f,
f,e)}p=y}q=p.length<q?p:c(p,q,n,!0);return h(m,a,n)+"<span class='toontalk-decimal-point'>.</span>"+q};b.match=function(a){if(this.get_erased&&this.get_erased()){if(a.get_widget().match_with_any_number)return a.get_widget().match_with_any_number();this.last_match=a;return this}return a.match_with_this_number?a.match_with_this_number(this):(this.last_match=a,this)};b.match_with_any_number=function(){return"matched"};b.match_with_this_number=function(a){if(a.equals(this)&&a.get_operator()===this.get_operator())return"matched";
a.last_match=this;return a};b.get_custom_title_prefix=function(){var b="="===this.get_operator()?"Drop me on another number I'll give him my value.":"/"===this.get_operator()?"Drop me on another number I'll divide him by my value.":"Drop me on another number and I'll "+z(this.get_operator(),"myself")+" him.";this.get_approximate()&&(b+="\nI look a bit yellow because I'm the result of an "+a.UTILITIES.encode_HTML_for_title("<i>approximate</i>")+" calculation.");return b};return b}();window.TOONTALK.number_backside=
function(){return{create:function(b){var c=a.backside.create(b),e=c.get_element(),g=document.createElement("div"),h=b.numerator_string(),n=b.denominator_string(),k=a.UTILITIES.create_text_area(h,"toontalk-numerator-input","","Type here to edit the numerator",void 0,"number"),m=a.UTILITIES.create_text_area(n,"toontalk-denominator-input","","Type here to edit the denominator",void 0,"number"),p=a.UTILITIES.create_radio_button("number_format","decimal","toontalk-decimal-radio-button","Decimal number",
"Display number as a decimal.",!0),q=a.UTILITIES.create_radio_button("number_format","proper_fraction","toontalk-proper-fraction-radio-button","Mixed number","Display number as an integer part and a proper fraction.",!0),y=a.UTILITIES.create_radio_button("number_format","improper_fraction","toontalk-improper-fraction-radio-button","Improper fraction","Display number as a simple fraction.",!0),z=a.UTILITIES.create_radio_button("number_format","scientific_notation","toontalk-scientific-notation-radio-button",
"Scientific notation","Display number as a decimal between 1 and 10 multiplied by ten to some power.",!0),v=a.UTILITIES.create_radio_button("operator","+","toontalk-plus-radio-button","+","Add me to what I'm dropped on.",!0),x=a.UTILITIES.create_radio_button("operator","-","toontalk-minus-radio-button","&minus;","Subtract me from what I'm dropped on.",!0),A=a.UTILITIES.create_radio_button("operator","*","toontalk-times-radio-button","&times;","Multiply me with what I'm dropped on.",!0),F=a.UTILITIES.create_radio_button("operator",
"/","toontalk-divide-radio-button","&divide;","I will divide what I'm dropped on.",!0),d=a.UTILITIES.create_radio_button("operator","=","toontalk-set-equal-radio-button","&equals;","Set what I'm dropped on to my value.",!0),f=function(a){var d=k.button.value.trim(),c=m.button.value.trim(),e=function(a,b,d){if(1>a.length)return{message:"Empty "+b+" treated as 1.",replacement:"1"};if("-"===a.charAt(0)){if(d)return{message:"'-' only allowed as the first character of the "+b+". Ignoring extra '-'s.",
replacement:e(a,b).replacement};a=e(a.substring(1,a.length),b,!0);a.message||(a.replacement="-"+a.replacement);return a}return/^\d+$/.test(a)?{replacement:a}:{message:"The "+b+" can only contain digits. '"+a+"' doesn't make sense.",replacement:a.replace(/[^\d]*/g,"")}};if(d!==h||c!==n){var f=e(d,"numerator");if(f.message){var l=parseFloat(d);if(isNaN(l))b.display_message(f.message,{display_on_backside_if_possible:!0}),d=f.replacement;else var g=bigrat.fromDecimal(l)}if("0"===c)b.display_message("It doesn't make sense for a fraction to have a denominator of 0. Resetting it to 1.",
{display_on_backside_if_possible:!0}),c="1";else if(f=e(c,"denominator"),f.message){var u=parseFloat(c);if(isNaN(u))b.display_message(f.message,{display_on_backside_if_possible:!0}),c=f.replacement||"1";else var p=bigrat.fromDecimal(u)}if(g&&p)b.set_value(bigrat.divide(b.get_value(),g,p),!0);else if(g)b.set_value(bigrat.divide(b.get_value(),g,bigrat.fromValues(c,1)),!0);else if(p)b.set_value(bigrat.divide(b.get_value(),bigrat.fromValues(d,1),p),!0);else if(!b.set_from_values(d,c)&&!isNaN(u))return;
h=b.numerator_string();n=b.denominator_string();b.robot_in_training()&&(a=a.target.className.split(" ",1)[0],"toontalk-denominator-input"===a?b.robot_in_training().edited(b,{setter_name:p?"set_denominator_to_float":"set_denominator",argument_1:c,toString:"by changing the value of the denominator to "+c,button_selector:"."+a}):b.robot_in_training().edited(b,{setter_name:g?"set_numerator_to_float":"set_numerator",argument_1:d,toString:"by changing the value of the numerator to "+d,button_selector:"."+
a}));b.rerender()}},r=function(){var d=a.UTILITIES.selected_radio_button(p,q,y,z);d&&(d=d.button.value,b.set_format(d,!0,!0))},t=function(){var c=a.UTILITIES.selected_radio_button(v,x,A,F,d);c&&(c=c.button.value,b.set_operator(c,!0,!0))},C=a.UTILITIES.create_horizontal_table(k.container,g,m.container),S=a.UTILITIES.create_div(p,q,y,z),Z=a.UTILITIES.create_div(v,x,A,F,d),l=a.backside.create_advanced_settings_button(c,b),u=c.update_display.bind(c),L=c.add_advanced_settings,M=function(){switch(b.get_format()){case "decimal":return p;
case "improper_fraction":return y;case "mixed_number":case "proper_fraction":return q;case "scientific_notation":return z}},da=function(){switch(b.get_operator()){case "+":return v;case "-":return x;case "*":return A;case "/":return F;case "=":return d}};g.innerHTML="/";$(g).addClass("ui-widget");k.button.addEventListener("change",f);k.button.addEventListener("mouseout",f);k.button.addEventListener("mouseenter",function(){h=k.button.value.trim()});m.button.addEventListener("change",f);m.button.addEventListener("mouseout",
f);m.button.addEventListener("mouseenter",function(){n=m.button.value.trim()});e.appendChild(C);e.appendChild(l);p.button.addEventListener("change",r);q.button.addEventListener("change",r);y.button.addEventListener("change",r);z.button.addEventListener("change",r);a.UTILITIES.check_radio_button(M());a.UTILITIES.check_radio_button(da());v.button.addEventListener("change",t);x.button.addEventListener("change",t);A.button.addEventListener("change",t);F.button.addEventListener("change",t);d.button.addEventListener("change",
t);c.update_display=function(){$(k.button).val(b.numerator_string());$(m.button).val(b.denominator_string());a.UTILITIES.check_radio_button(M());a.UTILITIES.check_radio_button(da());u()};c.add_advanced_settings=function(){L.call(c,S,Z);$(S).controlgroup().removeClass("ui-controlgroup");$(Z).controlgroup().removeClass("ui-controlgroup")};a.UTILITIES.when_attached(e,function(){c.is_primary_backside()||b.add_listener("value_changed",function(){c.rerender()})});return c}}}();window.TOONTALK.number.function=
function(){var b=a.create_function_table(),c=function(a){return bigrat.toDecimal(q(a,m))},e=function(a){return bigrat.toDecimal(q(a,g))},h=function(){return!0};b.add_function_object("sum",function(c,e){return b.n_ary_widget_function(c,a.number.ZERO,a.number.add,"sum",e)},"The bird will return with the sum of the numbers in the box.","+");b.add_function_object("difference",function(c,e){return b.n_ary_widget_function(c,a.number.ZERO,a.number.subtract,"difference",e)},"The bird will return with the result of subtracting the numbers in the box from the first number.",
"-");b.add_function_object("product",function(c,e){return b.n_ary_widget_function(c,a.number.ONE,a.number.multiply,"product",e)},"The bird will return with the product of the numbers in the box.","\u00c3\u0192\u00c6\u2019\u00c3\u00a2\u00e2\u201a\u00ac\u00e2\u20ac\u009d");b.add_function_object("division",function(c,e){return b.n_ary_widget_function(c,a.number.ONE,a.number.divide,"division",e)},"The bird will return with the result of dividing the numbers into the first number in the box.","\u00c3\u0192\u00c6\u2019\u00c3\u201a\u00c2\u00b7");
b.add_function_object("modulo",function(a,c){return b.n_ary_function(a,b.bigrat_function_to_widget_function(q),2,"modulo",c)},"The bird will return with the first number modulo the second number. For positive numbers this is like the remainder after division.","mod");b.add_function_object("minimum",function(c,e){return b.n_ary_widget_function(c,a.number.ONE,a.number.minimum,"minimum",e)},"The bird will return with the smallest of the numbers in the box.","min");b.add_function_object("maximum",function(c,
e){return b.n_ary_widget_function(c,a.number.ONE,a.number.maximum,"maximum",e)},"The bird will return with the largest of the numbers in the box.","max");b.add_function_object("absolute value",function(c,e){return b.n_ary_function(c,function(b){var e=a.number.ZERO(c.get_hole_contents(1).get_format());bigrat.abs(e.get_value(),b);return e},1,"absolute value",e)},"The bird will return with the positive version of the number.","abs");b.add_function_object("power",function(a,c){return b.n_ary_function(a,
b.bigrat_function_to_widget_function(function(a,b){a=bigrat.power(bigrat.create(),a,b[0].valueOf());b=b[1].valueOf();return 1===b?a:bigrat.nthRoot(bigrat.create(),a,b)},function(a){return 0!==a[1][1].compare(BigInteger.ONE)}),2,"power",c)},"The bird will return with the first number to the power of the second number.");b.add_function_object("logarithm",function(a,c){return b.n_ary_function(a,b.numeric_javascript_function_to_widget_function(function(){return 1===arguments.length?Math.log(arguments[0]):
Math.log(arguments[0])/Math.log(arguments[1])},h),1,"logarithm",c)},"The bird will return an approximation of the logarithm number of the first number.\nIf a second number is provided then it is used as the base of the logarithm.\nIf there is no second number the logarithm is natural (the base is e).","log");b.add_function_object("random",function(a,c){return b.n_ary_function(a,b.numeric_javascript_function_to_widget_function(function(){return 0===arguments.length?Math.random():1===arguments.length?
Math.random()*arguments[0]:arguments[0]<arguments[1]?Math.random()*(arguments[1]-arguments[0])+arguments[0]:Math.random()*(arguments[0]-arguments[1])+arguments[1]}),0,"random",c)},"The bird will return a random number between the first and second numbers.\nIf the second number isn't provided a number less than the first number is returned.\nIf no numbers are given then the bird returns with a number between 0 and 1.","rand");b.add_function_object("round",function(a,c){return b.n_ary_function(a,b.bigrat_function_to_widget_function(A),
1,"round",c)},"The bird will return the number rounded to the nearest integer.");b.add_function_object("floor",function(a,c){return b.n_ary_function(a,b.bigrat_function_to_widget_function(y),1,"floor",c)},"The bird will return the largest integer less than or equal to the number.");b.add_function_object("ceiling",function(a,c){return b.n_ary_function(a,b.bigrat_function_to_widget_function(z),1,"ceiling",c)},"The bird will return the smallest integer greater than or equal to the number.","ceil");b.add_function_object("delay",
function(c,e){var g=Date.now(),h=b.check_message(c);if("string"!==typeof h)if(2>h.box_size)b.report_error("Delay function birds need a number in the second hole saying how long to wait.",h);else{var k=c.get_hole_contents(1).to_float();setTimeout(function(){var k=a.number.ZERO(a.number.function_bird_results_default_format);k.set_value_from_decimal((Date.now()-g)/1E3);k.set_approximate(!0);b.process_response(k,h,c,e)},1E3*k);return!0}},"The bird will return after waiting the number of seconds in the second hole. She will return with the exact amount of time since she received the box.");
b.add_function_object("integer and fraction parts",function(a,c){return b.n_ary_function(a,p,1,"integer and fraction parts",c)},"The bird will return with a box containing the integer part and the fraction.","parts");b.add_function_object("sine",function(a,e){return b.n_ary_function(a,b.numeric_javascript_function_to_widget_function(function(a){return Math.sin(a/k)},!0,c),1,"sine",e)},"The bird will return with an approximation of the sine of the number (in degrees).","sin");b.add_function_object("cosine",
function(a,e){return b.n_ary_function(a,b.numeric_javascript_function_to_widget_function(function(a){return Math.cos(a/k)},!0,c),1,"cosine",e)},"The bird will return with an approximation of the cosine of the number (in degrees).","cos");b.add_function_object("arc tangent",function(a,c){return b.n_ary_function(a,b.numeric_javascript_function_to_widget_function(function(a){return k*Math.atan(a)},!0),1,"arc tangent",c)},"The bird will return with an approximation of the arc tangent (in degrees) of the number.",
"atan");b.add_function_object("arc tangent of y and x",function(a,c){return b.n_ary_function(a,b.numeric_javascript_function_to_widget_function(function(a,b){return k*Math.atan2(a,b)},!0),2,"arc tangent of y and x",c)},"The bird will return with an approximation of the arc tangent (in degrees) of the point where the first number is the y coordinate and the second one is the x.","atan2");b.add_function_object("sine (in radians)",function(a,c){return b.n_ary_function(a,b.numeric_javascript_function_to_widget_function(Math.sin,
!0,e),1,"sine (in radians)",c)},"The bird will return with an approximation of the sine of the number (in radians).","sin rad");b.add_function_object("cosine (in radians)",function(a,c){return b.n_ary_function(a,b.numeric_javascript_function_to_widget_function(Math.cos,!0,e),1,"cosine (in radians)",c)},"The bird will return with an approximation of the cosine of the number (in radians).","cos rad");b.add_function_object("arc tangent (in radians)",function(a,c){return b.n_ary_function(a,b.numeric_javascript_function_to_widget_function(Math.atan,
!0),1,"arc tangent (in radians)",c)},"The bird will return with an approximation of the arc tangent (in radians) of the number.","atan rad");b.add_function_object("arc tangent of y and x (in radians)",function(a,c){return b.n_ary_function(a,b.numeric_javascript_function_to_widget_function(Math.atan2,!0),2,"arc tangent of y and x (in radians)",c)},"The bird will return with an approximation of the arc tangent (in radians) of the point where the first number is the y coordinate and the second one is the x.",
"atan2 rad");b.add_function_object("turn into words",a.widget.get_description_function(b),"The bird will return with words describing what is in the second hole.","describe",["a widget"]);b.add_function_object("speak",a.widget.get_speak_function(b),"The bird will cause the browser to speak what is in the second box hole. Other holes can have numbers describing the <a href='https://developer.mozilla.org/en-US/docs/Web/API/SpeechSynthesisUtterance'>volume, pitch, rate, voice_number</a>. Might do nothing in <a href='http://caniuse.com/#search=speech%20syn'>some browsers</a>.",
"speak",["a widget"]);b.add_function_object("listen for a number",a.widget.get_listen_function(b,!0),"The bird will cause the browser to listen to the next number said and give the number to the bird in the first hole. If you put a number between 0 and 1 in the second hole then only recognitions with at least that confidence will be considered. ","listen",[]);return b.get_function_table()}()})(window.TOONTALK);(function(a){var k=function(c,e,b,h){if(c&&0<=b&&c.maintain_proportional_dimensions()&&c.get_default_width){var k=c.get_default_width();c=c.get_default_height();b/k>=h/c?(k=k*h/c,b={left:(b-k)/2,top:0,width:k,height:h}):(k=c*b/k,b={left:0,top:(h-k)/2,width:b,height:k})}else c.is_backside()&&(c.update_display(),c.scale_to(b,.92*h)),b={left:0,top:0};a.UTILITIES.set_css(e,b)};window.TOONTALK.box=function(a){var c=Object.create(a.widget);c.create=function(b,e,m,g,v){var h=Object.create(c),p=[];"undefined"===
typeof e&&(e=!0);h.is_box=function(){return!0};h.get_horizontal=function(){return e};h.set_horizontal=function(a,b,c){e=a;b&&($(this.get_frontside_element()).children(".toontalk-side").remove(),this.rerender());c&&this.robot_in_training()&&this.robot_in_training().edited(this,{setter_name:"set_horizontal",argument_1:a,toString:"by changing the orientation to "+(a?"horizontal":"vertical"),button_selector:a?".toontalk-horiztonal-radio-button":"toontalk-vertical-radio-button"});return this};h.get_hole=
function(a){return p[a]};h.get_hole_contents=function(a){return p[a]&&p[a].get_contents()};h.set_hole=function(b,c,e){p[b].set_contents(c);if(e){c&&c.save_dimensions();e=this.get_frontside_element();b=$(e).children(".toontalk-hole-number-"+b);b.empty();if(!c)return;var g=this.get_hole_dimensions();e=c.get_element(!0);0<b.length&&b.get(0).appendChild(e);k(c,e,g.width,g.height);$(e).find("iframe").attr("width",g.width).attr("height",g.height-20);c.rerender()}this.rerender();a.debugging&&(this._debug_string=
this.to_debug_string())};h.get_holes=function(){return p};h.temporarily_remove_contents=function(a,b){var c=this.get_index_of(a);this.temporarily_removed_contents||(this.temporarily_removed_contents=[]);this.temporarily_removed_contents[c]=a;this.set_hole(c,void 0,b);return function(){this.set_hole(c,a,b);this.temporarily_removed_contents[c]=void 0}.bind(this)};h.get_contents_temporarily_removed=function(a){if(this.temporarily_removed_contents)return this.temporarily_removed_contents[a]};h.set_contents=
function(b){a.UTILITIES.for_each_batch(b,function(a,b){p[b].set_contents(a)})};h.get_size=function(){return b};h.set_size=function(c,e,g){var k;if(b===c||0>c||isNaN(c)||c>Number.MAX_SAFE_INTEGER)return!1;var n=this.visible();p.length=c;if(c>b)for(k=b;k<c;k++)p[k]=a.box_hole.create(k),p[k].set_parent_of_frontside(h),p[k].set_visible(n);b=c;e&&(this.constrained_by_container()?(e=this.get_parent_of_frontside(),e.is_hole()&&(e=e.get_parent_of_frontside()),e.rerender()):this.rerender());(e=this.get_listeners("contents_or_properties_changed"))&&
e.forEach(function(a){a({type:"contents_or_properties_changed",new_size:c})});g&&this.robot_in_training()&&this.robot_in_training().edited(this,{setter_name:"set_size",argument_1:c,oString:"by changing the number of holes to "+c+" of the box",button_selector:".toontalk-box-size-input"});a.debugging&&(this._debug_string=this.to_debug_string());return!0};h.get_hole_dimensions=function(){var c=this.get_frontside_element(),g=$(c).width()||a.box.get_default_width();c=$(c).height()||a.box.get_default_height();
return e?{width:g/b,height:c}:{width:g,height:c/b}};h.receive_size_from_dropped=function(b,c){if(b.is_number())return c=a.number.create(this.get_size()),c.number_dropped_on_me_semantics(b),b=Math.max(0,Math.round(c.to_float())),this.set_size(b),b.toString()};h.copy=function(a){a||(a={});var g=p.map(function(b){if(b=b.get_contents())return b.copy(a)});g=c.create(b,e,g,this.get_description(),this.get_name());return this.add_to_copy(g,a)};h.generate_name=function(){for(var a="",b=this.get_size();0<b;)a+=
";",b--;return a};h.add_standard_widget_functionality(h);h.has_name(h);h.set_name(v);for(v=0;v<b;v++)p[v]=a.box_hole.create(v),p[v].set_parent_of_frontside(h);h.set_description(g);if(a.listen){var q,A,y;h.add_speech_listeners({commands:"left to right | horizontal | top to bottom | vertical",numbers_acceptable:!0,descriptions_acceptable:!0,success_callback:function(b){var c=a.UTILITIES.get_dragee_copy()||h;switch(b){case "left to right":case "horizontal":c.set_horizontal(!0,!0,!0);break;case "top to bottom":case "vertical":c.set_horizontal(!1,
!0,!0);break;default:q=parseInt(b),isNaN(q)?console.log("did not understand '"+b+"'"):c.set_size(q,!0,!0)}c.update_display(!0);b=c.get_size();A="You are now holding a "+(c.get_horizontal()?"horizontal":"vertical")+" box with "+(1<b?b+" holes":0===b?"no holes":"one hole")+".";A!==y&&(h.display_message(A,{display_on_backside_if_possible:!0,duration:4E3}),y=A)}})}m&&h.set_contents(m);a.debugging&&(h._debug_id=a.UTILITIES.generate_unique_id(),h._debug_string=h.to_debug_string());return h};c.create_backside=
function(){return a.box_backside.create(this)};c.equals=function(a){return a.equals_box&&this.get_type_name()===a.get_type_name()&&a.equals_box(this)};c.equals_box=function(a){var b=this.get_size(),c;if(b!==a.get_size())return!1;for(c=0;c<b;c++){var e=this.get_hole_contents(c);var k=a.get_hole_contents(c);if(!e&&k||e&&!k||e&&k&&(!e.equals||!e.equals(k)))return!1}return!0};c.compare_with=function(a){if(a.compare_with_box)return-1*a.compare_with_box(this)};c.compare_with_box=function(a){var b=this.get_size(),
c=a.get_size();if(b>c)return 1;if(b<c)return-1;for(c=0;c<b;c++){var e=this.get_hole_contents(c);var k=a.get_hole_contents(c);if(e&&!k)return 1;if(!e&&k)return-1;if(e&&k)if(e.compare_with){if(e=e.compare_with(k),1===e||-1===e)return e}else return}return 0};c.match=function(a){if(this.get_erased&&this.get_erased()){if(a.get_widget().match_with_any_box)return a.get_widget().match_with_any_box();this.last_match=a;return this}return a.match_with_this_box?a.match_with_this_box(this):(this.last_match=a,
this)};c.match_with_any_box=function(){return"matched"};c.match_with_this_box=function(b){var c=this.get_size(),e=[],g,k,x;if(c!==b.get_size())return b.last_match=this,b;for(g=0;g<c;g++)if(x=b.get_hole_contents(g))if(k=this.get_hole_contents(g)){k=a.UTILITIES.match(x,k);if(k.is_widget)return k;"matched"!==k&&(e=0===e.length?k:e.concat(k))}else if(k=this.get_contents_temporarily_removed(g))e.push(k);else return b.last_match=this,b;return 0<e.length?e:"matched"};c.toString=function(a){var b="",c=this.get_size(),
e,k=this.get_type_name()+" that looks like ";for(e=0;e<c;e++){var x=this.get_hole(e);b+=x.get_full_description(a);e<c-1&&(b+=" | ")}return k+"["+b.replace(k,"")+"]"};c.get_type_name=function(a){return a?"boxes":"box"};c.get_default_description=function(){return"a box for holding things."};c.get_help_URL=function(){return"docs/manual/boxes.html"};c.get_json=function(b,c,e,g){var h=[],k=function(e,g,m){var p;if(e>=this.get_size())c({type:"box",size:this.get_size(),contents:h,horizontal:this.get_horizontal(),
name:this.get_name()},g,m+1);else if(p=this.get_hole_contents(e))if(p.is_primary_backside&&p.is_primary_backside()){var q=function(a,b,c){h.push({widget:a,is_backside:!0});k(e+1,b,c+1)}.bind(this);a.UTILITIES.get_json(p.get_widget(),b,q,g,m+1)}else p.is_widget?(q=function(a,b,c){h.push({widget:a});k(e+1,b,c+1)}.bind(this),a.UTILITIES.get_json(p,b,q,g,m+1)):(q=function(a,b,c){h.push(a);k(e+1,b,c+1)}.bind(this),p.get_json(b,q,g,m+1));else h.push(null),k(e+1,g,m+1)}.bind(this);k(0,e,g+1)};c.walk_children=
function(a){var b=this.get_size(),c,e;for(c=0;c<b;c++)if(e=this.get_hole_contents(c)){if(!a(e))break}else if(!a(this.get_hole(c)))break};a.creators_from_json.box=function(b,e){if(b)return c.create(b.size,b.horizontal,a.UTILITIES.create_array_from_json(b.contents,e),b.description,b.name)};c.update_display=function(){var b=this.get_frontside(!0).get_element(),c=this.get_size(),e=a.UTILITIES.get_style_numeric_property(b,"z-index"),g=function(h,p,m){var q=p.get_contents(),y=(q||p).get_element(!0),z=$(h).parents(".toontalk-box-hole"),
x=function(){$(h).parents(".toontalk-box-hole").children(".toontalk-nest").is("*")&&(E/=a.nest.CONTENTS_WIDTH_FACTOR,J/=a.nest.CONTENTS_HEIGHT_FACTOR)};if(h.parentElement){if(v){var w=0;if(0<z.length||$(b).is(".toontalk-conditions-contents")){var E=n-2*D/c;var J=I-2*D}else E=n,J=I;x();var O=E*m;1<m&&(O+=D*(m-1))}else O=0,0<z.length||$(b).is(".toontalk-conditions-contents")?(E=n-2*D,J=I-2*D/c):(E=n,J=I),x(),w=J*m,1<m&&(w+=D*(m-1));setTimeout(function(){a.UTILITIES.set_css(h,{left:O,top:w,width:E,height:J,
"z-index":"number"===typeof e&&e+c-m});q&&q.render()});A[m]&&h.setAttribute("toontalk_name",A[m]);!a.UTILITIES.has_animating_image(y)&&0<m&&($(h).removeClass("toontalk-box-eighth-size-border-left toontalk-box-quarter-size-border-left toontalk-box-half-size-border-left toontalk-box-full-size-border-left"),$(h).removeClass("toontalk-box-eighth-size-border-top toontalk-box-quarter-size-border-top toontalk-box-half-size-border-top toontalk-box-full-size-border-top"),v?$(h).addClass(K+"-left"):$(h).addClass(K+
"-top"));if(h!==y&&q&&q.get_parent()===p){k(q,y,E,J);$(p.element).find("iframe").attr("width",E).attr("height",J-20);try{h.appendChild(y)}catch(d){a.UTILITIES.report_internal_error(d+". Avoided a circularity involving a box hole.")}p.get_contents().rerender()}p.is_element()&&(z={width:E,height:J},y=p.get_contents(),y.is_plain_text_element()?$(y.get_frontside_element()).css({"font-size":a.UTILITIES.font_size(y.get_text(),E,{height:J}),width:"",height:""}):$(y.get_frontside_element()).css(z),y=y.dereference(),
y.set_size_attributes(E,J,!0),$(h).css(z))}else setTimeout(function(){g(h,p,m)})},v=this.get_horizontal();$(b).is(".toontalk-box");var x=this.constrained_by_container(),p=function(){var e=$(b).children(".toontalk-box-hole");$(b).is(".toontalk-conditions-contents")?a.UTILITIES.set_css(b,{width:z-2*D,height:w-2*D}):this.directly_inside_conditions_container()||$(b).parent().is(".toontalk-scale-half")||(10>z||10>w||!$(b).parent(".toontalk-box-hole").is("*")?a.UTILITIES.set_css(b,{width:z,height:w}):a.UTILITIES.set_css(b,
{width:"",height:""}));10>z||10>w||(e.length===c?e.each(function(a,b){var c=this.get_hole(a);c&&g(b,c,a)}.bind(this)):(e.remove(),this.get_holes().forEach(function(a,c){y=a.get_element();$(y).addClass("toontalk-hole-number-"+c);a.get_contents()&&a.get_contents().rerender();g(y,a,c);b.appendChild(y)})));x||$(b).children(".ui-resizable-handle").css({right:-D,bottom:-D})}.bind(this),q=function(){var e=function(a){if(a.parentElement)return $(a.parentElement).is(".toontalk-box-hole")?a.parentElement:e(a.parentElement)},
g=e(b)||b;g=$(b).parent().is(".toontalk-scale-half")?b:g;x?(z=$(g).width(),w=$(g).height()):z=this.directly_inside_conditions_container()&&a.UTILITIES.get_toontalk_css_numeric_attribute("width",".toontalk-conditions-container")||!$(g).is(".toontalk-carried-by-bird")&&a.UTILITIES.get_style_numeric_property(g,"width")||this.saved_width||a.box.get_default_width();void 0===w&&(w=this.directly_inside_conditions_container()&&a.UTILITIES.get_toontalk_css_numeric_attribute("height",".toontalk-conditions-container")||
!$(g).is(".toontalk-carried-by-bird")&&a.UTILITIES.get_style_numeric_property(g,"height")||this.saved_height||a.box.get_default_height());v?(n=0===c?0:z/c,I=w):(n=z,I=w/c)}.bind(this),A=this.get_name().split(";"),y,z,n,w,I;a.logging&&0<=a.logging.indexOf("display")&&console.log("Updating display of "+this.to_debug_string());$(b).addClass("toontalk-box");$(b).removeClass("toontalk-box-eighth-size-border toontalk-box-quarter-size-border toontalk-box-half-size-border toontalk-box-full-size-border");
a.UTILITIES.give_tooltip(b,this.get_title());a.debugging&&(this._debug_string=this.to_debug_string());if(this.get_erased())$(b).addClass("toontalk-box-erased"),$(b).children(".toontalk-side").remove();else if($(b).removeClass("toontalk-box-erased"),q(),10>z||10>w)p();else{var D=this.get_border_size(n,I);var K=4===D?"toontalk-box-eighth-size-border":8===D?"toontalk-box-quarter-size-border":16===D?"toontalk-box-half-size-border":"toontalk-box-full-size-border";0===c?K+=" toontalk-zero-hole-box":v?n-=
(c-1)*D/c:I-=(c-1)*D/c;$(b).addClass(K);a.UTILITIES.set_timeout(p)}};c.get_default_width=function(){return 164};c.get_default_height=function(){return 68};c.get_border_size=function(a,c){if(0===a)return a=$(this.get_frontside_element()).width(),16>=a?8:32>=a?16:32;if(!a&&!c){var b=this.get_size();a=$(this.get_frontside_element()).width();c=$(this.get_frontside_element()).height();this.get_horizontal()?a=0===b?0:a/b:c=0===b?0:c/this.get_size()}return 32>=a||32>=c?4:64>=a||64>=c?8:128>=a||128>=c?16:
32};c.is_resizable=function(){return!0};c.get_name_input_label=function(){return"The labels of my holes are"};c.get_name_input_title=function(){return"Each hole label is followed by a ';'. Yoou may enter as many hole labels as there are holes."};c.drop_on=function(a,c){if(a.box_dropped_on_me){var b=a.box_dropped_on_me&&a.box_dropped_on_me(this,c);c.event&&a.rerender();b&&this.remove();return b}if(a.widget_side_dropped_on_me)return a.widget_side_dropped_on_me(this,c);console.log("No handler for drop of "+
this+" on "+a)};c.box_dropped_on_me=function(a,c){console.log("box on box not yet implemented");return!1};c.widget_side_dropped_on_me=function(b,c){var e=this.which_hole(c.event),g=this.get_size();if(void 0===e&&c.robot)if(0<g)1<g&&a.UTILITIES.display_message("Robot "+c.robot.get_name()+" wasn't trained to know which hole of "+this+" to drop "+b+" on. Random hole chosen."),e=Math.floor(Math.random()*g);else{a.UTILITIES.display_message("Robot "+c.robot.get_name()+" can't drop "+b+" on "+this+" because it has no holes.");
return}if(0<=e)return g=this.get_hole(e),(e=g.get_contents())?b.drop_on(e,c):g.widget_side_dropped_on_me(b,c);0===g?a.UTILITIES.display_message("Can't drop "+b+" on "+this+" because it has no holes."):a.UTILITIES.report_internal_error(b+" dropped on "+this+" but no event was provided.")};c.get_index_of=function(a){return a.get_parent_of_frontside()&&a.get_parent_of_frontside().get_index&&a.get_parent_of_frontside().get_index()};c.name_font_size=function(a,c){if(0===this.get_size())return 0;this.get_horizontal()?
(c=(c||this.get_height())/6,a=(a||this.get_width())/(8*this.get_size())):(c=(c||this.get_height())/(6*this.get_size()),a=(a||this.get_width())/8);return Math.min(a,c)};c.removed_from_container=function(a,c){c=!!c;var b=this.get_index_of(a);0<=b&&(this.set_hole(b,void 0,c),c&&(this.rerender(),a.restore_dimensions()))};c.get_path_to=function(b,c){var e=this.get_size(),g;if("empty hole"===b.get_type_name()){c=b.get_parent_of_frontside();var h=a.box.path.create(b.get_index());if(c===this)return h;b=this.get_path_to(c);
if(!b)return;b.next=h;return b}for(g=0;g<e;g++)if(h=this.get_hole_contents(g)||this.get_contents_temporarily_removed(g)){if(b===h||h.top_contents_is&&h.top_contents_is(b))return a.box.path.create(g);if(h.get_path_to&&(h=h.get_path_to(b,c)))return b=a.box.path.create(g),b.next=h,b}};c.element_to_highlight=function(a){a=this.which_hole(a,!0);var b;if(0>a||0===this.get_size())return this.get_frontside_element();a=this.get_hole(a);return(b=a.get_contents())?b.get_frontside_element():a.get_frontside_element()};
c.which_hole=function(a){var b=this.get_horizontal(),c=this.get_frontside_element(),e=this.get_size();if(0!==e){var k=$(c).offset();c=b?$(c).width()/e:$(c).height()/e;var x=b?k.left:k.top;if(a)for(k=0;k<e;k++)if(x+=c,(b?a.pageX<=x:a.pageY<=x)||k+1===e)return k}};c.dereference_path=function(b,c,e){if(b){!b.get_index&&b.next&&(b=b.next);var g=b.get_index&&b.get_index();if(e||"undefined"!==typeof g){if(!a.debugging||"number"===typeof g){if(e=this.get_hole_contents(g)){if(e.dereference_contents&&!b.not_to_be_dereferenced)return e.dereference_contents(b.next||
b,c);if(b.next){if(e.dereference_path)return e.dereference_path(b.next,c);a.UTILITIES.report_internal_error("Expected to refer to a part of "+e+" but it lacks a method to obtain "+a.path.toString(b.next))}if(b.removing_widget){if("empty hole"===e.get_type_name()){a.UTILITIES.display_message("Robot is trying to remove something from an empty hole. ",{only_if_new:!0});return}e.get_infinite_stack()||c.remove_from_container(e,this)}return e}if(b.removing_widget){a.UTILITIES.display_message("Robot is trying to remove something from an empty hole. ",
{only_if_new:!0});return}return this.get_hole(g)}a.UTILITIES.display_message(this+" unable to dereference the path: "+a.path.toString(b),{only_if_new:!0})}}else return this};c.path={create:function(b){return{get_index:function(){return b},toString:function(){return"scale"===this.true_type?0===b?"the left pan ":"the right pan ":"the "+a.UTILITIES.ordinal(b)+" hole "},get_json:function(a,c,e,k){var g=function(a,e,g){c({type:"box_path",index:b,true_type:this.true_type,next:a},e,g+1)}.bind(this);this.next?
this.next.get_json(a,g,e,k+1):g(void 0,e,k+1)}}}};c.get_custom_title_prefix=function(){return"Drop things in my holes to store them."};a.creators_from_json.box_path=function(b,e){var h=c.path.create(b.index);b.next&&(h.next=a.UTILITIES.create_from_json(b.next,e));b.true_type&&(h.true_type=b.true_type);return h};return c}(window.TOONTALK);window.TOONTALK.box_backside=function(a){return{create:function(c){var b=a.backside.create(c),e=a.UTILITIES.create_text_input(c.get_size().toString(),"toontalk-box-size-input",
"Number of holes","Type here to edit the number of holes.",void 0,"number",function(b){if(b=a.UTILITIES.input_area_drop_handler(b,c.receive_size_from_dropped.bind(c),c))c.rerender(),c.robot_in_training()&&c.robot_in_training().dropped_on_text_area(b,c,{area_selector:".toontalk-box-size-input",setter:"receive_size_from_dropped",toString:"for the box's size"})}),k=a.UTILITIES.create_radio_button("box_orientation","horizontal","toontalk-horiztonal-radio-button","Left to right","Show box horizontally.",
!0),g=a.UTILITIES.create_radio_button("box_orientation","vertical","toontalk-vertical-radio-button","Top to bottom","Show box vertically.",!0),v=function(){var a=parseInt(e.button.value.trim(),10);c.set_size(a,!0,!0)},x=function(){var b=a.UTILITIES.selected_radio_button(k,g);b&&c.set_horizontal("horizontal"===b.button.value,!0,!0)},p=b.get_element(),q=a.backside.create_advanced_settings_button(b,c),A=b.update_display.bind(b),y=a.UTILITIES.create_div(k,g);e.button.addEventListener("change",v);e.button.addEventListener("mouseout",
v);k.button.addEventListener("change",x);g.button.addEventListener("change",x);b.update_display=function(){e.button.value=c.get_size().toString();c.get_horizontal()?a.UTILITIES.check_radio_button(k):a.UTILITIES.check_radio_button(g);A()};a.UTILITIES.when_attached(p,function(){b.is_primary_backside()||c.add_listener("contents_or_properties_changed",function(){b.rerender()})});p.appendChild(e.container);p.appendChild(y);$(y).controlgroup().removeClass("ui-controlgroup");p.appendChild(q);b.rerender();
return b}}}(window.TOONTALK);window.TOONTALK.box_hole=function(a){return{create:function(c){var b=Object.create(this),e,m;b.is_hole=function(){return!0};b.is_empty_hole=function(){return!e};b.constrained_by_container=function(){return!1};b.get_element=function(){m||(m=document.createElement("div"),m.className="toontalk-box-hole toontalk-frontside toontalk-side",m.toontalk_widget_side=b);return m};b.get_frontside=function(a){return e?e.get_frontside(a):this.get_element()};b.get_backside_widgets=function(){return e?
e.get_backside_widgets():[]};b.get_frontside_element=function(a){return this.get_element()};b.get_frontside=function(){return this};b.get_width=function(){return $(this.get_element()).width()};b.get_height=function(){return $(this.get_element()).height()};b.widget_side_dropped_on_me=function(b,c){var e=this.get_parent_of_frontside(),g=this.get_contents(),h;if(g)return g.widget_side_dropped_on_me&&g.widget_side_dropped_on_me(b,c);b.dropped_on_other&&b.dropped_on_other(this,c);if(c.event){a.sounds&&
a.sounds.fall_inside.play();g=this.get_element();var k=b.is_plain_text_element();var m=b.get_element();$(m).css({"z-index":a.UTILITIES.next_z_index()});var z=$(m.parentElement).offset();k||(m.style.left=c.event.pageX-z.left+"px",m.style.top=c.event.pageY-z.top+"px",$(m).addClass("toontalk-animating-element"));if(h=a.UTILITIES.is_attached(g)){var n=$(g).offset();m.style.width=g.style.width;m.style.height=g.style.height;m.style.left=n.left-z.left+"px";m.style.top=n.top-z.top+"px"}else m.style.width=
0,m.style.height=0;n=function(){$(m).removeClass("toontalk-animating-element");this.set_contents(b);h?(e.render(),b.render()):m.remove();c.event&&e.backup_all()}.bind(this);setTimeout(n,k||a.UTILITIES.has_animating_image(m)?0:1200);e.robot_in_training()&&e.robot_in_training().dropped_on(b,this);b.save_dimensions&&b.set_size_attributes&&b.set_size_attributes($(g).width(),$(g).height());b.is_backside()||e.get_frontside_element().dispatchEvent(a.UTILITIES.create_event("widget added",{element_widget:m,
where:"front",index:this.get_index()}))}else e.rerender(),this.set_contents(b,c);return!0};b.get_json=function(){return null};b.add_to_json=function(a){return a};b.copy=function(b){return a.box_hole.create(c)};b.match=function(){return"matched"};b.get_type_name=function(a){return e?e.get_type_name(a):a?"empty holes":"empty hole"};b.name_font_size=function(){return this.get_box().name_font_size()};b.is_of_type=function(a){return e?e.is_of_type(a):"empty hole"===a};b.get_box=function(){return this.get_parent_of_frontside()};
b.update_display=function(){if(e){var a=this.get_frontside_element();k(e,e.get_element(!0),$(a).width(),$(a).height())}};b.dereference=function(){return e?e.dereference():this};b.can_run=function(a){return e&&e.can_run(a)};b.get_index=function(){return c};b.get_contents=function(){return e};b.set_contents=function(b,c){var g=this.get_listeners("contents_or_properties_changed");g&&(e!==b&&g.forEach(function(a){a({type:"contents_or_properties_changed",old_value:e,new_value:b})}),e&&g.forEach(function(a){e.remove_listener("contents_or_properties_changed",
a,!0)}),b&&g.forEach(function(a){b.add_listener("contents_or_properties_changed",a)}));e&&e.set_parent(void 0);(e=b)?(e.set_parent(this),a.debugging&&(this._debug_string="A hole containing "+e.to_debug_string()),c&&c.robot&&!c.robot.visible()||e.set_visible(this.visible())):a.debugging&&(this._debug_string=this.to_debug_string())};b.get_contents_dimensions=function(){return{width:$(this.get_frontside_element()).width(),height:$(this.get_frontside_element()).height()}};b.visible=function(){return this.get_parent_of_frontside().visible()};
b.set_visible=function(a,b){e&&e.set_visible(a,b?b+1:1)};b.remove=function(){e&&e.remove()};b.render=function(){e&&a.DISPLAY_UPDATES.pending_update(this)};b.rerender=function(){if(e&&this.visible())return this.render()};b.set_running=function(a){e&&e.set_running(a)};b.set_parent=function(a){e&&e.set_parent(a)};b.maintain_proportional_dimensions=function(){if(e)return e.maintain_proportional_dimensions()};b.removed_from_container=function(b,c,h,k){e?(c&&e.restore_dimensions(),this.set_contents(void 0),
c&&this.get_parent_of_frontside().render()):k&&a.UTILITIES.report_internal_error("Holes can't be removed from containers.")};b.temporarily_remove_contents=function(a,b){if(e)return this.get_parent_of_frontside().temporarily_remove_contents(a,b)};b.toString=function(){return e?e.toString():"_"};b.get_description=function(){return e?e.get_description():"_"};b.get_full_description=function(a){return e?e.get_full_description(a):"_"};b.is_backside=function(){return!1};b.get_widget=function(){return this.get_parent_of_frontside()};
b.is_number=function(){return e?e.is_number():!1};b.is_box=function(){return e?e.is_box():!1};b.is_scale=function(){return e?e.is_scale():!1};b.is_bird=function(){return e?e.is_bird():!1};b.is_nest=function(){return e?e.is_nest():!1};b.is_robot=function(){return e?e.is_robot():!1};b.is_element=function(){return e?e.dereference().is_element():!1};b.get_original_width=function(){if(e&&e.get_original_width)return e.get_original_width()};b.get_original_height=function(){if(e&&e.get_original_height)return e.get_original_height()};
b.is_sensor=function(){return e?e.is_sensor():!1};b.is_top_level=function(){return!1};b.is_plain_text_element=function(){return!1};b.get_active=function(){return e?e.get_active():!1};b.set_active=function(a,b){e&&e.set_active(a,b)};a.widget.has_parent(b);a.widget.has_listeners(b);if(a.debugging||a.logging)b.to_debug_string=function(b){var g=("the "+a.UTILITIES.ordinal(c)+" hole of the "+(this.get_parent_of_frontside()?this.get_parent_of_frontside().to_debug_string():"not-yet-defined box")).substring(0,
b);return e?g+" which contains "+e.to_debug_string(b):g+" which is empty"},b._debug_string=b.to_debug_string();return b}}}(window.TOONTALK);window.TOONTALK.box.function=function(){var c=a.create_function_table();c.add_function_object("box hole",function(e,b){return c.typed_bird_function(e,function(b,e,g){var h=Math.round(b.to_float());if(1>h)c.report_error("The 'box hole' function bird cannot find the "+a.UTILITIES.ordinal(h-1)+" hole. She only accepts positive numbers.",g);else if(h>e.get_size())c.report_error("The 'box hole' function bird cannot cannot find the "+
a.UTILITIES.ordinal(b-1)+" hole. The box only has "+e.get_size()+" holes.",g);else{if(e=e.get_hole_contents(h-1))return g.message_return_bird?e.copy():e;c.report_error("The 'box hole' function bird cannot cannot find anything in the "+a.UTILITIES.ordinal(b-1)+" hole. It is empty.",g)}},["number","box"],"box hole",b,2,2)},"The bird will return with what is in a hole of the box. The number determines which hole's contents are returned. Use 1 for the first hole.","hole",["number","box"]);c.add_function_object("count holes",
function(e,b){return c.typed_bird_function(e,function(b){return a.number.create(b.get_size())},["box"],"count holes",b,1,1)},"The bird will return with the number of holes the box has.","count holes",["box"]);c.add_function_object("fill hole",function(e,b){return c.typed_bird_function(e,function(b,e,g,k){var h=Math.round(b.to_float());if(1>h)c.report_error("The fill hole function bird cannot fill the "+a.UTILITIES.ordinal(b)+" hole. She only accepts positive numbers.",k);else return k.message_return_bird&&
(e=e.copy(),g=g.copy()),h>e.get_size()&&e.set_size(h),e.set_hole(h-1,g),e},["number","box",void 0],"fill hole",b,3,3)},"The bird will return with the box where one of its holes has been filled by whatever is in the fourth hole. The number determines which hole's contents are changed. 1 for the first hole.","fill hole",["number","box",void 0]);c.add_function_object("split box",function(e,b){return c.typed_bird_function(e,function(b,e,g){var h=Math.round(b.to_float()),k=e.get_size();if(0>h)c.report_error("The box split function bird cannot split the box after "+
b+" holes. She only accepts zero or positive numbers.",g);else if(h>k)c.report_error("The box split function bird cannot split the box after "+b+" holes. The box only has "+k+" holes.",g);else{e.get_holes();b=k-h;k=a.box.create(b);var p;for(p=0;p<b;p++)k.set_hole(p,e.get_hole_contents(p+h));g.message_return_bird&&(e=e.copy());e.set_size(h);return a.box.create(2,!1,[e,k])}},["number","box"],"split box",b,2,2)},"The bird will return with a box with the original box split in two. The number determines where the split is. 1 for after the first hole.",
"split",["number","box"]);c.add_function_object("merge boxes",function(e,b){return c.typed_bird_function(e,function(){var b=0,c,e;if(1===arguments.length)return a.box.create(0);var k=arguments[arguments.length-1];var x=arguments[0];k.message_return_bird&&(x=x.copy());for(c=0;c<arguments.length-1;c++)b+=arguments[c].get_size();var p=x.get_size();x.set_size(b);for(c=1;c<arguments.length-1;c++){var q=arguments[c].get_size();for(b=0;b<q;b++){if(e=arguments[c].get_hole_contents(b))k.message_return_bird&&
(e=e.copy()),x.set_hole(p,e);p++}}return x},["box"],"merge boxes",b)},"The bird will return with a box that joins together all the boxes.","merge",["any number of boxes"]);c.add_function_object("get window property",function(e,b){return c.typed_bird_function(e,function(b,e){var g=window,h=b.get_size(),k=function(){var g="window",k;for(k=0;k<h;k++){m=b.get_hole_contents(k);if(!m||!m.get_text){c.report_error("The 'get window property' bird could not get the text of the "+a.UTILITIES.ordinal(k)+" hole.",
e);return}g+="."+m.get_text().trim()}return g},p;for(p=0;p<h;p++){var m=b.get_hole_contents(p);if(!m||!m.get_text){c.report_error("The 'get window property' bird could not get the text of the "+a.UTILITIES.ordinal(p)+" hole.",e);return}try{g=g[m.get_text().trim()]}catch(A){c.report_error("Error trying to find the value of "+k()+". "+A,e);return}}if(void 0===g)c.report_error("Error no value for "+k()+exception,e);else return"number"===typeof g?a.number.create(g):a.element.create(g.toString())},["box"],
"window property",b,1,1)},"The bird will return with the value of the property accessed by each of the property names in the box.","win prop",["box"]);c.add_function_object("set window property",function(e,b){return c.typed_bird_function(e,function(b,e,g){var h=window,k=b.get_size(),p=function(e){var h="window",k;for(k=0;k<e;k++){y=b.get_hole_contents(k);if(!y||!y.get_text){c.report_error("The 'set window property' bird could not get the text of the "+a.UTILITIES.ordinal(k)+" hole.",g);return}h+=
"."+y.get_text().trim()}return h},m,A;for(m=0;m<k-1;m++){var y=b.get_hole_contents(m);if(!y||!y.get_text){c.report_error("The 'set window property' bird could not get the text of the "+a.UTILITIES.ordinal(m)+" hole.",g);return}try{h=h[y.get_text().trim()]}catch(n){c.report_error("Error trying to find the property of "+p(k-1)+". "+n,g);return}}h||(A="Property missing of "+p(k-1));if(!A)try{var z=e.to_float?e.to_float():e.get_text?e.get_text():e.toString();y=b.get_hole_contents(k-1);if(!y||!y.get_text){c.report_error("The 'set window property' bird could not get the text of the "+
a.UTILITIES.ordinal(m)+" hole.",g);return}h[y.get_text().trim()]=z}catch(n){A="Unable to set the value of "+p(k)+" to value of "+e}if(A)c.report_error(A,g);else return e},["box",void 0],"set window property",b,2,2)},"The bird will set the value of the property accessed by each of the property names in the box in the second hole to the value of the widget in the third hole.","set win prop",["box"]);return c.get_function_table()}()})(window.TOONTALK);(function(){var a,k,c,e;window.TOONTALK.bird=function(b){var c=Object.create(b.widget),k=function(a,c,e){var g=a.get_function_type();a=a.get_function_object();var h=Object.keys(TOONTALK[g]["function"]),k=h.map(function(a){return TOONTALK[g]["function"][a].title});h=b.UTILITIES.create_select_menu("functions",h,"toontalk-select-function","Which function should I fly to? ","Click to select the function that this bird will use when given a box.",k);c=c.get_element();var m;a&&$(h.menu).val(a.name).selectmenu("refresh");
$(h.menu).on("selectmenuselect",function(a){e.set_function_name(a.target.value);e.get_description()||(m=$(e.get_backside_element()).find(".toontalk-description-input"),0<m.length&&m.get(0).setAttribute("placeholder",e.get_default_description()))});$(h.menu).selectmenu("menuWidget").addClass("toontalk-select-menu");c.insertBefore(h.container,c.firstChild)};c.create=function(g,h,m){var p=[],q=[];m||(m=Object.create(c));m.set_nest=function(a,b){if(g===b||void 0===g)g=a};m.is_bird=function(){return!0};
m.widget_side_dropped_on_me=function(a,c){if(this.get_infinite_stack()){var e=this.add_copy_to_container();return e.widget_side_dropped_on_me(a,c)}if(g){if(g.has_ancestor(a))return a.display_message("Bird can't take its nest to its nest!"),!1;if(!(g.visible()||this.visible()||g.any_nest_copies_visible())||c.robot&&c.robot.visible()&&!c.robot.animate_consequences_of_actions()){var h=function(){try{g.add_to_contents(a,c)}catch(I){if(I.wait_for_nest_to_receive_something)I.wait_for_nest_to_receive_something.run_when_non_empty(h,
this);else throw console.error(I.stack),I;}};h();c.robot&&c.robot===a.robot_waiting_before_next_step&&(a.robot_waiting_before_next_step=void 0,c.robot.run_next_step())}else{c.by_function_bird||a.save_dimensions();var k=this.get_frontside_element();setTimeout(function(){$(k).removeClass("toontalk-bird-gimme").addClass("toontalk-bird-static "+this.get_class_name_with_color("toontalk-bird-static"));this.get_parent_of_frontside()&&this.get_parent_of_frontside().rerender()}.bind(this));a.set_visible(g.visible());
c.robot&&!c.do_not_run_next_step&&(a.robot_waiting_before_next_step=c.robot,c.robot.run_next_step&&(e=function(b){b&&b();a.robot_waiting_before_next_step=void 0;c.robot.run_next_step()}));c.after_delivery_continuation=b.UTILITIES.join_continuations(c.after_delivery_continuation,e);g.animate_bird_delivery(a,this,c)}}else c.robot&&!c.robot.visible()?a.remove():this.animate_delivery_to(a);c.event&&!c.by_function_bird&&this.robot_in_training()&&this.robot_in_training().dropped_on(a,this);return!0};m.animate_delivery_to=
function(a,c,e){e||(e={});if(a){var h=e.nest_recieving_message,k=e.after_delivery_continuation,m=this.get_parent_of_frontside(),y=this.get_frontside_element(!0),z=$(y).position();$(y).width();var v=this.closest_visible_ancestor_or_frontside(),x=$(v.get_frontside_element()).offset(),A=function(){b.sounds&&b.sounds.bird_fly.pause();h||a.remove();if(e.temporary_bird)this.remove();else{var d=function(){$(y).removeClass("toontalk-bird-morph-to-static");$(y).addClass("toontalk-bird-static "+this.get_class_name_with_color("toontalk-bird-static"));
m&&m.get_widget().rerender()}.bind(this);y.style.position=t;b.UTILITIES.set_css(y,z);f&&f.appendChild(y);m&&(m.get_widget().is_top_level()?this.rerender():m.get_widget().rerender());if(T&&(C.remove_backside_widget(this,!0),T(),p)){var c=p;p=[];q=[];c.forEach(function(a){a()})}b.UTILITIES.add_animation_class(y,"toontalk-bird-morph-to-static");b.UTILITIES.add_one_shot_event_handler(y,"animationend",1E3,d)}k&&k();e.event&&this.backup_all()}.bind(this),V=function(){var d=function(a){b.UTILITIES.set_timeout(function(){this.fly_to(x,
function(){a&&a();A&&A()},e)}.bind(this))}.bind(this);if(h)try{e.delivery_bird=this,h.add_to_contents(a,{ignore_copies:!0,make_message_nests_delivery_targets:h.is_function_nest()}),d()}catch(oa){if(oa.wait_for_nest_to_receive_something){oa.wait_for_nest_to_receive_something.run_when_non_empty(V,this);var c=A;A=function(){c&&c();oa.wait_for_nest_to_receive_something.remove()};k&&(k(),k=void 0);return}b.sounds&&b.sounds.bird_fly.pause();console.error(oa.stack);throw oa;}else this.is_function_bird()||
k&&k();P($(y).offset())}.bind(this),N=function(a,d){d||(d=b.UTILITIES.widget_side_of_element(a));this.element_to_display_when_flying=a;d&&(this.update_display(),setTimeout(function(){d.update_display()}));$(a).addClass("toontalk-carried-by-bird");$(a).removeClass("toontalk-temporarily-set-down");b.UTILITIES.set_timeout(function(){var c={left:"",top:"",position:""};d&&!d.use_scaling_transform&&(c.width="",c.height="");1<a.toontalk_x_scale&&(c["font-size"]="inherit");b.UTILITIES.set_css(a,c);this.update_display()}.bind(this))}.bind(this),
P=function(d){if(this.element_to_display_when_flying){$(this.element_to_display_when_flying).removeClass("toontalk-carried-by-bird");if(d){var c={"z-index":b.UTILITIES.next_z_index()};0<this.element_to_display_when_flying.width_before_carry&&(c.width=this.element_to_display_when_flying.width_before_carry);0<this.element_to_display_when_flying.height_before_carry&&(c.height=this.element_to_display_when_flying.height_before_carry);1<this.element_to_display_when_flying.toontalk_x_scale&&(c["font-size"]=
"inherit");b.UTILITIES.set_css(this.element_to_display_when_flying,c);this.top_level_widget().get_backside_element().appendChild(this.element_to_display_when_flying);b.UTILITIES.set_absolute_position(this.element_to_display_when_flying,d);(d=a.get_parent_of_frontside())&&!d.is_backside()&&d.rerender()}else $(this.element_to_display_when_flying).remove();this.element_to_display_when_flying=void 0;this.update_display()}}.bind(this),G,Q,T,U;h||(h=g);if(h||this.visible()){e.delay=b.animation_settings.PAUSE_BETWEEN_BIRD_STEPS;
$(y).removeClass("toontalk-bird-gimme");if(a){var F=a.get_element(!0);N(F,a)}c&&!c.is_function_nest()&&(G=c.get_widget().closest_visible_ancestor_or_frontside().get_widget().get_frontside_element());if(!c||this.visible()||c.visible()&&(c.is_function_nest()||b.UTILITIES.visible_element(G))){b.sounds&&b.sounds.bird_fly.play();$(y).removeClass("toontalk-bird-static "+this.get_class_name_with_color("toontalk-bird-static"));if(c&&!c.is_function_nest()){var d=$(G).offset();h.get_frontside_element&&(Q=$(h.get_frontside_element()).closest(".toontalk-backside-of-top-level"))}Q&&
Q.is("*")||(Q=$(this.get_frontside_element()).closest(".toontalk-backside-of-top-level"));(c=Q.offset())||(c={left:0,top:0});e.starting_left?x={left:e.starting_left+c.left,top:e.starting_top+c.top}:0===x.left&&0===x.top&&(x={left:a?-F.clientWidth:-1E3,top:c.top+Q.height()/2});d||(d={left:F?-2*F.clientWidth:-1E3,top:c.top+Q.height()/2});var f=y.parentElement;v=$(y).width();var r=$(y).height();var t=y.style.position;y.style.position="absolute";var C=this.top_level_widget();m&&m.temporarily_remove_contents&&
(T=m.temporarily_remove_contents(this,!0))&&this.get_widget().add_to_top_level_backside(this);0<Q.length&&Q.get(0).appendChild(y);b.UTILITIES.set_css(y,{left:e.starting_left||x.left-c.left,top:e.starting_top||x.top-c.top,width:v,height:r});b.logging&&0<=b.logging.indexOf("bird")&&console.log(this.to_debug_string(50)+" from "+(e.starting_left||x.left-c.left)+", "+(e.starting_top||x.top-c.top)+" to "+d.left+", "+d.top);h&&(U=h.get_contents_element&&h.get_contents_element());if(U&&h.visible()&&(!e.robot||
e.robot.animate_consequences_of_actions())){v=$(G).width();r=$(G).height();var S=$(G).offset();c.max_left=c.left+Q.width();c.max_top=c.top+Q.height();d={left:d.left+v,top:d.top+r};var Z={left:Math.min(S.left+v,c.max_left-v),top:Math.min(S.top+r,c.max_top-r)},l={left:Math.max(S.left-v,c.left),top:Math.max(S.top-r,c.top)};d=function(){var b=function(){h.visible()?(h.set_locked(!0),this.fly_to(S,u,e)):(e.delivery_bird=this,e.ignore_copies=!0,h.add_to_contents(a,e),k&&(k(),k=void 0))}.bind(this);$(F).addClass("toontalk-temporarily-set-down");
P(Z);h.get_locked()?h.run_when_unlocked(b):b()}.bind(this);var u=function(){N(U);this.fly_to(l,L,e)}.bind(this),L=function(){$(U).addClass("toontalk-temporarily-set-down");P(l);this.fly_to(Z,M,e)}.bind(this),M=function(){N(F,a);this.fly_to(S,da,e)}.bind(this),da=function(){var d=h.get_contents_dimensions();a.is_plain_text_element()&&$(F).addClass("toontalk-temporarily-set-down");P(S);a.is_plain_text_element()||b.UTILITIES.set_css(a.get_element(),d);this.fly_to(l,aa,e)}.bind(this),aa=function(){N(U);
this.fly_to(S,pa,e)}.bind(this),pa=function(){$(F).removeClass("toontalk-temporarily-set-down");h.set_locked(!1);P();h.update_display();V()}.bind(this);this.fly_to(Z,d,e)}else this.fly_to(d,V,e)}else e.delivery_bird=this,e.ignore_copies=!0,h.add_to_contents(a,e),e.temporary_bird&&this.remove()}else a.remove(),this.remove()}else e.after_delivery_continuation&&e.after_delivery_continuation(),b.debugging&&(console.error("animate_delivery_to called with undefined message_side."),console.trace())};m.get_json=
function(a,c,e,h){if(g){var k=function(a,b,e){c({type:"bird",nest:a},b,e+1)};b.UTILITIES.get_json(g,a,k,e,h+1)}else c({type:"bird"},e,h+1)};m.copy=function(b){var c,h;if(b)if(b.just_value)var k=this.create(void 0,this.get_description());else{if((h=g&&g.get_guid())&&b.nests_copied&&b.nests_copied[h]){k=b.nests_copied[h][0];e.call(k);for(c=1;c<b.nests_copied[h].length;c++)a.call(b.nests_copied[h][c],k);k=this.create(k,this.get_description())}else k=this.create(g,this.get_description());b.birds_copied||
(b.birds_copied={});h&&(b.birds_copied[h]||(b.birds_copied[h]=[]),b.birds_copied[h].push(k))}else k=g&&g.is_function_nest()?this.create(g.copy(),this.get_description()):this.create(g,this.get_description());return this.add_to_copy(k,b)};m.run_when_non_empty=function(a,b){0>q.indexOf(b)&&(p.push(a),q.push(b))};m.create_backside=function(){var a=b.bird_backside.create(this);g&&g.is_function_nest()&&k(g,a,this);return a};m.get_help_URL=function(){return g&&g.is_function_nest()?"docs/manual/function-birds.html":
"docs/manual/birds-nests.html"};m.is_function_bird=function(){return g&&g.is_function_nest()};m.get_custom_title_prefix=function(){var a;return g?g.is_function_nest()&&(a=g.get_function_object())?a.get_description():"Drop something on me and I'll take it to my nest.":"This bird no longer knows where her nest is. She'll get rid of anything you give her."};m.toString=function(a){return g?g.is_function_nest&&g.is_function_nest()?g.get_function_object().toString():g.get_name()?"bird named '"+g.get_name()+
"'":"bird":a&&"conditions"===a.role?"any bird":"bird without a nest"};m.get_default_description=function(){return this.is_function_bird()?"a bird who gives another bird a box to compute the '"+g.get_function_object().name+"' of "+this.get_function_type(!0)+".":"a bird who takes things to her nest."};m.update_display=function(){var a=this.get_frontside(!0);this.get_backside();var c=a.get_element();c.setAttribute("toontalk_name",this.get_name());b.UTILITIES.give_tooltip(c,this.get_title());$(c).is(".toontalk-bird, .toontalk-side-animating")||
($(c).addClass("toontalk-bird-static "+this.get_class_name_with_color("toontalk-bird toontalk-bird-static")),c.addEventListener("dragenter",function(a){0<=c.className.indexOf("toontalk-bird-static")&&($(c).removeClass("toontalk-bird-static "+this.get_class_name_with_color("toontalk-bird-static")),b.UTILITIES.add_animation_class(c,"toontalk-bird-gimme"))}.bind(this)),c.addEventListener("dragleave",function(a){$(c).is(".toontalk-bird-gimme")&&($(c).addClass("toontalk-bird-static "+this.get_class_name_with_color("toontalk-bird-static")).removeClass("toontalk-bird-gimme"),
this.get_parent_of_frontside()&&this.get_parent_of_frontside().render())}.bind(this)));if(this.element_to_display_when_flying){this.has_ancestor(b.UTILITIES.widget_side_of_element(this.element_to_display_when_flying))&&this.top_level_widget().get_backside_element().appendChild(c);try{c!==this.element_to_display_when_flying&&c.appendChild(this.element_to_display_when_flying)}catch(z){b.UTILITIES.report_internal_error("Error attaching 'message' to bird. Message className is "+this.element_to_display_when_flying.className+
". Error is "+z)}}else $(c).children(".toontalk-side").remove();b.UTILITIES.set_css(c,{"font-size":this.name_font_size()})};m.set_function_name=function(a){g&&g.is_function_nest()&&g.set_function_name(a)&&(this.rerender(),this.robot_in_training()&&this.robot_in_training().edited(this,{setter_name:"set_function_name",argument_1:a,toString:"change the function bird to '"+a+"'",button_selector:".toontalk-select-function"}))};m.get_function_type=function(a){return g.get_function_type(a)};m.get_class_name_with_color=
function(a){return g&&g.get_class_name_with_color?g.get_class_name_with_color(a):a};m.get_name=function(){return g?g.get_name():""};g&&g.set_name&&(m.set_name=function(a,b,c){return g.set_name(a,b,c)});m.has_name_font_size(m);m.get_name_height=function(a){return.3*(a||this.get_height())};m.is_nest_visible=function(){return g&&g.visible()};m.add_standard_widget_functionality(m);m.add_speech_listeners({descriptions_acceptable:!0,names_acceptable:!0});m.set_description(h);b.debugging&&(m._debug_id=b.UTILITIES.generate_unique_id(),
m._debug_string=m.to_debug_string());return m};c.create_function=function(a,e,h){if("undefined"===typeof b[a].function)throw a="Unable to create function bird for type: "+a,b.UTILITIES.report_internal_error(a),a;return c.create(b.nest.create_function(e,a,h||b.UTILITIES.get_first_property(b[a].function)))};c.match=function(a){if(a.get_widget().match_with_any_bird)return a.get_widget().match_with_any_bird(this);this.last_match=a;return this};c.match_with_any_bird=function(){return"matched"};c.fly_to=
function(a,c,e){var g=this.get_frontside_element(),h=$(g).offset(),k="toontalk-fly-west toontalk-fly-northwest toontalk-fly-north toontalk-fly-northeast toontalk-fly-east toontalk-fly-southeast toontalk-fly-south toontalk-fly-southwest".split(" ")[Math.round(4*(Math.atan2(a.top-h.top,a.left-h.left)/Math.PI+1))%8];$(g).position();var m=function(){$(g).removeClass(k);e.delay&&this.visible()?setTimeout(c,e.robot?e.robot.transform_step_duration(e.delay):e.delay):c()}.bind(this);h=function(){$(g).removeClass("toontalk-bird-static "+
this.get_class_name_with_color("toontalk-bird-static"));b.UTILITIES.add_animation_class(g,k);this.animate_to_absolute_position(a,m,e.robot&&e.robot.transform_animation_speed(b.animation_settings.BIRD_ANIMATION_SPEED))}.bind(this);this.visible()?setTimeout(h,1):h()};c.get_type_name=function(a,b){return a?b&&this.is_function_bird()?"function birds":"birds":"bird"};c.maintain_proportional_dimensions=function(){return!0};c.matching_resource=function(a){return a.get_type_name&&a.get_type_name()===this.get_type_name()};
c.drop_on=function(a,b){if(a.widget_side_dropped_on_me)return a.widget_side_dropped_on_me(this,b)};b.creators_from_json.bird=function(a,e,h){return a?b.bird.create(b.UTILITIES.create_from_json(a.nest,e,h),a.description):Object.create(c)};return c}(window.TOONTALK);window.TOONTALK.bird_backside=function(a){return{create:function(b){var c=a.backside.create(b);c.add_description_setting();c.add_name_setting();c.get_element().appendChild(a.backside.create_advanced_settings_button(c,b));return c}}}(window.TOONTALK);
window.TOONTALK.nest=function(b){var h=Object.create(b.widget),m,g,v=0,x=0;h.default_maximum_capacity=10;h.maximum_capacity=h.default_maximum_capacity;h.create=function(p,q,A,y,z,n,w){var I=[],D=[],K=[],E;w||(w=Object.create(h));q||(q=[]);z||(v++,z=v);a=function(a){y&&c.call(y,this);y=a;A=a.get_guid();k.call(a,this)};e=function(){y&&c.call(y,this);y=void 0;A=b.UTILITIES.generate_unique_id();this.set_name(this.generate_name())};k=function(a){m||(m=b.UTILITIES.generate_unique_id());this[m](a)};c=function(a){m||
(m=b.UTILITIES.generate_unique_id());this[m](a,!0)};w.is_nest=function(){return!0};w.get_guid=function(){return A};w.matched_by=function(a){return 0<q.length?b.UTILITIES.match(a,q[0]):[[this,a]]};w.run_when_non_empty=function(a,b){0<q.length?a(q[0]):0>K.indexOf(b)&&(I.push(a),K.push(b))};w.dereference=function(){return 0<q.length?q[0]:this};w.match=function(a){if(0<q.length)return q[0].match(a);if(a.match_nest_with_nest)return a.match_nest_with_nest(this);this.last_match=a;return this};w.add_to_contents=
function(a,c){var e=q.push(a);var g=this.visible();c||(c={});e>h.maximum_capacity&&c.robot&&c.robot_removed_contents_since_empty&&!c.robot.visible()&&!g&&(b.logging&&0<=b.logging.indexOf("nest")&&console.log(this.to_debug_string(50)+" postponing addition of "+a.to_debug_string(50)+" by "+c.robot.to_debug_string(50)+". Stack is "+q.length+" long. "+D.length+" previously postponed."),c.robot.add_body_finished_listener(function(){c.robot.set_stopped(!0);D.push(function(){c.robot.set_stopped(!1);c.robot.run_actions()})}));
b.logging&&0<=b.logging.indexOf("nest")&&console.log(this.to_debug_string()+" added "+a.to_debug_string()+" nest now contains "+q.length+" widgets.");a.is_backside()?a.set_parent_of_backside(this):a.set_parent_of_frontside(this);E&&!c.ignore_copies&&(c.delivery_bird?E.forEach(function(e){e.has_ancestor(a.get_widget())||e.animate_bird_delivery(b.UTILITIES.copy_side(a),c.delivery_bird,c)}):E.forEach(function(e){e.has_ancestor(a.get_widget())||e.add_to_contents(b.UTILITIES.copy_side(a,!1,!0),c)}));1===
e?(0<I.length&&(e=I,I=[],K=[],e.forEach(function(b){b(a)})),a.set_visible(g),g?this.get_containing_widget().rerender():a.hide()):(a.hide(),a.set_visible(!1));c.event&&this.backup_all();this.rerender()};w.animate_bird_delivery=function(a,c,e){if(void 0!==this.get_parent_of_frontside()||c.visible()){if(c.animate_delivery_to(a,this,e),E){var g=$(c.closest_visible_ancestor().get_widget().get_frontside_element()).closest(":visible").position();var h=c.get_parent_of_frontside()&&c.get_parent_of_frontside().get_element();
var k=this.visible();E.forEach(function(n){var m=b.UTILITIES.copy_side(a,!1,k);if(!n.has_ancestor(a.get_widget()))if(g&&(n.visible()||k)){var d=c.copy({just_value:!0});var f=d.get_frontside_element(!0);h&&h.appendChild(f);d.animate_delivery_to(m,n,{starting_left:g.left,starting_top:g.top,nest_recieving_message:n,temporary_bird:!0,robot:e.robot})}else n.add_to_contents(m,e)})}}else a.remove(),e.after_delivery_continuation&&e.after_delivery_continuation()};w.get_contents_element=function(){if(0<q.length)return q[0].get_element()};
w.get_locked=function(){return this.locked_for_animating_deliveries};w.set_locked=function(a){this.locked_for_animating_deliveries=a;!a&&this.to_run_when_unlocked&&0<this.to_run_when_unlocked.length&&this.to_run_when_unlocked.shift()()};w.run_when_unlocked=function(a){this.to_run_when_unlocked?this.to_run_when_unlocked.push(a):this.to_run_when_unlocked=[a]};w.removed_from_container=function(a,c,e){a=q.shift();b.logging&&0<=b.logging.indexOf("nest")&&(a?console.log(this.to_debug_string(50)+" removed "+
a.to_debug_string()+" remaining widgets is "+q.length):console.log(this.to_debug_string(50)+" nothing left to remove."));if(a)return a.is_backside()?a.set_parent_of_backside(void 0):a.get_widget().set_parent_of_frontside(void 0),this.visible()&&(a.restore_dimensions&&a.restore_dimensions(),0<q.length&&(q[0].set_visible(!0),$(q[0].get_element()).show()),this.get_containing_widget().is_top_level()?this.render():this.get_containing_widget().render()),q.length<=h.maximum_capacity&&0<D.length&&(b.logging&&
0<=b.logging.indexOf("nest")&&console.log(this.to_debug_string(50)+" running "+D.length+" postponed additions. Stack is "+q.length+" long."),h.maximum_capacity=Number.MAX_VALUE,D.forEach(function(a){a()}),h.maximum_capacity=h.default_maximum_capacity,D=[]),a;e&&b.UTILITIES.report_internal_error("Nothing removed from nest!")};w.dereference_path=function(a,c){if(0===q.length)return this.get_guid()?{wait_until_this_nest_receives_something:this}:this;if(q&&"function"===typeof q[0].dereference_path)return q[0].dereference_path(a,
c);c.display_message("Robot expected to find something on a nest that it could get "+b.path.toString(a)+". But the nest is empty or contains something else.");return this};w.dereference_contents=function(a,c){var e;if(0===q.length)return{wait_until_this_nest_receives_something:this};if(a.removing_widget){var g=q[0];c.remove_from_container(g,this);if(this.visible()){var h=this.get_frontside_element();a=$(h).offset();var k=$(h).closest(".toontalk-backside-of-top-level");(e=k.offset())||(e={left:0,top:0});
var n=g.get_element(!0);var m=$(h).width();h=$(h).height();var d=.1*m+a.left-e.left;var f=.1*h+a.top-e.top;b.UTILITIES.set_css(n,{width:m*b.nest.CONTENTS_WIDTH_FACTOR,height:h*b.nest.CONTENTS_HEIGHT_FACTOR});g.render();0<k.length&&c.add_watched_step_end_listeners(function(){g.get_parent()&&(k.get(0).appendChild(n),b.UTILITIES.set_css(n,{left:d,top:f}))})}return g}return a.next?q[0].get_widget().dereference_path&&(g=q[0].get_widget().dereference_path(a.next,c))?g:b.path.continue_dereferencing_path(a.next,
q[0].get_widget(),c):q[0].get_widget()};w.get_json=function(a,c,e,g){var h=[],k=function(){var k=function(a,b,e){c({type:"nest",contents:h,guid:A,original_nest:a,serial_number:z,name:this.get_name()},b,e+1)}.bind(this);y?b.UTILITIES.get_json(y,a,k,e,g+1):k(void 0,e,g+1)}.bind(this);b.UTILITIES.get_json_of_array(q,h,0,a,k,e,g+1)};w.copy=function(c){if(c&&c.just_value){if(0<q.length){var e=q[0].copy(c);if(!c.copy_covered_nests)return e}var g=b.nest.create(this.get_description(),[],"in a robot's condition",
void 0,z,this.get_name());e&&g.add_to_contents(e);return g}e=b.UTILITIES.copy_widget_sides(q,c);if(c)if(c.fresh_copy)g=b.nest.create(this.get_description(),e,A&&b.UTILITIES.generate_unique_id());else{var h=y||this;if(c.birds_copied&&c.birds_copied[A]){var k=h.get_guid();c.nests_copied&&c.nests_copied[k]?(g=c.nests_copied[k][0].copy(),c.nests_copied[k].forEach(function(b){a.call(b,g)})):g=b.nest.create(this.get_description(),e,b.UTILITIES.generate_unique_id(),void 0,void 0,this.generate_name());c.birds_copied[A].forEach(function(a){a.set_nest(g,
this);b.debugging&&(a._debug_string=a.to_debug_string())}.bind(this))}else g=b.nest.create(this.get_description(),e,A,h,z,this.get_name()),k=A;c.nests_copied||(c.nests_copied={});c.nests_copied[h]?c.nests_copied[k].push(g):c.nests_copied[k]=[g]}else g=b.nest.create(this.get_description(),e,A,y||this,z,this.get_name());return this.add_to_copy(g,c)};w.has_contents=function(){return 0<q.length};w.set_contents=function(a){q=a};w.dropped_on_other=function(a,c){var e,g,h,k;if(!A){A=b.UTILITIES.generate_unique_id();
b.debugging&&(this._debug_string=this.to_debug_string());var n=b.bird.create(this);if(c.robot){c.robot.add_newly_created_widget(n);if(!this.visible())return;this.robot_waiting_before_next_step=c.robot}c.event&&this.robot_in_training()&&this.robot_in_training().add_newly_created_widget(n);b.sounds&&setTimeout(function(){b.sounds.hatching.play()},1E3);this.rerender();var m=this.get_frontside_element(!0);b.UTILITIES.add_animation_class(m,"toontalk-hatch-egg");var d=function(){if(a.is_backside())var d=
a;else if((d=b.UTILITIES.widget_side_of_jquery($(m).closest(".toontalk-backside-of-top-level")))||(d=b.UTILITIES.widget_side_of_jquery($(a.get_widget().get_frontside_element(!0)).closest(".toontalk-backside-of-top-level"))),d)d=d.is_backside()?d:d.get_backside();else{b.UTILITIES.report_internal_error("Unable to find the top-level backside for bird to go to.");return}var p=d.get_element();var q=$(p).offset();e=n.get_frontside_element(!0);$(e).removeClass("toontalk-bird-static "+this.get_class_name_with_color("toontalk-bird-static"));
b.UTILITIES.add_animation_class(e,"toontalk-fly-southwest");g=b.UTILITIES.relative_position(m,p);b.UTILITIES.set_css(e,{left:g.left,top:g.top});c.event&&this.robot_in_training()&&(c.ignore_training=!0);d.widget_side_dropped_on_me(n,c);$(m).removeClass("toontalk-hatch-egg").addClass("toontalk-empty-nest "+this.get_class_name_with_color("toontalk-empty-nest")).css({width:"",height:""});this.get_parent_of_frontside()&&this.get_parent_of_frontside().is_top_level()&&(b.UTILITIES.set_css(m,{left:g.left-
5,top:g.top+45}),this.get_parent_of_frontside().render());k=function(){$(e).removeClass("toontalk-fly-southwest");b.UTILITIES.set_timeout(function(){b.UTILITIES.add_animation_class(e,"toontalk-fly-down");$(e).removeClass("toontalk-bird-static "+this.get_class_name_with_color("toontalk-bird-static"));h=function(){var a=function(){$(e).removeClass("toontalk-bird-morph-to-static toontalk-side-animating").addClass("toontalk-bird-static "+this.get_class_name_with_color("toontalk-bird-static"))}.bind(this);
$(e).removeClass("toontalk-fly-down");b.UTILITIES.add_animation_class(e,"toontalk-bird-morph-to-static");b.UTILITIES.add_one_shot_event_handler(e,"animationend",1E3,a);c.robot&&(this.robot_waiting_before_next_step=void 0,c.robot.run_next_step());n.update_display()}.bind(this);b.UTILITIES.add_one_shot_event_handler(m,"animationend",1E3,h)}.bind(this))}.bind(this);$(e).removeClass("toontalk-bird-static "+this.get_class_name_with_color("toontalk-bird-static"));n.animate_to_absolute_position({left:Math.max(10,
g.left-70)+q.left,top:Math.max(10,g.top+70)+q.top},k,c.robot&&c.robot.transform_animation_speed(b.animation_settings.BIRD_ANIMATION_SPEED));this.rerender()}.bind(this);b.UTILITIES.add_one_shot_event_handler(m,"animationend",2E3,d)}return!0};w.widget_side_dropped_on_me=function(a,b){b.event&&a.save_dimensions&&a.save_dimensions();0===q.length?(this.add_to_contents(a,b),a.dropped_on_other?a.dropped_on_other(this,b):b.event&&this.robot_in_training()&&this.robot_in_training().dropped_on(a,this)):a.drop_on(q[0],
b);return!0};w.drop_on=function(a,b){return a.widget_side_dropped_on_me?(a.widget_side_dropped_on_me(this,b),!0):!1};w.element_to_highlight=function(){return 0===q.length?this.get_frontside_element():q[0].get_frontside_element()};w.update_display=function(){var a=this.get_frontside(!0),c=this.get_backside();var e=a.get_element();if(0<q.length){e.setAttribute("toontalk_name","");var g=q[0];if(g.is_backside()){var h=g.get_element(!0);g.update_display();g.scale_to_fit(h,e)}else g.set_visible(!0),g.render(),
h=q[0].get_element(!0),$(h).show();b.UTILITIES.when_attached(h,function(){var a=this.get_contents_dimensions();if(a){var c=$(e).width();var k=$(e).height();b.UTILITIES.set_css(h,{width:a.width,height:a.height,left:c*(1-b.nest.CONTENTS_WIDTH_FACTOR)/2,top:k*(1-b.nest.CONTENTS_HEIGHT_FACTOR)/2});g.set_size_attributes&&g.set_size_attributes(a.width,a.height);g.render()}}.bind(this));$(e).parent().is(".toontalk-box-hole")&&!$(e).parent().is(".toontalk-scale-half")?(e.parentElement.appendChild(h),$(h).css({"z-index":b.UTILITIES.next_z_index()})):
e.appendChild(h);$(e).addClass("toontalk-empty-nest "+this.get_class_name_with_color("toontalk-empty-nest"));q[0].is_backside()?g.set_parent_of_backside(this):g.set_parent_of_frontside(this)}else e.setAttribute("toontalk_name",this.get_name()),A?($(e).removeClass(this.get_class_name_with_color("toontalk-nest-with-egg")),$(e).addClass("toontalk-empty-nest "+this.get_class_name_with_color("toontalk-empty-nest"))):b.UTILITIES.add_animation_class(e,this.get_class_name_with_color("toontalk-nest-with-egg")),
b.UTILITIES.set_css(e,{"font-size":this.name_font_size()});b.UTILITIES.give_tooltip(e,this.get_title());$(e).addClass("toontalk-nest");c&&c.rerender()};m||(m=b.UTILITIES.generate_unique_id());w[m]=function(a,b){if(!E){if(b)return;E=[]}b?E.splice(E.indexOf(a),1):E.push(a)};w.get_contents_dimensions=function(){var a=this.get_frontside_element();var c=$(a).parent().is(".toontalk-box-hole")&&!$(a).parent().is(".toontalk-scale-half")?a.parentElement:a;a=$(c).width();c=$(c).height();a*=b.nest.CONTENTS_WIDTH_FACTOR;
c*=b.nest.CONTENTS_HEIGHT_FACTOR;var e=q[0];if(e){var g=e.is_box()?1:2;e=e.get_border_size?g*e.get_border_size(a,c):0;return{width:a-e,height:c-e}}};w.get_path_to=function(a,c){if(0<q.length){var e=q[0].get_widget();if(e===a)return b.path.to_widget_on_nest();if(e.get_path_to){var g=b.path.to_widget_on_nest();if(a=e.get_path_to(a,c))return g.next=a,g}}};w.walk_children=function(a){if(0<q.length)return a(q[0])};w.top_contents_is=function(a){return 0<q.length&&q[0]===a};w.any_nest_copies_visible=function(){var a=
!1;if(!E)return!1;E.some(function(b){b.visible()&&(a=!0)});return a};w.compare_with=function(a){if(0<q.length){if(q[0].compare_with)return q[0].compare_with(a);b.UTILITIES.report_internal_error("Nest contains something that doesn't understand 'compare_with'. It is "+q[0])}else if(a.compare_with_nest)return-1*a.compare_with_nest(this)};w.compare_with_nest=function(a){return 0===q.length?0:1};w.compare_with_number=function(a){return 0<q.length?q[0].compare_with(a):-1};w.get_class_name_with_color=function(a){return z?
a+["","-magenta","-yellow"][z%3]:a};w.generate_name=function(){x++;return n&&"#"!==n[0]?b.UTILITIES.strip_trailling_digits(n).trim()+" "+x:"#"+x};w.has_name(w);w.get_name_width=function(a){return.8*(a||this.get_width())};w.get_name_height=function(a){return.5*(a||this.get_height())};var O=w.set_name;w.set_name=function(a,c,e){var g=this.get_name();if(!O.call(this,a,c,e))return!1;c&&$(".toontalk-bird").each(function(){if(this.getAttribute("toontalk_name")===g){var c=b.UTILITIES.widget_side_of_element(this);
b.UTILITIES.set_css(c.get_element(),{"font-size":b.UTILITIES.font_size(a,.4*c.get_width(),{height:.6*c.get_height()})});c.rerender()}})};w.compare_with_box=w.compare_with_number;w.compare_with_scale=w.compare_with_number;w.add_standard_widget_functionality(w);g||(g=w.remove);w.remove=function(){g.call(this);y&&c.call(y,this)};w.add_speech_listeners({descriptions_acceptable:!0,names_acceptable:!0});var J=w.set_visible;w.set_visible=function(a,b){J.call(this,a,b);a||this.set_locked(!1)};w.set_name(n);
w.set_description(p);b.debugging&&(w._debug_id=b.UTILITIES.generate_unique_id(),w._debug_string=w.to_debug_string());y&&A&&(m||(m=b.UTILITIES.generate_unique_id()),y[m](w));return w};h.create_function=function(a,c,e){var g=function(){return!1},h=b[c]&&b[c].function&&b[c].function[e];g={is_nest:function(){return!0},get_function_type:function(a){return b[c].get_type_name(a)},get_function_object:function(){return h},set_function_name:function(a){if(e===a)return!1;e=a;h=b[c]&&b[c].function&&b[c].function[e];
this.add_to_contents=h.respond_to_message;return!0},is_function_nest:function(){return!0},copy:function(){return b.nest.create_function(a,c,e)},animate_bird_delivery:function(a,b,c){b.animate_delivery_to(a,this,c)},get_json:function(a,e,g,k){e({type:"function_nest",function_type:c,function_name:h?h.name:b.UTILITIES.get_first_property(b[c].function)},g,k+1)},add_to_json:b.widget.add_to_json,get_widget:function(){return this},get_guid:function(){},get_name:function(){return h.short_name},get_backside_widgets:function(){return[]},
has_ancestor:g,visible:g,any_nest_copies_visible:g,is_backside:g};b.widget.has_parent(g);b.widget.has_description(g);b.widget.add_sides_functionality(g);g.set_description(a);h?(g.add_to_contents=h.respond_to_message,b.debugging&&(g._debug_id=b.UTILITIES.generate_unique_id(),g._debug_string="a function nest that "+h.toString())):b.UTILITIES.report_internal_error("Cannot create a function nest because TOONTALK."+c+"."+e+" is not defined.");return g};b.creators_from_json.function_nest=function(a,c){if(a)return b.nest.create_function(a.description,
a.function_type,a.function_name)};h.create_backside=function(){return b.nest_backside.create(this)};h.match_nest_with_nest=function(a){return"matched"};h.toString=function(){return this.get_name()?"nest named '"+this.get_name()+"'":"nest"};h.get_default_description=function(){return"a nest that receives things from its birds."};h.get_help_URL=function(){return"docs/manual/birds-nests.html"};h.get_type_name=function(a){return a?"nests":"nest"};h.maintain_proportional_dimensions=function(){return!0};
h.matching_resource=function(a){return a.get_type_name&&a.get_type_name()===this.get_type_name()};h.get_custom_title_prefix=function(){return"Drop something on my bird and she'll take it here."};b.creators_from_json.nest=function(a,c,e){if(!a)return Object.create(h);e||(e=!a.original_nest&&a.guid&&c&&c.guid_to_nest_table&&c.guid_to_nest_table[a.guid]);e=b.nest.create(a.description,[],a.guid,a.original_nest&&b.UTILITIES.create_from_json(a.original_nest,c),a.serial_number,a.name,e);e.set_contents(b.UTILITIES.create_array_from_json(a.contents,
c));return c.guid_to_nest_table[a.guid]=e};h.CONTENTS_WIDTH_FACTOR=1;h.CONTENTS_HEIGHT_FACTOR=1;return h}(window.TOONTALK);window.TOONTALK.nest_backside=function(a){return{create:function(b){b=a.backside.create(b);b.add_description_setting();b.add_name_setting();return b}}}(window.TOONTALK)})();window.TOONTALK.scale=function(a){var k=Object.create(a.widget);k.create=function(c,e,b,h,k){var g=function(){b.rerender()},m=function(){return b.get_contents_dimensions()};b||(b=a.box.create(2,void 0,c,e,k||""));var x=b.get_json;var p=b.copy;var q=b.get_path_to;b.is_scale=function(){return!0};b.copy=function(c){this.get_name();c||(c={});var e=p.call(this,c);e=a.scale.create(void 0,void 0,e,c.just_value&&this.get_state());return b.add_to_copy(e,c)};b.get_json=function(a,b,c,e){var g=function(a,c,
e){a.type="scale";a.inactive_state=this.get_inactive_state();b(a,c,e+1)}.bind(this);x.call(this,a,g,c,e+1)};b.get_path_to=function(a,b){if(a=q.call(this,a,b))a.true_type="scale";return a};b.drop_on=function(a,b){if(a&&a.widget_side_dropped_on_me)return a.widget_side_dropped_on_me(this,b)};b.widget_side_dropped_on_me=function(a,b){var c=this.get_hole_contents(0),e=this.get_hole_contents(1);a.dropped_on_other&&a.dropped_on_other(this,b);if(c&&!e)return this.get_hole(1).widget_side_dropped_on_me(a,b),
!0;if(!c&&(e||!b.event))return this.get_hole(0).widget_side_dropped_on_me(a,b),!0;var g=this.which_hole(b.event,!1);if(0===g){if(c){if(c.drop_on)return a.drop_on(c,b);return}}else if(e){if(e.drop_on)return a.drop_on(e,b);return}if(this.get_hole(g))return this.get_hole(g).widget_side_dropped_on_me(a,b),!0};b.which_hole=function(c,e){var g=b.get_frontside_element(),h=$(g).offset();g=a.UTILITIES.get_element_width(g);c=c.clientX-(h.left+g/2);e=e?g/10:0;return-c>e?0:c>e?1:-1};b.get_inactive_state=function(){return h};
b.update_display=function(){var b=this.get_frontside_element(!0),c=$(b),e=$(b).children(".toontalk-scale-half"),g=$(b).parent();g=g.is(".toontalk-backside")||c.is(".toontalk-conditions-contents")?b:g.get(0);var h=$(g).width()||c.width(),k=$(g).height()||c.height(),p=function(b,c,e){var g=c.get_contents(),n=(g||c).get_element(!0);a.UTILITIES.set_css(b,{left:e*h*.5,top:0,width:.5*h,height:k});if(b!==n){var p=0===e?-.05*h:.15*h;e="toontalk-scale-balanced"===q?.1*k:0===e&&"toontalk-scale-left_heavier"===
q||1===e&&"toontalk-scale-right_heavier"===q?.25*k:1===e&&"toontalk-scale-left_heavier"===q||0===e&&"toontalk-scale-right_heavier"===q?-.1*k:.2*k;var y=.4*h;var v=.4*k;$(n).css({left:p,top:e,width:y,height:v});$(b).css({width:y,height:v});g&&(g.set_location_attributes&&g.set_location_attributes(p,e),g.set_size_attributes&&g.set_size_attributes(y,v),g.is_backside()&&(g.update_display(),g.scale_to(y,v)),g.set_visible(!0),g.render());b.appendChild(n);c.get_contents_dimensions=m;c.is_scale_pan=function(){return!0}}};
if(c.is(".toontalk-top-level-resource"))var q="toontalk-scale-balanced";else{var v=this.get_state();q="undefined"===typeof v?"toontalk-scale-unbalanced":["toontalk-scale-right_heavier","toontalk-scale-balanced","toontalk-scale-left_heavier"][v+1]}c.removeClass("toontalk-scale-balanced toontalk-scale-left_heavier toontalk-scale-right_heavier toontalk-scale-unbalanced");c.addClass(q);c.addClass("toontalk-scale");0===h&&(h=1);0===k&&(k=1);$(g).is(".toontalk-top-level-resource")||$(b).is(".toontalk-top-level-resource")||
(c=a.UTILITIES.scale_to_fit(b,g,123,91),h/=c.x_scale,k/=c.y_scale);2===e.length?e.each(function(b,c){a.UTILITIES.set_timeout(function(){p(c,this.get_hole(b),b)}.bind(this))}.bind(this)):(this.get_holes().forEach(function(a,c){var e=a.get_element();a.get_contents();0===c?$(e).addClass("toontalk-left_scale  toontalk-scale-half"):$(e).addClass("toontalk-right_scale toontalk-scale-half");b.appendChild(e);a.update_display()}),setTimeout(function(){this.render()}.bind(this),100));a.UTILITIES.give_tooltip(b,
this.get_title());a.debugging&&(this._debug_string=this.to_debug_string())};b.get_contents_dimensions=function(){var a=this.get_frontside_element(!0),b=$(a).parent(),c=b.is(".toontalk-backside")||$(a).is(".toontalk-conditions-contents")?a:b.get(0);b=$(c).width()||$(a).width();a=$(c).height()||$(a).height();return{width:.4*b,height:.4*a}};b.render=function(){a.DISPLAY_UPDATES.pending_update(this)};b.get_type_name=function(a){return a?"scales":"scale"};b.get_help_URL=function(){return"docs/manual/scales.html"};
b.is_resizable=function(){return!1};b.toString=function(){var b=this.get_hole_contents(0),c=this.get_hole_contents(1);switch(this.get_state()){case -1:var e="scale leaning to the right";break;case 1:e="scale leaning to the left";break;case 0:e="balanced scale";break;default:if(e="unbalanced scale",!g&&!h)return e}var g=b?"contains "+a.UTILITIES.add_a_or_an(b.get_full_description()):"is empty";var h=c?"contains "+a.UTILITIES.add_a_or_an(c.get_full_description()):"is empty";return e+" and the left pan "+
g+" and the right pan "+h};b.create_backside=function(){return a.scale_backside.create(this)};b.get_state=function(){var a=this.get_inactive_state();if(a)return a;a=this.get_hole_contents(0);var b=this.get_hole_contents(1);if(a||b)if(a)if(b){if(a=a.dereference(),b=b.dereference(),a.get_widget().compare_with)return a.get_widget().compare_with(b.get_widget())}else return 1;else return-1};b.match=function(a){if(a.get_widget().match_with_scale)return a.get_widget().match_with_scale(this);this.last_match=
a;return this};b.match_with_scale=function(a){var b;return(b=this.get_hole_contents(0))&&b.is_nest()&&!b.has_contents()||(b=this.get_hole_contents(1))&&b.is_nest()&&!b.has_contents()?[[b,this]]:this.get_state()!==a.get_state()?(a.last_match=this,a):this.match_with_this_scale(a)};b.match_with_this_scale=function(b){var c=[],e,g,h;for(e=0;2>e;e++)if(h=b.get_hole_contents(e))if(g=this.get_hole_contents(e)){g=a.UTILITIES.match(h,g.dereference());if(g.is_widget)return g;"matched"!==g&&(c=0===c.length?
g:c.concat(g))}else if(g=this.get_contents_temporarily_removed(e))c.push(g);else return b.last_match=this,b;return 0<c.length?c:"matched"};b.match_with_this_box=function(a){a.last_match=this;return a};b.compare_with=function(a){if(a.compare_with_scale)return-1*a.compare_with_scale(this)};b.compare_with_scale=function(a){var b=this.get_state();a=a.get_state();return b&&!a?1:!b&&a?-1:b>a?1:b<a?-1:0};b.get_name_input_label=void 0;b.generate_name=function(){return""};b.get_custom_title_prefix=function(){var a=
this.get_state(),b=this.get_hole_contents(0),c=this.get_hole_contents(1);if("undefined"===typeof a)return b&&c?"I can't compare "+b+" and "+c+".":"Use me to compare two things. Drop them in my pans.";b||(b="empty pan");c||(c="empty pan");return["The "+c+" is greater than the "+b+".","The "+c+" is equal to the "+b+".","The "+c+" is less than the "+b+"."][a+1]};b.get_default_description=function(){return"a scale for comparing things."};var A=b.set_visible;b.set_visible=function(a,c){var e=function(a){a.new_value&&
a.new_value.add_listener("value_changed",g);a.old_value&&a.old_value.remove_listener("value_changed",g,!0)};A.call(this,a,c?c+1:1);a?(b.get_hole(0).add_listener("contents_or_properties_changed",e),b.get_hole(1).add_listener("contents_or_properties_changed",e)):(b.get_hole(0).remove_listener("contents_or_properties_changed",e,!0),b.get_hole(1).remove_listener("contents_or_properties_changed",e,!0));b.get_hole_contents(0)&&b.get_hole_contents(0).add_listener("value_changed",g);b.get_hole_contents(1)&&
b.get_hole_contents(1).add_listener("value_changed",g)};b.set_name=void 0;a.debugging&&(b._debug_id=a.UTILITIES.generate_unique_id(),b._debug_string=b.to_debug_string());return b};a.creators_from_json.scale=function(c,e){if(c)return k.create(a.UTILITIES.create_array_from_json(c.contents,e),c.description,void 0,c.inactive_state,c.name)};return k}(window.TOONTALK);
window.TOONTALK.scale_backside=function(a){return{create:function(k){var c=a.backside.create(k);c.add_description_setting();c.get_element().appendChild(a.backside.create_advanced_settings_button(c,k));return c}}}(window.TOONTALK);(function(){window.TOONTALK.robot=function(a){var k=function(b,c,e,g,k){e.current_action_name=c;if(b=a.path.get_path_to(b,e,!0)){g||(g={});var h=Date.now();g.time=h-e.time_of_last_step;e.time_of_last_step=h;e.add_step(a.robot_action.create(b,c,g),k)}else console.log("No path found for "+c);e.current_action_name=void 0},c=Object.create(a.widget),e=0;c.create=function(b,e,k,g,v,x,p,q,A){var h=Object.create(c),m,n,w=[],I=[],D,K,E,O,J,V,N,P,G;k||(k=a.actions.create());m||(m=h);b&&b.set_parent_of_frontside(h);
h.is_robot=function(){return!0};h.get_frontside_conditions=function(){return b};h.set_frontside_conditions=function(a){(b=a)&&!b.is_top_level()&&b.set_parent_of_frontside(this)};h.get_backside_matched_widgets=function(){return G};h.set_backside_matched_widgets=function(a){G=a};h.get_matched_backside_widget=function(a){if(G)return G[N.indexOf(a)]};h.get_backside_widget_of_type=function(a,b){var c;if(G)return G[a];if(b=b&&b.get_backside_widgets())return b.some(function(b){if(b.is_of_type(a)&&0>this.get_newly_created_widgets().indexOf(b))return c=
b,!0}.bind(this)),c};h.get_backside_conditions=function(){return e};h.set_backside_conditions=function(b){$.isArray(b)?e=b.map(function(a){return a.is_nest&&a.is_nest()?a.dereference().copy():a}):(e=[],a.UTILITIES.available_types.forEach(function(a){b[a]&&e.push(b[a])}));e&&e.forEach(function(b){b.is_backside()?b.set_parent_of_backside(this):(a.widget.erasable(b),b.set_parent_of_frontside(this))}.bind(this))};e&&h.set_backside_conditions(e);h.initialize_backside_conditions=function(){var b=this.get_training_context();
N=b?b.get_backside_widgets().slice():[];P=a.UTILITIES.copy_widget_sides(N,{just_value:!0});this.set_backside_conditions([])};h.add_to_backside_conditions=function(b){var c;0<=this.get_newly_created_widgets().indexOf(b)||(e||(e=[]),b=N.indexOf(b),0<=b&&(c=P[b]),c&&0>e.indexOf(c)&&(e.push(c),a.widget.erasable(c)))};h.get_backside_condition_index=function(a){if(G){var b=G.indexOf(a);0>b&&(b=G.length,G.push(a))}else b=0,G=[a];return b};h.get_body=function(){return k};h.set_body=function(a){k=a};h.get_running=
function(){return J||this.is_ok_to_run()};h.running_or_in_run_queue=function(){return J};h.set_running_or_in_run_queue=function(a){J=a};h.stopped=function(){return V};h.set_stopped=function(a){V&&(J=!1);if(V!==a){if(V=a)this.run_body_finished_listeners(),this.visible()&&($(this.get_frontside_element()).removeClass("toontalk-robot-waiting"),this.set_animating(!1),this.rerender());this.get_next_robot()&&this.get_next_robot().set_stopped(a)}};h.drop_thing_in_hand=function(){v&&(v.drop_on(this.top_level_widget(),
{robot:this}),this.set_thing_in_hand(void 0))};h.finish_cycle_immediately=function(a){var b=function(){this.set_visible(!1);a&&a()}.bind(this);this.add_body_finished_listener(b)};h.get_context=function(){return D};h.set_context=function(a){D=a;this.get_next_robot()&&this.get_next_robot().set_context(a)};h.context_is_backside=function(){return K};h.set_context_is_backside=function(a){K=a;this.get_next_robot()&&this.get_next_robot().set_context_is_backside(a)};h.get_top_level_context=function(){return E};
h.set_top_level_context=function(a){E=a;this.get_next_robot()&&this.get_next_robot().set_top_level_context(a)};h.get_queue=function(){return O};h.set_queue=function(a){O=a;this.get_next_robot()&&this.get_next_robot().set_queue(a)};h.animate_consequences_of_actions=function(){return this.visible()&&!this.stopped()};h.transform_step_duration=function(a){return!this.visible()||this.stopped()||D&&!D.get_backside()?0:a&&A?a/A:a};h.transform_original_step_duration=function(a){if(!this.visible()||this.stopped()||
D&&!D.get_backside())return 0;if(0===A)return a};h.transform_animation_speed=function(a){return D&&!D.get_backside()||!this.visible()||this.stopped()?0:A?a*A:a};h.set_animating=function(b,c){var e=this.get_frontside_element();b&&a.UTILITIES.visible_element(e)?(c||(c=$(e).offset()),$(e).css({width:"",height:"","z-index":a.UTILITIES.next_z_index()}),a.UTILITIES.set_position_relative_to_top_level_backside(e,c),b=$(e).closest(".toontalk-backside-of-top-level"),0<b.length&&b.get(0).appendChild(e),$(e).addClass("toontalk-robot-animating"),
setTimeout(function(){$(e).addClass("toontalk-side-animating")},2E3)):$(e).removeClass("toontalk-robot-animating toontalk-side-animating")};h.add_body_finished_listener=function(a){w.push(a)};h.run_body_finished_listeners=function(){w.forEach(function(a){a()});w=[]};h.add_watched_step_end_listeners=function(a){I.push(a)};h.run_watched_step_end_listeners=function(){I.forEach(function(a){a()});I=[]};h.get_thing_in_hand=function(){return v};h.set_thing_in_hand=function(b){if(a.debugging){if(b&&"empty hole"===
b.get_type_name()){a.UTILITIES.report_internal_error("Robot trying to pick up an empty hole.");return}a.logging&&0<=a.logging.indexOf("thing_in_hand")&&console.log(this.to_debug_string(50)+" now has in his hand "+(b?b.to_debug_string(50):"nothing"))}b&&!b.constrained_by_container()&&b.save_dimensions();v=b};h.get_next_robot=function(){return p};h.set_next_robot=function(b){var c=this.get_backside_element();b===this?a.UTILITIES.report_internal_error("Ignoring attempt to make a robot its next robot in the team. "+
b):(b&&b.set_first_in_team(this.get_first_in_team()),!b&&p&&(p.set_first_in_team(p),p.set_previous_robot(void 0)),(p=b)&&p.set_previous_robot(this),c&&($(c).find(".toontalk-drop-area-instructions").get(0).innerHTML=this.drop_area_instructions()))};h.get_previous_robot=function(){return n};h.set_previous_robot=function(a){n=a};h.get_first_in_team=function(){return m};h.set_first_in_team=function(a){m=a;p&&p.set_first_in_team(a)};h.walk_children=function(a){var b;p&&!a(p)||!(b=this.get_frontside_conditions())||
b.is_top_level()||a(b)};h.get_run_once=function(){return x};h.set_run_once=function(a){x=a;this.update_title();return!0};h.get_watched_speed=function(){return A};h.set_watched_speed=function(a){A=a;return!0};h.can_run=function(a){return!0};h.training_started=function(b){var e=this.get_training_context();e?this.being_trained||(this.time_of_last_step=Date.now(),this.being_trained=!0,this.set_frontside_conditions(e.copy({just_value:!0})),this.initialize_backside_conditions(),b||($("*").css({cursor:"url("+
a.UTILITIES.absolute_file_path("images/RB19.32x32.PNG")+"), default"}),$(this.get_frontside_element()).addClass("toontalk-ghost-robot")),this.update_title(),b=this.get_backside_element(),$(b).find(".toontalk-conditions-panel").remove(),this.robot_training_this_robot()&&this.robot_training_this_robot().started_training_another(this)):a.UTILITIES.report_internal_error("Robot started training but can't find its 'context'. Best to remove this robot and train a fresh robot.  robot_training_this_robot is "+
b+" robot is "+c)};h.training_finished=function(){if(this.being_trained){var b;var c=this.get_body().get_newly_created_widgets();for(b=0;b<c.length;b++){var e=c[b];"copy"===e.last_action&&this.add_step(a.robot_action.create(a.newly_created_widgets_path.create(b),"add to the top-level backside"))}$(this.get_frontside_element()).removeClass("toontalk-ghost-robot");this.rerender();this.being_trained=!1;this.update_title();this.backup_all();this.robot_finished_training();this.robot_in_training()?this.robot_in_training().finished_training_another(this):
$("*").css({cursor:""})}};if(a.debugging||a.logging)h.to_debug_string=function(b){var c=this.get_frontside_conditions&&this.get_frontside_conditions();return("Robot ("+(this.get_description()||"")+" "+this.get_name()+") runs if working on "+(c?a.UTILITIES.add_a_or_an(c.toString()):"anything")).substring(0,b)};p&&h.set_next_robot(p);h.add_standard_widget_functionality(h);var Q=h.remove_backside_widget.bind(h);h.has_name(h);h.set_name(q);h.set_description(g);a.listen&&h.add_speech_listeners({descriptions_acceptable:!0,
names_acceptable:!0});h.remove_backside_widget=function(a,b){var c=this.get_frontside_conditions(),d;a===c?this.set_frontside_conditions(void 0):(d=this.get_backside_conditions())&&d.some(function(b,c){if(a===b)return d.splice(c,1),!0})||Q(a,b)};a.debugging&&(h._debug_id=a.UTILITIES.generate_unique_id(),h._debug_string=h.to_debug_string());return h};c.create_backside=function(){return a.robot_backside.create(this)};c.copy=function(b){var c=this.get_frontside_conditions(),e=this.get_backside_conditions();
c=c?c.copy({just_value:!0}):void 0;var g=this.get_next_robot();g=g?g.copy(b):void 0;var k;e&&(k=a.UTILITIES.copy_widgets(e,{just_value:!0}));e=this.create(c,k,this.get_body().copy(),this.get_description(),this.get_thing_in_hand(),this.get_run_once(),g,(!b||!b.fresh_copy)&&this.get_name(),this.get_watched_speed());return this.add_to_copy(e,b)};c.match=function(a){if(a.get_widget().is_robot()){var b=this.get_body().is_empty();var c=a.get_widget().get_body().is_empty();if(b===c)return"matched"}this.last_match=
a;return this};c.generate_name=function(){e++;return"#"+e.toString()};c.run=function(b,c,e,g){var h=this.get_frontside_conditions(),k,m;if(this.being_trained||this.running_or_in_run_queue())return this;if((m=this.get_backside())&&m.visible()&&h){var q=function(a){$(a.get_element()).removeClass("toontalk-conditions-not-matched toontalk-conditions-waiting").find(".toontalk-conditions-not-matched, .toontalk-conditions-waiting").removeClass("toontalk-conditions-not-matched toontalk-conditions-waiting")};
q(h);this.rerender()}b?(this.set_context(b),this.set_context_is_backside(c),this.set_top_level_context(e),this.set_queue(g)):b=this.get_context();this.match_status=a.UTILITIES.match(h,this.get_context());if("matched"===this.match_status){var A=[];(h=this.get_backside_conditions())&&0<h.length&&((k=b.get_backside_widgets())&&h.some(function(c){if(c.matching_widget&&c.matching_widget.get_parent===b){var e=a.UTILITIES.match(c,c.matching_widget);if("matched"===e){A.push(c.matching_widget);var g=e}}g||
k.some(function(b){e=void 0;if(!(0<=A.indexOf(b))){if(b!==this&&!b.is_backside()){q&&q(b);e=a.UTILITIES.match(c,b);if("matched"===e)return A.push(b),g=e,c.matching_widget=b,!0;if(!e.is_widget)g=e;else if(!g||g.is_widget)g=e}void 0===g&&(g=c)}}.bind(this));if("matched"!==g)return this.match_status=g,!0}.bind(this)),"matched"!==this.match_status&&(A=void 0),this.set_backside_matched_widgets(A))}if("matched"===this.match_status){if(this.get_body().is_empty())return;g||(g=this.get_queue()||a.DEFAULT_QUEUE);
this.get_body().reset_newly_created_widgets();g.enqueue(this);return this.match_status}if(this.match_status){if(this.match_status.is_widget)return $(this.match_status.get_frontside_element()).addClass("toontalk-conditions-not-matched"),this.rerender(),this.get_next_robot()?this.get_next_robot().run(b,c,e,g):this.match_status;this.match_status.forEach(function(a){a[1]&&$(a[1].get_element()).addClass("toontalk-conditions-waiting")})}if(this.get_next_robot()){c=this.get_next_robot().run(b,c,e,g);if("matched"===
c)return c;c.is_widget||c.forEach(function(a){0>this.match_status.indexOf(a)&&this.match_status.push(a)}.bind(this))}if(this.get_first_in_team()===this){var y=function(){this.set_waiting(!1);this.run()}.bind(this);this.match_status.forEach(function(a){a[0]?a[0].run_when_non_empty(y,this):a.run_when_non_empty(y,this)}.bind(this));this.set_waiting(!0)}return this.match_status};c.set_waiting=function(b){var c=this.get_frontside_element();c&&(b?this.visible()&&!this.stopped()&&(a.UTILITIES.add_animation_class(c,
"toontalk-robot-waiting"),a.UTILITIES.give_tooltip(c,"This robot is waiting for a bird to deliver something.")):($(c).removeClass("toontalk-robot-waiting"),a.UTILITIES.give_tooltip(c,this.get_title())))};c.run_actions=function(){if(this.stopped())return this.get_first_in_team().set_running(!1),!1;if(this.get_first_in_team().visible())return this.get_body().run_watched(this);this.set_parent_of_frontside(this.get_context());return this.get_body().run_unwatched(this)};c.drop_from_data_transfer=function(a,
c){if(a.is_top_level&&a.is_top_level()){var b=a.get_backside_widgets().slice();setTimeout(function(){b.forEach(function(a){this.picked_up(a,void 0,!0);this.time_of_last_step-=1E3;this.dropped_on(a,c.get_backside());this.time_of_last_step-=1E3}.bind(this))}.bind(this))}else this.data_transfer=a};c.ignore_pick_up_or_drop=function(a){return this===a.get_widget()||a.is_top_level()||this.get_parent_of_frontside()===a};c.picked_up=function(b,c,e){if(!this.ignore_pick_up_or_drop(b)){if(b.get_infinite_stack&&
b.get_infinite_stack()){this.current_action_name="pick up a copy of";var g=a.UTILITIES.get_dragee_copy()}else this.current_action_name="pick up";if(e){var h=b;g=b.copy({fresh_copy:!0});c=a.path.get_path_to_resource(g)}else c=a.path.get_path_to(b,this,!0);if(c){e=Date.now();var k={time:e-this.time_of_last_step};this.time_of_last_step=e;k=a.robot_action.create(c,this.current_action_name,k);this.add_step(k,h)}b.last_action=this.current_action_name;this.current_action_name=void 0;this.set_thing_in_hand(g||
b);return k}};c.dropped_on=function(b,c){var e,g;if(!(this.ignore_pick_up_or_drop(b)||b.is_backside()&&this.get_parent_of_frontside()&&this.get_parent_of_frontside().get_widget()===b)){this.data_transfer&&(this.picked_up(this.data_transfer,void 0,!0),this.data_transfer=void 0,this.time_of_last_step-=1E3);this.current_action_name="drop it on";if(e=a.path.get_path_to(c,this)){if(c.is_backside()){var h=$(c.get_element());if(g=h.offset()){var k=h.width();h=h.height();var p=$(b.get_frontside_element()).offset();
k=(p.left-g.left)/k;g=(p.top-g.top)/h;k=Math.max(0,Math.min(1,k));g=Math.max(0,Math.min(1,g));p={left_offset_fraction:k,top_offset_fraction:g}}}else p={};g=Date.now();p.time=g-this.time_of_last_step;this.time_of_last_step=g;e=a.robot_action.create(e,this.current_action_name,p);this.add_step(e)}b.last_action=this.current_action_name+" "+c.get_type_name();this.current_action_name=void 0;this.set_thing_in_hand(void 0)}};c.dropped_on_text_area=function(a,c,e){k(a,"drop it on the text area of",this,e);
a.last_action="drop it on the text area of "+c.get_type_name();this.set_thing_in_hand(void 0)};c.copied=function(a,c,e){e=e?"pick up a copy of":"copy";k(a,e,this,void 0,c);c.last_action=e};c.removed=function(a){var b;this.get_parent()&&(b=this.get_parent().get_widget());k(a,"remove",this);a.last_action="remove";b===a||a===this?(this.add_to_top_level_backside(this.copy()),this.training_finished()):this.add_newly_created_widget_if_new(a)};c.restored=function(a){k(a,"restore",this)};c.edited=function(a,
c){k(a,"edit",this,c)};c.erased_widget=function(a){k(a,"change whether erased",this)};c.resized_widget=function(a,c,e,g,v){c===g&&e===v||k(a,"change size of",this,{x_factor:g/c,y_factor:v/e})};c.started_training_another=function(a){k(a,"start training",this)};c.finished_training_another=function(a){k(a,"stop training",this)};c.trained=function(a,c){k(a,"train",this,{step:c})};c.backside_opened=function(a){k(a,"open the backside",this)};c.backside_closed=function(a){a.is_primary_backside()?k(a.get_widget(),
"close the backside",this):this.removed(a)};c.button_clicked=function(a,c){k(c.get_widget(),"click the button of",this,{button_selector:a})};c.created_widget=function(b,c,e){this.add_newly_created_widget(b);b.get_parent()||this.add_to_top_level_backside(b,!1);this.add_step(a.robot_action.create(a.path.get_path_to_resource(b.copy()),"add a new widget to the work space",{button_selector:e,path_to_source:a.path.get_path_to(c,this)}))};c.get_newly_created_widgets=function(){return this.get_body().get_newly_created_widgets()};
c.remove_from_container=function(a,c){var b=c.get_index_of&&a.get_parent_of_frontside()&&c.get_index_of(a),e=function(){c.removed_from_container(a,void 0,b,!0)};a=a.dereference();this.animate_consequences_of_actions()?this.add_watched_step_end_listeners(e):e();this.add_newly_created_widget_if_new(a)};c.get_training_context=function(){return this.get_first_in_team().get_parent_of_frontside()&&this.get_first_in_team().get_parent_of_frontside().get_widget()};c.add_step=function(a,c){this.get_body().add_step(a,
c);this.update_title();"train"!==a.get_action_name()&&"start training"!==a.get_action_name()&&this.robot_training_this_robot()&&this.robot_training_this_robot().trained(this,a)};c.update_display=function(){var b=this.get_frontside(!0);this.get_backside();var c=this.get_thing_in_hand(),e;a.debugging&&(this._debug_string=this.to_debug_string());var g=b.get_element();c&&(e=c.get_element());!e&&this.carrying_tool&&(e=document.createElement("div"),$(e).addClass(this.carrying_tool));a.UTILITIES.give_tooltip(g,
this.get_title());$(g).addClass("toontalk-robot");$(g).children(".toontalk-held-by-robot").remove();if(e)try{g.appendChild(e)}catch(v){}this.match_status&&(this.match_status.is_widget?$(g).addClass("toontalk-side-animating toontalk-robot-not-matched"):$(g).removeClass("toontalk-robot-not-matched"));g.setAttribute("toontalk_name",this.get_name());a.UTILITIES.set_timeout(function(){if(e){var b={position:"absolute"};$(e).addClass("toontalk-held-by-robot");var h=a.UTILITIES.get_element_width(e);a.UTILITIES.get_element_height(e);
var k=a.UTILITIES.get_element_width(g);var m=a.UTILITIES.get_element_height(g);if(c&&0===h){h=c.get_default_width?c.get_default_width():2*k;var A=c.get_default_height?c.get_default_height():m/2;b.width=h;b.height=A}b.left=(k-h)/2;b.top=m/4;$(e).css(b);c&&c.rerender()}});a.UTILITIES.set_css(g,{"font-size":this.name_font_size()})};c.add_newly_created_widget=function(a){return this.get_body().add_newly_created_widget(a)};c.add_newly_created_widget_if_new=function(a){if(a!==this.get_training_context()&&
this!==a)return this.get_body().add_newly_created_widget_if_new(a)};c.is_newly_created=function(a){return this.get_body().is_newly_created(a)};c.get_recently_created_widget=function(){var a=this.get_body().get_newly_created_widgets();return a[a.length-1]};c.get_title=function(){var a=this.get_description();if(a)return a="I'm "+a,0>a.lastIndexOf(".")&&(a+="."),a+"\n"+this.toString();a=this.get_frontside_element();return $(a).is(".toontalk-top-level-resource")?"Drag this robot to a work area.":this.toString()};
c.toString=function(b){var c,e;if(b&&"conditions"===b.role)return"any robot";if(b&&"match_status"===b.role)return"robot "+this.get_name();var g="function"===typeof this.get_frontside_conditions&&this.get_frontside_conditions();var k="function"===typeof this.get_backside_conditions&&this.get_backside_conditions();if(!g&&!k)return"an untrained robot";var x=g&&g.is_top_level();b||(b={});var p=b.person;if(b&&b.resource){if(this.get_description())return'"'+this.get_description()+'"';b.person="third"}var q=
this.get_body();var A=e="";var y=this.get_next_robot();if(x)var z="When the workspace's green flag "+a.UTILITIES.encode_HTML_for_title("<span class='toontalk-green-flag-icon'></span>")+" is pressed";else if(g){var n=a.UTILITIES.add_a_or_an(g.get_full_description({role:"conditions"}));z="When working on something that matches "+n}k&&(k.forEach(function(b){b&&(z+=" and\nif on the"+(x?" work area ":" back ")+" is "+a.UTILITIES.add_a_or_an(b.get_full_description({role:"conditions"})),c=!0)}),c&&(z+="\n"));
z||(z="");if(this.being_trained){if(q.is_empty())return"I'm ready to be trained. Show me what to do and then click on my 'Stop training' button.";e="is being trained.\n";A="\n..."}try{var w=q.toString({robot:this})}catch(K){w=a.UTILITIES.is_stack_overflow(K)?"...":"Describing the actions caused this error: "+K.message}q=e+z+(b&&"third"===b.person?" he will ":" I will ")+(this.get_run_once()?"":"repeatedly ")+"\n"+(w||"do nothing")+A;if(b&&b.resource)return b.person=p,q.replace(/\n/g," ");if(this.match_status)if(this.match_status.is_widget&&
g){var I=g.is_top_level()?"the work area I'm running on":"the "+g.get_type_name()+" I'm on the back of";if(this.match_status===g)var D=I;else this.match_status.has_ancestor(g)?D="the "+(this.match_status.last_match?this.match_status.last_match.toString():"thing")+" inside the "+I:(g.is_top_level()||(I="the "+this.match_status.get_type_name()+" on "+I),k.some(function(a){if(this.match_status===a)return D="any "+a.get_type_name(!0)+" on ",g.is_top_level()||(D+="the back of "),D+=I,!0;if(this.match_status.has_ancestor(a))return D=
"any "+this.match_status.toString()+" inside the "+a.get_type_name(!0)+" on the back of "+I,!0}.bind(this)));q="I'm not running because the "+this.match_status.toString({role:"match_status"})+" (highlighted in red on my backside) that I'm expecting doesn't match "+D+". Perhaps editing my conditions will help.\n"+q}else"matched"!==this.match_status&&(q=this.match_status[0]?"I'm waiting for something to be delivered to the nest that matches "+(0<this.match_status[0].length&&this.match_status[0][1]?
a.UTILITIES.add_a_or_an(this.match_status[0][1].toString()):a.UTILITIES.add_a_or_an(this.match_status[0].toString()))+" in my conditions (highlighted in yellow on my backside).\n"+q:"I'm waiting for something to be delivered to the nest.");y&&(q+="<p>If it doesn't match then the next robot will try to run.<p><p>"+y.toString()+"</p>");return q};c.get_type_name=function(a){return a?"robots":"robot"};c.maintain_proportional_dimensions=function(){return!0};c.matching_resource=function(a){return a.is_robot()&&
!this.get_frontside_conditions()&&!a.get_frontside_conditions()&&this.get_body().is_empty()&&a.get_body().is_empty()};c.get_top_level_context_description=function(a){var b=this.get_frontside_conditions();b=b?b.get_type_name():"top-level";return"top-level"===b?a&&"third"===a.person?"his workspace":"my workspace":a&&"third"===a.person?"the "+b+" he's working on":"the "+b+" I'm working on"};c.get_help_URL=function(){return"docs/manual/robots.html"};c.drop_area_instructions=function(){return this.get_next_robot()?
"This robot here will try to run when I can't:&nbsp;&nbsp;":"Drop a robot here who will try to run when I can't."};c.get_name_height=function(a){return.4*(a||this.get_height())};c.get_contents_dimensions=function(){return{width:240,height:60}};c.get_json=function(b,c,e,g){var h=this.get_frontside_conditions(),k=this.get_backside_conditions(),p=function(){var k=function(e,g,k){var n=function(a,b,g){c({type:"robot",frontside_conditions:a,backside_conditions:A,body:m,run_once:this.get_run_once(),next_robot:e,
name:this.get_name(),speed:this.get_watched_speed()},b,g+1)}.bind(this);this.get_body().get_json(b,function(c,e,g){m=c;h?h.is_top_level()?n({type:"top_level"},e,g+1):a.UTILITIES.get_json(h,b,n,e,g+1):n(void 0,e,g+1)},g,k+1)}.bind(this);this.get_next_robot()?a.UTILITIES.get_json(this.get_next_robot(),b,k,e,g+1):k(void 0,e,g+1)}.bind(this),m;if(k){var A=[];a.UTILITIES.get_json_of_array(k,A,0,b,p,e,g+1)}else p()};a.creators_from_json.robot=function(b,c){if(b){var e,g,h;b.thing_in_hand&&(g=a.UTILITIES.create_from_json(b.thing_in_hand,
c));b.next_robot&&(e=a.UTILITIES.create_from_json(b.next_robot,c));b.backside_conditions&&($.isArray(b.backside_conditions)?h=a.UTILITIES.create_array_from_json(b.backside_conditions,c):b.semantic&&a.UTILITIES.available_types.forEach(function(c){b.semantic.backside_conditions[c]&&h.push(a.UTILITIES.get_json(b.semantic.backside_conditions[c],json_history))}));var k=a.UTILITIES.create_from_json(b.frontside_conditions||b.bubble,c);e=a.robot.create(k,h,void 0,b.description,g,b.run_once,e,b.name,b.speed);
c||(c={});c.robot=e;e.set_body(a.UTILITIES.create_from_json(b.body,c));return e}};c.find_conditions_path=function(b,c,e){var g=c.get_frontside_conditions(),h=g===b?"entire_condition":g&&g.get_path_to&&g.get_path_to(b,e);g=a.path.get_path_to(c,e);var k;if(!h){var p=c.get_backside_conditions();p.some(function(a){if(a&&a!==e&&a!==c&&(h=a.get_path_to(b,e)))return k=a,!0})}if(h)return a.robot.create_conditions_path(h,g,k);a.UTILITIES.report_internal_error("Robot has widget in its conditions but unable to construct the path.")};
c.create_conditions_path=function(b,c,e){"string"===typeof e&&this.get_backside_conditions().some(function(a){if(a&&a.get_type_name()===e)return e=a,!0});return{dereference_path:function(g){var h=a.path.dereference_path(c,g);h=e?e:h.get_frontside_conditions();return"entire_condition"===b?h:a.path.dereference_path(b,g,h)},toString:function(){var g="entire_condition"===b?"the ":a.path.toString(b)+" of the ";return e?g+e.toString()+" backside condition of "+a.path.toString(c):g+" front side condition of "+
a.path.toString(c)},get_json:function(g,h,k,p){var m=function(a,k,p){c.get_json(g,function(a,c,k){var n=function(b,c,g){h({type:"path_to_robot_conditions",backside_condition:e&&b,path_to_robot:a,path_within_conditions:b},c,g+1)};"entire_condition"===b?n("entire_condition",c,k+1):b.get_json(g,n,c,k+1)},k,p+1)};e?a.UTILITIES.get_json(e,g,m,k,p+1):m(void 0,k,p+1)}}};a.creators_from_json.path_to_robot_conditions=function(b){var c=a.UTILITIES.create_from_json(b.path_to_robot),e="entire_condition"===b.path_within_conditions?
b.path_within_conditions:a.UTILITIES.create_from_json(b.path_within_conditions);b=b.backside_condition&&a.UTILITIES.create_from_json(b.backside_condition);return a.robot.create_conditions_path(e,c,b)};return c}(window.TOONTALK);window.TOONTALK.robot_backside=function(a){var k=function(c,b,h,k){c=a.UTILITIES.create_text_element(c);var e=b.get_element(!0),m=document.createElement("div"),x=function(){$(e).parent().addClass("toontalk-conditions-container");if(b.visible()){b.update_display();var c={width:$(m).width(),
height:$(m).height(),left:"",top:""};b.use_scaling_transform?b.use_scaling_transform(c):b.is_backside()&&a.UTILITIES.scale_element(e,c.width,c.height,b.get_original_width()||$(e).width(),b.get_original_height()||$(e).height(),void 0,c);$(e).is(".toontalk-box")||$(e).is(".toontalk-image-element")||$(e).is(".toontalk-number")||$(e).css(c);b.rerender()}};$(e).addClass("toontalk-conditions-contents "+k);h.match_status&&(h.match_status.is_widget?$(h.match_status.get_frontside_element()).addClass("toontalk-conditions-not-matched"):
"matched"!==h.match_status&&h.match_status.forEach(function(a){$(a[1].get_element()).addClass("toontalk-conditions-waiting")}));m.appendChild(e);h=a.UTILITIES.create_horizontal_table(c,m);$(h).addClass("toontalk-conditions-panel");a.UTILITIES.run_when_dimensions_known(e,function(){setTimeout(x,100)});return h},c=function(c,b){var e=b.get_frontside_conditions(),m=b.get_backside_conditions(),g=b.visible(),v;e&&(e.is_top_level()?0>c.firstChild.textContent.indexOf("I always run when the green flag")&&
c.insertBefore(a.UTILITIES.create_text_element("I always run when the green flag <span class='toontalk-green-flag-icon'></span> is clicked."),c.firstChild):0>c.firstChild.textContent.indexOf("I run only if the thing I'm on the back of matches: ")&&c.insertBefore(k("I run only if the thing I'm on the back of matches: ",e,b,"toontalk-frontside-conditions-area"),c.firstChild),e.set_visible(g),e.rerender());m&&0===$(c).find(".toontalk-backside-condition").length&&m.forEach(function(e){if(e){var h=e.is_backside()?
"on-backside":e.get_type_name();v="toontalk-backside-"+h+"-conditions-area toontalk-backside-condition";if("bird"===h){if(0===$(c).find(".toontalk-bird-on-back-condition").length){var m=a.UTILITIES.create_text_element("And there is a bird on the back.");$(m).addClass("toontalk-bird-on-back-condition toontalk-backside-condition")}}else m=k("And if "+a.UTILITIES.add_a_or_an(h)+" matches: ",e,b,v);m&&c.insertBefore(m,c.firstChild.nextSibling);e.set_visible(g);e.rerender()}})};return{create:function(e){var b=
a.backside.create(e),h=b.get_element(),k=function(a){return a?"Check this if you want the robot to start over again after finishing what he was trained to do.":"Uncheck this if you want the robot to stop after finishing what he was trained to do."},g=a.UTILITIES.create_check_box(!e.get_run_once(),"toontalk-run-once-check-box","When finished start again",k(e.get_run_once())),v="normal;original;double;half;very fast;very slow".split(";"),x=[1,0,2,.5,10,.25],p=function(a){a=v.indexOf(a);return x[a]},
q=a.UTILITIES.create_select_menu("robot_speed",v,"toontalk-select-function","  What speed should I run at? ","Click to select the speed I'll run when watched.","The normal speed for each step;The original delay between steps when I was trained;Double the normal speed;Half the normal speed;Ten times normal speed;One-fourth of normal speed".split(";")),A=a.UTILITIES.create_drop_area(e.drop_area_instructions()),y=e.get_next_robot(),z=a.backside.create_advanced_settings_button(b,e),n=b.update_display.bind(b),
w=function(a,b){var c=a.get_frontside_element(!0);if(a.get_default_width){var e=a.get_default_width();a=a.get_default_height();$(c).css({left:"",top:"",width:e,height:a})}b.appendChild(c)},I=b.hide_backside,D=b.add_advanced_settings;b.hide_backside=function(a){I.call(this,a);e.being_trained&&e.training_finished()};$(A).data("drop_area_owner",e);g.button.addEventListener("click",function(b){var c=g.button.checked;e.set_run_once(!c);a.UTILITIES.give_tooltip(g.container,k(!c));e.robot_in_training()&&
e.robot_in_training().edited(e,{setter_name:"set_run_once",argument_1:!c,toString:"change to "+(c?"run again":"run once")+" of the robot",button_selector:".toontalk-run-once-check-box"});b.stopPropagation()});$(q.menu).val(function(a){a=void 0!==a?x.indexOf(a):0;return v[a]}(e.get_watched_speed())).selectmenu("refresh");$(q.menu).on("selectmenuselect",function(a){e.set_watched_speed(p(a.target.value))});y&&w(y,A);A.addEventListener("drop",function(b){(b=a.UTILITIES.get_dragee())&&b.is_robot()&&(b.get_body().is_empty()?
(b=b.open_backside())&&$(b.get_element()).find(".toontalk-train-backside-button").click():(w(b,A),e.set_next_robot(b)))});b.get_next_robot_area=function(){return A};b.update_display=function(){var b=e.get_frontside_element();b&&a.UTILITIES.give_tooltip(b,e.get_title());this.change_label_and_title_of_train_button(this.get_widget().being_trained);n()};a.UTILITIES.when_attached(h,function(){var a=e.get_backside_conditions(),b=e.get_frontside_conditions();a&&a.forEach(function(a){a.set_visible(!0)});
b&&b.set_visible(!0)});h.appendChild(this.create_train_button(b,e));c(h,e);h.appendChild(z);b.add_advanced_settings=function(){D.call(b,g.container,q.container,A)};return b},create_train_button:function(e,b){var h=e.get_element();$(h);var k=$("<button>Train</button>").button(),g=!1;k.addClass("toontalk-train-backside-button toontalk-button-style");e.change_label_and_title_of_train_button=function(e){jQuery.contains(window.document,k.get(0))&&(k.is(".ui-button")||k.button(),e?(k.button("option","label",
"Stop training "+b.get_name()),a.UTILITIES.give_tooltip(k.get(0),"Click to stop training this robot.")):b.get_body().is_empty()?(k.button("option","label","Train"),a.UTILITIES.give_tooltip(k.get(0),"Click to start training this robot.")):(k.button("option","label","Re-train "+b.get_name()),a.UTILITIES.give_tooltip(k.get(0),"Click to start training this robot all over again.")),a.UTILITIES.visible_element(h)&&c(h,b))};e.change_label_and_title_of_train_button(g);k.get(0).addEventListener("click",function(a){g=
!g;e.change_label_and_title_of_train_button(g);g?(b.initialize_backside_conditions(),b.get_body().reset_steps(),b.robot_started_training(b),b.training_started()):b.training_finished();a.stopPropagation()});k.css({display:"block"});return k.get(0)}}}(window.TOONTALK)})();(function(){var a=function(a){return"rotate"===a||"skewX"===a||"skewY"===a||"transform-origin-x"===a||"transform-origin-y"===a},k=function(c){return"transform-origin-x"===c||"transform-origin-y"===c?"https://developer.mozilla.org/en-US/docs/Web/CSS/transform-origin#"+c:a(c)?"https://developer.mozilla.org/en-US/docs/Web/CSS/transform#"+c:"http://www.w3.org/community/webed/wiki/CSS/Properties/"+c};window.TOONTALK.element=function(c){var e=["left","top","width","height"],b=Object.create(c.widget),h=
function(a,b){var c;if(!a)return 0;"number"===typeof a&&(c=a);0===a.length&&(c=0);if("undefined"===typeof c){var e=a.substring(a.length-1);if(0<="0123456789x".indexOf(e)&&(c=parseFloat(a),isNaN(c)))return}a=c;0<=["rotate","skewX","skewY"].indexOf(b)?(b=a%360,0>b&&(b+=360)):b=a;return b},m=function(a,b){if((b.left||b.top)&&!a.being_dragged){var c=a.get_parent_of_frontside();var e=$(a.get_element()).width();a=$(a.get_element()).height();if(c){if(b.left){var g=c.is_element()?c.get_original_width():c.get_width();
if(b.left<e/-2||b.left>g+e/2)if(e=0<g?(b.left%g+g)%g:b.left,b.left!==e){b.left=e;var h=!0}}b.top&&(c=c.is_element()?c.get_original_height():c.get_height(),b.top<a/-2||b.top>c+a/2)&&(c=0<c?(b.top%c+c)%c:b.top,b.top!==c&&(b.top=c,h=!0));return h}}};b.create=function(e,h,k,p,q,A,y,z){var g=Object.create(b),v=c.UTILITIES.generate_unique_id(),x=g.drag_started,D={},K={},E,O,J,V,N,P,G,Q,T,U,F,d,f;h||(h=["left","top","width","height"]);g.is_element=function(){return!0};g.is_resizable=function(){return!0};
g.get_HTML=function(){return V};g.get_guid=function(){return v};g.get_text=function(){var a,b;return void 0===N&&((a=this.get_frontside_element())?N=a.textContent:(a=(b=this.get_HTML())&&"<"==b[0]&&$(b).get(0))?(document.body.appendChild(a),N=a.textContent,$(a).remove()):N=b,""===N&&a&&"IMG"!==a.nodeName&&(this.update_display(),N=a.textContent),""===N)?this.get_HTML():N};g.set_HTML=function(a){var b=this.get_frontside_element(),d=function(a){for(var b=0,d,c;;){b=a.indexOf("<a ",b);if(0>b)break;d=
a.indexOf(">",b);if(0>d)break;b+=3;c=a.indexOf("target='_blank'",b);if(0>c||c>d)a=a.substring(0,b)+"target='_blank'"+a.substring(b)}0===a.indexOf("data:image")?a="<image src='"+a+"'>":0===a.indexOf("data:audio")?a="<audio src='"+a+"'>":0===a.indexOf("data:video")&&(a="<video src='"+a+"'>");""===a&&(a="&thinsp;");return a}.bind(this);if(V===a)return!1;this.initialize_element();V=d(a);N=void 0;if(!b)return!1;$(b).children(":not(.ui-resizable-handle)").remove();this.is_plain_text_element();b.innerHTML=
V;P&&this.compute_original_dimensions(!0);return!0};g.set_HTML_from_sub_classes=g.set_HTML;g.set_text=function(a){var b=this.get_frontside_element(),d=function(c){c=$(c).contents();0===c.length?b.textContent=a:c.each(function(){this.nodeType==Node.TEXT_NODE?(this.textContent=a,a=""):d(this,a)})};if(!b||a===b.textContent)return!1;if($(b).is(".toontalk-plain-text-element"))return this.set_HTML(a);d(b);return this.set_HTML(b.innerHTML)};g.get_style_attributes=function(){return h};g.set_style_attributes=
function(a){h=a};g.get_attribute_widgets_in_backside_table=function(){return D};g.set_attribute_widgets_in_backside_table=function(a){D=a};g.get_original_copies=function(){return K};g.get_pending_css=function(){return F};g.get_transform_css=function(){return d};g.add_to_css=function(b,c){a(b)?(d||(d={}),d[b]=c):(F||(F={}),F[b]=c)};g.apply_css=function(){var a="",b,e,f;if((e=this.get_frontside_element())&&!$(e).is(".toontalk-not-observable"))if(jQuery.contains(window.document,e)){if(this.is_plain_text_element()){F||
(F={});(f=(b=this.get_parent())&&(b.is_nest()||b.is_hole()||b.is_robot()))?(b=this.get_parent().get_contents_dimensions(),T=b.width,U=b.height,this.plain_text_dimensions(T,U)):b=T?{width:T,height:U}:{width:c.UTILITIES.get_element_width(e),height:c.UTILITIES.get_element_height(e)};if(b.width&&f){F["font-size"]=c.UTILITIES.font_size(this.get_text(),b.width,{height:b.height});F.width=b.width;F.height=b.height;F.transform="";$(e).css(F);F=void 0;return}F.width||F.height?F["font-size"]=c.UTILITIES.font_size(this.get_text(),
F.width||b.width,{height:F.height||b.height}):(F["font-size"]="",F.width="",F.height="");if(!d){$(e).css(F);return}}if(F||d)if(F?(F.width&&(T=F.width),F.height&&(U=F.height)):F={},F.position="absolute",d&&("number"===typeof d.rotate&&(a+="rotate("+d.rotate+"deg)"),"number"===typeof d.skewX&&(a+="skewX("+d.skewX+"deg)"),"number"===typeof d.skewY&&(a+="skewY("+d.skewY+"deg)"),"number"===typeof d["transform-origin-x"]||"number"===typeof d["transform-origin-y"])&&(F["transform-origin"]=(d["transform-origin-x"]||
0)+" "+(d["transform-origin-y"]||0)),$(e).is(".toontalk-conditions-contents")&&this.is_image_element())$(e).children("img").css({"max-width":"100%",height:"100%"}),$(e).css({transform:""}),F=void 0;else if(T||U)if(m(this,F),a&&c.UTILITIES.add_transform_to_css(a,"",F,0>e.parentElement.className.indexOf("toontalk-box-hole")),!this.constrained_by_container()&&this.is_plain_text_element())$(e).css(F);else{$(e).css({width:"",height:""});var g=F;c.UTILITIES.run_when_dimensions_known(e,function(b){var d=
this.get_parent_of_frontside();m(this,g);$(e).is(".toontalk-conditions-contents")&&this.directly_inside_conditions_container()&&(T=c.UTILITIES.get_toontalk_css_numeric_attribute("width",".toontalk-conditions-container"),U=c.UTILITIES.get_toontalk_css_numeric_attribute("height",".toontalk-conditions-container"));(this.ok_to_set_dimensions()||this.constrained_by_container())&&c.UTILITIES.scale_element(e,T,U,G,Q,a,g,b,!d);F=void 0}.bind(this))}else m(this,F),c.UTILITIES.add_transform_to_css(a,"",F,0>
e.parentElement.className.indexOf("toontalk-box-hole")),$(e).css(F),F=void 0}else c.UTILITIES.when_attached(e,this.apply_css.bind(this))};g.on_update_display=function(a){f?f.push(a):f=[a]};g.fire_on_update_display_handlers=function(){f&&c.UTILITIES.set_timeout(function(){f.forEach(function(a,b){a()||f.splice(b,1)})})};g.is_image_element=function(){return 0<$(this.get_frontside_element()).children("img").length};g.get_additional_classes=function(){return z};g.set_additional_classes=function(a){z=a};
g.get_children=function(){return p};g.get_child=function(a){if(p)return p[a]};g.set_sound_effect=function(a){E=a;E.volume=c.UTILITIES.get_audio_volume(E)};g.get_sound_effect=function(){return E};g.get_video_object=function(){var a;O||(a=this.get_frontside_element())&&(O=a.getElementsByTagName("video")[0]);return O};g.set_video_object=function(a){O=a};g.get_ignore_pointer_events=function(){return y};g.set_ignore_pointer_events=function(a){y=a;$(this.get_frontside_element()).find(":not(ui-resizable-handle)").css({"pointer-events":a?
"none":"auto"})};g.get_source_URL=function(){return J};g.set_source_URL=function(a,b){if(J!==a)return J=a,b||this.refresh(),!0};g.use_scaling_transform=function(a){""===a.width&&(a.width=void 0);""===a.height&&(a.height=void 0);void 0===G?c.UTILITIES.run_when_dimensions_known(this.get_frontside_element(),function(){c.UTILITIES.scale_element(this.get_frontside_element(),a.width,a.height,G,Q,void 0,a)}.bind(this)):c.UTILITIES.scale_element(this.get_frontside_element(),a.width,a.height,G,Q,void 0,a)};
g.add_standard_widget_functionality(g);var r=g.set_running.bind(g);g.set_running=function(a,b){r(a,b);Object.keys(D).forEach(function(d){D[d].set_running(a,b)});!a&&this.visible()&&(h.forEach(function(a){this.add_to_css(a,this.get_attribute(a))}.bind(this)),this.rerender());p.forEach(function(d){d.set_running(a,b)})};var t=g.can_run.bind(g);g.can_run=function(a){var b=a&&a.widgets_considered,d;"undefined"===typeof b&&(b=[]);if(0<=b.indexOf(this))return!1;b.push(this);if(t(a))return!0;Object.keys(D).some(function(b){if(D[b].can_run(a))return d=
!0}.bind(this));if(d)return d;p.some(function(b){if(b.can_run(a))return d=!0});return d};g.drag_started=function(a,b){this.drag_x_offset=a.view.drag_x_offset;this.drag_y_offset=a.view.drag_y_offset;x.call(this,a,b)};g.update_display=function(){var a=this.get_frontside_element(!0);this.get_backside();var d=function(a){return this.is_image_element()?"image":$(a).is(".toontalk-plain-text-element")?"text":"element"}.bind(this);if(!this.being_dragged&&!$(b).is(".toontalk-has-attached-callback"))if(this.get_erased()){var e=
$(a).parent(".toontalk-backside").is("*")?d="":d="100%";this.save_dimensions();$(a).removeClass().empty().addClass("toontalk-erased-element toontalk-side").css({width:d,height:e,position:"",transform:""});this.inside_conditions_container()?c.UTILITIES.give_tooltip(a,"This is an element that has been erased. It will match any element."):c.UTILITIES.give_tooltip(a,"This is an erased element. It will replace its HTML with the HTML of the element you drop on it.")}else $(a).is(".toontalk-erased-element")&&
($(a).removeClass("toontalk-erased-element"),this.restore_dimensions()),P||this.initialize_element(),this.is_plain_text_element()&&(this.constrained_by_container()?$(a).css({width:"",height:""}):this.plain_text_dimensions()),"undefined"===typeof G&&a.parentElement&&(this.is_plain_text_element()?this.plain_text_dimensions():this.compute_original_dimensions()),this.apply_css(),p?p.forEach(function(b){try{a.appendChild(b.get_frontside_element(!0))}catch(u){}b.set_visible(!0);b.update_display()}):p=[],
this.fire_on_update_display_handlers(),c.open_backside_only_if_alt_key||c.UTILITIES.give_tooltip(a,"Click to see the backside where you can place robots or change the style of this "+d(a)+"."),this.set_ignore_pointer_events(this.get_ignore_pointer_events())};g.initialize_element=function(){var a=this.get_frontside_element(),b;a&&(V=this.get_HTML(),a.innerHTML=V,$(a).addClass("toontalk-element-frontside"),this.is_plain_text_element()?((b=this.get_additional_classes())&&$(a).addClass(b),$(a).addClass("ui-widget toontalk-plain-text-element")):
this.is_image_element()?$(a).addClass("toontalk-image-element"):$(a).addClass("toontalk-non-plain-text-element"),P=!0)};g.is_plain_text_element=function(){var a=this.get_HTML();if(a)return!a.match(/<\w/)};g.plain_text_dimensions=function(a,b){this.constrained_by_container()||(this.get_frontside_element(),G=a||12*this.get_text().length,Q=b||32,this.saved_width=G,this.saved_height=Q)};g.compute_original_dimensions=function(a){c.UTILITIES.original_dimensions(this,function(a,b){var d=this.get_parent_of_frontside();
G=a;Q=b;d&&d.get_box?d.get_box().rerender():(h.forEach(function(a){this.add_to_css(a,this.get_attribute(a))}.bind(this)),this.rerender())}.bind(this),a)};g.get_attribute_from_current_css=function(a){if("width"===a&&(T||G))return T||G;if("height"===a&&(U||Q))return U||Q;var b=this.get_frontside_element(!0);var d=c.UTILITIES.get_style_numeric_property(b,a);""===d&&(d=$(b).css(a));if(!d)return 0;if("number"===typeof d){if(G&&U){if("left"===a)return d+(G-T)/2;if("top"===a)return d+(Q-U)/2}return d}return"%"!==
d.charAt(d.length-1)||"left"!==a&&"top"!==a?d:$(b).offset()[a]};g.get_original_width=function(){return G};g.get_original_height=function(){return Q};g.increment_width=function(a){this.set_attribute("width",(T||G)+a)};g.increment_height=function(a){this.set_attribute("height",(U||Q)+a)};g.get_width=function(){return T};g.get_height=function(){return U};g.add_child=function(a){var b=$(a.get_frontside_element(!0)),d=$(this.get_frontside_element(!0));p.push(a);a.set_parent_of_frontside(this);var e=c.UTILITIES.set_position_relative_to_element(b,
d,b.offset(),!0);a.is_element()&&a.set_location_attributes(e.left,e.top);d.get(0).dispatchEvent(c.UTILITIES.create_event("widget added",{element_widget:b.get(0),where:"front"}));this.robot_in_training()&&this.robot_in_training().dropped_on(a,this)};g.removed_from_container=function(a,b){a=p.indexOf(a);0<=a&&p.splice(a,1)};g.set_HTML(e.toString());g.set_description(k);q&&("string"===typeof q?(0>q.indexOf("http")&&0>q.indexOf("data:")&&(q=c.TOONTALK_URL+q),g.set_sound_effect(new Audio(q))):g.set_sound_effect(q));
A&&("string"===typeof A?g.set_HTML("<video src='"+A+"'/>"):g.set_video_object(A));c.debugging&&(g._debug_id=c.UTILITIES.generate_unique_id(),g._debug_string=g.to_debug_string());p?p.forEach(function(a){a.set_parent_of_frontside(g)}):p=[];return g};b.copy=function(a){var e=this.get_style_attributes(),g=b.create(this.get_HTML(),e.slice(),this.get_description(),c.UTILITIES.copy_widgets(this.get_children()),this.get_sound_effect(),this.get_video_object(),this.get_ignore_pointer_events()),h=this.get_attribute_widgets_in_backside_table(),
k={},m=g.get_backside(this.visible());g.set_source_URL(this.get_source_URL());a&&(a.elements_copied||(a.elements_copied={}),a.elements_copied[this.get_guid()]=g);Object.keys(h).forEach(function(b){k[b]=h[b].copy(a);k[b].set_parent_of_frontside(m,!1,!0);g.set_attribute(b,this.get_attribute(b))}.bind(this));g.set_attribute_widgets_in_backside_table(k);return this.add_to_copy(g,a)};b.match=function(a){if(this.get_erased&&this.get_erased()){if(a.match_with_any_element)return a.match_with_any_element();
this.last_match=a;return this}return a.match_with_another_element_widget?a.match_with_another_element_widget(this):(this.last_match=a,this)};b.match_with_any_element=function(){return"matched"};b.match_with_another_element_widget=function(a){if(this.get_HTML()===a.get_HTML())return"matched";var b=a.get_text();if(""!==b&&b===this.get_text())return"matched";a.last_match=this;return a};b.compare_with=function(a){if(a.compare_with_other_element)return a.compare_with_other_element(this)};b.compare_with_other_element=
function(a){a=a.get_HTML().localeCompare(this.get_HTML());return 0>a?-1:0<a?1:a};b.get_path_to=function(a,c){var e=this.get_children(),g=e.indexOf(a),h,k;if(0<=g)return b.path.create(g);e.forEach(function(e,g){e.get_path_to&&(k=e.get_path_to(a,c))&&(h=b.path.create(g),h.next=k)});return h};c.creators_from_json.element_path=function(a,e){var g=b.path.create(a.index);a.next&&(g.next=c.UTILITIES.create_from_json(a.next,e));return g};b.dereference_path=function(a,b){if(a){var e=a.get_index&&a.get_index();
if(!c.debugging||"number"===typeof e){var g=this.get_children();if(e=g[e]){if(e.dereference_contents&&!a.not_to_be_dereferenced)return e.dereference_contents(a.next||a,b);if(a.next){if(e.dereference_path)return e.dereference_path(a.next,b);c.UTILITIES.report_internal_error("Expected to refer to a child of "+e+" but it lacks a method to obtain "+c.path.toString(a.next))}a.removing_widget&&(e.get_infinite_stack()||b.remove_from_container(e,this));return e}}c.UTILITIES.display_message(this+" unable to dereference the path: "+
c.path.toString(a),{only_if_new:!0})}else return this};b.path={create:function(a){return{get_index:function(){return a},toString:function(){return"the "+c.UTILITIES.ordinal(a)+" widget "},get_json:function(b,c,e,g){c({type:"element_path",index:a,next:this.next&&this.next.get_json(b)},e,g+1)}}}};b.widget_side_dropped_on_me=function(a,b){if(a.is_backside())return!1;this.get_erased()&&a.get_HTML?(this.set_HTML(a.get_HTML()),this.set_erased(!1),a.remove()):(this.add_child(a),this.rerender());return!0};
b.create_backside=function(){return c.element_backside.create(this)};b.get_attribute_from_pending_css=function(a){var b=this.get_pending_css();if(b&&b[a]||(b=this.get_transform_css())&&b[a])return b[a]};b.get_attribute=function(a){var b=this.get_attribute_from_pending_css(a);if("left"===a){var e=this.get_frontside_element();e=c.UTILITIES.translate_x(e)}else"top"===a?(e=this.get_frontside_element(),e=c.UTILITIES.translate_y(e)):e=0;return"undefined"!==typeof b&&"auto"!=b?b+e:this.get_attribute_from_current_css(a)+
e};b.set_attribute=function(a,b,e,k){var g=this.get_frontside(!0).get_element(),p=function(b){var c=this.get_original_copies()[a];c&&c.forEach(function(a){a.set_value_from_sub_classes(bigrat.fromDecimal(b))})}.bind(this);if(!g)return!1;var m="left"===a?c.UTILITIES.translate_x(g):"top"===a?c.UTILITIES.translate_y(g):0;g=this.get_attribute_from_pending_css(a);b-=m;if(g===b||"undefined"===typeof g&&(g=this.get_attribute_from_current_css(a),g===b))return!1;m=h(b,a);if("number"===typeof m){if(g==m)return!1;
c.logging&&0<=c.logging.indexOf("attribute:")&&0<=c.logging.indexOf(a)&&console.log("Attribute "+a+" set to "+m+" was "+g+" at "+Date.now()+" for "+this);b=m;"left"!==a&&"top"!==a||p(b)}e&&this.robot_in_training()&&this.robot_in_training().edited(this,{setter_name:"set_attribute",argument_1:a,argument_2:b,toString:"change the '"+a+"' style to "+b+" of",button_selector:".toontalk-element-"+a+"-attribute-input"});this.constrained_by_container()||(this.add_to_css(a,b),k&&(b=this.get_style_attributes(),
0>b.indexOf(a)&&b.push(a)),this.rerender());return!0};b.dropped_on_style_attribute=function(a,b,c){if(a){var e=a.toString();if(a.is_number()){var g=this.get_attribute(b);if("number"===typeof g)var h=g;else if("auto"===g)switch(b){case "left":h=$(this.get_frontside_element()).offset().left;break;case "top":h=$(this.get_frontside_element()).offset().top;break;default:h=0}else h=parseFloat(g);g=a.to_float();switch(e.substring(0,1)){case "-":e=h-g;break;case "*":e=h*g;break;case "/":e=h/g;break;case "^":e=
Math.pow(h,g);break;default:e=h+g}this.set_attribute(b,e,!1);(c.event||c.robot&&c.robot.visible())&&this.get_backside().render()}a.get_infinite_stack()||a.remove();c.event&&this.robot_in_training()&&this.robot_in_training().dropped_on(a,this.create_attribute_widget(b))}};b.get_attribute_widget_in_backside_table=function(a,b,c){var e=this.get_attribute_widgets_in_backside_table()[a];e||b||(e=this.create_attribute_widget(a,c),this.get_attribute_widgets_in_backside_table()[a]=e);return e};b.create_attribute_widget=
function(a,b){var g=".toontalk-element-"+a+"-attribute-input",h=this.get_backside_element();b=this.get_attribute(a);var q=this,v=function(a,b){var e=b.toString,g=b.equals,h=b.remove;I=b.update_display;b.element_widget=this;b.attribute=a;b.get_type_name=function(a){return a?"element attributes":"element attribute"};b.toString=function(){return e.call(this)+" ("+this.attribute+" of "+this.get_attribute_owner()+")"};b.get_default_description=function(){return"a number that is the "+this.attribute+" of "+
this.get_attribute_owner().toString({plain_text:!0})+"."};b.get_custom_title_prefix=function(){return"I'm the '"+this.attribute+"' attribute of "+this.get_attribute_owner().toString({inside_tool_tip:!0})+" \nDrop a number on me or edit my backside to change my value. My backside has an info button to learn more."};b.equals=function(b){return a===b.attribute?this.equals(b.element_widget):g.call(this,b)};b.update_display=function(){if(!this.get_erased()){var a=this.get_attribute_owner();if(a.get_parent_of_frontside()&&
a.get_parent_of_frontside().is_element()&&!a.being_dragged&&!a.constrained_by_container()){var b={};var c=bigrat.toDecimal(this.get_value());b[this.attribute]=c;m(a,b)&&this.set_value(b[this.attribute]);$(a.get_frontside_element()).css(b)}else a=a.get_attribute(this.attribute),isNaN(a)||K(a)}I.call(this)};w=b.copy.bind(b);b.copy=function(b){var c;if(b){if(b.just_value)return w(b);b.elements_copied&&(c=b.elements_copied[q.get_guid()])}return this.add_to_copy((c||q).create_attribute_widget(a),b)};b.get_json=
function(b,e,g,h){c.UTILITIES.get_json(q,b,function(b,d,c){e({type:"attribute_widget",attribute_name:a,element:b},d,c+1)},g,h+1)};b.get_original_attribute_widget=function(){var b=q.get_original_copies()[a];return b&&b[0]};b.is_attribute_widget_copy=function(b){var c=q.get_original_copies()[a];return c&&0<=c.indexOf(b)};b.get_attribute_owner=function(){var a=function(b){if(b=b.get_parent_of_frontside())return b.is_backside()?b:b.is_nest()?void 0:a(b.get_widget())},b;var c=a(this);if(!c)return(c=this.get_original_attribute_widget())&&
c!==this?c.get_attribute_owner():q;if(!c.get_widget().is_element())return q;c=c.get_widget();for(b=c.get_parent_of_backside();b&&b.get_widget().is_element();)c=b.get_widget(),b=c.get_parent_of_backside();return c};b.remove=function(b,c){var e=q.get_original_copies()[a],g=e&&e.indexOf(this);0<=g&&e.splice(g,1);h.call(this,b,c)};b.get_help_URL=function(){return k(a)}}.bind(this),y=function(a,b){var e=c.number.create(0,1);v(a,e);e.set_value_from_decimal(b);e.set_format("decimal");e.set_value=function(b){try{var e=
q.get_original_copies()[a],g="number"===typeof b?b:bigrat.toDecimal(b),h=bigrat.fromDecimal(g);this.get_attribute_owner().set_attribute(this.attribute,g)&&e.forEach(function(a,b){a.set_value_from_sub_classes(h,!0)});return this.set_value_from_sub_classes(h,!1)}catch(T){return c.UTILITIES.report_internal_error("Error while setting the value of an attribute widget: "+T),!1}};e.is_attribute_widget=function(){return!0};e.get_function_type=function(a){return a?"numbers":"number"};return e}.bind(this),
z=function(a,b){b=c.element.create(b);v(a,b);b.set_HTML=function(b){var c=q.get_original_copies()[a],e;this.get_attribute_owner().set_attribute(this.attribute,b)&&c.forEach(function(a,c){e=a.set_HTML_from_sub_classes(b)});return e};b.get_function_type=function(a){return a?"elements":"element"};b.set_additional_classes("toontalk-string-attribute-widget");return b}.bind(this);var n=0<=["background-color","color"].indexOf(a)?"string":"number";var w,I;h&&(g=$(h).find(g),0<g.length&&(g.get(0).toontalk_widget_side=
this));if("number"===n){var D=y(a,b);var K=D.set_value_from_decimal.bind(D);if(0<=e.indexOf(a)&&(this.on_update_display(function(){D.rerender();return!0}),"left"===a||"top"===a)){var E=function(b){if(b.currentTarget.toontalk_widget_side===D.get_attribute_owner()){var c=D.get_attribute_owner();b.stopPropagation();var e=$(c.get_frontside_element()).closest(".toontalk-backside-of-top-level").offset();e||(console.log("Unable to find top-level backside of an element for its position. Perhaps is 'visible' but not attached."),
e={left:0,top:0});var g=b.pageX-e.left-(c.drag_x_offset||0);e=b.pageY-e.top-(c.drag_y_offset||0);"left"===a?(b=g,c.set_attribute("top",e)):(b=e,c.set_attribute("left",g));D.set_value_from_decimal(b);I.call(D)}};D.add_parent_of_frontside_change_listener(function(a,b){a&&a.get_widget().is_element()&&a.get_frontside_element().removeEventListener("drag",E);b&&b.get_widget().is_element()&&b.get_frontside_element()&&b.get_frontside_element().addEventListener("drag",E)})}}else if("string"===n)D=z(a,b),K=
D.set_HTML.bind(D);else{c.UTILITIES.report_internal_error("Unrecognized attribute type: "+n+" for "+a);return}(b=this.get_original_copies()[a])?b.push(D):this.get_original_copies()[a]=[D];return D};c.creators_from_json.attribute_widget=function(a,b){if(a)return c.UTILITIES.create_from_json(a.element,b).create_attribute_widget(a.attribute_name,b)};c.creators_from_json.attribute_number=c.creators_from_json.attribute_widget;b.on_backside_hidden=function(){this.get_style_attributes().forEach(function(a){(a=
this.get_attribute_widget_in_backside_table(a,!0))&&a.set_visible(!1)}.bind(this))};b.toString=function(a){if(this.get_erased())return"any element";var b=function(b){var c="",e=function(a,b,c){var e=b.indexOf(a+"="),g;if(0<=e){var h=b.indexOf("'",e);0<=h&&(g=b.indexOf("'",h+1));if(0<=g)return b.substring(0,e)+a+"="+c+b.substring(g+1)}e=b.indexOf(" ");return b.substring(0,e+1)+a+"="+c+" "+b.substring(e+1)};if(1<b.length&&"<"===b.charAt(0)){if(0===b.indexOf("<img "))return"<img width='60' height='40' "+
b.substring(4);if(this.is_image_element())c="style='width: 60px; height: 40px;'";else if(0<=b.indexOf("<iframe "))return b.indexOf("<iframe "),e("width",e("height",b,"'60'"),"'80'");a&&a.inside_tool_tip&&(c+=" class='toontalk-widget-in-tool-tip'");return"<div "+c+">"+b+"</div>"}return'"'+b+'"'}.bind(this);var e=function(){var a=this.get_HTML(),b=a.indexOf("alt=");if(0<=b){var c=a.indexOf("'",b+5);if(0<=c)return"("+a.substring(b+5,c)+")"}return""}.bind(this);var g=this.get_children();if(a&&!a.inside_tool_tip&&
"conditions"!==a.role){if(a.for_json_div)return"";b=e();b||(b=(b=this.get_source_URL())?"whose text is the contents of "+b:(b=this.get_text())?'"'+b+'"':"")}else b=b(this.get_HTML());g&&0<g.length&&(b+=" with "+c.UTILITIES.describe_widgets(g)+" on top");return"the element "+b};b.get_type_name=function(a){return a?"elements":"element"};b.get_help_URL=function(){return"docs/manual/elements.html"};b.get_json=function(a,b,e,h){var g=this.get_style_attributes(),k=c.UTILITIES.remove_z_index(this.get_HTML()),
m=encodeURIComponent(k),p=[];if(100<=k.length){a.shared_html||(a.shared_html=[]);k=a.shared_html.indexOf(m);0>k&&(k=a.shared_html.push(c.UTILITIES.string_to_array(m,100))-1);var n={shared_html_index:k}}else n=c.UTILITIES.string_to_array(m,100);m=function(){var k=[],m=function(q){var y=function(){m(q+1)},z;if(q>=g.length)b({type:"element",html:n,attributes:g,attribute_values:g.map(this.get_attribute.bind(this)),attributes_backsides:k,additional_classes:this.get_additional_classes(),children:0<this.get_children().length&&
p,sound_effect:this.get_sound_effect()&&c.UTILITIES.string_to_array(this.get_sound_effect().src,100),video:this.get_video_object()&&c.UTILITIES.string_to_array(this.get_video_object().src,100),ignore_pointer_events:this.get_ignore_pointer_events()?!0:void 0,source_URL:this.get_source_URL()},e,h+1,a);else if(z=this.get_attribute_widget_in_backside_table(g[q],!0)){var v=[];k.push(v);c.UTILITIES.get_json_of_array(z.get_backside_widgets(),v,0,a,y,e,h+1)}else k.push(null),y()}.bind(this);m(0)}.bind(this);
0<this.get_children().length?c.UTILITIES.get_json_of_array(this.get_children(),p,0,a,m,e,h+1):m()};c.creators_from_json.element=function(a,e){if(a){Array.isArray(a.html)&&(a.html=a.html.join(""));var g=decodeURIComponent("string"===typeof a.html?a.html:e.shared_html&&e.shared_html[a.html.shared_html_index]);if(a.children){var k=e.is_child;e.is_child=!0;var m=c.UTILITIES.create_array_from_json(a.children,e);e.is_child=k}if(void 0===g&&(g="string"===typeof a.html?"No json.html recreating an element widget.":
"additional_info.shared_html missing while recreating an element widget.",!c.debugging))throw Error(g);a.sound_effect&&Array.isArray(a.sound_effect)&&(a.sound_effect=a.sound_effect.join(""));a.video&&Array.isArray(a.video)&&(a.video=a.video.join(""));var v=b.create(g,a.attributes,a.description,m,a.sound_effect,a.video,a.ignore_pointer_events);var y=e&&e.event?["left","top"]:[];a.attribute_values.forEach(function(b,g){var k=a.attributes[g];g=a.attributes_backsides&&a.attributes_backsides[g];(e.is_child||
0>y.indexOf(k))&&(0!==b||"width"!==k&&"height"!==k)&&v.add_to_css(k,h(b)||b);g&&(b=v.get_attribute_widget_in_backside_table(k,!1,e),c.UTILITIES.add_backside_widgets_from_json(b,g,e))}.bind(this));a.additional_classes&&v.set_additional_classes(a.additional_classes);a.source_URL&&(v.set_source_URL(a.source_URL),v.refresh());m&&c.UTILITIES.when_attached(function(){m.forEach(function(b,e){(e=a.children[e]&&a.children[e].widget&&a.children[e].widget.view)&&c.UTILITIES.set_css(b.get_frontside_element(!0),
{left:e.frontside_left,top:e.frontside_top})})});return v}};b.create_attribute_path=function(a,b){b=c.path.get_path_to(a.element_widget,b,!0);return this.extend_attribute_path(b,a.attribute)};b.refresh=function(){this.get_source_URL()&&c.UTILITIES.create_widget_from_URL(this.get_source_URL(),function(a){a&&this.set_HTML(a.get_HTML())}.bind(this))};b.extend_attribute_path=function(a,b){return{dereference_path:function(c){return(c=a.dereference_path(c,c.get_top_level_context()||c.get_context()))&&c.get_widget().get_attribute_widget_in_backside_table(b)},
toString:function(){return"the '"+b+"' property of "+c.path.toString(a)},get_json:function(e,g,h,k){c.path.get_json(a,e,function(a,c,e){g({type:"path_to_style_attribute",attribute:b,element_widget_path:a},c,e+1)},h,k+1)}}};c.creators_from_json.path_to_style_attribute=function(a,e){e=c.UTILITIES.create_from_json(a.element_widget_path,e);return b.extend_attribute_path(e,a.attribute)};b.set_size_attributes=function(a,b,e){e?(this.add_to_css("width",a),this.add_to_css("height",b)):(this.set_attribute("width",
a),this.set_attribute("height",b));c.UTILITIES.set_timeout(function(){this.rerender();$(this.get_frontside_element()).find("iframe").attr("width",a).attr("height",b-20)}.bind(this))};b.set_location_attributes=function(a,b){this.set_attribute("left",a);this.set_attribute("top",b)};b.receive_HTML_from_dropped=function(a){var b=a.get_text&&a.get_text();a.remove();if(this.set_HTML(b))return this.get_text()};b.receive_URL_from_dropped=function(a){a=a.get_text();if(this.set_source_URL(a))return this.get_source_URL()};
b.add_style_attribute=function(a){var b=this.get_style_attributes();0>b.indexOf(a)&&(b.push(a),"left"===a?(a=this.get_frontside_element(),a.addEventListener("drag",function(a){var b=this.get_backside_element(!0),c=this.get_frontside_element();b&&c&&$(b).find(".toontalk-element-left-attribute-input").val(a.originalEvent.clientX)}.bind(this))):"top"===a&&(a=this.get_frontside_element(),a.addEventListener("drag",function(a){var b=this.get_backside_element(!0),c=this.get_frontside_element();b&&c&&$(b).find(".toontalk-element-top-attribute-input").val(a.originalEvent.clientY)}.bind(this))));
return!0};b.remove_style_attribute=function(a){var b=this.get_style_attributes();a=b.indexOf(a);0<=a&&(b.splice(a,1),this.get_backside().update_style_attribute_chooser());return!0};return b}(window.TOONTALK);window.TOONTALK.element_backside=function(a){var c=function(b,c,e){if(e.visible()){var g=c.get_style_attributes();c.get_frontside_element();$(b).empty();g.forEach(function(g){c.get_attribute(g);var h=document.createElement("tr"),k=document.createElement("td"),m=e.is_primary_backside()?c.get_attribute_widget_in_backside_table(g):
e.get_widget().create_attribute_widget(g),y=m.get_frontside_element(!0);m.set_parent_of_frontside(e,!1,!0);m.set_infinite_stack(!0);b.appendChild(h);h.appendChild(k);k.appendChild(a.UTILITIES.create_text_element(g));k=document.createElement("td");h.appendChild(k);m.set_visible(!0);$(y).addClass("toontalk-element-attribute");k.appendChild(y)})}},b=function(b,c){var e=$("<button>Add or remove my style attributes</button>").button();e.addClass("toontalk-show-attributes-chooser-button");e.get(0).addEventListener("click",
function(g){a.UTILITIES.visible_element(b)?($(b).hide(),e.button("option","label","Add or remove my style attributes"),a.UTILITIES.give_tooltip(e.get(0),"Click to add widgets for my style attributes.")):($(b).show(),e.button("option","label","Hide my style attributes list"),a.UTILITIES.give_tooltip(e.get(0),"Click to hide my list of attributes that can be added or removed."));c.robot_in_training()&&c.robot_in_training().button_clicked(".toontalk-show-attributes-chooser-button",c)});a.UTILITIES.give_tooltip(e.get(0),
"Click to add widgets for my style attributes.");return e.get(0)};return{create:function(e){var h=a.backside.create(e),g=h.get_element();e.get_HTML();var v=document.createElement("table"),x=document.createElement("div"),p=b(x,e),q=a.backside.create_advanced_settings_button(h,e),A=a.UTILITIES.create_check_box(!0,"toontalk-react-to-pointer-check-box","Normal response to mouse","Uncheck this if you don't want the usual browser action to occur when clicked. Useful if this element normally responds to mouse clicks."),
y=a.UTILITIES.get_current_url_boolean_parameter("elementHTML",!0),z=y?"get_HTML":"get_text",n=h.update_display.bind(h),w=h.add_advanced_settings,I;e.initialize_element();var D=e[z]().trim();if(0<D.length&&!e.is_image_element()){var K=function(b){(b=a.UTILITIES.input_area_drop_handler(b,e.receive_HTML_from_dropped.bind(e),e))&&e.robot_in_training()&&e.robot_in_training().dropped_on_text_area(b,e,{area_selector:".toontalk-html-input",setter:"receive_HTML_from_dropped",toString:"for the element's text"})};
var E=a.UTILITIES.create_text_area(D,"toontalk-html-input","My HTML is","Type here to edit the text.",K,void 0,!0);D=function(a){a=E.button.value.trim().replace(/\xA0/g," ");e.get_frontside_element();var b=y?"set_HTML":"set_text";e[b](a)&&e.robot_in_training()&&e.robot_in_training().edited(e,{setter_name:b,argument_1:a,toString:'change the text to "'+a+'"',button_selector:".toontalk-html-input"})};$(E.container).css({width:"100%"});K=60>=E.button.value.length?2:600>E.button.value.length?Math.ceil(E.button.value.length/
60):10;$(E.button).css({width:"95%",height:K+"em"});E.button.addEventListener("change",D);E.button.addEventListener("mouseout",D);e.is_plain_text_element()&&g.appendChild(E.container);if(e.get_source_URL()){K=function(b){var c=a.UTILITIES.input_area_drop_handler(b,e.receive_URL_from_dropped.bind(e),e);c&&e.robot_in_training()&&e.robot_in_training().dropped_on_text_area(c,e,{area_selector:".toontalk-URL-input",setter:"receive_URL_from_dropped",toString:"for the URL source of the text"});b.stopPropagation()};
D=function(a){a=O.button.value.trim().replace(/\xA0/g," ");e.get_frontside_element();e.set_source_URL(a)&&e.robot_in_training()&&e.robot_in_training().edited(e,{setter_name:"set_source_URL",argument_1:a,toString:'change the source URL to "'+a+'"',button_selector:".toontalk-URL-input"})};var O=a.UTILITIES.create_text_input(e.get_source_URL(),"toontalk-URL-input","","Edit the URL where this text comes from.",void 0,void 0,K);O.button.addEventListener("change",D);O.button.addEventListener("mouseout",
D);g.appendChild(O.container)}}h.update_style_attribute_chooser=function(){var b=function(b,e,d){var f=0<=d.get_style_attributes().indexOf(b),g=a.UTILITIES.create_check_box(f,"toontalk-style-attribute-check-box",b+"&nbsp;","Click to add or remove the '"+b+"' style attribute from my backside."),h="toontalk-style-attribute-check-box-for-"+b;f=a.UTILITIES.create_anchor_element("i",k(b));var n=document.createElement("li"),m=function(a){g.button.checked?d.add_style_attribute(b):d.remove_style_attribute(b);
c(v,d,d.get_backside());d.robot_in_training()&&d.robot_in_training().edited(d,{setter_name:g.button.checked?"add_style_attribute":"remove_style_attribute",argument_1:b,toString:(g.button.checked?"add":"remove")+" a widget for the "+b+" attribute of",button_selector:"."+h})};$(f).addClass("toontalk-help-button notranslate toontalk-attribute-help-button");$(f).css({color:"white"});f.translate=!1;f.lang="en";g.container.appendChild(f);$(g.button).addClass(h);g.button.addEventListener("click",m);g.button.addEventListener("touchstart",
function(a){g.button.checked=!g.button.checked;m(a)});n.appendChild(g.container);e.appendChild(n)},g=function(a,c,d){if("string"===typeof a)b(a,c,d);else if(a.label){var e=document.createElement("h3");e.textContent=a.label;var h=document.createElement("ul");c.appendChild(e);c.appendChild(h);g(a.sub_menus,h,d)}else a.forEach(function(a){g(a,c,d)})};$(x).is(".ui-accordion")&&$(x).accordion("destroy");$(x).empty();g([{label:"Geometry attributes",sub_menus:"left top width height z-index background-position".split(" ")},
{label:"Color attributes",sub_menus:["background-color","color","opacity"]},{label:"Font attributes",sub_menus:["font-size","font-weight"]},{label:"Visibility",sub_menus:["display","visibility"]},{label:"Transformations",sub_menus:["rotate","skewX","skewY","transform-origin-x","transform-origin-y"]}],x,e);$(x).accordion({active:0,heightStyle:"content"});return x};h.get_attributes_chooser=function(){return x};h.add_advanced_settings=function(){w.call(h);var a=$(g).children(".toontalk-advanced-settings-table");
0<a.length&&(a.get(0).appendChild(A.container),a.get(0).appendChild(x),a.get(0).appendChild(p),E&&!e.is_plain_text_element()&&a.get(0).appendChild(E.container))};if(I=e.get_sound_effect()){var J=function(){h.visible()&&(I.paused?(a.UTILITIES.give_tooltip(V.get(0),"Click to begin playing this sound."),V.button("option","label","Play sound")):(a.UTILITIES.give_tooltip(V.get(0),"Click to pause this sound."),V.button("option","label","Pause sound")))};var V=$("<button>Play sound</button>").button();V.addClass("toontalk-play-sound-effect-button");
D=function(b){I.paused?(a.UTILITIES.play_audio(I),I.addEventListener("ended",J)):I.pause();J();e.robot_in_training()&&e.robot_in_training().button_clicked(".toontalk-play-sound-effect-button",e)};V.get(0).addEventListener("click",D);J();g.appendChild(V.get(0))}else if(e.get_video_object()){var N=e.get_video_object();var P=function(b){h.visible()&&(N.paused?(a.UTILITIES.give_tooltip(G.get(0),"Click to begin playing this video."),G.button("option","label","Play video")):(a.UTILITIES.give_tooltip(G.get(0),
"Click to pause this video."),G.button("option","label","Pause video")))};var G=$("<button>Play video</button>").button();G.addClass("toontalk-play-video-button");D=function(a){N.paused?(N.play(),N.addEventListener("ended",P)):N.pause();P();e.robot_in_training()&&e.robot_in_training().button_clicked(".toontalk-play-video-button",e)};G.get(0).addEventListener("click",D);P();g.appendChild(G.get(0))}h.update_style_attribute_chooser();c(v,e,h);0<e.get_style_attributes().length?g.appendChild(v):e.is_plain_text_element()||
g.appendChild(a.UTILITIES.create_text_element("No attributes enabled. Click the <span class='toontalk-button-style'>></span> button to see the advanced options."));g.appendChild(q);$(x).hide();$(x).addClass("toontalk-attributes-chooser");h.update_display=function(){E&&$(E.button).val(e[z]());c(v,e,h);a.UTILITIES.visible_element(x)&&h.update_style_attribute_chooser();e.get_backside_widgets().forEach(function(a){a&&a.get_widget().is_attribute_widget()&&a.rerender()});n()};$(g).find(".toontalk-hide-backside-button").each(function(a,
b){b.addEventListener("click",function(){$(x).hide()})});A.button.checked=!e.get_ignore_pointer_events();A.button.addEventListener("click",function(){e.set_ignore_pointer_events(!A.button.checked)});A.button.addEventListener("touchstart",function(){A.button.checked=!A.button.checked;e.set_ignore_pointer_events(!A.button.checked)});return h}}}(window.TOONTALK);window.TOONTALK.element.function=function(a){var c=a.create_function_table(),b=function(b){return b?a.UTILITIES.add_a_or_an(b.get_type_name()):
"an empty hole"};c.add_function_object("join text",function(e,k){var g="";return c.typed_bird_function(e,function(){var e=arguments[arguments.length-1];for(i=0;i<arguments.length-1;i++){if(!arguments[i]||!arguments[i].get_text){c.report_error("The 'join text' bird is unable to turn "+b(arguments[i])+" into text to join.",e);return}g+=arguments[i].get_text()}return a.element.create(g)},[void 0],"join",k)},"The bird will return with a new element that is made by joining all the elements and numbers.",
"join",["any number of numbers or elements"]);c.add_function_object("part of text",function(b,e){return c.typed_bird_function(b,function(b,e,h,k){if(e&&e.to_float)return e=Math.round(e.to_float()-1),h=h&&h.to_float&&Math.round(h.to_float()-1),a.element.create(b.get_text().substring(e,h));c.report_error("The 'part of text' bird is unable to find the text in the second hole. ",k||h)},["element","number","number"],"part of text",e,2,3)},"The bird will return with a new element whose text is the part of the text of the first element (or number) beginning with the first number ending with the second number. 1 is for the first letter.",
"part",["an element followed by two postive numbers"]);c.add_function_object("length of text",function(e,k){return c.typed_bird_function(e,function(e,h){if(e.get_text)return a.number.create(e.get_text().length);c.report_error("The 'length of text' bird could not turn "+b(e)+" into a text to find its length.",h)},[void 0],"length of text",k,1)},"The bird will return with a number that is length of the text of the first element (or number).","length",["an element or number"]);c.add_function_object("text as number",
function(e,k){return c.typed_bird_function(e,function(e,h){if(e&&e.get_text)return e=e.get_text(),h=e.indexOf("/"),0<=h?h=a.number.create(e.substring(0,h),e.substring(h+1,e.length)):(h=a.number.create(0),h.set_value_from_decimal(e)),h;c.report_error("The 'text as number' bird could not turn "+b(e)+" into a text to turn it into a number.",h)},[void 0],"text as number",k,1,1)},"The bird will return with a number that has the same text as the element. Arithmetic can be done on the result unlike the original text.",
"text as number",["an element"]);c.add_function_object("read page",function(e,k){return c.typed_bird_function(e,function(g,h){if(g.get_text){var m=g.get_text();a.UTILITIES.download_file(m,function(b){null===b&&(b="Unable to read "+m);b=a.element.create(b,[],"what was in "+m);c.process_response(b,h,e,k)})}else c.report_error("The 'read page' bird could not turn "+b(g)+" into a text to use it as a URL.",h)},["element"],"read page",k,1,1)},"The bird will return with the contents of the URL.","read URL",
["an element containing a URL"]);c.add_function_object("go to page",function(a,e){return c.typed_bird_function(a,function(a,e){this.robot_in_training()?this.robot_in_training().display_message("Robot trained to replace current URL."):a.get_text?window.location.assign(a.get_text()):c.report_error("The 'go to page' bird could not turn "+b(a)+" into a text to use it as a URL.",e)},["element"],"replace page",e,1,1)},"The bird will cause the current page to be replaced by the new URL. The back button should return to the current page.",
"page",["an element containing a URL"]);c.add_function_object("speak",a.widget.get_speak_function(c),"The bird will cause the browser to speak what is in the second box hole. Other holes can have numbers describing the <a href='https://developer.mozilla.org/en-US/docs/Web/API/SpeechSynthesisUtterance'>volume, pitch, rate, voice_number, and language</a>. Might do nothing in <a href='http://caniuse.com/#search=speech%20syn'>some browsers</a>.","speak",["a widget"]);c.add_function_object("listen",a.widget.get_listen_function(c),
"The bird will cause the browser to listen to the next thing said and give the words to the bird in the first hole. If you put a number between 0 and 1 in the second hole then only recognitions with at least that confidence will be considered. if you put in the third hole words or phrases separted by | then the recogniser will expect one of those words or phrases.","listen",[]);c.add_function_object("show message",function(b,e){return c.typed_bird_function(b,function(b,c,e,h,k){var g=c&&c.to_float?
{duration:1E3*c.to_float()}:{duration:1E4};g.user_initiated=!0;if(this.robot_in_training())this.robot_in_training().display_message("Robot trained to display: "+b.get_text(),g);else if(b.is_plain_text_element())a.UTILITIES.display_message(b.get_text(),g);else{var m=b.get_frontside_element();b.is_resizable()&&(b.remove({do_not_remove_children:!0}),c=e?e.to_float():240,h=h?h.to_float():80,a.UTILITIES.set_css(m,{width:c,height:h,left:-1E3,top:-1E3}),b.set_size_attributes&&b.set_size_attributes(c,h),
document.body.appendChild(m));b.update_display();setTimeout(function(){$(m).css({left:"",top:""});a.UTILITIES.display_message(m.outerHTML,g);$(m).remove()},1E3)}},[void 0,"number","number","number"],"show message",e,1,4)},"The bird will cause what is in the second box hole to be displayed. The third hole can be a number indicating how many seconds the message should be displayed. The 4th and 5th hole can contain the width and height.","display",["a widget","number"]);return c.get_function_table()}(window.TOONTALK)})();window.TOONTALK.sensor=function(a){var k=Object.create(a.widget),c=function(a,b){"element"===a.get_type_name()&&(a.set_additional_classes("toontalk-string-value-from-sensor"),b.visible()&&a.rerender())};k.create=function(e,b,h,k,g,v,x){var m=a.nest.create(h,k,"sensor",void 0,void 0,x||"sensor"),q=m.get_json,A=m.update_display,y=m.set_running,z=m.copy,n=b.split(" "),w=function(b){switch(typeof b){case "number":b=a.number.create(Math.round(b),1);break;case "string":b=a.element.create(b,void 0,void 0,
void 0,void 0,void 0,"toontalk-string-value-from-sensor");c(b,m);break;case "boolean":b=a.element.create(b.toString(),void 0,void 0,void 0,void 0,void 0,"toontalk-string-value-from-sensor"),c(b,m)}return b},I=function(b){if(m.get_active()){var c=K(b);var g=m.get_attributes();var h=m.visible();b=$(m.get_frontside_element()).closest(".toontalk-backside-of-top-level");if(1===c.length){if(c=w(c[0]),"undefined"===typeof c)return}else c=a.box.create(c.length,!0,c.map(w),"the values of the "+a.UTILITIES.conjunction(g)+
" attributes of "+a.UTILITIES.add_a_or_an(e)+" event.",g.join(";"));h?(h=a.bird.create(m),m.add_to_top_level_backside(h),c.render(),h.animate_delivery_to(c,m,{nest_recieving_message:m,temporary_bird:!0,starting_left:b.width()/2,starting_top:b.height()})):m.add_to_contents(c)}}.bind(this);m.is_sensor=function(){return!0};m.copy=function(b){if(b&&b.just_value&&this.has_contents())return z.call(this,b);var c=b?a.sensor.create(e,this.get_attributes_string(),h,void 0,b.copying_resource||g,v,this.get_name()):
a.sensor.create(e,this.get_attributes_string(),h,void 0,g,v,this.get_name());c=m.add_to_copy(c,b);c.set_active(this.get_active());return c};m.get_json=function(b,c,h,k){var m=function(h,k,m){h.type="sensor";h.event_name=e;h.attribute=this.get_attributes_string();h.active=g;if(v){var n=function(a){h.sensor_of=a;c(h,k,m+1)};a.UTILITIES.get_json(v,b,n,k,m+1)}else c(h,k,m+1)}.bind(this);q.call(this,b,m,h,k+1)};m.update_display=function(){var a=$(this.get_frontside_element());A.call(this);g||a.is(".toontalk-top-level-resource")?
(a.addClass("toontalk-sensor-nest"),a.removeClass("toontalk-sensor-inactive-nest")):(a.addClass("toontalk-sensor-inactive-nest"),a.removeClass("toontalk-sensor-nest"));a.removeClass("toontalk-empty-nest")};m.get_type_name=function(a){return a?"sensors":"sensor"};m.get_help_URL=function(){return"docs/manual/sensors.html"};m.toString=function(){return"a sensor that receives the '"+this.get_attributes_string()+"' attribute of "+e+" events"};m.get_class_name_with_color=function(a){return a};m.get_active=
function(){return!0===g};m.restore_active=function(){"temporarily false"===g&&this.set_active(!0)};m.set_active=function(a,b){if(g!==a||b)!0===a?v?v.get_frontside_element(!0).addEventListener(e,I):window.addEventListener(e,I):v?v.get_frontside_element(!0).removeEventListener(e,I):window.removeEventListener(e,I),g=a};m.set_running=function(a){this.set_active(a);y.call(this,a)};m.set_active(g,!0);m.create_backside=function(){return a.sensor_backside.create(this)};m.get_event_name=function(){return e};
m.set_event_name=function(a){var b=g;e&&g&&this.set_active(!1);e=a;b&&this.set_active(!0)};m.get_attributes=function(){return n};m.set_attributes=function(a){n=a.split(" ")};m.get_attributes_string=function(){return n.join(" ")};m.match=function(a){this.last_match=a;return this};m.set_sensor_of=function(a){v=a};m.get_custom_title_prefix=function(){var a="When a '"+e+"' event"+(v?" to "+v:"")+" occurs my bird will bring me the '"+this.get_attributes_string()+"' attribute of the event.";g?this.get_backside()||
(a+=" On my back you can change which kind of events and attributes I receive."):a+=" But I'm deactivated and can't receive anything until the green flag <span class='toontalk-green-flag-icon'></span> is clicked or the 'Listening to events' check box on my back is ticked.";return a};m.get_default_description=function(){return v?"a sensor for "+v.get_default_description():"a sensor for this document."};var D=m.can_run;m.can_run=function(a){return!(a&&a.robots_only)||D.call(this,a)};var K=function(b){return m.get_attributes().map(function(c){var e=
b[c];if("key"===c&&void 0===e){if((e=b.keyIdentifier)&&0===e.indexOf("U+"))return String.fromCharCode(b.keyCode)}else if("undefined"===typeof e){if(b.detail&&b.detail.element_widget&&("widget"===c||"back"===c))return c=a.UTILITIES.widget_side_of_element(b.detail.element_widget).create_backside(),c.save_dimensions(),c;if(b.detail&&b.detail.element_widget&&"front"===c)return a.UTILITIES.widget_side_of_element(b.detail.element_widget);if(b.detail&&void 0!==b.detail[c])return"value changed"===b.type?
a.number.create_from_bigrat(b.detail[c]):b.detail[c];e="No such attribute for "+m;m.display_message(e,{display_on_backside_if_possible:!0})}return e})};return m};a.creators_from_json.sensor=function(e,b){if(e){var h=a.sensor.create(e.event_name,e.attribute,e.description,[],!1,void 0,e.name),k;e.sensor_of?a.UTILITIES.set_timeout(function(){h.set_sensor_of(a.UTILITIES.create_from_json(e.sensor_of,b));h.set_active(e.active)}):h.set_active(e.active);0<e.contents.length&&setTimeout(function(){k=a.UTILITIES.create_array_from_json(e.contents,
b);h.set_contents(k);k.forEach(function(a){c(a.get_widget(),h)});h.rerender()},500);return h}};return k}(window.TOONTALK);
window.TOONTALK.sensor_backside=function(a){return{create:function(k){var c=a.UTILITIES.create_text_input(k.get_event_name(),"toontalk-sensor-event-name-input","Event name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;","Type here the event name.","https://developer.mozilla.org/en-US/docs/Web/Events/"+k.get_event_name()),e=a.UTILITIES.create_text_input(k.get_attributes_string(),"toontalk-sensor-event-attribute-input","Event attribute","Type here the event attribute name or names separated by spaces.","https://developer.mozilla.org/en/docs/Web/API/Event"),
b=a.UTILITIES.create_check_box(k.get_active(),"toontalk-sensor-active-check-box","Listening to events","Check the box if you want to make this sensor active."),h=a.nest_backside.create(k),m=h.get_element(),g=function(){k.set_event_name(c.button.value.trim())},v=function(){k.set_attributes(e.button.value.trim())},x=a.backside.create_advanced_settings_button(h,k),p=function(a){var c=b.button.checked;k.set_active(c);k.robot_in_training()&&k.robot_in_training().edited(robot,{setter_name:"set_active",
argument_1:c,toString:"change to "+(c?"active":"inactive")+" of the "+k,button_selector:".toontalk-sensor-active-check-box"});k.render();a.stopPropagation()},q=h.add_advanced_settings;m.appendChild(x);h.add_advanced_settings=function(){c.button.addEventListener("change",g);e.button.addEventListener("change",v);b.button.addEventListener("click",p);q.call(h,c.container,e.container);var a=$(m).children(".toontalk-advanced-settings-table");0<a.length&&a.get(0).appendChild(b.container)};return h}}}(window.TOONTALK);window.TOONTALK.tool=function(a){document.addEventListener("mousemove",function(c){a.tool.pageX=c.pageX;a.tool.pageY=c.pageY});var k,c;return{get_widget_side_under_tool:function(){return k},set_last_event_type:function(a){c=a},add_listeners:function(e,b){var h,m,g,v,x,p=function(k){var n=e.getBoundingClientRect();c=void 0;b.set_held&&b.set_held(!0);v=n.height;k&&k.preventDefault();setTimeout(function(){b.held&&!b.held()||$(e).addClass("toontalk-tool-held")},200);h=$(e).offset();document.addEventListener("mousemove",
A);document.addEventListener("touchmove",A);document.addEventListener("mouseup",y);document.addEventListener("touchend",y);a.logging&&0===a.logging.indexOf("touch")&&(a.debugging+="\nmouse_down at "+Date.now());g=m=0;$(".ui-tooltip").each(function(){$(this).hide()})},q=function(c){var h=e.getBoundingClientRect();b.held&&b.held()||p(c);m=a.UTILITIES.get_mouse_or_first_touch_event_attribute("clientX",c)-h.left;g=a.UTILITIES.get_mouse_or_first_touch_event_attribute("clientY",c)-h.top},A=function(b){k=
a.UTILITIES.find_widget_side_on_page(b,e,m,g-v/2);b.preventDefault();k&&k.is_of_type("empty hole")&&(k=k.get_parent_of_frontside());$(".ui-tooltip").each(function(){$(this).hide()});var c=z(b);var h=a.UTILITIES.get_mouse_or_first_touch_event_attribute("pageX",b)-c.deltaX-m;b=a.UTILITIES.get_mouse_or_first_touch_event_attribute("pageY",b)-c.deltaY-g;e.style.left=h+"px";e.style.top=b+"px";a.logging&&0===a.logging.indexOf("touch")&&(a.debugging+="\nmouse_move at "+Date.now()+" now at "+e.style.left+
", "+e.style.top);if(k&&k.get_widget().is_top_level())x&&(a.UTILITIES.remove_highlight(),x=void 0);else{if(k){var n=k.get_element();if(n===x)return}x=n;a.UTILITIES.highlight_element(x)}},y=function(b){var c=a.UTILITIES.find_widget_side_on_page(b,e,m,g-v/2);b.preventDefault();n(e.toontalk_tool,c,b)}.bind(this),z=function(a){var b=0,c=0;20>a.clientX?b=-20:a.clientX+20>window.innerWidth&&(b=20);20>a.clientY?c=-20:a.clientY+20>window.innerHeight&&(c=20);window.scrollBy(b,c);return{deltaX:b,deltaY:c}},
n=function(b,g,k){g&&g.is_of_type("empty hole")&&(g=g.get_parent_of_frontside());x&&a.UTILITIES.remove_highlight();if(g&&g.top_level_widget&&(void 0===c||c===k.type)){var m=g.top_level_widget();b.apply_tool(g,k);c=k.type;m.backup_all()}!g&&b.nothing_under_tool&&b.nothing_under_tool();b.set_held&&b.set_held(!1);$(e).removeClass("toontalk-tool-held");$(e).addClass("toontalk-tool-returning");a.UTILITIES.add_one_shot_event_handler(e,"transitionend",1E3,function(){$(e).removeClass("toontalk-tool-returning")});
h&&a.UTILITIES.set_timeout(function(){e.style.left=h.left+"px";e.style.top=h.top+"px"});document.removeEventListener("mousemove",A);document.removeEventListener("touchmove",A);document.removeEventListener("mouseup",y);document.removeEventListener("touchend",y);a.logging&&0===a.logging.indexOf("touch")&&(a.debugging+="\nmouse_up at "+Date.now(),alert(a.debugging),a.debugging="touch")};e.addEventListener("mousedown",q);e.addEventListener("touchstart",q);return p}}}(window.TOONTALK);window.TOONTALK.vacuum=function(a){var k=Object.create(null),c={suck:"I'm a vacuum. Drag me over the thing you want to remove.\nType 'e' to switch to erasing, type 'r' to swich to restoring, or 'a' for removing all.\nOr click to switch modes.",erase:"I'm a vacuum. Drag me over the thing you want to erase (or un-erase).\nType 's' to switch to sucking, type 'r' to switch to restoring, or 'a' for removing all.\nOr click to switch modes.",restore:"Drag me over the work area. Each time you release me I'll restore a widget.\nType 's' to switch to sucking, type 'e' to swich to erasing, or 'a' for removing all.\nOr click to switch modes.",
suck_all:"Drag me over the work area and click. Everything will be removed.\nType 'r' to switch to restoring, type 'e' to switch to erasing, or type 's' to switch to sucking.\nOr click to switch modes."},e={suck:"toontalk-vacuum-s",erase:"toontalk-vacuum-e",restore:"toontalk-vacuum-r",suck_all:"toontalk-vacuum-a"},b={suck:"erase",erase:"restore",restore:"suck_all",suck_all:"suck"},h=!1,m;k.create=function(){var g,v,x,p=[],q=function(b,c){x!==b&&(x=b,!c&&a.sounds&&a.sounds.click.play(),$(g).removeClass(v),
v=e[x],$(g).addClass(v),A())},A=function(){"restore"===x&&0===p.length?a.UTILITIES.give_tooltip(g,"I'm empty.\nType 's' to switch to sucking, or type 'e' to switch to erasing, or 'a' to remove all."):a.UTILITIES.give_tooltip(g,c[x])};document.addEventListener("keyup",function(b){var c=String.fromCharCode(b.keyCode);if(b.altKey){if(0>"SsEeRrAa".split("").indexOf(c))return;g||(k.the_vacuum.get_element(),$(g).css({left:a.tool.pageX,top:a.tool.pageY}),document.body.appendChild(g));m()}k.the_vacuum.held()&&
("s"===c||"S"===c?q("suck"):"e"===c||"E"===c?q("erase"):"r"===c||"R"===c?q("restore"):"a"===c||"A"===c?q("suck_all"):a.sounds&&a.sounds.event_ignored.play(),b.preventDefault(),b.stopPropagation())});document.addEventListener("keydown",function(a){k.the_vacuum.held()&&(a.preventDefault(),a.stopPropagation())});a.vacuum.the_vacuum={apply_tool:function(b,c){var e=b.get_widget(),h=function(b){c&&e.robot_in_training()&&e.robot_in_training().removed(b);b.is_primary_backside&&b.is_primary_backside()?b.hide_backside():
b===e.robot_in_training()?(b.training_finished(),b.set_run_once(!0)):(e.is_bird()&&a.sounds&&a.sounds.bird_fly.pause(),b.is_backside()||(b.save_dimensions_of(b),b.this_and_walk_children(function(a){a.is_sensor()&&a.get_active()&&a.set_active("temporarily false");return!0})),p.push(b),b.set_running&&b.set_running(!1),b.is_backside()||b.this_and_walk_children(function(a){!a.is_backside()&&a.is_sensor()&&a.get_active()&&a.set_active(!1);return!0}),b.remove({event:c,do_not_remove_children:!0}))};a.tool.set_last_event_type(c.type);
if("suck"===x)b.remove&&!b.get_widget().is_top_level()&&(h(b),a.sounds&&a.sounds.vacuum_suck.play());else if("erase"===x||"restore"===x&&b.get_erased&&b.get_erased()){if(!b.is_top_level()){var k=!b.get_erased();a.sounds&&(k?a.sounds.vacuum_suck.play():a.sounds.vacuum_spit.play());b.set_erased(k,!0);c&&e.robot_in_training()&&e.robot_in_training().erased_widget(b,k)}}else if("restore"===x){if(0<p.length){k=p.pop();k.restore_dimensions();var m=b.add_to_top_level_backside(k);c&&e.robot_in_training()&&
e.robot_in_training().restored(k);m.toontalk_widget_side=k;b=$(g).offset();b.left-=$(m).width();a.UTILITIES.set_absolute_position(m,b);k.this_and_walk_children&&(k.this_and_walk_children(function(a){a.is_sensor()&&a.restore_active();return!0}),a.sounds&&a.sounds.vacuum_spit.play())}}else"suck_all"===x&&(k=b.top_level_widget(),b=k.get_backside_widgets().slice(),0<b.length&&a.sounds&&(a.sounds.vacuum_suck.play(),a.sounds.bird_fly.pause()),a.UTILITIES.for_each_batch(b,function(a){a&&e!==e.robot_in_training()&&
h(a)}),k.set_backside_widgets([]))},nothing_under_tool:function(){q(b[x])},get_element:function(){g||(g=document.createElement("div"),$(g).addClass("toontalk-vacuum"),m=a.tool.add_listeners(g,this),q("suck",!0),A(),g.toontalk_tool=a.vacuum.the_vacuum);return g},held:function(){return h},set_held:function(b){var c=function(){a.UTILITIES.listen_for_speech({commands:"suck | erase | restore | remove all",success_callback:function(b,e){if("remove all"===b)q("suck_all");else if("suck"===b||"erase"===b||
"restore"===b)q(b);else return console.log("ignoring "+b),!1;var g=$(".toontalk-highlight");if(0<g.length)(b=a.UTILITIES.widget_side_of_jquery(g))&&b.top_level_widget&&(g=b.top_level_widget(),this.apply_tool(b,e),g.backup_all(),c());else if("restore"===b||"remove all"===b)g=a.tool.get_widget_side_under_tool(),this.apply_tool(g,e);return!0}.bind(this)})}.bind(this);(h=b)?c():a.UTILITIES.stop_listening_for_speech()},set_mode:function(a){q(a)}};return a.vacuum.the_vacuum};a.creators_from_json.vacuum=
function(b,c){var e=a.vacuum.create();b.mode&&a.UTILITIES.set_timeout(function(){e.set_mode(b.mode)});return e};return k}(window.TOONTALK);window.TOONTALK.wand=function(a){var k=Object.create(null);k.create=function(){var c=!1,e,b={apply_tool:function(b,c){b.is_top_level()||(a.sounds&&a.sounds.magic.play(),c=b.add_copy_to_container(),c.update_display(),b.robot_in_training()&&b.robot_in_training().copied(b,c,!1))},get_element:function(){e||(e=document.createElement("div"),$(e).addClass("toontalk-wand"),a.UTILITIES.give_tooltip(e,"I'm a magic wand. Drag me over the thing you want me to copy."),a.tool.add_listeners(e,this),e.toontalk_tool=
b);return e},held:function(){return c},set_held:function(b){var e=function(){a.UTILITIES.listen_for_speech({commands:"copy | abracadabra",success_callback:function(b,c){b=$(".toontalk-highlight");if(0<b.length&&(b=a.UTILITIES.widget_side_of_jquery(b))&&b.top_level_widget){var g=b.top_level_widget();this.apply_tool(b,c);a.tool.set_last_event_type(c.type);g.backup_all();e()}return!0}.bind(this)})}.bind(this);(c=b)?e():a.UTILITIES.stop_listening_for_speech()}};return b};a.creators_from_json.wand=function(){return a.wand.create()};
return k}(window.TOONTALK);window.TOONTALK.SETTINGS=function(a){var k=[],c=function(a,b){Dropbox.choose({success:b,linkType:"direct",extensions:a})},e=function(e,g,v){var m=[];a.UTILITIES.create_local_files_table(function(p){var q=function(g,h){g=function(b){b||h.newPanel.append(a.UTILITIES.create_text_element("Error connecting to cloud. Have you logged in?"))};var k=h.newPanel.is(".dataTable");$(".dataTables_info").hide();$(".dataTables_wrapper").hide();0<h.newTab.find(".toontalk-programs-in-cloud-tab-label").length?e.get_setting("save_to_dropbox")?
c([".tt.json"],function(b){a.UTILITIES.download_file(b[0].link,e.download_callback(function(){$(v).remove()}))}):k?($("#tab-1_info").show(),$("#tab-1_wrapper").show()):b(h.newPanel,"program",e,v,g):0<h.newTab.find(".toontalk-pages-in-cloud-tab-label").length?e.get_setting("save_to_dropbox")?c([".tt.html"],function(a){h.newPanel.before($("<p><a href='"+a[0].link+"' target='_blank'>Click to open "+a[0].name+"</a></p>"))}):k?($("#tab-2_info").show(),$("#tab-2_wrapper").show()):b(h.newPanel,"page",e,
v,g):($("#tab-0_info").show(),$("#tab-0_wrapper").show())};m[0]="Programs stored in browser";k[0]=p;if(g){m[1]=a.UTILITIES.create_text_element("Programs in cloud","toontalk-programs-in-cloud-tab-label");m[2]=a.UTILITIES.create_text_element("Published pages","toontalk-pages-in-cloud-tab-label");e.get_setting("save_to_google_drive")?(k[1]=a.UTILITIES.create_file_data_table("toontalk-programs-in-cloud-table"),k[2]=a.UTILITIES.create_file_data_table("toontalk-pages-in-cloud-table")):(k[1]=a.UTILITIES.create_text_element("Choose a file to load."),
k[2]=a.UTILITIES.create_text_element("Choose a page to display."));var x=a.UTILITIES.create_tabs(m,k);v.appendChild(x);$(x).on("tabsactivate",q)}else v.appendChild(a.UTILITIES.create_tabs(m,k));h(e,p,!0,v);$(p).on("draw.dt",function(){h(e,p,!1,v)})})},b=function(b,c,e,k,p){a.google_drive.get_toontalk_files(!1,c,function(g){if("string"===typeof g)var m=g;else g.error&&(m=g.error.message);m?"Need to authorize"===m||"Login Required"===m?a.google_drive.authorize(p):(console.log(m),console.log("Google drive status: "+
a.google_drive.get_status()),p(null)):(a.UTILITIES.become_file_data_table(b,g.items,!0,"program"===c&&"toontalk-file-load-button toontalk-file-load-button-without-click-handler"),h(e,b.get(0),!0,k),b.on("draw.dt",function(){h(e,b.get(0),!0,k)}),p(b.get(0)))})},h=function(a,b,c,e){var g=function(b){var g=function(){$(e).remove()},h=function(){a.set_setting("program_name",b.target.textContent);a.load(c,g)}.bind(this);a.save(!0,void 0,h)};b=$(b).find(".toontalk-file-load-button-without-click-handler");
b.each(function(a,b){b.addEventListener("click",g)});b.removeClass("toontalk-file-load-button-without-click-handler")};return{open:function(b){var c=document.createElement("div"),h=b.get_backside_element(),k=b.get_setting("program_name"),m=a.UTILITIES.create_text_input(k,"toontalk-program-name-input","Current program name:","Edit this to change the name of your program","docs/manual/settings.html"),q=a.UTILITIES.create_close_button(function(){$(c).remove()},"Click to close the settings panel."),A=
a.UTILITIES.create_check_box(!1,"toontalk-url-parameter-setting",a.speak?a.CHROME_APP?"Turn off spoken help":"Reload with speaking turned off":a.CHROME_APP?"Turn on spoken help":"Reload with spoken help",a.speak?"Check this if you no longer want spoken help.":"Check this if you would like ToonTalk to speak to you."),y=a.UTILITIES.create_check_box(!1,"toontalk-url-parameter-setting",a.balloons?a.CHROME_APP?"Turn off help balloons":"Reload with no balloon help":a.CHROME_APP?"Turn on help balloons":
"Reload with balloon help",a.balloons?"Check this if you no longer want ToonTalk to display balloons giving tips and help.":"Check this if you would like ToonTalk to display balloons giving tips and help."),z=a.UTILITIES.create_check_box(!1,"toontalk-url-parameter-setting",a.listen?a.CHROME_APP?"Turn off voice commands":"Reload with voice commands turned off":a.CHROME_APP?"Turn on voice commands":"Reload with <a href='docs/manual/voice-commands.html' target = '_blank'>voice commands</a> turned on",
a.listen?"Check this if you no longer want ToonTalk to listen to voice commands.":"Check this if you would like ToonTalk to listen for voice commadns."),n=a.UTILITIES.create_check_box(!1,"toontalk-url-parameter-setting",a.TRANSLATION_ENABLED?a.CHROME_APP?"Turn off translation from English":"Reload with no translation from English":a.CHROME_APP?"Turn on translation":"Reload with over one hundred languages that ToonTalk can be translated to",a.TRANSLATION_ENABLED?"Check this if you no longer want ToonTalk to display a choice of languages.":
"Check this if you would like ToonTalk to display a menu of languages for the interface to be translated to."),w=a.UTILITIES.create_text_element("Saving and loading options"),I=a.UTILITIES.create_check_box(b.get_setting("save_to_dropbox"),"toontalk-save-setting","When saving to the cloud use my Dropbox account",'Check this if you want your programs saved to a "ToonTalk Reborn" folder in the "Apps" folder in your Dropbox.'),D=a.UTILITIES.create_check_box(b.get_setting("save_to_google_drive"),"toontalk-save-setting",
"When saving to the cloud use my Google Drive account",'Check this if you want your programs saved to a "ToonTalk Programs" folder in your Google Drive.'),K=a.UTILITIES.create_check_box(b.get_setting("auto_save_to_cloud"),"toontalk-save-setting","Save automatically to cloud storage","Check this if you want your programs to Dropbox or Google Drive when your program changes."),E=a.UTILITIES.create_check_box(b.get_setting("auto_save_to_local_storage"),"toontalk-save-setting","Save automatically to this browser's local storage",
"Check this if you want your programs automatically saved in this browser's local storage."),O=a.UTILITIES.create_button("Save to cloud storage now","toontalk-save-button","Click to save your program now to your Dropbox or your Google Drive account.",function(){b.save(!0,{google_drive:b.get_setting("save_to_google_drive"),dropbox:b.get_setting("save_to_dropbox")})}),J=a.UTILITIES.create_button("Save to browser's storage now","toontalk-save-button","Click to save your program now to this browser's local storage.",
function(){b.save(!0,{local_storage:!0})}),V=a.UTILITIES.create_button("Login to Google","toontalk-google-login-button","Click to log in to Google to authorize use of your Google Drive.",function(){a.google_drive.authorize(function(){$(V).remove()})}),N=a.UTILITIES.create_button("Publish","toontalk-publish-button","Click to publish your program by generating a Google Drive URL.",function(){b.display_message("Creating your web page...",{dont_log:!0});b.publish(G,P.button.checked)}),P=a.UTILITIES.create_check_box(b.get_setting("publish_as_workspace"),
"toontalk-publish-setting","As a workspace","Check this if you want to publish the workspace and its widgets. Uncheck it you wish to publish just the widgets."),G=function(c,d){if(c){var e=b.get_setting("program_name");d=document.createElement("span");c=a.google_drive.google_drive_url(c.id,!0);d.innerHTML="Published <a href='"+c+"' target='_blank' title='Click to visit or edit.'>"+e+"</a>";c=$(m.container).children("tr");b.display_message("Your web page is ready for you to edit. Just click on the link.",
{dont_log:!0});0<c.length&&c.get(0).appendChild(a.UTILITIES.create_table_entry(d))}},Q=document.createElement("div"),T=a.google_drive&&"undefined"!==typeof gapi?a.google_drive.get_status():"Google Drive API not loaded",U=!0,F=function(){$(c).remove();setTimeout(function(){window.TOONTALK.SETTINGS.open(b)})},d=a.UTILITIES.create_vertical_table(N,P.container),f=function(b,c){return function(){window.location.assign(a.UTILITIES.add_URL_parameter(window.location.href,b,c?"0":"1"))}},r=function(b){return function(){a.UTILITIES.set_parameter(b,
!a[b])}},t=function(b,c){return a.CHROME_APP?r(c):f(b,a[c])},C=$(m.container).children("tr");$(c).addClass("toontalk-settings-panel").css({width:$(h).width()+29,height:$(h).height()+50,left:-2,top:-25,"z-index":9999999});c.appendChild(q);m.button.addEventListener("change",function(){var d=m.button.value.trim();k!==d&&b.save(!0,void 0,function(){k=d;b.set_setting("program_name",d);b.load(!0,function(){setTimeout(function(){$(c).css({"z-index":a.UTILITIES.next_z_index()})},500)},function(){b.save(!0,
void 0,function(){$(".toontalk-settings-panel").remove();b.display_message("Your program was copied and the new copy's name is '"+b.get_setting("program_name")+"'.",{dont_log:!0})})})})});A.button.addEventListener("click",t("speak","speak"));z.button.addEventListener("click",t("listen","listen"));y.button.addEventListener("click",t("balloons","balloons"));n.button.addEventListener("click",t("translate","TRANSLATION_ENABLED"));D.button.addEventListener("click",function(a){b.save(!0,{save_to_google_drive:D.button.checked,
gooogle_drive:!0});b.set_setting("save_to_google_drive",D.button.checked);D.button.checked?($(O).hide(),I.button.checked=!1,b.set_setting("save_to_dropbox",!1),F()):I.button.checked?$(O).show():($(O).hide(),K.button.checked=!1)});I.button.addEventListener("click",function(a){b.save(!0,{save_to_dropbox:I.button.checked,dropbox:!0});b.set_setting("save_to_dropbox",I.button.checked);I.button.checked?($(O).hide(),D.button.checked=!1,b.set_setting("save_to_google_drive",!1),F()):D.button.checked?$(O).show():
($(O).hide(),K.button.checked=!1)});K.button.addEventListener("click",function(a){b.save(!0,{auto_save_to_cloud:K.button.checked,google_drive:b.set_setting("save_to_google_drive"),dropbox:b.set_setting("save_to_dropbox")});b.set_setting("auto_save_to_cloud",K.button.checked);K.button.checked?$(O).hide():I.button.checked||D.button.checked?$(O).show():$(O).hide()});E.button.addEventListener("click",function(a){b.save(!0,{auto_save_to_local_storage:E.button.checked,local_storage:!0});b.set_setting("auto_save_to_local_storage",
E.button.checked);E.button.checked?$(J).hide():$(J).show()});P.button.addEventListener("click",function(a){b.set_setting("publish_as_workspace",P.button.checked)});c.appendChild(Q);$(w).css({"font-weight":"bold","font-size":24,color:"navy"});Q.appendChild(A.container);Q.appendChild(y.container);a.CHROME_APP||(Q.appendChild(z.container),Q.appendChild(n.container));Q.appendChild(w);Q.appendChild(m.container);a.CHROME_APP||(Q.appendChild(D.container),Q.appendChild(K.container),Q.appendChild(E.container));
D.container.appendChild(a.UTILITIES.create_space());D.container.appendChild(O);I.container.appendChild(a.UTILITIES.create_space());I.container.appendChild(O);b.get_setting("auto_save_to_cloud")&&$(O).hide();E.container.appendChild(a.UTILITIES.create_space());E.container.appendChild(J);b.get_setting("auto_save_to_local_storage")&&$(J).hide();b.get_setting("save_to_google_drive")?"Need to authorize"===T?(D.container.appendChild(a.UTILITIES.create_space()),D.container.appendChild(V)):"Authorized"!==
T&&"Ready"!==T&&"Authorized but not yet ready"!==T?(U=!1,b.set_setting("google_drive_unavailable",!0),setTimeout(function(){D.button.disabled=!0;$(N).button("option","disabled",!0);$(O).button("option","disabled",!0);a.UTILITIES.give_tooltip(D.container,"Inactivated because attempt to connect to Google Drive returned: "+T);N.title=D.container.title;O.title=D.container.title},1)):b.set_setting("google_drive_unavailable",!1):b.get_setting("save_to_dropbox")&&(U=!0);0<C.length&&C.get(0).appendChild(a.UTILITIES.create_table_entry(d));
e(b,U,c);h.appendChild(c)}}}(window.TOONTALK);window.TOONTALK.DEFAULT_SETTINGS={program_name:"My first program",save_to_google_drive:!0,auto_save_to_cloud:!0,auto_save_to_local_storage:!0};window.TOONTALK.DISPLAY_UPDATES=function(a){var k=[],c=0,e=!1,b=!1;return{pending_update:function(a){0<=k.indexOf(a)||(k.push(a),this.update_display())},update_display:function(){if(!b&&!document.hidden&&0!==k.length){var h=Date.now();h<c?(b=!0,setTimeout(this.update_display_workhorse.bind(this),c-h)):e||(b=!0,a.UTILITIES.set_timeout(function(){this.update_display_workhorse(h)}.bind(this)))}},update_display_workhorse:function(h){var m=k;k=[];e=!0;b=!1;c=(h|Date.now())+50;a.UTILITIES.for_each_batch(m,
function(b){var c=b.get_element&&b.get_element(),e;if(c&&(b.visible()||$(c).is(".toontalk-top-level-resource")))if($(c).is(".toontalk-not-observable"))a.DISPLAY_UPDATES.pending_update(b);else if($(c).is(".toontalk-has-attached-callback"))c.parentElement&&c.toontalk_attached_callback&&(c.toontalk_attached_callback(),c.toontalk_attached_callback=void 0);else{$(c).show();b.update_display();b.get_backside&&(e=b.get_backside())&&e.visible()&&e.update_display();setTimeout(function(){a.UTILITIES.use_custom_tooltip(c)});
var g=$(c).parent().closest(".toontalk-side");c&&!$(c).is(".toontalk-top-level-resource, .toontalk-bird, .toontalk-nest, .toontalk-box-hole, .toontalk-plain-text-element, .toontalk-conditions-contents, .toontalk-robot, .toontalk-widget, .toontalk-held-by-robot")&&a.UTILITIES.set_timeout(function(){if(g.is(".toontalk-box-hole")||g.is(".toontalk-nest"))$(c).children(".ui-resizable-handle").hide();else if($(c).is(".ui-resizable"))$(c).children(".ui-resizable-handle").show();else if(a.UTILITIES.make_resizable($(c),
b),b.is_box()){var e=b.get_border_size();$(c).children(".ui-resizable-handle").css({right:-e,bottom:-e})}})}});e=!1;0<k.length&&(b=!0,setTimeout(function(){this.update_display_workhorse()}.bind(this),50))}}}(window.TOONTALK);window.TOONTALK.actions=function(a){a.creators_from_json.body=function(k,c){var e=a.actions.create();c.body=e;e.initialise_steps(a.UTILITIES.create_array_from_json(k.steps,c));return e};return{create:function(k){var c=Object.create(this),e=[];k||(k=[]);c.copy=function(){return a.actions.create(a.UTILITIES.copy_array(k))};c.get_steps=function(){return k};c.initialise_steps=function(a){k=a};c.is_empty=function(){return 0===k.length};c.reset_steps=function(){k=[];this.reset_newly_created_widgets()};
c.reset_newly_created_widgets=function(){a.logging&&0<=a.logging.indexOf("newly-created")&&console.log("Reset newly_created_widgets. Length was "+e.length);e=[]};c.add_step=function(b,c){b?(k.push(b),c&&this.add_newly_created_widget_if_new(c)):a.UTILITIES.report_internal_error("Attempt to add an undefined step.")};c.add_newly_created_widget_if_new=function(a){0<=e.indexOf(a)||this.add_newly_created_widget(a)};c.add_newly_created_widget=function(b){a.debugging&&0<=e.indexOf(b)?console.log("add_newly_created_widget called with not new widget."):
(e.push(b),a.logging&&0<=a.logging.indexOf("newly-created")&&console.log("Added "+b.to_debug_string(50)+" to list of newly_created_widgets. Length is "+e.length))};c.is_newly_created=function(a){return 0<=e.indexOf(a)};c.get_newly_created_widgets=function(){return e};c.get_path_to=function(b,c,k){var g,h;e.some(function(e,m){if(e===b||k&&e===b)return g=a.newly_created_widgets_path.create(m),!0;if(e.get_path_to&&(h=e.get_path_to(b,c)))return g=a.newly_created_widgets_path.create(m),g.next=h,!0});return g};
c.dereference_path=function(b){a.debugging&&!e[b]&&a.UTILITIES.report_internal_error("Expected to find the "+a.UTILITIES.ordinal(b)+" newly created widget.");return e[b]};return c},run_unwatched:function(k,c){var e=this.get_steps();a.logging&&0<=a.logging.indexOf("run")&&console.log(k.to_debug_string(50)+" running unwatched");c||(c=0);k.run_next_step=function(b){if(c<e.length){var h=e[c];c++;a.logging&&0<=a.logging.indexOf("event")&&console.log(h+" (unwatched) at "+Date.now()+" by robot "+k.get_name()+
" "+k._debug_id);b?(k.run_watched_step_end_listeners(),h.run_watched(k)):h.run_unwatched(k)}else this.stopped()||(k.set_running_or_in_run_queue(!1),k.run_body_finished_listeners(),k.get_run_once()?k.get_first_in_team().set_running(!1):k.get_first_in_team().run())};k.run_next_step()},run_watched:function(k){var c=this.get_steps(),e=k.get_frontside_element(),b=e.parentElement,h=k.get_first_in_team(),m=0,g=$(e).offset(),v=$(e).offset(),x=$(e).width(),p=$(e).height();k.get_first_in_team().top_level_widget();
var q=$(e).closest(".toontalk-backside-of-top-level").offset(),A=k.get_context().get_backside(),y=k.get_parent(),z,n;a.logging&&0<=a.logging.indexOf("run")&&console.log(k.to_debug_string(50)+" running watched");var w=(z=k.get_previous_robot())?$(z.get_backside(!0).get_next_robot_area()):A&&$(A.get_backside_element(!0));if(!a.UTILITIES.is_attached(e)&&z){var I=e.parentElement;!I&&w&&(I=w.get(0));for(n=z.get_first_in_team();n!==k;)n.open_backside(),n.get_backside().set_advanced_settings_showing(!0),
function(){var a=n;setTimeout(function(){a.get_backside()&&(a.get_backside().set_advanced_settings_showing(!1),a.hide_backside())},2E3)}(),z=n.get_frontside_element(),g=$(z).offset(),0!==g.left&&0!==g.top&&void 0===q&&(v={left:g.left,top:g.top},q=g),n=n.get_next_robot();k.set_visible(!0);k.update_display();k.add_body_finished_listener(function(){I&&TOONTALK.UTILITIES.is_attached(I)?I.appendChild(e):y||k.remove({do_not_remove_frontside:!0});$(e).css({left:"",top:"",position:"","z-index":""})})}k.add_body_finished_listener(function(){var c=
h.visible(),m=function(){c&&(b&&(b.appendChild(e),k.set_parent_of_frontside(a.UTILITIES.widget_side_of_element(b))),k.set_animating(!1));h===k?a.UTILITIES.set_absolute_position(e,g):(a.UTILITIES.set_css(e,{position:"static"}),w&&0<w.length&&w.append(e));k.get_run_once()?h.set_running(!1):k.stopped()?$(e).removeClass(".toontalk-side-animating"):h.run();k.rerender()};c?(!e.parentElement&&k.get_parent_of_frontside()&&k.get_parent_of_frontside().get_frontside_element(!0).appendChild(e),a.UTILITIES.animate_to_absolute_position(e,
g,m,k&&k.transform_animation_speed(a.animation_settings.ROBOT_ANIMATION_SPEED))):(k.set_animating(!1),m(),k===h&&k.get_context().add_backside_widget(k),$(k.get_frontside_element()).remove())});0===x&&($(e).css({width:"",height:""}),x=k.saved_width||$(e).width(),p=k.saved_height||$(e).height());q||(q={left:0,top:0});w&&0<w.length&&a.UTILITIES.is_attached(w.get(0))&&(z=w.get(0).getBoundingClientRect(),g.left<z.left-q.left||g.top<z.top-q.top||g.left+x>z.right+q.left||g.top+p>z.bottom+q.top)&&(g=w.offset(),
g.left+=w.width()/2,g.top+=w.height()-p,v=g);k.start_offset=v;k.add_to_top_level_backside();a.UTILITIES.set_absolute_position(e,g);k.run_next_step=function(){!A||document.hidden||!A.visible()&&!a.UTILITIES.visible_element(A.get_element())||k.stopped()?(k.set_running_or_in_run_queue(!1),k.set_animating(!1),$(e).css({width:"",height:""}),e.style.transitionDuration="",b&&b.appendChild(e),this.run_unwatched(k,m)):setTimeout(function(){k.run_watched_step_end_listeners();if(m<c.length){var b=c[m];m++;a.logging&&
0<=a.logging.indexOf("event")&&console.log(b+" (watched)");b.run_watched(k)}else k.set_running_or_in_run_queue(!1),k.run_body_finished_listeners()},k.transform_step_duration(a.animation_settings.PAUSE_BETWEEN_STEPS))}.bind(this);k.set_animating(!0,g);k.run_next_step();return!0},toString:function(a){for(var c="",e=this.get_steps().map(function(b){return b&&b.toString(a)});""===e[e.length-1];)e.pop();e.forEach(function(a,h){a&&(c+=a,c=h===e.length-2?c+" and \n":h<e.length-2?c+", \n":c+".")});return c},
get_json:function(k,c,e,b){var h=[];a.UTILITIES.get_json_of_array(this.get_steps(),h,0,k,function(){c({type:"body",steps:h},e,b+1)},e,b+1)}}}(window.TOONTALK);
window.TOONTALK.newly_created_widgets_path=function(a){a.creators_from_json.newly_created_widgets_path=function(k){return a.newly_created_widgets_path.create(k.index)};return{create:function(k){return{dereference_path:function(c){var e=c.get_body().dereference_path(k),b;if(this.next)return a.path.dereference_path(this.next,c,e);this.removing_widget&&e&&((b=e.get_parent_of_frontside())&&b.is_hole()&&(b=b.get_parent_of_frontside()),b&&b.removed_from_container&&c.remove_from_container(e,b));return e},
toString:function(){return"the "+a.UTILITIES.ordinal(k)+" new widget"},get_json:function(a,e,b,h){e({type:"newly_created_widgets_path",index:k},b,h+1)}}}}}(window.TOONTALK);window.TOONTALK.robot_action=function(a){var k=function(a,b,c){if(!c||!c.running_watched||!a.get_backside())return!0;a.get_backside().hide_backside()},c={copy:function(a,b){b.add_newly_created_widget(a.copy());return!0},"pick up":function(b,e,g){if(b.is_empty_hole&&b.is_empty_hole())a.UTILITIES.report_internal_error("The following robot is trying to pick up an empty hole.\n"+e);else{if(b.get_infinite_stack())return c["pick up a copy of"](b,e);g&&g.running_watched||b.set_parent(void 0);e.set_thing_in_hand(b);
return!0}},"pick up a copy of":function(a,b){a=a.copy();b.add_newly_created_widget(a);b.set_thing_in_hand(a);return!0},"drop it on":function(b,c,e){var g;if(b)if(g=c.get_thing_in_hand()){if(g.drop_on)return a.debugging&&g===b&&a.UTILITIES.report_internal_error("Dropping something on itself! "+b),b.visible()||$(g.get_frontside_element()).remove(),g.drop_on(b,{robot:c}),c.set_thing_in_hand(void 0),b.rerender(),c.add_newly_created_widget_if_new(g),g.robot_waiting_before_next_step===c?(e&&e.running_watched||
(g.robot_waiting_before_next_step=void 0),!1):!0;a.debugging&&a.UTILITIES.report_internal_error("Thing in robot's hand ("+g+") doesn't handle 'drop_on'. Robot that "+c)}else!c.being_trained&&a.debugging&&a.UTILITIES.report_internal_error("The robot that '"+c.toString()+"' is executing drop_on but has nothing in its hand.");else a.debugging&&a.UTILITIES.report_internal_error("The robot that '"+c.toString()+"' is executing drop_on but doesn't know where to drop what its holding")},"drop it on the text area of":function(b,
c,e){var g;if(b){if(g=c.get_thing_in_hand())return c.set_thing_in_hand(void 0),b[e.setter](g),!0;a.UTILITIES.report_internal_error("The robot that '"+c.toString()+"' is executing dropped_on_text_area but has nothing in its hand.")}else a.UTILITIES.report_internal_error("The robot that '"+c.toString()+"' is executing dropped_on_text_area but doesn't know where to drop what its holding")},remove:function(a,b){a.remove();a===b?b.set_stopped(!0):b.add_newly_created_widget_if_new(a);return!0},restore:function(a,
b){b.add_to_top_level_backside(a);a.get_element().toontalk_widget_side=a;return!0},"change whether erased":function(a,b,c){if(a.set_erased)return a.set_erased(!a.get_erased()),!0;a.display_message("Robot is unable to erase "+a)},edit:function(b,c,e){if(b[e.setter_name])return e.argument_2?b[e.setter_name].call(b,e.argument_1,e.argument_2,b.visible()):b[e.setter_name].call(b,e.argument_1,b.visible()),!0;a.UTILITIES.report_internal_error(b+" cannot be edited.")},"change size of":function(a,b,c){return!0},
"add to the top-level backside":function(b,c,e){if(!e||!e.running_watched){e=c.top_level_widget();e.add_backside_widget(b);var g=c.get_context();if(!g.visible())return;var h=e.get_backside_element();g=b.get_frontside_element(!0);b.update_display();h.appendChild(g);b.animate_to_element(h,void 0,c.transform_animation_speed(a.animation_settings.ANIMATION_SPEED));e.get_backside&&$(g).css(e.get_backside().get_free_location(b))}return!0},"add a new widget to the work space":function(b,c,e){if(c.get_context())return c.get_context().is_top_level()?
(e=c.add_to_top_level_backside(b),c=$(c.get_frontside_element()).offset(),b.update_display(),a.UTILITIES.set_position_relative_to_top_level_backside(e,c,!0)):b.drop_on(c.get_context().get_backside(!0),{robot:c}),!0;a.UTILITIES.report_internal_error("Robot has no context in 'add a new widget to the work space'. Robot is "+c+" and widget is "+b)},"start training":function(b,c,e){if(b.is_robot())return e&&e.running_watched||(b.initialize_backside_conditions(),b.get_body().reset_steps(),c.robot_started_training(b)),
b.training_started(c),!0;a.UTILITIES.report_internal_error("Expected to train a robot but found instead "+b)},"stop training":function(a,b,c){a.training_finished();return!0},train:function(b,c,e){if(b.add_step)return b.add_step(e.step),!0;a.UTILITIES.report_internal_error("Cannot peform a training step because cannot train a non-robot.")},"open the backside":function(){return!0},"open the backside of":function(){return!0},"close the backside of":k,"close the backside":k,"click the button of":function(a,
b,c){".toontalk-green-flag"===c.button_selector?a.set_running(!0):".toontalk-stop-sign"===c.button_selector&&a.set_running(!1);return!0}},e=function(b,c,e,g){var h=c.get_thing_in_hand(),k=c.get_frontside_element(),m=b.get_element();m||(m=a.UTILITIES.find_resource_equal_to_widget(b,c));if(a.UTILITIES.is_attached(m)&&c.visible()&&!c.stopped()){var n=m.getBoundingClientRect();if(g&&g.left_offset_fraction){c.original_animation_left_offset||(c.original_animation_left_offset=[]);c.original_animation_top_offset||
(c.original_animation_top_offset=[]);n={left:g.left_offset_fraction*n.width,top:g.top_offset_fraction*n.height};if(h){var p=h.get_element();a.UTILITIES.visible_element(p)&&(p=$(p).offset(),k=$(k).offset(),n.left-=p.left-k.left,n.top-=p.top-k.top)}b.get_backside&&(h=b.get_backside().get_free_location(h,{try_first:n}),m.animation_left_offset=h.left,m.animation_top_offset=h.top,c.animation_left_offset=h.left,c.animation_top_offset=h.top)}else{var q=n.width/2;var y=n.height/2}c.animate_to_widget(b,e,
c.transform_animation_speed(a.animation_settings.ROBOT_ANIMATION_SPEED),q,y,!0,c.transform_original_step_duration(g&&g.time),c)}else e()},b=function(a,b,c,g){e(a,b,function(){a.open_backside(c);p(a,b)},g)},h=function(a,b){var c=a.get_backside_element(!0),e=$(c).find(b).get(0);if(e)return e;a.get_backside().set_advanced_settings_showing(!0);return $(c).find(b).get(0)},m=function(b,c,e,g,k,m){var n=h(b,g);c.get_frontside_element();var q=n&&a.UTILITIES.visible_element(n),y=function(){e(n);$(n).addClass("ui-state-active");
if(".toontalk-select-function"===g||".toontalk-box-size-input"===g)n.value=k.argument_1;setTimeout(function(){$(n).removeClass("ui-state-active");a.UTILITIES.remove_highlight();c.run_next_step(!0)},m)},v=function(){if(!a.UTILITIES.visible_element(n)){var e=b.get_backside(!0);e.set_advanced_settings_showing(!0,e.get_element())}c.animate_to_element(n,y,c.transform_animation_speed(a.animation_settings.ROBOT_ANIMATION_SPEED),0,0,!0,c.transform_original_step_duration(k&&k.time))};a.UTILITIES.highlight_element(b.get_frontside_element());
!q&&b.open_backside&&c.animate_consequences_of_actions()?b.open_backside(v,c.transform_step_duration(a.animation_settings.OPEN_BACKSIDE_DURATION))&&p(b,c):v()},g=function(b,c,e,g,h){var k=a.UTILITIES.closest_element($("."+h),$(c.get_frontside_element()).offset()),m=function(){v(b,c,e,g)};k&&c.animate_consequences_of_actions()&&0<$("."+h).length?c.animate_to_element(k,m,c.transform_animation_speed(a.animation_settings.ROBOT_ANIMATION_SPEED),0,0,!0):m()},v=function(b,c,e,g){c.get_frontside_element();
var h=function(){c.carrying_tool=void 0;c.update_display();e();c.run_next_step(!0)};if(c.animate_consequences_of_actions())if(c.carrying_tool=g,c.update_display(),g=c.transform_animation_speed(a.animation_settings.ROBOT_ANIMATION_SPEED),b)c.animate_to_element(b.get_element(),h,g,0,0,!0);else{var k=c.top_level_widget().get_element();b=$(k).offset();b.left+=$(k).width()*(.1+.8*Math.random());b.top+=$(k).height()*(.1+.8*Math.random());c.animate_to_absolute_position(b,h,g,!0)}else e(),c.run_next_step(!0)};
k=function(a,b,c){var e=a.get_parent_of_frontside();g(a,b,function(){c();e&&"top-level"!==e.get_widget().get_type_name()&&e.update_display&&e.update_display();a.rerender()},"toontalk-vacuum-ready-small","toontalk-vacuum")};var x=function(b,c,e){b.open_backside(function(){e();c.run_next_step(!0)},a.animation_settings.OPEN_BACKSIDE_DURATION);p(b,c)},p=function(a,b){b.add_body_finished_listener(function(){a.get_backside()&&a.get_backside().hide_backside()})},q=function(b,c,e,g){g=g&&g.time?c.transform_original_step_duration(g.time):
c.transform_step_duration(a.animation_settings.CLOSE_BACKSIDE_DURATION);setTimeout(function(){$(b.get_backside_element()).children(".toontalk-close-button").click();e();c.run_next_step(!0)},g)},A={copy:function(b,c,e){g(b,c,function(){b.add_copy_to_container?(e(),b.add_copy_to_container(c.get_recently_created_widget())):a.UTILITIES.display_message("Unable to copy "+a.UTILITIES.add_a_or_an(b.get_type_name())+" by robot named "+c.get_name())},"toontalk-wand-small","toontalk-wand")},"pick up":function(b,
c,g,h){var k=function(){g();c.animate_consequences_of_actions()&&c.update_display();c.run_next_step(!0)};a.debugging&&"empty hole"===b.get_type_name()?a.UTILITIES.report_internal_error("Robot trying to pick up an empty hole."):b.save_dimensions()&&c.animate_consequences_of_actions()?e(b,c,k,h):k()},"pick up a copy of":function(b,c,g,h){e(b,c,function(){var e;g();c.animate_consequences_of_actions()&&(e=c.get_recently_created_widget())&&(e.set_visible(!0),a.UTILITIES.copy_frontside_dimensions(b,e),
c.update_display());c.run_next_step(!0)},h)},"drop it on":function(c,g,h,k){var m=g.get_thing_in_hand();if(m){a.debugging&&m===c&&a.UTILITIES.report_internal_error("Dropping something on itself!");var n=m.get_element(!0);m.set_visible(g.visible());var p=function(){$(n).removeClass("toontalk-held-by-robot");if(m.drop_on){if(g.animate_consequences_of_actions()&&!a.UTILITIES.visible_element(n)){var b=$(g.get_frontside_element()).closest(".toontalk-backside-of-top-level");0<b.length&&b.get(0).appendChild(n)}g.rerender()}h();
m.drop_on&&m.visible()&&(a.UTILITIES.set_absolute_position(n,$(n).offset()),m.restore_dimensions());m.robot_waiting_before_next_step!==g&&g.run_next_step(!0)};c.is_backside()&&!a.UTILITIES.visible_element(c.get_element())?b(c.get_widget(),g,p,k):e(c,g,p,k)}else a.debugging&&(a.UTILITIES.report_internal_error("Expected the robot to be holding something."),console.log("The robot is "+g)),e(c,g,h,k)},"drop it on the text area of":function(c,g,h,k){var m=g.get_thing_in_hand();if(m){var n=m.get_element(!0);
m.set_visible(g.visible());var p=function(){$(n).removeClass("toontalk-held-by-robot");h();m.remove();var a=c.get_parent_of_frontside().get_widget();a.is_hole()&&(a=a.get_parent_of_frontside());a.is_top_level()?c.render():a.render();g.set_thing_in_hand(void 0);g.run_next_step(!0)};var q=function(){return $(c.get_backside_element()).find(k.area_selector).get(0)};g.rerender();if(a.UTILITIES.visible_element(c.get_backside_element())){var v=q();g.animate_to_element(v,p,g.transform_animation_speed(a.animation_settings.ROBOT_ANIMATION_SPEED/
2),0,0,!0)}else b(c,g,function(){v=q();g.animate_to_element(v,p,g.transform_animation_speed(a.animation_settings.ROBOT_ANIMATION_SPEED/2),0,0,!0)},k)}else a.UTILITIES.report_internal_error("Expected the robot to be holding something."),console.log("The robot is "+g),e(c,g,h,k)},remove:k,"change whether erased":k,restore:function(b,c,e){g(void 0,c,function(){a.UTILITIES.set_css(b.get_element(!0),$(c.get_frontside_element()).position());e()},"toontalk-vacuum-ready-small","toontalk-vacuum")},edit:function(b,
c,e,g){m(b,c,function(){b.get_backside()&&b.get_backside().update_display();e()},g.button_selector,g,c.transform_step_duration(a.animation_settings.BUTTON_USE_DELAY))},"change size of":function(b,c,e,g){var h=b.get_frontside_element();h?c.animate_to_element(h,function(){var k=h.getBoundingClientRect(),m=k.width*g.x_factor;k=k.height*g.y_factor;var n=c.transform_step_duration(a.animation_settings.CHANGE_SIZE_DURATION);$(h).addClass("toontalk-animating-element");h.style.transitionDuration=n+"ms";h.style.width=
m+"px";h.style.height=k+"px";setTimeout(function(){$(h).removeClass("toontalk-animating-element");h.style.transitionDuration="";e();b.render();c.run_next_step(!0)},n)},c.transform_animation_speed(a.animation_settings.ROBOT_ANIMATION_SPEED),0,0,!0):(e(),c.run_next_step(!0))},"add to the top-level backside":function(a,b,c){c();b.run_next_step(!0)},"add a new widget to the work space":function(b,c,e,g){g&&g.button_selector?(b=a.path.dereference_path(g.path_to_source,c),m(b,c,e,g.button_selector,g,c.transform_step_duration(a.animation_settings.BUTTON_USE_DELAY))):
(e(),c.run_next_step(!0))},"start training":function(a,b,c){var e=a.open_backside();a=a.get_frontside_element();c();e&&$(e.get_element()).find(".toontalk-train-backside-button").click();$(a).addClass("toontalk-robot-animating toontalk-robot-being-trained-by-robot");a.toontalk_followed_by={element:b.get_frontside_element(),left_offset:30,top_offset:-20};a.toontalk_return_to=$(a).offset();b.run_next_step(!0)},"stop training":function(b,c,e,g){var h=b.get_frontside_element();m(b,c,function(){var g=function(){h.toontalk_return_to=
void 0;b.get_backside()&&b.get_backside().change_label_and_title_of_train_button(!1);$(h).removeClass("toontalk-robot-animating toontalk-robot-being-trained-by-robot");h.toontalk_followed_by=void 0;setTimeout(e,c.transform_step_duration(a.animation_settings.STOP_TRAINING_DELAY))};h.toontalk_return_to?a.UTILITIES.animate_to_absolute_position(h,h.toontalk_return_to,g,c.transform_animation_speed(a.animation_settings.ROBOT_ANIMATION_SPEED)):g()},".toontalk-train-backside-button",g,c.transform_step_duration(a.animation_settings.BUTTON_USE_DELAY))},
train:function(b,c,e,g){var h=function(){e();c.run_next_step(!0)};(g=g.step.run_watched)?(b.run_next_step=h,b.get_parent_of_frontside()?b.set_context(b.get_parent_of_frontside().get_widget()):a.UTILITIES.report_internal_error("Robot being trained by a robot that doesn't know its parent widget.  robot_being_trained is "+b+" robot is "+c),g(b)):h()},"open the backside":x,"open the backside of":x,"close the backside of":q,"close the backside":q,"click the button of":function(a,b,c,e){m(a,b,function(g){$(g).is(".toontalk-settings-backside-button")&&
">"===g.innerText&&b.add_body_finished_listener(function(){a.get_backside()&&a.get_backside().set_advanced_settings_showing(!1,a.get_backside_element())});".toontalk-green-flag"!==e.button_selector&&".toontalk-stop-sign"!==e.button_selector&&$(g).click();c()},e.button_selector,e)}};a.creators_from_json.robot_action=function(b,c){return b.additional_info?a.robot_action.create(a.UTILITIES.create_from_json(b.path,c),b.action_name,a.UTILITIES.create_keys_from_json(b.additional_info,c)):a.robot_action.create(a.UTILITIES.create_from_json(b.path,
c),b.action_name)};return{create:function(b,e,g){var h=Object.create(this),k=c[e],m=A[e];if(m)return b||a.UTILITIES.report_internal_error("path undefined in "+e+" action"),k||a.UTILITIES.report_internal_error("no run_function for "+e),h.get_action_name=function(){return e},h.get_additional_info=function(){return g},h.run_unwatched=function(c){var e=a.path.dereference_path(b,c);if(!e)return a.UTILITIES.report_internal_error("Unable to dereference path: "+a.path.toString(b)+", the back of "+c.get_context()+
". This could be because this robot ("+c+") was trained in a very different situation.",{dont_log_exception:!0}),!1;a.logging&&0<=a.logging.indexOf("event")&&(e.wait_until_this_nest_receives_something?console.log("   wait_until_this_nest_receives_something "+e.wait_until_this_nest_receives_something.to_debug_string(50)+"("+a.path.toString(b)+") by unwatched "+c.to_debug_string(50)+" "+c._debug_id):console.log("   "+e.to_debug_string(50)+" ("+a.path.toString(b)+") by unwatched "+c.to_debug_string(50)+
" "+c._debug_id));e.wait_until_this_nest_receives_something?e.wait_until_this_nest_receives_something.run_when_non_empty(function(){c.visible()?this.run_watched(c):this.run_unwatched(c)}.bind(this),c):(g&&(g.running_watched=!1),k(e,c,g)&&c.run_next_step())},h.run_watched=function(c){var e;c.stopped?c.stopped()&&!c.being_trained?this.run_unwatched(c):(e=a.path.dereference_path(b,c))?(a.logging&&0<=a.logging.indexOf("event")&&console.log("   "+e+" ("+a.path.toString(b)+" "+(e.to_debug_string?e.to_debug_string(50):
e)+" by watched "+c.to_debug_string(50)+" "+c._debug_id+(c.animate_consequences_of_actions()?"":" finishing instantly")),e.wait_until_this_nest_receives_something?(e.wait_until_this_nest_receives_something.run_when_non_empty(function(){c.set_waiting(!1);this.run_watched(c)}.bind(this),c),c.set_waiting(!0),TOONTALK.UTILITIES.visible_element(c.get_context().get_backside_element())||c.get_frontside().remove()):(g&&(g.running_watched=!0),m(e,c,function(){g||(g={});g.running_watched=!0;k(e,c,g)},g))):
a.UTILITIES.display_message("Unable to dereference the path: "+a.path.toString(b)+" in context: "+c.get_context(),{only_if_new:!0}):a.UTILITIES.report_internal_error("Watched action not passed its robot. Was passed "+c+" and action is "+this)},h.toString=function(c){var h="",k="",m=e;if("open the backside"===e||"close the backside"===e)e+=" of";if("click the button of"===e)switch(g.button_selector){case ".toontalk-green-flag":m="click the green flag "+a.UTILITIES.encode_HTML_for_title("<span class='toontalk-green-flag-icon'></span>")+
" of";break;case ".toontalk-stop-sign":m="click the stop sign "+a.UTILITIES.encode_HTML_for_title("<span class='toontalk-stop-sign-icon'></span>")+" of";break;case ".toontalk-play-sound-effect-button":m="click the 'Play Sound' button of";break;case ".toontalk-settings-backside-button":m="open the advanced settings of";break;case ".toontalk-show-attributes-chooser-button":m="click the button to add or remove attributes of ";break;case ".toontalk-remove-backside-and-widget-button":m="click the button to remove the back and front of ";
break;default:m="click a button of"}if("add a new widget to the work space"===e)return e.replace("a new widget",a.path.toString(b));if("add to the top-level backside"===e)return"";c||(c={});var p=a.path.toString(b,c);if("edit"===e||"drop it on the text area of"===e)h=" ("+g.toString+")";else if("train"===e){h=g.step.toString({person:"third"});if(""===h)return h;h=" to "+h;k="- ";c&&c.robot_being_trained_description&&(p=c.robot_being_trained_description)}else"start training"===e?c&&(c.robot_being_trained_description=
"it"):"stop training"===e&&(p=c.robot_being_trained_description,c.robot_being_trained_description=void 0);if(0<="pick up;edit;remove;copy;change whether erased;pick up a copy of;drop it on the text area of".split(";").indexOf(e)){if(0<=p.indexOf("hole of"))return k+m+" what is in "+p+h;if(0===p.indexOf("a When"))return p=p.substring(3),p=a.UTILITIES.remove_encoded_HTML(p),p=a.UTILITIES.elide(p,80,1),"."===p[p.length-1]&&(p=p.substring(0,p.length-1)),k+m+" a robot who "+p+h+"\n"}return k+m+" "+p+h},
h.get_json=function(c,h,k,m){var p=function(g,k,m){a.path.get_json(b,c,function(a,b,c){h({type:"robot_action",action_name:e,path:a,additional_info:g},b,c+1)},k,m+1)};g?a.UTILITIES.get_json_of_keys(g,["running_watched"],p,k,m+1):p(void 0,k,m+1)},h;a.UTILITIES.report_internal_error("No watched function for "+e)}}}(window.TOONTALK);window.TOONTALK.queue=function(a){var k={create:function(){var c=Object.create(this);c.to_run=a.UTILITIES.create_queue();c.run_function=c.run.bind(c);return c},enqueue:function(a){a.running_or_in_run_queue()||(a.set_running_or_in_run_queue(!0),this.to_run.enqueue(a)&&!this.running&&this.run())},maximum_run:50,paused:!1,running:!1,start:function(){this.running||this.to_run.isEmpty()||this.run()},run:function(){var c=Date.now()+k.maximum_run;for(this.running=!0;!this.to_run.isEmpty()&&!this.paused&&
Date.now()<c;){var e=this.to_run.dequeue();e.run_actions()}this.to_run.isEmpty()?this.running=!1:a.UTILITIES.set_timeout(this.run_function)}};return k}(window.TOONTALK);window.TOONTALK.path=function(a){var k;a.creators_from_json["path.to_entire_context"]=function(c,e){return a.path.to_entire_context()};a.creators_from_json["path.to_self"]=function(c,e){return a.path.to_self()};a.creators_from_json["path.to_thing_in_hand"]=function(){return a.path.to_thing_in_hand()};a.creators_from_json["path.to_widget_on_nest"]=function(){return a.path.to_widget_on_nest()};a.creators_from_json["path.top_level_backside"]=function(){return a.path.top_level_backside};a.creators_from_json["path.to_backside_widget_of_context"]=
function(c,e){return"undefined"===typeof c.backside_index?a.path.get_path_to_backside_widget_of_context(c.type_name,e&&e.robot):a.path.get_path_to_backside_index_of_context(c.backside_index,c.type_name,e&&e.robot)};a.creators_from_json["path.to_resource"]=function(c,e){return a.path.get_path_to_resource(a.UTILITIES.create_from_json(c.resource,e))};return{get_path_to:function(c,e,b){var h=function(c,e){var g=e.get_training_context(),h=e.get_body();if(c.is_primary_backside&&c.is_primary_backside()){var k=
!0;c=c.get_widget()}if(g===c){var m=a.path.to_entire_context();m.is_backside=k;return m}if(e===c||e.get_first_in_team()===c)return a.path.to_self();if(e.get_thing_in_hand()===c)return a.path.to_thing_in_hand();var A=c.get_type_name();if("top-level"===A)return a.path.top_level_backside;if(m=h.get_path_to(c,e,b))return m.is_backside=k,m;if("element attribute"===A&&c.is_attribute_widget_copy(c))return m=a.element.create_attribute_path(c,e),m.is_backside=k,m;if(g){if(g.get_path_to&&(h=g.get_path_to(c,
e)))return h.is_backside=k,m=a.path.to_entire_context(),m.next=h,m;g.get_backside_widgets().some(function(b){b=b.get_widget();var g;if(b===c||b.top_contents_is&&b.top_contents_is(c))return e.add_to_backside_conditions(b),m=a.path.get_path_to_backside_widget_of_context(b,e),m.is_backside=k,!0;if(b.get_path_to&&(g=b.get_path_to(c,e)))return g.is_backside=k,e.add_to_backside_conditions(b),m=a.path.get_path_to_backside_widget_of_context(b,e),m.next=g,!0});if(m)return m.is_backside=k,m;if((g=!c.is_robot()&&
c.ancestor_of_type&&c.ancestor_of_type("robot"))&&g!==c)return a.robot.find_conditions_path(c,g,e);if(m=a.path.get_path_to_resource(c.dereference().copy()))m.is_backside=k;return m}a.UTILITIES.report_internal_error("function"==="No context to compute the path. Widget is "+c+" robot is "+e+". Robot parent is"+typeof this.get_parent_widget_of_frontside?this.get_parent_widget_of_frontside():"Cannot access its parent. Type is "+typeof this+" and type of get_parent_widget_of_frontside is "+typeof this.get_parent_widget_of_frontside)}(c,
e,b);h&&c.dereference_contents&&(a.path.path_end(h).not_to_be_dereferenced=!0);!h||"pick up"!==e.current_action_name&&"remove"!==e.current_action_name||(a.path.path_end(h).removing_widget=!0);return h},path_end:function(a){for(;a.next;)a=a.next;return a},dereference_path:function(a,e,b){var c;a?a.dereference_path?c=a.dereference_path(e,b):b&&b.dereference_path&&(c=b.dereference_path(a,e)):c=b||e.get_context();return c&&a&&a.is_backside?c.get_backside(!0):c},continue_dereferencing_path:function(a,
e,b){void 0===e&&b.context_is_backside()&&(e=b.get_top_level_context());void 0===e&&(e=b.get_context());return a.next?e.dereference_contents&&!a.next.not_to_be_dereferenced?(e=e.dereference_contents(a,b))&&a.is_backside?e.get_backside(!0):e:(e=e.dereference_path(a.next,b))&&a.next.is_backside?e.get_backside(!0):e:e.dereference_contents&&!a.not_to_be_dereferenced?(e=e.dereference_contents(a,b))&&a.is_backside?e.get_backside(!0):e:e},toString:function(c,e){var b="";if(!c)return"undefined path";c.is_backside&&
(b="the backside of ");e||(e={});var h=e.resource;e.resource=!0;c.next?(a.path.toString(c.next,e),c=b+a.path.toString(c.next,e).trim()+" of "+c.toString(e)):c=b+c.toString(e);e.resource=h;return c},get_json:function(c,e,b,h,k){var g;c.get_json?c.get_json(e,function(h,k,m){c.is_widget&&(h=c.add_to_json(h,e));c.next&&(g=function(a){h.next_path=a},a.path.get_json(c.next,e,g,k,m+1));c.removing_widget&&(h.removing_widget=!0);c.not_to_be_dereferenced&&(h.not_to_be_dereferenced=!0);if(!0===c.is_backside||
c.is_backside&&c.is_backside())h.is_backside=!0;b(h,k,m+1)},h,k+1):b(c,h,k+1)},to_entire_context:function(c){return{dereference_path:function(c,b){return a.path.continue_dereferencing_path(this,b,c)},toString:function(a){return a&&a.robot?a.robot.get_top_level_context_description(a):a&&"third"===a.person?"what he's working on":"what I'm working on"},get_json:function(a,b,c,k){b({type:"path.to_entire_context"},c,k+1)}}},to_self:function(){return{dereference_path:function(a,e){return a.get_first_in_team()},
toString:function(a){return"myself"},get_json:function(a,e,b,h){e({type:"path.to_self"},b,h+1)}}},to_widget_on_nest:function(){return{dereference_path:function(c,e){return a.path.continue_dereferencing_path(this,e,c)},toString:function(){return"what is on the nest"},get_json:function(a,e,b,h){e({type:"path.to_widget_on_nest"},b,h+1)}}},to_thing_in_hand:function(){return{dereference_path:function(c,e){return a.path.continue_dereferencing_path(this,c.get_thing_in_hand(),c)},toString:function(){return"what I'm holding"},
get_json:function(a,e,b,h){e({type:"path.to_thing_in_hand"},b,h+1)}}},get_path_to_resource:function(c){var e;if(c){if(e=c.get_widget())return{dereference_path:function(b){var c=e.copy({copying_resource:!0}),k;b.add_newly_created_widget(c);if(b.visible()&&(k=a.UTILITIES.find_resource_equal_to_widget(e,b))){c.save_dimensions_of(a.UTILITIES.widget_side_of_element(k));var g=c.get_frontside_element();var v=$(k).position();a.UTILITIES.set_timeout(function(){$(g).css({left:v.left,top:v.top,width:$(k).width(),
height:$(k).height()})})}return c},toString:function(b){return a.UTILITIES.add_a_or_an(e.toString(b))},get_json:function(b,c,k,g){e.get_json(a.UTILITIES.fresh_json_history(b),function(a,b,e){c({type:"path.to_resource",resource:a},b,e+1)},k,g+1)}}}else console.error("Widget missing in get_path_to_resource.")},get_path_to_backside_widget_of_context:function(c,e){return"string"===typeof c?{dereference_path:function(b){var e=b.get_context(),k=b.get_backside_widget_of_type(c,e);k||e.get_backside_widgets().some(function(a){if(a.get_widget().is_of_type(c)&&
!b.is_newly_created(a.get_widget()))return k=a.get_widget(),!0});if(k)return a.path.continue_dereferencing_path(this,k,b)},toString:function(b){b=(b&&b.robot&&b.robot.get_backside_conditions()?b.robot.get_backside_conditions()[c]:a.UTILITIES.add_a_or_an(c))+" on the back of what I'm working on";return this.removing_widget?"what is on "+b:b},get_json:function(a,e,k,g){e({type:"path.to_backside_widget_of_context",type_name:c},k,g+1)}}:this.get_path_to_backside_index_of_context(e.get_backside_condition_index(c),
c.get_type_name(),e)},get_path_to_backside_index_of_context:function(c,e,b){return{dereference_path:function(b){var h=b.get_backside_matched_widgets()[c],g=function(a,b){var c;b.some(function(b){if(b.get_type_name()===a){if(c)return c=void 0,!0;c=b.dereference()}});return c};h&&h.get_type_name()!==e&&(h=g(e,b.get_backside_matched_widgets()));if(this.next)return a.path.dereference_path(this.next,b,h);if(h)return this.removing_widget&&((g=h.get_parent_of_frontside())&&g.is_hole()&&(g=g.get_parent_of_frontside()),
g&&g.removed_from_container&&"nest"!==e&&b.remove_from_container(h,g)),a.path.continue_dereferencing_path(this,h,b);a.debugging&&console.log("can this happen?")},toString:function(c){var h=(c=(c=b.get_frontside_conditions())&&c.is_top_level())?"work area":"back of what";h=a.UTILITIES.add_a_or_an(e||"thing")+" on the "+h+" I'm working on";return!this.removing_widget||c&&"nest"!==e?h:"what is on "+h},get_json:function(a,b,g,k){b({type:"path.to_backside_widget_of_context",type_name:e,backside_index:c},
g,k+1)}}},process_path_json:function(c,e,b){e.next_path&&(c.next=a.UTILITIES.create_from_json(e.next_path,b));e.removing_widget&&(c.removing_widget=!0);e.not_to_be_dereferenced&&(c.not_to_be_dereferenced=!0);e.is_backside&&(c.is_backside=!0)},top_level_backside:{dereference_path:function(c){if(c=c.get_context().ancestor_of_type&&c.get_context().ancestor_of_type("top-level"))return c;k||(k=a.widget.create_top_level_widget());return k},toString:function(){return"the top-level backside"},get_json:function(a,
e,b,h){e({type:"path.top_level_backside"},b,h+1)}}}}(window.TOONTALK);window.TOONTALK.publish=function(a){var k=function(a,e,b){var c='<!DOCTYPE html>\n<html>\n<head>\n<script src="https://toontalk.github.io/ToonTalk/toontalk.js?published=1">\x3c/script>\n<title>\n'+a+"</title>\n</head>\n<body>\n";e.forEach(function(a,e){c+='<div class="toontalk-edit" contenteditable="true">\n'+a+"\n</div>\n";b[e]&&(c+=b[e])});return c+="</body>\n</html>\n"};return{publish_widget:function(c,e,b,h){var m=a.google_drive.get_status(),g=["Edit this. Select text for formatting."],v=function(b){(b=
b&&b.items&&0<b.items.length&&b.items[0])?h(b,p):(b=k(c,g,p),a.google_drive.upload_file(x,"html",b,h))};if("Ready"===m){var x=e.get_setting("program_name");if(b)a.UTILITIES.get_json_top_level(e,function(b){e.set_setting("program_name",x+" (published version)");p=[a.UTILITIES.toontalk_json_div(b,e)];e.set_setting("program_name",x)});else{b=e.get_backside_widgets();var p=[];b.forEach(function(b,c){b.visible()&&a.UTILITIES.get_json_top_level(b,function(c){c.view&&(c.view.saved_width=void 0,c.view.saved_height=
void 0);p.push(a.UTILITIES.toontalk_json_div(c,b.get_widget()));g.push("")})})}a.google_drive.get_toontalk_files(a.google_drive.full_file_name(x,"page"),"page",v)}else console.log("Unable to publish to Google Drive because: "+m),h(null)},republish:function(c){a.google_drive.insert_or_update_file(void 0,c.file_id,"page",k(c.title,c.editable_contents,c.widgets_json),function(){console.log("Published page '"+c.title+"' updated.")})}}}(window.TOONTALK);function handle_client_load(){window.TOONTALK?window.TOONTALK.google_drive.handle_client_load():setTimeout(handle_client_load,1E3)}
window.TOONTALK.google_drive=function(a){var k=a.GOOGLE_DRIVE_CLIENT_ID||"148386604750-704q35l4gcffpj2nn3p4ivcopl81nm27.apps.googleusercontent.com",c=a.ORIGIN_FOR_GOOGLE_DRIVE||"toontalk.github.io",e="Need to authorize",b,h;return{handle_client_load:function(b){0>window.location.href.indexOf(c)?(e="Connections to Google Drive are configured for the following domain only: "+c+".\nIf you are hosting ToonTalk elsewhere you need to set TOONTALK.GOOGLE_DRIVE_CLIENT_ID and TOONTALK.ORIGIN_FOR_GOOGLE_DRIVE",
b?b(e):console.log(e)):setTimeout(function(){a.google_drive.check_authorization(b)})},check_authorization:function(b){e="Awaiting authorization";gapi.auth.authorize({client_id:k,scope:"https://www.googleapis.com/auth/drive",immediate:!0},function(c){a.google_drive.handle_authorization_result(c,b)})},handle_authorization_result:function(b,c){b&&!b.error?(e="Authorized but not yet ready",gapi.client.load("drive","v2",function(){a.google_drive.get_folder_ids(function(){e="Ready";"undefined"!==typeof CKEDITOR&&
$(".toontalk-edit").each(function(b,c){CKEDITOR.inline(c);a.UTILITIES.can_receive_drops(c)})})}),c&&c()):(e="Need to authorize",c&&c(e))},authorize:function(b){gapi.auth.authorize({client_id:k,scope:"https://www.googleapis.com/auth/drive",immediate:!1},function(c){a.google_drive.handle_authorization_result(c,b)})},get_folder_ids:function(c){a.google_drive.get_folder_id(!0,function(e){b=e;a.google_drive.get_folder_id(!1,function(a){h=a;c()})})},get_folder_id:function(c,e){var g=c?"ToonTalk Programs":
"ToonTalk Pages",k=function(b){var h=function(a){a&&a.id?e(a.id):(console.error("Failure to create folder '"+g+"'. Response follows."),console.error(a))};(b=b&&b.items&&0<b.items.length&&b.items[0].id)?e(b):c?a.google_drive.create_folder("ToonTalk Programs",!1,h):a.google_drive.create_folder("ToonTalk Pages",!0,h)};c&&b?e(b):!c&&h?e(h):a.google_drive.fetch_folder_id(g,k)},get_status:function(){return e},connection_to_google_drive_possible:function(){return 0!==e.indexOf("Connections to Google Drive are configured for the following domain only: ")&&
!a.CHROME_APP},list_files:function(a,b){gapi.client.request({path:"/drive/v2/files",method:"GET",params:a}).execute(b)},fetch_folder_id:function(b,c){a.google_drive.list_files({q:"mimeType = 'application/vnd.google-apps.folder' and title ='"+b+"' and trashed = false"},c)},get_toontalk_files:function(b,c,e){"undefined"===typeof gapi?e("Google Drive API not available."):(c="properties has {key='ToonTalkType' and value='"+c+"' and visibility='PUBLIC'} and trashed = false",b&&(c+=" and title='"+b+"'"),
a.google_drive.list_files({q:c},e))},get_toontalk_program_file:function(c,e){a.google_drive.list_files({q:"'"+b+"' in parents and trashed = false and title='"+c+"'"},function(a){a&&a.items&&0<a.items.length?e(a.items[0]):e(null)})},upload_file:function(b,c,e,h){var g="json"===c?"program":"page",k=b+"."+c;a.google_drive.get_toontalk_files(k,g,function(b){gapi.client.load("drive","v2",function(){var c=b&&b.items&&0<b.items.length&&b.items[0].id;h||(h=function(b){b.error?(console.log("Google drive status: "+
a.google_drive.get_status()),"Login Required"!==b.error.message&&console.log(b.error.message)):a.debugging&&console.log("File "+b.title+" ("+b.id+") "+(c?"updated":"created"))});c?a.google_drive.insert_or_update_file(void 0,c,g,e,h):a.google_drive.insert_or_update_file(k,void 0,g,e,h)})})},full_file_name:function(a,b){return a+"."+("program"===b?"json":"html")},insert_or_update_file:function(c,e,k,x,p){var g={title:c,mimeType:"text/html"};g.parents=[{kind:"drive#fileLink",id:"program"===k?b:h}];x=
"\r\n---------314159265358979323846\r\nContent-Type: application/json\r\n\r\n"+JSON.stringify(g)+"\r\n---------314159265358979323846\r\nContent-Type: text/html\r\n\r\n"+x+"\r\n---------314159265358979323846--";if(c){g="/upload/drive/v2/files";var m="POST"}else g="/upload/drive/v2/files/"+e,m="PUT";gapi.client.request({path:g,method:m,params:{uploadType:"multipart"},headers:{"Content-Type":'multipart/mixed; boundary="-------314159265358979323846"'},body:x}).execute(function(b){e||a.google_drive.insert_property(b.id,
"ToonTalkType",k,"PUBLIC");b.error?console.log("Unable to access file "+(c||e)+" due to error: "+b.error.message):p&&p(b)})},create_folder:function(a,b,c){void 0===gapi.client.drive?console.log("Expected gapi.client.drive to be defined to accesss Google drive."):gapi.client.drive.files.insert({resource:{title:a,mimeType:"application/vnd.google-apps.folder"}}).execute(b?function(a){gapi.client.drive.permissions.insert({fileId:a.id,resource:{value:"",type:"anyone",role:"reader"}}).execute(function(b){c(a)})}:
c)},download_file:function(b,c){if(b.downloadUrl){var e=gapi.auth.getToken().access_token;a.UTILITIES.download_file(b.downloadUrl,c,e)}else c(null)},google_drive_url:function(b,c){return"function"===typeof a.cross_origin_url_function?(b=a.cross_origin_url_function("https://drive.google.com/uc?id="+b),a.TOONTALK_URL+"published.html"+window.location.search+(window.location.search?"&":"?")+"replace-with-url="+encodeURIComponent(b)):"https://drive.google.com/uc?export=download&id="+b},insert_property:function(a,
b,c,e){gapi.client.drive.properties.insert({fileId:a,resource:{key:b,value:c,visibility:e}}).execute(function(a){})}}}(window.TOONTALK);function googleTranslateElementInit(){window.TOONTALK.translate_element=new google.translate.TranslateElement({pageLanguage:"en",layout:google.translate.TranslateElement.InlineLayout.SIMPLE},"google_translate_element")}
window.TOONTALK.UTILITIES=function(a){var k={},c=!1,e=100,b=[],h=[],m=function(a){var b;for(b=0;b<a.addedNodes.length;b++){var c=a.addedNodes.item(b);if(1===c.nodeType){if(!c.toontalk_widget_side&&$(c).is(".toontalk-side")){$(c).remove();break}setTimeout(function(){!c.toontalk_attached_callback||$(c).is(".toontalk-not-observable")&&!c.toontalk_run_even_if_not_observable||($(c).removeClass("toontalk-has-attached-callback"),c.toontalk_attached_callback(),c.toontalk_attached_callback=void 0,c.toontalk_run_even_if_not_observable=
void 0);$(c).find(".toontalk-has-attached-callback").each(function(a,b){$(b).removeClass("toontalk-has-attached-callback");b.toontalk_attached_callback&&(b.toontalk_attached_callback(),b.toontalk_attached_callback=void 0)})})}$(c.parentElement).is(".toontalk-frontside")?$(c).css({"z-index":""}):$(c.parentElement).is(".toontalk-backside")&&$(c).css({"z-index":k.next_z_index()})}},g=new MutationObserver(function(a){a.forEach(m)}),v=function(){var b=new MutationObserver(function(a){a.forEach(function(a){(a=
$(a.target).closest(".toontalk-translation-element").get(0))&&a.toontalk_callback&&(a.toontalk_callback(a.innerText),a.innerText="",a.toontalk_callback=void 0)})});$("a").each(function(a,b){b.href=k.add_URL_parameter(b.href,"translate","1")});if(!$("#google_translate_element").is("*")){var c=document.createElement("div");c.id="google_translate_element";document.body.insertBefore(c,document.body.firstChild)}document.head.appendChild($('<meta name="google-translate-customization" content="7e20c0dc38d147d6-a2c819007bfac9d1-gc84ee27cc12fd5d1-1b"></meta>')[0]);
a.CHROME_APP||V("https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit");var d=document.createElement("div");d.className="toontalk-translation-element";document.body.appendChild(d);b.observe(d,{characterData:!0,subtree:!0});k.translate=function(a,b){d.innerHTML=a;d.toontalk_callback=b}},x=function(a,b,c){if(a){var d=a[b]||0;a[c]&&(d/=a[c]);for(a=a.parentElement;a;)d+=a[b]||0,a[c]&&(d/=a[c]),a=a.parentElement;return d}},p=function(b,c){a.debugging+="\n"+b;console.log(b);
c&&(alert(a.debugging),a.debugging="touch")},q=function(a){var b=a.indexOf("<div style='display:none;'>{");b=0>b?a.indexOf("{"):b+27;var c=a.lastIndexOf("}");if(!(0>b||0>c))return a.substring(b,c+1)},A=function(b){var c=b.currentTarget;if(!$(c).is(".toontalk-conditions-contents")){var d=$(c).closest(".toontalk-side"),e=k.get_mouse_or_first_touch_event_attribute("clientX",b),g=k.get_mouse_or_first_touch_event_attribute("clientY",b),l;$(".ui-tooltip").remove();$(".ui-tooltip").removeClass("toontalk-side-animating");
if(!(b.dataTransfer&&b.dataTransfer.getData("text")&&0<b.dataTransfer.getData("text").length&&0!=b.dataTransfer.getData("text").indexOf("data:"))){f=d||$(c);var h=k.widget_side_of_jquery(f);if(!h){h=k.widget_side_of_element(c);k.report_internal_error("Possible bug that "+f+" doesn't have a known owner.");if(!h){k.report_internal_error("The element doesn't have an owner either.");return}f=$(c)}h=h.get_selection();f=$(h.get_element());k.get_dragee_copy()&&k.get_dragee_copy().render();h.set_stopped&&
h.set_stopped(!0);!h.save_dimensions||h.get_parent_of_frontside()&&!h.get_parent_of_frontside().get_widget().is_top_level()||h.save_dimensions();h.being_dragged=!0;var m=f.get(0).getBoundingClientRect();var n=f.is(".toontalk-top-level-resource");$(c).removeClass("toontalk-wiggle");h.get_json&&(c=function(a){a.view.drag_x_offset=e-m.left;a.view.drag_y_offset=g-m.top;!a.view.frontside_width&&f.parent().is(".toontalk-backside")&&(a.view.frontside_width=f.width(),a.view.frontside_height=f.height());f&&
f.data("json",a);if(b.dataTransfer)try{l=k.toontalk_json_div(a,h),b.dataTransfer.effectAllowed=n?"copy":"move",b.dataTransfer.setData("text",l),k.is_internet_explorer()||b.dataTransfer.setData("text/html",l)}catch(xa){}h.drag_started&&h.drag_started(a,n)},a.UTILITIES.get_json_top_level(h,c,6E5));f.addClass("toontalk-being-dragged");(c=h.get_listeners("picked up"))&&c.map(function(a){a()});b.stopPropagation()}}},y=function(a){var b;if(!$(a.currentTarget).is(".toontalk-conditions-contents")){f||(f=
$(a.target).closest(".toontalk-side"));if(b=k.widget_side_of_jquery(f))b.being_dragged=void 0,(b=b.get_listeners("dropped"))&&b.map(function(a){a()});f.is(".toontalk-frontside")&&(f.parent().is(".toontalk-backside")?(b=f.data("json"))&&k.set_css(f,{width:b.view.frontside_width,height:b.view.frontside_height}):f.parent().is(".toontalk-top-level-resource, .toontalk-drop-area, .toontalk-json")||f.is(".toontalk-carried-by-bird, .toontalk-element-attribute, .toontalk-function-bird-documentation-bird")||
k.has_animating_image(f.get(0))||k.set_css(f,{width:"100%",height:"100%"}));N();a.stopPropagation()}},z=function(a){if(f)return k.widget_side_of_jquery(f);if(a)return a=k.data_transfer_json_object(a),k.create_from_json(a)},n=function(b){var c=b.currentTarget,d=k.data_transfer_json_object(b),e=function(b,d){b=k.create_from_json(b);d=document.createElement("div");var e=b.get_element(!0),f=$(c).closest(".toontalk-edit"),g=a.published_support.create_editable_text();$(d).addClass("toontalk-json toontalk-top-level-resource toontalk-top-level-resource-container");
$(e).addClass("toontalk-top-level-resource").css({position:"relative",width:b.saved_width,height:b.saved_height});e.toontalk_widget_side=b;d.toontalk_widget_side=b;d.appendChild(e);$(d).insertAfter(f);$(g).insertAfter(d);CKEDITOR.inline(g);k.can_receive_drops(g);b.set_visible(!0);b.render()},g=function(){m.hide();var b=document.elementFromPoint(p-window.pageXOffset-a.USABILITY_DRAG_OFFSET.x,q-window.pageYOffset-a.USABILITY_DRAG_OFFSET.y);m.show();if(b)return $(b).closest(".toontalk-side")},l,h;void 0===
d&&f&&(d=f.data("json"));f&&f.data("json","");var m=f;N();if(m||void 0!==d||b.dataTransfer.files||Q(b)){if($(b.target).is(".toontalk-drop-area-instructions"))e=$(b.target).parent();else if($(b.target).is(".toontalk-element-attribute-input")){if(e=$(b.target).closest(".toontalk-side"),l=k.widget_side_of_jquery(e)){var n=m?k.widget_side_of_jquery(m):k.create_from_json(d);k.restore_resource(m,n);l.dropped_on_style_attribute(n,b.target.name,b);b.stopPropagation();return}}else if($(b.target).is(".toontalk-drop-area"))e=
$(b.target);else{if(d&&$(b.currentTarget).is(".toontalk-edit")){e(d,b);return}m&&m.is(".toontalk-backside")?e=$(b.target).closest(".toontalk-backside, .toontalk-bird, .toontalk-nest, .toontalk-box"):(e=$(b.target).closest(".toontalk-side"),0<e.length&&m&&P(e.get(0),m.get(0))&&(e=m.parent().closest(".toontalk-side")))}if(0!==e.length){var p=k.get_mouse_or_first_touch_event_attribute("pageX",b);var q=k.get_mouse_or_first_touch_event_attribute("pageY",b);if(e.is(".toontalk-top-level-resource"))if("touchend"===
b.type){e=$(".toontalk-highlight");if(0===e.length||e.get(0)===m.get(0))e=g();if(!e||0===e.length)return}else return;var r=e.offset();l=k.widget_side_of_jquery(e);if(m&&0<m.length&&!(l&&l.get_widget().get_infinite_stack&&l.get_widget().get_infinite_stack())&&(m.get(0)===e.get(0)||jQuery.contains(m.get(0),e.get(0)))){if(m.is(".toontalk-backside-of-top-level"))return;e=$(".toontalk-highlight");if(0===e.length||e.get(0)===m.get(0))e=g();if(!e||0===e.length)return;r=e.offset();g=k.widget_side_of_jquery(e);
if(!l||l.is_backside()&&g.is_backside()||!l.is_backside()&&!g.is_backside())l=g}k.remove_highlight();if(d&&d.view&&d.view.drag_x_offset){g=d.view.drag_x_offset;var t=d.view.drag_y_offset}else t=g=0;if(m&&0<m.length){if(!(l&&l.get_widget().get_infinite_stack&&l.get_widget().get_infinite_stack()||m.get(0)!==e.get(0)&&!jQuery.contains(m.get(0),e.get(0)))){k.set_css(m,{left:m.get(0).offsetLeft+(b.layerX-g),top:m.get(0).offsetTop+(b.layerY-t)});b.stopPropagation();return}n=k.widget_side_of_jquery(m);if(m.parent().is(".toontalk-drop-area"))m.removeClass("toontalk-widget-in-drop_area"),
"function"===typeof m.parent&&m.parent().data("drop_area_owner").set_next_robot(void 0);else{if(h=n&&n.get_parent()){var v=$(h.get_element());!n.is_backside()&&n.get_widget().get_infinite_stack&&n.get_widget().get_infinite_stack()?(v=n.get_widget().saved_width,h=n.get_widget().saved_height,n=k.get_dragee_copy(),n.get_widget().saved_width=v,n.get_widget().saved_height=h,v=m.width(),h=m.height(),m=$(n.get_element(!0)),e.is(".toontalk-backside")&&k.set_css(m,{width:d.view.frontside_width||v,height:d.view.frontside_height||
h}),n.update_display()):h.removed_from_container&&(v.is(".toontalk-backside")?h.remove_backside_widget(n,!0):(h.removed_from_container(n,b),n.restore_dimensions&&!h.is_empty_hole()&&n.restore_dimensions()))}else k.restore_resource(m,n);n&&n.robot_in_training()&&n.robot_in_training().add_newly_created_widget_if_new(n)}}else{if(d)n=k.create_from_json(d,{event:b});else{if(0<b.dataTransfer.files.length){for(d=0;d<b.dataTransfer.files.length;d++)K(b.dataTransfer.files[d],e,l,r,b);b.stopPropagation();return}if(Q(b)){E(b.dataTransfer.getData("URL"),
e,l,r,b);b.stopPropagation();return}}if(!n){d?k.report_internal_error("Unable to construct a ToonTalk widget from the JSON."):a.debugging&&console.log("No data transfer in drop.");b.stopPropagation();return}n.robot_in_training()&&n.robot_in_training().drop_from_data_transfer(n);m=$(n.get_element(!0));n.is_primary_backside&&n.is_primary_backside()&&(k.set_css(m,{width:d.view.backside_width,height:d.view.backside_height,"background-color":d.view.background_color,"border-width":d.view.border_width}),
n.apply_backside_geometry())}l&&n&&!n.is_backside()&&n.get_widget()===l.get_widget()||n&&D(e,m,n,l,r,b,d,g,t)}}else b.dataTransfer?k.report_internal_error("Drop failed since unable to parse as JSON."):k.report_internal_error("Drop failed since there is no event.dataTransfer"),b.stopPropagation()},w=function(a,b){a.addEventListener("drop",function(a){var c=z(a);k.restore_resource(k.get_$dragee(),c);b(a)});k.can_receive_drops(a)},I=function(a,b){var c=k.get_$dragee();var d=c&&c.is(".toontalk-backside")?
$(b).closest(".toontalk-backside, .toontalk-bird, .toontalk-nest, .toontalk-box"):$(b).closest(".toontalk-side");$(b).is(".toontalk-drop-area")&&c.is(".toontalk-robot")?($(b).addClass("toontalk-highlight"),b=void 0):($(b).is(".toontalk-box-size-input")||$(b).is(".toontalk-numerator-input")||$(b).is(".toontalk-denominator-input"))&&c.is(".toontalk-number")?($(b).addClass("toontalk-highlight"),b=void 0):b=!d.is("*")||d.is(".toontalk-backside-of-top-level")||d.closest(".toontalk-top-level-resource").is("*")||
d.is(".toontalk-being-dragged")||c&&P(d.get(0),c.get(0))?void 0:d;if(b)return k.highlight_element(b.get(0),a),b.get(0)},D=function(b,c,d,e,f,g,h,m,n){var l=k.get_mouse_or_first_touch_event_attribute("pageX",g),u=k.get_mouse_or_first_touch_event_attribute("pageY",g);m||(m=0);n||(n=0);d.set_visible(!0);h&&h.semantic&&h.semantic.running&&k.set_timeout(function(){d.set_running(!0)},100);if(b.is(".toontalk-backside")){if(d.get_widget().is_top_level()){var p=h.semantic.backside_widgets;var q=h.shared_widgets;
var r=b.get(0);(m=e.robot_in_training())&&m.drop_from_data_transfer(d,e);m=d.get_backside_widgets().slice();a.UTILITIES.for_each_batch(m,function(a,b){var c=a.get_widget();d.remove_backside_widget(a);b=0<=p[b].widget.shared_widget_index?q[p[b].widget.shared_widget_index].view:p[b].widget.view;var f=a.get_element(!0);if(!P(f,r)){if(a.is_backside()){var g=b.backside_left;var l=b.backside_top;var h=b.backside_width;var u=b.backside_height}else g=b.frontside_left,l=b.frontside_top,h=b.frontside_width,
u=b.frontside_height;e.add_backside_widget(a);r.appendChild(f);var m=$(f).position();L={left:m.left+g,top:m.top+l};a.is_resizable()&&(L.width=h,L.height=u);k.constrain_css_to_fit_inside(r,L);k.set_css(f,L);d.set_location_attributes&&c.set_location_attributes(L.left,L.top);a.is_backside()&&(c.backside_geometry=b.backside_geometry,c.apply_backside_geometry())}}.bind(this));e.top_level_widget().backup_all();return}if(!e){k.report_internal_error("No target_widget");return}d?e.widget_side_dropped_on_me(d,
{event:g}):k.report_internal_error("No source_widget");g=l-(f.left+(m||0));b=u-(f.top+(n||0));var L={left:k.left_as_percent(g,c.get(0)),top:k.top_as_percent(b,c.get(0))};k.set_css(c,L);!d.is_backside()&&d.set_location_attributes&&d.set_location_attributes(g,b);h&&h.semantic&&h.semantic.running&&!k.get_$dragee()&&d.set_running(!0)}else if(b.is(".toontalk-drop-area"))c.addClass("toontalk-widget-in-drop_area"),0<b.length&&b.get(0).appendChild(c.get(0)),c.is(".toontalk-robot")&&b.data("drop_area_owner").set_next_robot(k.widget_side_of_jquery(c));
else{if(c.is(".toontalk-backside-of-top-level"))return;if(e||g.changedTouches){r=b.closest(".toontalk-backside-of-top-level").get(0);!r&&g.changedTouches&&(h=document.elementFromPoint(l-window.pageXOffset,u-window.pageYOffset),(r=$(h).is(".toontalk-backside-of-top-level")?h:$(h).closest(".toontalk-backside-of-top-level").get(0))||(r=$(".toontalk-backside-of-top-level").get(0)),e=k.widget_side_of_element(r).get_backside());if(!r)return;r.appendChild(c.get(0));h=$(r).offset();L={left:l-(h.left+m+a.USABILITY_DRAG_OFFSET.x),
top:u-(h.top+n+a.USABILITY_DRAG_OFFSET.y)};k.set_css(c,L);d.remove_from_parent_of_frontside&&d.remove_from_parent_of_frontside(g);d.set_visible(!0);d.drop_on&&d.drop_on(e,{event:g})||e.widget_side_dropped_on_me&&e.widget_side_dropped_on_me(d,{event:g})||(c=b.closest(".toontalk-backside-of-top-level"),0<c.length&&(e=k.widget_side_of_jquery(c))&&e.widget_side_dropped_on_me(d,{event:g}))}else{console.log("Warning: when handling a drop event the target widget was missing.");return}}a.logging&&0<=a.logging.indexOf("drop")&&
(console.log("Drop of "+d._debug_id+" on "+e._debug_id),console.log("Left: "+L.left+"; top: "+L.top+"; page_x: "+l+"; page_y: "+u+"; drag_x_offset: "+m+"; drag_y_offset: "+n));k.remove_highlight()},K=function(b,c,d,e,f){var g=new FileReader,l=0===b.type.indexOf("image"),h=0===b.type.indexOf("audio"),u=0===b.type.indexOf("video"),m,n,p;g.onloadend=function(){if(l)m=a.element.create("<img src='"+g.result+"' class = 'toontalk-image' alt='"+b.name+"'/>");else if(h){m=a.element.create(b.name+" sound");
var r=new Audio(g.result);r.addEventListener("event",function(a){k.display_message("Error trying to play a sound: "+a.message)});m.set_sound_effect(r)}else if(u)m=a.element.create("<video src='"+g.result+"' alt='"+b.name+"'/>");else{if(n=q(g.result))try{(p=k.parse_json(n))&&(m=k.create_from_json(p))}catch(Ia){}m||(m=a.element.create(g.result))}m&&m.robot_in_training()&&m.robot_in_training().drop_from_data_transfer(m,d);D(c,$(m.get_frontside_element(!0)),m,d,e,f,p)};l||h||u?g.readAsDataURL(b):g.readAsText(b)},
E=function(b,c,d,e,f){var g,l=function(b,c,e,f){var l=function(a){a&&(a&&a.robot_in_training()&&a.robot_in_training().drop_from_data_transfer(a,d),D(c,$(a.get_frontside_element(!0)),a,d,e,f))};k.create_widget_from_URL(b,l,function(c){var d=f.dataTransfer.getData("text/html")||f.dataTransfer.getData("text");d?(g=d,l(a.element.create(d))):(d=g?a.element.create("<div class='toontalk-iframe-container'><iframe srcdoc='"+g+"' width='480' height='320'></iframe></div>"):a.element.create("<div class='toontalk-iframe-container'><iframe src='"+
b+"' width='480' height='480'></iframe></div>"),l(d),console.log("Error loading URL. Loading it in an iframe instead. URL is "+b),console.log(c))})};b.split(/\r?\n/).forEach(function(a){"#"!==a[0]&&l(a,c,e,f)})},O=function(a,b){var c=$("<div class='"+a+"'>");k.run_when_dimensions_known(c.get(0),function(){var a=c.width(),d=c.height();b.get_default_width=function(){return a};b.get_default_height=function(){return d}})},J=function(){var b=k.get_path_to_toontalk_folder()+"sounds/",c=function(a){a=new Audio(b+
a);a.volume=k.get_audio_volume(a);return a};try{a.sounds={hatching:c("SPARROW.mp3"),bird_fly:c("PIGEON.mp3"),bammer_hammer:c("POP.mp3"),vacuum_spit:c("SPIT.mp3"),vacuum_suck:c("DUSTBUST.mp3"),drop:c("BOOK_DROP.mp3"),magic:c("MAGIC.mp3"),fall_inside:c("FALL_INSIDE.mp3"),click:c("TYPE.mp3"),event_ignored:c("PLOP.mp3")},a.sounds.bird_fly.loop=!0}catch(L){}},V=function(a){var b=document.createElement("script");b.src=a;document.body.appendChild(b)},N=function(){f&&(f.removeClass("toontalk-being-dragged"),
k.set_timeout(function(){t=r=f=void 0}))},P=function(a,b){if(a===b)return!0;if(a.parentNode)return P(a.parentNode,b)},G=function(a,b){var c=0,d=encodeURIComponent("<span class='notranslate' translate='no'>decodeURIComponent"),e=encodeURIComponent("decodeURIComponent</span>"),f=a.indexOf(d),g="";if(0>f)return a;for(;0<=f;){var l=f+d.length;var h=a.indexOf(e,l);if(0>h)return k.report_internal_error("Expected title to have matching pairs of "+d+" and "+e),a;g+=a.substring(c,f)+b(a.substring(l,h));c=
h+e.length;f=a.indexOf(d,c)}return g+=a.substring(c)},Q=function(a){return(a=a.dataTransfer&&a.dataTransfer.getData("URL"))&&0<a.length&&0>a.indexOf("data:")},T=function(b){var c=k.get_current_url_parameter("replace-with-url");if(c){var d=decodeURIComponent(c);k.download_file(d,function(c){var e;if(c)if(e=U(c,"body")){if(c=U(c,"title",!0))document.title=c;c=document.createElement("div");c.innerHTML=e;document.body.appendChild(c);b();0<=d.indexOf("drive.google.com")&&a.google_drive.connection_to_google_drive_possible()&&
(e=decodeURIComponent(d),e=e.substring(e.lastIndexOf("id=")+3),$(".toontalk-edit").attr("contenteditable",!0),a.published_support&&a.published_support.send_edit_updates(e))}else k.display_message("Expected contents of "+d+" to contain a body element.");else k.display_message("Unable to read contents of "+d)},"object"==typeof gapi&&gapi.auth&&gapi.auth.getToken()&&gapi.auth.getToken().access_token)}else k.display_message("Expected a url=... parameter in the URL.")},U=function(a,b,c){var d=a.indexOf("<"+
b);if(!(0>d)){var e=a.indexOf("</"+b+">");if(!(0>e))return c?a.substring(d+2+b.length,e):a.substring(d,e+3+b.length)}},F=[],d=[],f,r,t,C,S;window.addEventListener("message",function(a){"zero-timeout-message"===a.data&&a.source===window&&(a.stopPropagation(),0<F.length&&(a=F.shift(),"function"===typeof a&&a()))},!1);g.observe(window.document,{childList:!0,subtree:!0});k.available_types="number box element robot nest sensor top-level".split(" ");k.create_from_json=function(b,c,d,e){var f=function(a,
b,c){(b.shared_widgets[c]=a)&&a.finish_create_from_json_continuation&&(a.finish_create_from_json_continuation(),a.finish_create_from_json_continuation=void 0);return a},g,l,h;if(b){c||(c={});c.guid_to_nest_table||(c.guid_to_nest_table={});b.shared_widgets&&(c.json_of_shared_widgets=b.shared_widgets,c.shared_widgets=[]);b.shared_html&&(b.shared_html=b.shared_html.map(function(a){return Array.isArray(a)?a.join(""):a}),c.shared_html=b.shared_html);if(b.widget)return(g=k.create_from_json(b.widget,c))&&
b.is_backside?g.get_backside(!0):g;if(c&&c.shared_widgets&&0<=b.shared_widget_index){if(e=c.shared_widgets[b.shared_widget_index])return e;e=c.json_of_shared_widgets[b.shared_widget_index];g=a.creators_from_json[e.semantic.type]();c.shared_widgets[b.shared_widget_index]=g;g=k.create_from_json(e,c,g,!0);return f(g,c,b.shared_widget_index)}(h=b.semantic)||(h=b);var u=b.view;if(0<=h.shared_widget_index){if(!c.json_of_shared_widgets){k.report_internal_error("JSON refers to shared widgets but they can't be found. Sorry.");
return}g=k.create_from_json(c.json_of_shared_widgets[h.shared_widget_index],c,d,!0);return f(g,c,h.shared_widget_index)}if(h.type){if(a.creators_from_json[h.type]){c||(c={});u?c.json_view=u:u=c.json_view;if(a.debugging)g=a.creators_from_json[h.type](h,c,d);else try{g=a.creators_from_json[h.type](h,c,d)}catch(xa){console.error(xa.stack),f="Unable to recreate a "+h.type+". Error is "+xa+".",k.report_internal_error(f+" JSON is "+JSON.stringify(b,k.clean_json,"  ")),g=k.create_text_element(f)}g&&!g.is_widget&&
a.path.process_path_json(g,b,c);if(g&&g.get_backside){h.erased&&(a.widget.erasable(g),g.set_erased(h.erased));h.infinite_stack&&g.set_infinite_stack(h.infinite_stack);h.open_backside_only_if_stopped&&g.set_open_backside_only_if_stopped(!0);if(u){if(u.frontside_width)if(l=g.get_element()){if(g.ok_to_set_dimensions()){var m={width:u.frontside_width,height:u.frontside_height};if("element"===h.type)g.on_update_display(function(){k.set_css(l,m)});else k.set_css(l,m)}}else!u.saved_width&&g.is_resizable()&&
(g.saved_width=u.frontside_width,g.saved_height=u.frontside_height);u.saved_width&&g.is_resizable()&&(g.saved_width=u.saved_width,g.saved_height=u.saved_height);u.backside_geometry&&(g.backside_geometry=u.backside_geometry);g.json_view=u}h.backside_widgets&&(e?g.finish_create_from_json_continuation=function(){this.add_backside_widgets_from_json(g,h.backside_widgets,c)}.bind(this):this.add_backside_widgets_from_json(g,h.backside_widgets,c))}return g}k.report_internal_error("JSON type '"+h.type+"' not supported. Perhaps a JavaScript file implementing it is missing.")}else a.UTILITIES.report_internal_error("No type attribute given in "+
JSON.stringify(h,k.clean_json,"  "))}};k.add_backside_widgets_from_json=function(a,b,c){if(b){var d=this.create_array_from_json(b,c);a.set_backside_widgets(d,b.map(function(a){return a&&a.widget?0<=a.widget.shared_widget_index&&c.json_of_shared_widgets[a.widget.shared_widget_index]?c.json_of_shared_widgets[a.widget.shared_widget_index].view:a.widget.view:a}))}};k.create_array_from_json=function(a,b){var c=[];a.forEach(function(a,d){c[d]=a?k.create_from_json(a,b):a});return c};k.get_json_of_array=
function(b,c,d,e,f,g,h){var l;if(h>a.maximum_recursion_depth)throw{toontalk_continuation:function(){k.get_json_of_array(b,c,d,e,f,Date.now(),0)}};if(d>=b.length)f(h+1);else if(l=b[d])if(l.is_primary_backside&&l.is_primary_backside()){var u=function(a,g,l){c.push({widget:a,is_backside:!0});this.get_json_of_array(b,c,d+1,e,f,g,l+1)}.bind(this);k.get_json(l.get_widget(),e,u,g,h+1)}else l.is_widget?(u=function(l,h,u){c.push({widget:l});u>a.maximum_recursion_depth||0===d%100&&(!k.maximum_json_generation_duration||
Date.now()-g>k.maximum_json_generation_duration)?k.set_timeout(function(){this.get_json_of_array(b,c,d+1,e,f,h,0)}.bind(this)):this.get_json_of_array(b,c,d+1,e,f,h,u+1)}.bind(this),k.get_json(l,e,u,g,h+1)):(u=function(a,g,l){c.push(a);this.get_json_of_array(b,c,d+1,e,f,g,l+1)}.bind(this),l.get_json(e,u,g,h+1));else k.get_json_of_array(b,c,d+1,e,f,g,h+1)};k.fresh_json_history=function(a){var b={widgets_encountered:[],shared_widgets:[],json_of_widgets_encountered:[]};a&&a.shared_html&&(b.shared_html=
a.shared_html);return b};k.get_json_top_level=function(a,b,c){var d=this.fresh_json_history(),e=function(c){var e=function(a){a=d.widgets_encountered.indexOf(a);return d.json_of_widgets_encountered[a]},f=function(a){return e(d.shared_widgets[a])},g=d.shared_widgets.map(e);if(0<d.shared_widgets.length&&c.semantic){g=d.shared_widgets.map(e);c.shared_widgets=d.shared_widgets.map(function(b,c){c=e(b);return a===b?{semantic:c.semantic,view:c.view,version:c.version}:c});var l=d.shared_widgets.slice().sort(function(a,
b){return a.is_nest()?-1:b.is_nest()?1:a.has_ancestor_either_side(b)?-1:b.has_ancestor_either_side(a)?1:0});l.map(function(a){a=d.shared_widgets.indexOf(a);k.tree_replace_once(c.semantic,g[a],{shared_widget_index:a},f,k.generate_unique_number())});a===l[l.length-1]&&(c.semantic={shared_widget_index:d.shared_widgets.indexOf(a)})}c.shared_html=d.shared_html;b(c)};k.maximum_json_generation_duration=c;try{k.get_json(a,d,e,Date.now(),0)}catch(aa){if(aa.toontalk_continuation)aa.toontalk_continuation();
else throw aa;}};k.get_json=function(b,c,d,e,f){if(a.debugging&&!c)k.report_internal_error("no json_history");else{void 0===f&&(f=0);var g=c.shared_widgets.indexOf(b);if(0<=g)d({shared_widget_index:g},e,f+1);else if(g=c.widgets_encountered.indexOf(b),0<=g)g=c.shared_widgets.push(b)-1,d({shared_widget_index:g},e,f+1);else{g=c.widgets_encountered.push(b)-1;b.is_primary_backside&&b.is_primary_backside()&&(b=b.get_widget());var l=function(a,e,f){b.add_to_json&&(a=b.add_to_json(a,c));c.json_of_widgets_encountered[g]=
a;if(b.add_backside_widgets_to_json){var l=function(b){d(a,e,b+1)};b.add_backside_widgets_to_json(a,c,l,e,f+1)}else d(a,e,f+1)};if(Date.now()-e<=k.maximum_json_generation_duration&&f<a.maximum_recursion_depth)try{b.get_json(c,l,e,f+1)}catch(la){if(la.toontalk_continuation)throw la;if(k.is_stack_overflow(la))throw{toontalk_continuation:function(){b.get_json(c,l,Date.now(),0)}};k.display_message("Failed to save your project due to error: "+la.message,{only_if_new:!0})}else k.avoid_stack_overflow(function(){b.get_json(c,
l,Date.now(),0)})}}};k.avoid_stack_overflow=function(a){k.set_timeout(function(){try{a()}catch(u){if(u.toontalk_continuation)u.toontalk_continuation();else throw u;}})};k.get_json_of_keys=function(b,c,d,e,f){var g;c||(c=[]);Object.keys(b).forEach(function(d){0>c.indexOf(d)&&(g||(g={}),b[d].get_json?a.path.get_json(b[d],void 0,function(a,b,c){g[d]={json:a}},e,f+1):g[d]=b[d])});d(g,e,f+1)};k.create_keys_from_json=function(a,b){var c={};Object.keys(a).forEach(function(d){c[d]=a[d].json?k.create_from_json(a[d].json,
b):a[d]});return c};k.tree_replace_once=function(a,b,c,d,e){if(a.id_of_tree_replace_once_task!==e){a.id_of_tree_replace_once_task=e;var f;Object.keys(a).some(function(g){f=a[g];if(null!==f){if(f===b)return a[g]=c,!0;if("shared_widget_index"!==g&&!(0<=["string","number","function","undefined","boolean"].indexOf(typeof f))&&this.tree_replace_once(f,b,c,d,e))return!0}}.bind(this));return!1}};k.toontalk_json_div=function(a,b){var c=b.get_widget(),d=c.get_backside_widgets(),e=c.get_type_name();c=c.toString({for_json_div:!0});
"top-level"===e?b.is_backside()?(a.semantic&&(a.semantic.settings=void 0),e="a work area containing ",0===d.length?e="an empty work area":(e=1===d.length?e+"one thing: ":e+(d.length+" things: "),e+=k.describe_widgets(d))):e="a top-level widget":(e=k.add_a_or_an(e),b.is_backside()&&(e="the back of "+e));c&&(b=c.indexOf("data:image/"),0<b&&(d=c.indexOf("alt=",b),0>d&&(d=c.indexOf(">",b)),c=c.substring(0,b+20)+" ... "+c.substring(d)));try{return"<div class='toontalk-json notranslate' translate='no' style='display:none'>\nThis will be replaced by "+
e+".\n"+(c?c+"\n":"")+"<div style='display:none;'>"+JSON.stringify(a,k.clean_json,"  ")+"</div></div>"}catch(aa){return k.is_stack_overflow(aa)?"<div>\n"+e+" is nested too deep to create a JSON string to save it.\nYou may be able to launch your browser with a larger stack.\n"+(c?c+"\n":"")+"</div>":"<div>\n"+e+" triggered the following error during save: "+aa.message+(c?c+"\n":"")+"</div>"}};k.describe_widgets=function(a){var b="",c=a.length;a.forEach(function(a){c--;b+=k.add_a_or_an(a.get_type_name());
1===c?b+=", and ":1<c&&(b+=", ")});return b};k.elide=function(a,b,c){c=Math.round(b*c);if(a.length<=b)return a;c=Math.max(c,a.indexOf(" ",c));b=a.length-(b-c);b=Math.max(b,a.indexOf(" ",b)+1);return a.substring(0,c)+" ... "+a.substring(b,a.length)};k.strip_trailling_digits=function(a){if(0===a.length)return a;var b=a[a.length-1];return"0"<=b&&"9">=b?k.strip_trailling_digits(a.substring(0,a.length-2)):a};k.clean_json=function(a,b){if("id_of_tree_replace_once_task"!==a)return"number"!==typeof b||"left_offset_fraction"!==
a&&"top_offset_fraction"!==a&&"drag_x_offset"!==a&&"drag_y_offset"!==a?b:parseFloat(b.toPrecision(3))};k.create_widget_from_URL=function(b,c,d,e){var f=function(h){try{var u=this.getResponseHeader("content-type");if(!u){var m=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");if(0===b.indexOf(m))u="";else{d&&(d("Could not determine the contents type of the url"),d=function(){});l.removeEventListener("load",f);return}}if(0===u.indexOf("audio")||
g(e,"audio")){var n=a.element.create(e||b);var p=new Audio(e||b);p.addEventListener("event",function(a){k.display_message("Error trying to play a sound from "+(e||b)+". Errror is "+a.message)});n.set_sound_effect(p)}else 0===u.indexOf("image")||g(e,"image")?n=a.element.create("<img src='"+(e||b)+"' class = 'toontalk-image' alt='"+b+"'/>"):0===u.indexOf("video")||g(e,"video")?n=a.element.create("<video src='"+(e||b)+" ' width='320' height='240'>"):0===u.indexOf("text")&&(0>u.indexOf("text/html")||
b.indexOf(".txt")===b.length-4)?this.responseText&&(n=a.element.create(this.responseText),n.set_source_URL(b,!0)):n=a.element.create("<div class='toontalk-iframe-container'><iframe src='"+b+"' width='480' height='320'></iframe></div>");n&&c(n)}catch(Ga){d&&(d(Ga),d=function(){}),c()}l.removeEventListener("load",f)},g=function(a,b){var c=a.lastIndexOf(".");if(0<=c)switch(a=a.substring(c+1),c=a.indexOf("?"),0<c&&(a=a.substring(0,c)),b){case "image":return"png jpg jpeg gif PNG JPG JPEG GIF".split(" ").includes(a);
case "audio":return["wav","mp3","WAV","MP3"].includes(a);case "video":return["mp4","MP4"].includes(a)}},l=new XMLHttpRequest;l.addEventListener("load",f);l.open("GET",b,!0);l.onerror=function(e){a.is_already_cross_origin_url&&!a.is_already_cross_origin_url(b)?k.create_widget_from_URL(a.cross_origin_url_function(b),c,d,b):d?(d(e),d=function(){}):(k.display_message("Error trying to GET "+b+" "+e),e.stack&&console.error(e.stack))};l.send()};k.copy_widgets=function(a,b){var c=[],d;for(d=0;d<a.length;d++)c[d]=
a[d]&&a[d].copy(b);return c};k.copy_widget_sides=function(a,b){var c=[];a.forEach(function(a){if(a){var d=a.get_widget().copy(b);a.is_backside()?c.push(d.get_backside(!0)):c.push(d)}});return c};k.copy_array=function(a){return a.slice()};k.generate_unique_id=function(){S+=1;return"toontalk_id_"+S};k.generate_unique_number=function(){return S+=1};k.get_style_property=function(a,b){if(a.currentStyle)return a.currentStyle[b];if(window.getComputedStyle){if(a.parentElement)return document.defaultView.getComputedStyle(a,
null).getPropertyValue(b);document.body.appendChild(a);b=document.defaultView.getComputedStyle(a,null).getPropertyValue(b);document.body.removeChild(a);return b}};k.get_style_numeric_property=function(a,b){var c=this.get_style_property(a,b);if("string"===typeof c){var d=c.indexOf("px");0<=d&&(c=c.substring(0,d));if("auto"===c)return"left"===b?$(a).position().left:"top"===b?$(a).position().top:c;a=parseFloat(c,10);return isNaN(a)?void 0:a}return c};k.get_element_width=function(a){return a?a.getBoundingClientRect().width:
0};k.get_element_height=function(a){return a?a.getBoundingClientRect().height:0};k.cached_selectors={};k.get_toontalk_css=function(a){var b;if(k.cached_selectors[a])return k.cached_selectors[a];for(b=0;b<document.styleSheets.length;b++){var c=document.styleSheets[b];if(c.href&&0<=c.href.indexOf("toontalk.css")){a:{if(c=c.cssRules)for(b=0;b<c.length;b++)if(c[b].selectorText===a){k.cached_selectors[a]=c[b].cssText;a=c[b].cssText;break a}a=void 0}return a}}};k.get_toontalk_css_attribute=function(a,b){b=
k.get_toontalk_css(b);if(b){var c=b.indexOf(a+": ");if(!(0>c))return c+=(a+": ").length,a=b.indexOf(";",c),b.substring(c,a)}};k.get_toontalk_css_numeric_attribute=function(a,b){if(a=k.get_toontalk_css_attribute(a,b))if(b=a.indexOf("px"),0<=b)return+a.substring(0,b)};k.data_transfer_json_object=function(b){var c,d;if(b.dataTransfer){try{var e=b.dataTransfer.getData("text/html")}catch(da){e=b.dataTransfer.getData("text")}if(!e||e.match(/[\u3400-\u9FBF]/))e=b.dataTransfer.getData("text");if(e){if(c=
q(e)){if(d=k.parse_json(c))return d}else if(0<b.dataTransfer.files.length||Q(b))return;b=a.element.create("");b.get_frontside_element(!0);e&&"<"===e[0]?b.set_HTML(e):b.set_text(e);b.get_json(k.fresh_json_history(),function(a,b,c,e){0<=a.html.shared_html_index&&(a.html=e.shared_html[a.html.shared_html_index]);d=a},Date.now(),0);return d}}};k.parse_json=function(a){try{return JSON.parse(a)}catch(u){k.is_stack_overflow(u)?k.report_internal_error("Exception parsing JSON because the widgets are too deeply nested. Perhaps you can launch the browser with a larger stack size."):
k.report_internal_error("Exception parsing JSON "+u.toString()+" error: "+a)}};k.is_stack_overflow=function(a){return 0===a.message.indexOf("Maximum call stack size exceeded")||0===a.message.indexOf("Stack overflow at line")||0===a.message.indexOf("Too much recursion")||0===a.message.indexOf("Abort (control stack overflow)")};k.drag_and_drop=function(a){k.draggable(a);k.can_receive_drops(a);if(!$(a).is(".toontalk-backside-of-top-level")){var b=$(a).is(".toontalk-top-level-resource")?0:500;k.enable_touch_events(a,
b)}};k.draggable=function(b){$(b).attr("draggable",!0);b.addEventListener("dragstart",function(a){A(a)});b.addEventListener("dragend",function(a){y(a)});a.together&&(["dragstart","dragend","drag"].forEach(function(a){b.addEventListener(a,k.together_send_message)}),b.addEventListener("drag",function(a){a.simulatedEventMessage&&($(a.target).is(".toontalk-top-level-resource")?$(a.target).css({left:a.pageX-(a.simulatedEventMessage.offsetLeft+a.simulatedEventMessage.dragXOffset),top:a.pageY-(a.simulatedEventMessage.offsetTop+
a.simulatedEventMessage.dragYOffset)}):k.set_position_relative_to_top_level_backside(a.target,{left:a.clientX-a.simulatedEventMessage.dragXOffset,top:a.clientY-a.simulatedEventMessage.dragYOffset}))}))};k.can_receive_drops=function(b){b.addEventListener("dragover",function(a){a.preventDefault();return!1});b.addEventListener("drop",function(a){a.preventDefault();n(a);a.stopPropagation()});a.together&&b.addEventListener("drop",k.together_send_message);k.can_give_mouse_enter_feedback(b)};k.can_give_mouse_enter_feedback=
function(a){var b;a.addEventListener("dragenter",function(c){var d=I(c,a);d&&b!==d&&k.remove_highlight(b);b=d;c.stopPropagation()});a.addEventListener("dragleave",function(a){b&&!k.inside_rectangle(a.clientX,a.clientY,b.getBoundingClientRect())&&(k.remove_highlight(b),b=void 0);a.stopPropagation()})};k.create_drop_area=function(a){var b=document.createElement("div"),c=$(b),d=document.createElement("div");d.innerHTML=a;$(d).addClass("toontalk-drop-area-instructions ui-widget");c.addClass("toontalk-drop-area");
b.appendChild(d);k.can_receive_drops(b);return b};k.process_json_elements=function(b,c,d){var e,f,g,l,h,u;b||(b=$(".toontalk-json"),c=0);if(0!==b.length){var m=function(a){if(g){n.textContent="";$(n).css({display:""});if(g.get_type_name)if(g.is_top_level())u=g.get_backside(!0),h=u.get_element(),$(n).replaceWith(h),$(h).css({width:g.json_view?g.json_view.backside_width:f.view.backside_width,height:g.json_view?g.json_view.backside_height:f.view.backside_height,"background-color":f.view.background_color,
"border-width":f.view.border_width}),g.json_view=void 0;else{if($(n).addClass("toontalk-top-level-resource toontalk-top-level-resource-container"),l=g.get_frontside_element(!0))$(l).addClass("toontalk-top-level-resource").css({position:"relative",width:g.saved_width,height:g.saved_height}),n.toontalk_widget_side=g,n.appendChild(l)}else n.appendChild(g.get_element());g.set_active&&g.set_active(!1);setTimeout(function(){g.update_display&&g.update_display();f.semantic.running&&g.set_running(!0)},100)}else k.report_internal_error("Could not recreate a widget from this JSON: "+
e);c<b.length-1&&k.process_json_elements(b,c+1,a+1)};var n=b.get(c);if(e=n.textContent)if(e=e.substring(e.indexOf("{"),e.lastIndexOf("}")+1),f=k.parse_json(e))if(f.semantic&&"top_level"===f.semantic.type&&!a.no_local_storage&&!a.reset&&f.load_most_recent_program){var p=function(b){var c=function(){try{g=k.create_from_json(f)}catch(Aa){console.error(Aa.stack),console.trace(),k.report_internal_error("An error occurred loading the saved state. Sorry. the error is "+Aa+" JSON is "+JSON.stringify(f)),
g=a.widget.create_top_level_widget()}d>=a.maximum_recursion_depth?k.avoid_stack_overflow(function(){m(0)}):m(d?d+1:1)};b&&"null"!==b?k.retrieve_object(b,function(a){a&&(f=a,c())}):c()};k.retrieve_string("toontalk-last-key",p)}else(g=k.create_from_json(f))&&g.set_visible&&P(n,document.body)&&g.set_visible(!0),d>=a.maximum_recursion_depth?k.avoid_stack_overflow(function(){m(0)}):m(d?d+1:1)}};k.relative_position_from_absolute_position=function(a,b){a=a.parentElement;var c=b.left;b=b.top;for(var d;a&&
"html"!==a.nodeType;)d=$(a).position(),c-=d.left,b-=d.top,a=a.parentElement;return{left:c,top:b}};k.set_absolute_position=function(a,b){b=k.relative_position_from_absolute_position(a,b);k.set_css(a,{left:b.left,top:b.top,position:"absolute"});$(a).is(".toontalk-side-animating")&&(a.style.left=b.left+"px",a.style.top=b.top+"px")};k.set_position_relative_to_top_level_backside=function(a,b,c){a=$(a);var d=a.closest(".toontalk-backside-of-top-level");0===d.length&&(d=$(".toontalk-backside-of-top-level"));
return this.set_position_relative_to_element(a,d,b,c)};k.set_position_relative_to_element=function(b,c,d,e){if(0===c.length)console.log("utilities.set_position_relative_to_element called with a parent element. Ignoring it.");else{var f=c.offset();c.get(0).appendChild(b.get(0));f||(f={left:0,top:0});var g=d.left-f.left;d=d.top-f.top;if(e){e=a.UTILITIES.get_element_width(b.get(0));f=a.UTILITIES.get_element_height(b.get(0));var h=a.UTILITIES.get_element_width(c.get(0));var l=a.UTILITIES.get_element_height(c.get(0));
g>h-e&&(g=h-e);0>g&&(g=0);d>l-f&&(d=l-f);0>d&&(d=0)}g=k.scale_left(g,c.get(0));d=k.scale_top(d,c.get(0));c={left:g,top:d,position:"absolute"};b.is(".toontalk-side-animating")?(b.get(0).style.left=g+"px",b.get(0).style.top=d+"px",k.add_one_shot_event_handler(b.get(0),"transitionend",2E3,function(){b.removeClass("toontalk-side-animating");b.get(0).style.transitionDuration=""})):k.set_css(b,c);return c}};k.restore_resource=function(b,c){if(b&&b.is(".toontalk-top-level-resource")){var d=k.get_resource_copy()||
c.copy({fresh_copy:!0});var e=d.get_frontside_element(!0);b.parent().removeClass("toontalk-top-level-resource toontalk-top-level-resource-container");b.removeClass("toontalk-top-level-resource toontalk-top-level-resource-container");$(e).addClass("toontalk-top-level-resource toontalk-top-level-resource-container").css({position:"relative"});b.css({position:"absolute"});k.set_css(e,{width:b.width(),height:b.height()});b.get(0).parentElement.appendChild(e);a.DISPLAY_UPDATES.pending_update(d);c.set_active&&
(c.set_active(!0),d.set_active(!1))}};k.closest_element=function(b,c){var d;if(!c)return b.get(0);var e=Number.MAX_VALUE;b.each(function(b,f){b=$(f).offset();b=a.UTILITIES.distance(b,c);e>b&&(d=f,e=b)});return d};k.find_resource_equal_to_widget=function(a,b){var c=Number.MAX_VALUE,d=$(b.get_frontside_element()).offset(),e;$(".toontalk-top-level-resource.toontalk-side").each(function(b,f){(b=k.widget_side_of_jquery($(f)))&&(a.equals&&a.equals(b)||a.matching_resource&&a.matching_resource(b)||a.get_type_name()===
b.get_type_name()&&"matched"===a.match(b))&&(a.is_hole()||b.get_backside_widgets().length===a.get_backside_widgets().length)&&(b=k.distance($(f).offset(),d),c>b&&(e=f,c=b))});return e};k.set_position_is_absolute=function(a,b,c){if(b){b=k.get_style_numeric_property(a,"left");var d=k.get_style_numeric_property(a,"top");if(c){var e=$(a.parentElement).offset();"auto"===b&&(b=c.pageX-e.left,b-=$(a).width()/2);"auto"===d&&(d=c.pageY-e.top,d-=90)}k.set_css(a,{left:k.left_as_percent(b,a),top:k.top_as_percent(d,
a),position:"absolute"})}else a.style.position="static"};k.left_as_percent=function(a,b,c){!c&&b&&(c=b.parentElement);if(!b||!c)return a;var d=c.getBoundingClientRect();a="auto"===a||isNaN(a)?$(b).offset().left:k.adjust_left_if_scaled(a,b);return 100*Math.min(($(c).offset().left-window.pageXOffset+a-d.left)/d.width,1-$(b).width()/d.width)+"%"};k.top_as_percent=function(a,b,c){!c&&b&&(c=b.parentElement);if(!b||!c)return a;var d=c.getBoundingClientRect();a="auto"===a||isNaN(a)?$(b).offset().top:k.adjust_top_if_scaled(a,
b);return 100*Math.min(($(c).offset().top+-window.pageYOffset+a-d.top)/d.height,1-$(b).height()/d.height)+"%"};k.adjust_left_if_scaled=function(a,b){b=k.widget_side_of_element(b);var c;return b&&b.get_original_width&&(c=b.get_original_width())&&b.get_attribute?a-(c-b.get_attribute("width"))/2:a};k.adjust_top_if_scaled=function(a,b){b=k.widget_side_of_element(b);var c;return b&&b.get_original_height&&(c=b.get_original_height())&&b.get_attribute?a-(c-b.get_attribute("height"))/2:a};k.scale_left=function(a,
b){b=k.widget_side_of_element(b);var c;return b&&b.get_original_width&&(c=b.get_original_width())&&b.get_attribute?a*c/b.get_attribute("width"):a};k.scale_top=function(a,b){b=k.widget_side_of_element(b);var c;return b&&b.get_original_height&&(c=b.get_original_height())&&b.get_attribute?a*c/b.get_attribute("height"):a};k.ordinal=function(a){a++;switch(a){case 1:return"first";case 2:return"second";case 3:return"third";case 4:return"fourth";case 5:return"fifth";case 6:return"sixth";case 7:return"seventh";
case 8:return"eighth";case 9:return"ninth";case 10:return"tenth";case 11:return"eleventh";case 12:return"twelfth";case 13:return"thirteenth";default:return 1===a%10?a+"st":2===a%10?a+"nd":3===a%10?a+"rd":a+"th"}};k.on_a_nest_in_a_box=function(a){return $(a).closest(".toontalk-nest").is("*")&&$(a).closest(".toontalk-box").is("*")};k.give_tooltip=function(a,b){a&&(a.title=b,k.use_custom_tooltip(a))};k.use_custom_tooltip=function(b){var c=$(b),d;"function"==typeof c.tooltip&&(k.widget_side_of_element(b)&&
k.widget_side_of_element(b).get_title&&(b.title=k.widget_side_of_element(b).get_title()),c.tooltip({position:{my:"center bottom-20",at:"center top",using:function(a,b){var e=c.offset();0>a.top&&(a.top=0);e.left<$(window).width()/2?a.left=e.left+c.width()+10:(a.left=0,d=e.left-40);"bottom"===b.vertical?(c.is(".toontalk-robot")?a.top-=30:c.is(".toontalk-number")?a.top-=30:c.is(".toontalk-box")?a.top-=30:a.top-=20,10>a.left&&(a.left=10),10>a.top&&(a.top=10)):a.top+=20;a.left=Math.min(a.left,$(window).width()-
100);a.left=Math.max(a.left,window.pageXOffset);a.top=Math.max(a.top,window.pageYOffset);k.set_css(this,a)}},open:function(c,e){var f=e.tooltip.get(0);c=f.textContent;var g=$(b).is(".toontalk-robot"),h;f.innerHTML=G(c,decodeURIComponent);a.speak&&(window.speechSynthesis.cancel(),g||(h=function(a){}),k.speak(f.innerText,{when_finished:h}));C&&$(C).remove();C=f;a.balloons?(100<c.length&&(h=Math.min(800,d||$(window).width()-100),$(f).position(),e.tooltip.css({maxWidth:h})),e.tooltip.css({"z-index":99999999}),
e.tooltip.find(".toontalk-iframe-container").removeClass("toontalk-iframe-container"),setTimeout(function(){e.tooltip.remove();$(f).data("ui-tooltip")&&($(f).tooltip("destroy"),$(".ui-helper-hidden-accessible").remove(),k.use_custom_tooltip(b));C=void 0},c.length*(a.MAXIMUM_TOOLTIP_DURATION_PER_CHARACTER||100))):e.tooltip.remove()},close:function(){$(this).data("ui-tooltip")&&($(this).tooltip("destroy"),$("[role='log']").remove(),k.use_custom_tooltip(b));C=void 0}}))};k.speak=function(b,d){var e=
window.speechSynthesis.getVoices(),f=function(a){for(var b=[],c=function(a){if(200>a.length)return a.length+1;var b=a.substring(0,200);var c=b.lastIndexOf(". ")||b.lastIndexOf(".\n");if(0<c)return c+2;c=b.lastIndexOf(".");if(c===b.length-1)return c+1;c=b.lastIndexOf(", ");if(0<c)return c+2;c=b.lastIndexOf(" ");return 0<c?c+1:Math.min(a.length+1,200)},d;0<a.length;)d=c(a),1<d&&b.push(a.substring(0,d-1)),a=a.substring(d);return b};if(c)if(d||(d={}),0===e.length)window.speechSynthesis.onvoiceschanged=
function(){k.speak(b,d);window.speechSynthesis.onvoiceschanged=void 0};else if(k.translate&&!d.no_translation)k.translate(b,function(a){d.no_translation=!0;k.speak(a,d)});else if(200<b.length)e=f(b),e.forEach(function(a,b){0===b&&(d.when_finished=function(){});k.speak(a,d)});else{e=void 0===d.pitch?1.2:d.pitch;f=void 0===d.volume?Math.min(1,3*a.volume):d.volume;var g=void 0===d.rate?.75:d.rate,h=void 0===d.voice_number?0:d.voice_number,l=d.language||0<document.getElementsByClassName("goog-te-menu-value").length&&
document.getElementsByClassName("goog-te-menu-value")[0].firstChild.innerText;ecraft2learn.speak(b,e,g,h,f,l,d.when_finished)}};k.translation_language_code=function(){return a.TRANSLATION_ENABLED&&google&&google.translate&&google.translate.TranslateElement?google.translate.TranslateElement().c:navigator.language};k.encode_HTML_for_title=function(a){return encodeURIComponent("<span class='notranslate' translate='no'>decodeURIComponent"+a+"decodeURIComponent</span>")};k.remove_encoded_HTML=function(a){return G(a,
function(){return""})};k.join_continuations=function(a,b){return a?b?function(){b(a)}:a:b};k.add_one_shot_event_handler=function(a,b,c,d){var e=!1,f=function(c){e=!0;d&&d();a.removeEventListener(b,f)};a.addEventListener(b,f);setTimeout(function(){e||f()},c)};k.animate_to_absolute_position=function(b,c,d,e,f,g){var h=$(b).offset(),l=$(b).position(),m=k.distance(c,h);0===g||0===e?(k.set_absolute_position(b,c),d&&d()):($(b).css({"z-index":k.next_z_index()}),g||(g=Math.round(m/(e||a.animation_settings.ANIMATION_SPEED))),
$(b).addClass("toontalk-side-animating"),b.style.transitionDuration=g+"ms",m=l.left+(c.left-h.left),h=l.top+(c.top-h.top),b.style.left=m+"px",b.style.top=h+"px",b.toontalk_followed_by&&(c.left+=b.toontalk_followed_by.left_offset,c.top+=b.toontalk_followed_by.top_offset,k.animate_to_absolute_position(b.toontalk_followed_by.element,c,void 0,e,f)),document.hidden&&(g=0),f?setTimeout(d,g):setTimeout(function(){$(b).removeClass("toontalk-side-animating");b.style.transitionDuration="";d&&d()},g))};k.distance=
function(a,b){var c=a.left-b.left;a=a.top-b.top;return Math.sqrt(c*c+a*a)};k.highlight_element=function(a,b,c){if(a){k.remove_highlight();if(!$(a).is(".toontalk-backside")){var d=k.widget_side_of_element(a);if(!d||d.element_to_highlight&&b&&(a=d.element_to_highlight(b),!a))return}$(a).is(".toontalk-highlight")||($(a).addClass("toontalk-highlight"),c&&setTimeout(function(){k.remove_highlight(a)},c))}};k.remove_highlight=function(a){a?$(a).removeClass("toontalk-highlight"):$(".toontalk-highlight").removeClass("toontalk-highlight")};
k.cursor_of_image=function(a){var b=a.lastIndexOf(".");return 0<=b?a.substring(0,b)+".32x32"+a.substring(b):a};k.inside_rectangle=function(a,b,c){return a>=c.left&&a<=c.right&&b>=c.top&&b<=c.bottom};k.constrain_css_to_fit_inside=function(a,b){var c=$(a).width();0!==c&&(a=$(a).height(),"number"===typeof b.left?b.left=Math.min(Math.max(b.left,0),c):(c=k.extract_percentage_from_string(b.left),"number"===typeof c&&(b.left=Math.min(100,Math.max(c,0))+"%")),"number"===typeof b.top?b.top=Math.min(Math.max(b.top,
0),a):(c=k.extract_percentage_from_string(b.top),"number"===typeof c&&(b.top=Math.min(100,Math.max(c,0))+"%")))};k.extract_percentage_from_string=function(a){try{if("string"===typeof a&&"%"===a[a.length-1])return parseFloat(a.substring(0,a.length-1))}catch(u){}};k.next_z_index=function(){e++;return e};k.create_button=function(a,b,c,d){a=$("<button>"+a+"</button>").button();var e=a.get(0);a.addClass(b+" toontalk-button");e.addEventListener("click",d);k.give_tooltip(e,c);return e};k.create_close_button=
function(a,b){var c=document.createElement("div"),d=document.createElement("div");$(c).addClass("toontalk-close-button toontalk-button");c.addEventListener("click",a);k.give_tooltip(c,b);d.innerHTML="&times;";c.appendChild(d);return c};k.check_radio_button=function(a){var b=$(a.button).closest(".ui-controlgroup");0<b.length&&b.find(".ui-state-active").removeClass("ui-state-active").prop("checked",!1);$(a.button).prop("checked",!0);$(a.label).addClass("ui-state-active")};k.create_alert_element=function(a){a=
G(a,decodeURIComponent);var b=k.create_text_element(a);0===$(b).children().length||0<=a.indexOf("<")?$(b).addClass("toontalk-alert-element"):$(b).children().addClass("toontalk-alert-element");return b};k.create_text_element=function(a,b){var c=document.createElement("div");c.innerHTML=a;$(c).addClass("ui-widget");b&&$(c).addClass(b);return c};k.create_space=function(){var a=document.createElement("span");a.innerHTML="&nbsp;";$(a).addClass("ui-widget");return a};k.create_anchor_element=function(b,
c){var d=document.createElement("a");d.innerHTML=b;a.TRANSLATION_ENABLED&&(c=k.add_URL_parameter(c,"translate","1"));d.href=c;d.target="_blank";return d};k.create_text_input=function(a,b,c,d,e,f,g){var h=document.createElement("input");h.type="text";h.className=b;h.value=a;k.give_tooltip(h,d);f&&(h.type=f);if(c){a=document.createElement("label");a.innerHTML=c;h.id=k.generate_unique_id();a.htmlFor=h.id;if(e){var l=k.create_anchor_element("i",e);$(l).addClass("toontalk-help-button toontalk-button notranslate");
l.translate=!1}c=k.create_horizontal_table(a,h,l);$(a).addClass("ui-widget")}else c=h;h.classList.add("toontalk-text-with-button-style","ui-corner-all","ui-widget","toontalk-text-area");h.addEventListener("touchstart",function(){$(h).select()});g&&w(h,g);k.use_custom_tooltip(h);return{container:c,button:h}};k.create_text_area=function(a,b,c,d,e,f,g){var h=document.createElement("textarea");h.className=b;h.value=a;k.give_tooltip(h,d);a=document.createElement("label");a.innerHTML=c;h.id=k.generate_unique_id();
a.htmlFor=h.id;c=g?k.create_vertical_table(a,h):k.create_horizontal_table(a,h);h.classList.add("toontalk-text-with-button-style","ui-corner-all","ui-widget","toontalk-text-area");h.addEventListener("touchstart",function(){$(h).select()});e&&w(h,e);$(a).addClass("ui-widget");k.use_custom_tooltip(h);return{container:c,button:h}};k.input_area_drop_handler=function(a,b,c){var d;a.preventDefault();if(c=z(a)){if(c.is_backside())return;if(d=b(c,a))$(a.currentTarget).trigger("change"),a.currentTarget.value=
d,c.remove(),a.stopPropagation()}return"string"===typeof d&&c};k.create_radio_button=function(a,b,c,d,e,f){f=document.createElement("div");var g=document.createElement("input"),h=document.createElement("label");g.type="radio";g.className=c+" toontalk-button";g.name=a;g.value=b;h.innerHTML=d;g.id=k.generate_unique_id();h.htmlFor=g.id;f.appendChild(g);f.appendChild(h);k.give_tooltip(f,e);$(g).checkboxradio({icon:!1}).addClass("toontalk-button");k.use_custom_tooltip(g);return{container:f,button:g,label:h}};
k.create_select_menu=function(a,b,c,d,e,f){var g=document.createElement("div"),h=document.createElement("select"),l=document.createElement("label");h.className=c;h.name=a;h.id=k.generate_unique_id();l.innerHTML=d;l.htmlFor=h.id;g.appendChild(l);g.appendChild(h);k.give_tooltip(g,e);b.forEach(function(a,b){var c=document.createElement("option");c.value=a;c.innerHTML=a;f&&f[b]&&k.give_tooltip(c,f[b]);h.appendChild(c)});$(h).selectmenu({width:"50%",open:function(){$(".ui-selectmenu-open").css({"z-index":9999999});
setTimeout(function(){$(".ui-selectmenu-open").find(".ui-menu-item").each(function(a,c){f&&(a=b.indexOf(c.textContent),0<=a&&f[a]&&k.give_tooltip(c,f[a]))})})}});$(l).addClass("ui-widget");k.use_custom_tooltip(h);return{container:g,menu:h,label:l}};k.create_check_box=function(a,b,c,d){var e=document.createElement("div"),f=document.createElement("input"),g=document.createElement("label");f.type="checkbox";f.className=b+" toontalk-button";f.checked=a;g.innerHTML=c;f.id=k.generate_unique_id();g.htmlFor=
f.id;$(g).addClass("ui-widget");e.appendChild(f);e.appendChild(g);k.give_tooltip(e,d);k.use_custom_tooltip(f);return{container:e,button:f,label:g}};k.create_div=function(){var a=document.createElement("div"),b;for(b=0;b<arguments.length;b++)arguments[b]&&(arguments[b].container?(a.appendChild(arguments[b].button),a.appendChild(arguments[b].label)):a.appendChild(arguments[b]));return a};k.create_horizontal_table=function(){var a=document.createElement("table"),b;var c=document.createElement("tr");
a.appendChild(c);for(b=0;b<arguments.length;b++)if(arguments[b]){var d=document.createElement("td");c.appendChild(d);d.appendChild(arguments[b])}return a};k.create_vertical_table=function(){var a=document.createElement("table"),b;for(b=0;b<arguments.length;b++)if(arguments[b]){var c=k.create_row(arguments[b]);a.appendChild(c)}return a};k.create_row=function(){var a=document.createElement("tr"),b=document.createElement("td"),c;for(c=0;c<arguments.length;c++)arguments[c]&&a.appendChild(arguments[c]);
b.appendChild(a);return a};k.create_table_entry=function(a){var b=document.createElement("td");b.appendChild(a);return b};k.selected_radio_button=function(){var a;for(a=0;a<arguments.length;a++)if(arguments[a].button.checked)return arguments[a]};k.create_image=function(a,b){var c=document.createElement("img");c.src=a;b&&$(c).addClass(b);if(0===a.indexOf("images/")){var d=function(b){c.removeEventListener("error",d);c.src="http://toontalk.github.io/ToonTalk/"+a};c.addEventListener("error",d)}return c};
k.create_tabs=function(a,b){var c=document.createElement("div"),d=document.createElement("ul"),e;if(a.length!==b.length)return console.error("UTILITIES.create_tabs called with different length lists."),c;a.forEach(function(a,c){var f=document.createElement("li"),g=document.createElement("a");if("string"===typeof a){var h=document.createElement("span");h.innerHTML=a}else h=a;e="tab-"+c;g.href="#"+e;g.appendChild(h);f.appendChild(g);d.appendChild(f);b[c].id=e});c.appendChild(d);b.forEach(function(a){c.appendChild(a)});
$(c).tabs();return c};k.add_iframe_popup=function(a){var b=document.createElement("iframe"),c=document.createElement("div");$(c).addClass("toontalk-close-popup-frame-button").button();c.addEventListener("click",function(a){$(b).remove();$(c).remove();a.stopPropagation()});c.innerHTML="Return to ToonTalk";$(b).addClass("toontalk-popup-frame");b.src=a;document.body.appendChild(c);document.body.appendChild(b)};k.create_file_data_table=function(a){var b=$('<table cellpadding="0" cellspacing="0" border="0"></table>');
a&&b.addClass(a);return b.get(0)};k.become_file_data_table=function(b,c,d,e){$(b).DataTable({data:c,autoWidth:!1,order:[[1,"desc"]],columns:[{data:"title",title:"Name",render:function(b,c,f,g){b=d?b.substring(0,b.length-5):b;c=d?a.google_drive.google_drive_url(f.id):"Click to load this program.";if(e)return"<div class='"+e+"' title='"+c+"'id='"+f.id+"'>"+b+"</div>";a.TRANSLATION_ENABLED&&(c=k.add_URL_parameter(c,"translate","1"));return"<a href='"+c+"'target='_blank' title='Click to open published page.'>"+
b+"</a>"}},{data:"modifiedDate",title:"Modified",render:function(a,b,c,d){return(new Date(a)).toUTCString()}},{data:"createdDate",title:"Created",render:function(a,b,c,d){return(new Date(a)).toUTCString()}},{data:"fileSize",title:"Size"}]});$(b).addClass("toontalk-file-table")};k.get_local_files_data=function(a){k.get_all_locally_stored_program_names(function(b){var c=[],d=function(e){var f=b[e];k.get_local_storage_meta_data(f,function(g){g&&c.push({title:f,modifiedDate:g.last_modified,createdDate:g.created,
fileSize:g.file_size});e<b.length?d(e+1):a(c)})};d(0)})};k.create_local_files_table=function(a){k.get_local_files_data(function(b){var c=k.create_file_data_table();k.when_attached(c,function(){k.become_file_data_table(c,b,!1,"toontalk-file-load-button toontalk-file-load-button-without-click-handler")});a(c)})};k.get_$dragee=function(){return f};k.get_dragee=function(){return f&&a.UTILITIES.widget_side_of_jquery(f)};k.get_resource_copy=function(){return t};k.get_dragee_copy=function(){if(r)return r;
var a=k.get_dragee();if(a&&!a.is_backside()&&(a.get_infinite_stack()||f.is(".toontalk-top-level-resource")))return r||(f.is(".toontalk-top-level-resource")?(r=a,t=a.copy({fresh_copy:!0})):r=a.add_copy_to_container(void 0,-1E3,-1E3)),r};k.add_URL_parameter=function(a,b,c){a=k.remove_URL_parameter(a,b);var d=a.indexOf("?");return a+(0<=d?"&":"?")+b+"="+c};k.remove_URL_parameter=function(a,b){var c=a.indexOf("&"+b+"=");0>c&&(c=a.indexOf("?"+b+"="));if(0>c)return a;b=a.indexOf("&",c+1);0>b&&(b=a.length);
a=a.substring(0,c)+a.substring(b);"?"===a[a.length-1]&&(a=substring(0,a.length-1));return a};k.add_a_or_an=function(a,b){var c=a.charAt(0);if("'"===c||'"'===c)c=a.charAt(1);return 0===a.indexOf("the ")||0===a.indexOf("a ")||0===a.indexOf("an ")||0===a.indexOf("any ")||0===a.indexOf('"the ')||0===a.indexOf('"a ')||0===a.indexOf('"an ')||0===a.indexOf('"any ')?a:0>"aeiou".indexOf(c)?b?"A "+a:"a "+a:b?"An "+a:"an "+a};k.lower_case_first_letter=function(a){return a.charAt(0).toLowerCase()+a.slice(1)};
k.maximum_string_length=function(a,b){if(a.length<=b)return a;var c=a.substring(0,Math.round(.75*b));return c+" ... "+a.substring(a.length-(b-c.length))};k.each_top_level_widget=function(a){$(".toontalk-backside-of-top-level").each(function(b,c){a(k.widget_side_of_element(c).get_widget())})};k.backup_all_top_level_widgets=function(a){k.each_top_level_widget(function(b){b.save(a)})};k.make_resizable=function(a,b){var c,d,e;a.resizable({start:function(b,f){d=f.originalSize.width;e=f.originalSize.height;
c=a.get(0).onclick},resize:function(c,f){a.is(".toontalk-element-frontside")&&(f.size.width!=d&&(b.increment_width(f.size.width-d),d=f.size.width),f.size.height!=e&&(b.increment_height(f.size.height-e),e=f.size.height));b.rerender()},stop:function(f,g){b.robot_in_training&&b.robot_in_training()&&b.robot_in_training().resized_widget(b,d,e,g.size.width,g.size.height);f.originalEvent.stopPropagation();setTimeout(function(){a.get(0).onclick=c},100)},handles:b.is_box()?"se":"n,e,s,w"});a.children(".ui-resizable-handle").css("z-index",
9999)};k.match=function(a,b){if(void 0===a)return"matched";if(a.is_nest())var c=a.match(b);else if(b=b.dereference(),c=a.match(b),c.is_widget&&b.matched_by)return b.matched_by(a);return c};k.current_URL=function(){return window.location.pathname};k.absolute_file_path=function(a){var b=window.location.pathname,c=b.lastIndexOf("ToonTalk/");return 0>c?a:b.substring(0,c+9)+a};k.copy_side=function(a,b,c){b=a.get_widget().copy(b);c&&k.copy_frontside_dimensions(a.get_widget(),b);return a.is_backside()?b.get_backside():
b};k.copy_frontside_dimensions=function(a,b){(a=a.get_widget().get_frontside_element())&&(b=b.get_frontside_element(!0))&&k.set_css(b,{width:$(a).width(),height:$(a).height()})};k.scale_to_fit=function(a,b,c,d){return $(b).is(".toontalk-backside")?k.scale_element(a,c,d,c,d):k.scale_element(a,$(b).width(),$(b).height(),c,d)};k.scale_element=function(b,c,d,e,f,g,h,m,n){var l=$(b).find("iframe");if(0<l.length)return l.attr("width",c).attr("height",d-20),{x_scale:1,y_scale:1};$(b).is(".toontalk-not-observable")&&
(l=a.UTILITIES.widget_side_of_element(b))&&l.render();if(!e){var p=$(b).children("img");e=p.is("*")?p.width():$(b).width()}f||(p||(p=$(b).children("img")),f=p.is("*")?p.height():$(b).height());p=c&&0!==e?c/e:b.toontalk_x_scale||1;l=d&&0!==f?d/f:b.toontalk_y_scale||1;0===p&&(p=1);0===l&&(l=1);b.toontalk_x_scale=p;b.toontalk_y_scale=l;m=(m=m&&m!==document.body?m:b.parentElement)&&0>m.className.indexOf("toontalk-box-hole")&&0>b.className.indexOf("toontalk-scale");var q="";h||(h={});"number"===typeof h.left&&
(h.left-=(e-c)/2,n=!0);"number"===typeof h.top&&(h.top-=(f-d)/2,n=!0);!n&&m?(c&&(b.toontalk_translate_x=(c-e)/2,q+="translateX("+b.toontalk_translate_x+"px) "),d&&(b.toontalk_translate_y=(d-f)/2,q+="translateY("+b.toontalk_translate_y+"px) ")):(b.toontalk_translate_x=void 0,b.toontalk_translate_y=void 0);k.add_transform_to_css((g||"")+" scale("+p+", "+l+")",q,h,m);h.width=e;h.height=f;k.set_css(b,h);return{x_scale:p,y_scale:l}};k.translate_x=function(a){return x("toontalk_translate_x","toontalk_x_scale")};
k.translate_y=function(a){return x("toontalk_translate_y","toontalk_y_scale")};k.add_transform_to_css=function(a,b,c,d){a&&(c||(c={}),c["transform-origin"]||(c["transform-origin"]=d?"center center":"left top"),k.set_css_transform(c,b+a))};k.set_css_transform=function(a,b){a["-webkit-transform"]=b;a["-moz-transform"]=b;a["-ms-transform"]=b;a["o-transform"]=b;a.transform=b};k.run_when_dimensions_known=function(b,c,d){var e=b.parentElement,f=function(a){return a&&0>a.className.indexOf("toontalk-box-hole")&&
!$(a).is(".toontalk-nest")};if(!d&&$(b).width()&&(f(e)||$(b).is(".toontalk-element-frontside")))setTimeout(function(){c(e)});else{var g=function(d){setTimeout(function(){var h=$(b).width(),l=$(b).height();h&&l?f(b.parentElement)?($(b).removeClass("toontalk-not-observable"),c(e),e?(e.appendChild(b),a.UTILITIES.widget_side_of_element(b).rerender()):b.parentElement===document.body&&$(b).remove()):k.run_when_dimensions_known(b,c,!0):setTimeout(function(){k.widget_side_of_element(b);1E4>d&&g(2*d)},d)})};
$(b).addClass("toontalk-not-observable");document.body.appendChild(b);d&&k.set_css(b,{width:"",height:"",transform:""});g(1)}};k.original_dimensions=function(a,b,c){var d=a.get_frontside_element();d.parentElement!==document.body&&k.run_when_dimensions_known(d,function(){var a=$(d).children("img");a.is("*")?b(a.width(),a.height()):b($(d).width(),$(d).height())},c)};k.relative_position=function(a,b){if(!k.is_attached(a))return{left:0,top:0};a=$(a).offset();b&&(b=$(b).offset(),a.left-=b.left,a.top-=
b.top);return a};k.add_animation_class=function(a,b){k.set_css(a,{width:"",height:""});$(a).addClass(b)};k.widget_side_of_jquery=function(a){if(0<a.length)return a.get(0).toontalk_widget_side};k.widget_side_of_element=function(a){return a.toontalk_widget_side};k.has_animating_image=function(a){a=$(a);return(a=a.css("animation")||a.css("webkit-animation")||a.css("moz-animation")||a.css("ms-animation")||a.css("o-animation"))&&0!==a.indexOf("none")};k.display_message=function(b,c){var e=k.create_alert_element(b),
f=function(){$(e).remove();$(".toontalk-help-link").css({opacity:""})};c||(c={});if(c.only_if_new)if(0>d.indexOf(b))d.push(b);else return b;$(".toontalk-alert-element").text($(".toontalk-alert-element").text()+"..."+b);!a.debugging||c.user_initiated||c.dont_log||(console.log(c.plain_text||b),console.trace());if(c.element||c.second_choice_element){var g=$(c.element).closest(".toontalk-backside");0===g.length&&(g=$(c.second_choice_element).closest(".toontalk-backside"));0<g.length&&($(e).addClass("toontalk-local-alert"),
g.append(e))}c.element&&0!==g.length||($(".toontalk-help-link").css({opacity:0}),document.body.insertBefore(e,document.body.firstChild));a.speak&&(window.speechSynthesis.cancel(),k.speak(c.plain_text||e.textContent));e.addEventListener("click",f);c.duration||(0<=b.indexOf("<")?c.duration=5E3:c.duration=Math.max(2E3,b.length*(a.MAXIMUM_TOOLTIP_DURATION_PER_CHARACTER||100)));setTimeout(f,c.duration);return b};k.display_tooltip=function(a){a.each(function(){k.use_custom_tooltip(this)});a.tooltip("open")};
k.report_internal_error=function(b,c){console.error(b);console.trace();a.debugging&&k.display_message("Error: "+b);"object"!==typeof Raven||c&&c.dont_log_exception||Raven.captureException(b.toString())};k.get_current_url_boolean_parameter=function(a,b){return 0>window.location.href.indexOf(a+"=")?b:0<=window.location.href.indexOf(a+"=1")?!0:!1};k.get_current_url_numeric_parameter=function(a,b){a=k.get_current_url_parameter(a);if("undefined"===typeof a)return b;try{return parseInt(a,10)}catch(L){return 0}};
k.get_current_url_parameter=function(a,b){var c=window.location.href.indexOf(a+"=");if(0>c)return b;a=c+a.length+1;b=window.location.href.indexOf("&",a);0>b&&(b=window.location.href.length);return window.location.href.substring(a,b)};k.get_path_to_toontalk_folder=function(){return a.TOONTALK_URL};k.is_browser_of_type=function(a){return 0<=window.navigator.userAgent.indexOf(a)};var Z=k.is_browser_of_type("MSIE")||k.is_browser_of_type("Trident");k.is_internet_explorer=function(){return Z};k.add_position=
function(a,b){return{left:a.left+b.left,top:a.top+b.top}};k.subtract_position=function(a,b){return{left:a.left-b.left,top:a.top-b.top}};k.remove_z_index=function(a){if(0===a.length||"<"!==a.charAt(0)||0>a.indexOf("z-index"))return a;a=$("<div>"+a+"</div>");a.attr("z-index","");return a.html()};k.add_test_all_button=function(){var a=$("#toontalk-test-all-button"),b=!1;if(0!==a.length){a.button();var c=a.get(0);c.innerHTML="Run all tests";a.get(0).addEventListener("click",function(a){b?($(".toontalk-stop-sign").each(function(){$(this).parent().is(".toontalk-backside-of-top-level")&&
$(this).click()}),c.innerHTML="Run all tests",k.rerender_all()):($(".toontalk-green-flag").each(function(){$(this).parent().is(".toontalk-backside-of-top-level")&&$(this).click()}),c.innerHTML="Stop all tests");b=!b})}};k.set_timeout=function(a,b){b||k.is_internet_explorer()?setTimeout(a,b):(F.push(a),window.postMessage("zero-timeout-message","*"))};k.get_first_property=function(a){return Object.keys(a)[0]};k.get_all_locally_stored_program_names=function(a){k.retrieve_object("toontalk-all-program-names",
function(b){if(b)a(b);else return a([])})};k.set_all_locally_stored_program_names=function(a){k.store_object("toontalk-all-program-names",a,function(){})};k.get_local_storage_meta_data=function(a,b){a=k.local_storage_program_meta_data_key(a);try{k.retrieve_object(a,b)}catch(L){b()}};k.local_storage_program_key=function(a){return"toontalk-json: "+a};k.local_storage_program_meta_data_key=function(a){return"toontalk-meta-data: "+a};a.CHROME_APP?(k.store_object=function(b,c,d){var e={};a.logging&&0<=
a.logging.indexOf("store")&&console.log("Storing "+c+" with key "+b);e[b]=JSON.stringify(c,k.clean_json);chrome.storage.local.set(e,d);chrome.runtime.lastError&&console.error(chrome.runtime.lastError+" caused by set "+b)},k.store_string=function(b,c,d){var e={};a.logging&&0<=a.logging.indexOf("store")&&console.log("Storing string "+c.substring(0,100)+"... with key "+b);e[b]=c;chrome.storage.local.set(e,d);a.logging&&0<=a.logging.indexOf("store")&&console.log("Storing string "+c.substring(0,100)+"... with key "+
b);chrome.runtime.lastError&&console.error(chrome.runtime.lastError+" caused by store_string "+b)},k.retrieve_object=function(b,c){chrome.storage.local.get(b,function(d){a.logging&&0<=a.logging.indexOf("retrieve")&&console.log("Retrieved "+(d[b]&&d[b].substring(0,100))+"... with key "+b);chrome.runtime.lastError&&console.error(chrome.runtime.lastError+" caused by get "+b);c(d[b]&&k.parse_json(d[b]))})},k.retrieve_string=function(b,c){chrome.storage.local.get(b,function(d){a.logging&&0<=a.logging.indexOf("retrieve")&&
console.log("Retrieved string "+(d[b]&&d[b].substring(0,100))+"... with key "+b);chrome.runtime.lastError&&console.error(chrome.runtime.lastError+" caused by get "+b);c(d&&d[b])})}):"undefined"!==typeof window.localStorage&&window.localStorage?(k.store_object=function(b,c,d){a.logging&&0<=a.logging.indexOf("store")&&console.log("Storing "+c+" with key "+b);try{var e=JSON.stringify(c,k.clean_json)}catch(da){k.is_stack_overflow(da)?a.UTILITIES.display_message("Unable to store your project because the depth of widget nesting exceeds the size of the stack.  Perhaps you can launch this browser or another with a larger stack size.",
{only_if_new:!0}):a.UTILITIES.display_message("Unable to store your project because of the error: "+da.message,{only_if_new:!0})}try{window.localStorage.setItem(b,e)}catch(da){a.UTILITIES.display_message("Unable to store your project to the browser's local storage. You can save to Google Drive if you have an account. Otherwise drag your project to Wordpad or the like. The error message is: "+da,{only_if_new:!0})}d&&d()},k.store_string=function(b,c,d){try{window.localStorage.setItem(b,c)}catch(M){a.UTILITIES.display_message("Unable to store your project to the browser's local storage. You can save to Google Drive if you have an account. Otherwise drag your project to Wordpad or the like. The error message is: "+
M,{only_if_new:!0})}d&&d()},k.retrieve_object=function(b,c){try{var d=window.localStorage.getItem(b);a.logging&&0<=a.logging.indexOf("retrieve")&&console.log("Retrieved "+(d&&d.substring(0,100))+"... with key "+b);c(d&&k.parse_json(d))}catch(M){a.UTILITIES.display_message("Unable to read from the browser's local storage. You can read and save to Google Drive if you have an account. The error message is: "+M,{only_if_new:!0})}},k.retrieve_string=function(b,c){try{a.logging&&0<=a.logging.indexOf("retrieve")&&
console.log("Retrieved string "+(window.localStorage.getItem(b)&&window.localStorage.getItem(b).substring(0,100))+"... with key "+b),c(window.localStorage.getItem(b))}catch(L){a.UTILITIES.display_message("Unable to read from the browser's local storage. You can read and save to Google Drive if you have an account. The error message is: "+L,{only_if_new:!0})}}):(k.store_object=function(){console.log("Browser local storage not available in this browser. Nothing stored")},k.store_string=k.store_object,
k.retrieve_object=function(a,b){b()},k.retrieve_string=k.retrieve_object);k.touch_available=function(){return"ontouchstart"in window||navigator.msMaxTouchPoints};k.enable_touch_events=function(b,c){var d=b,e=function(e){e.preventDefault();if(l){e.stopPropagation();var q=e.changedTouches[0];m&&(m.being_dragged=!1);$(b).removeClass("toontalk-being-dragged");l+c>=Date.now()?(e=document.createEvent("MouseEvent"),e.initMouseEvent("click",!0,!0,window,1,q.screenX,q.screenY,q.clientX,q.clientY,!1,!1,!1,
!1,0,null),q.target.dispatchEvent(e),m&&m.constrained_by_container()?$(b).css({left:"",top:""}):k.set_absolute_position(b,{left:h.left,top:h.top}),a.logging&&0===a.logging.indexOf("touch")&&p("touch end treated as click "+b.id,!0)):(y(e,b),a.logging&&0===a.logging.indexOf("touch")&&p("drag ended "+b.id),n(e),a.logging&&0===a.logging.indexOf("touch")&&p("drop happened "+b.id),a.logging&&0===a.logging.indexOf("touch")&&p("",!0),k.set_absolute_position(b,{left:q.pageX-f-a.USABILITY_DRAG_OFFSET.x,top:q.pageY-
g-a.USABILITY_DRAG_OFFSET.y}));l=void 0;b=d}},f=0,g=0,h,l,m,q;b.addEventListener("touchstart",function(c){var d=c.changedTouches[0],e;h=$(b).offset();0===a.USABILITY_DRAG_OFFSET.y&&(a.USABILITY_DRAG_OFFSET.y=25);a.logging&&0===a.logging.indexOf("touch")&&p("touch start "+b.id);c.preventDefault();if("TEXTAREA"===c.target.tagName||"INPUT"===c.target.tagName||$(c.target).is(".ui-resizable-handle"))a.logging&&0===a.logging.indexOf("touch")&&p("touch start ignored due to tag name or class "+b.id);else if((e=
k.find_widget_side_on_page(c.changedTouches[0],void 0,0,0))&&e.is_of_type("empty hole")&&(e=e.get_parent_of_frontside()),e&&e.get_frontside_element()!==b)a.logging&&0===a.logging.indexOf("touch")&&p("touch start ignored since has child who is really touched: "+k.widget_side_of_element(b));else{l=Date.now();a.logging&&0===a.logging.indexOf("touch")&&p("touch start of "+b.id+" at "+l);c.stopPropagation();if(m=k.widget_side_of_element(b))m.being_dragged=!0;if(m&&m.get_infinite_stack()){var n=m.copy();
m.set_infinite_stack(!1);n.set_infinite_stack(!0)}else if($(b).is(".toontalk-top-level-resource")){n=m.copy();m.add_copy_to_container(n,0,0);var q=$(b).offset();b=n.get_frontside_element(!0)}n&&(m.add_copy_to_container(n,0,0),m.robot_in_training()&&m.robot_in_training().copied(m,n,!1));$(b).css({"z-index":99999999});q||(q=$(b).offset());A(c);f=d.pageX-q.left;g=d.pageY-q.top;a.logging&&0===a.logging.indexOf("touch")&&p("drag started "+b.id)}},!0);b.addEventListener("touchmove",function(c){var d=c.changedTouches[0];
if(l){c.preventDefault();k.set_absolute_position(b,{left:d.pageX-f-a.USABILITY_DRAG_OFFSET.x,top:d.pageY-g-a.USABILITY_DRAG_OFFSET.y});c=k.find_widget_side_on_page(d,b,a.USABILITY_DRAG_OFFSET.x,a.USABILITY_DRAG_OFFSET.y);if(q&&q!==c){var e=q.get_frontside_element();k.remove_highlight(e);q=void 0}c&&(I(d,c.get_element()),q=c);a.logging&&0===a.logging.indexOf("touch")&&p("dragged to "+(d.pageX-f)+", "+(d.pageY-g)+" "+b.id)}},!0);b.addEventListener("touchend",e,!0);b.addEventListener("touchcancel",e,
!0)};k.get_mouse_or_first_touch_event_attribute=function(a,b){return b.changedTouches?b.changedTouches[0][a]:b.simulatedEventMessage&&"undefined"!==typeof b.simulatedEventMessage[a]?b.simulatedEventMessage[a]:b[a]};k.find_widget_side_on_page=function(a,b,c,d){var e=k.get_mouse_or_first_touch_event_attribute("pageX",a);a=k.get_mouse_or_first_touch_event_attribute("pageY",a);b&&$(b).hide();c=document.elementFromPoint(e-(window.pageXOffset+c),a-(window.pageYOffset+d));for(b&&$(b).show();c&&!c.toontalk_widget_side&&
!$(c).is(".toontalk-backside")&&!$(c).is(".toontalk-button")&&!$(c).is(".ui-button");)c=c.parentNode;if(c)var f=c.toontalk_widget_side;if(f)return f&&f.get_contents&&f.get_contents()&&(f=f.get_contents()),f};k.closest_top_level_backside=function(a,b){var c,d;$(".toontalk-backside-of-top-level").each(function(){var b=$(this).offset();b=b.left+$(this).width()/2-a^2+(b.top+$(this).height()/2-a)^2;c?b<d&&(c=this,d=b):(c=this,d=b)});return k.widget_side_of_element(c)};k.set_css=function(a,b){var c;if(b&&
a){if(c=k.widget_side_of_element(a)){var d=c.dereference();b.width&&!b["font-size"]&&(c.is_hole()?b["font-size"]=c.name_font_size(b.width,b.height):d.name_font_size&&(b["font-size"]=d.name_font_size(b.width,b.height)));if(!$(a).is(".toontalk-temporarily-set-down"))if(c.constrained_by_container())b.left="",b.top="";else if(c.is_plain_text_element()||c.is_nest()&&d.is_plain_text_element())b.width="",b.height=""}0===b.width&&(b.width="");0===b.height&&(b.height="");b.transform||"number"!==typeof b.width||
"number"!==typeof b.height||!d||d.is_plain_text_element()&&d.constrained_by_container()||!d.use_scaling_transform?$(a).css(b):(c!==d&&$(a).css(b),d.use_scaling_transform(b))}};k.font_size=function(b,c,d){if(!b||!c)return 0;d||(d={});var e=b.split(/[\s\-]/);var f=e.map(function(a){return a.length}).reduce(function(a,b){return Math.max(a,b)},-Infinity);c/=a.FONT_ASPECT_RATIO*(f+(d.margin||0));if(1===e.length)return d.height?Math.min(c,d.height):c;b=Math.ceil(b.length/f);c*b>.9*d.height&&(c*=Math.sqrt(d.height/
(c*b*1.2)),c*=.9);return c};k.map_arguments=function(a,b){for(var c=a.length,d=0,e=[];d<c;)e.push(b(a[d])),d++;return e};k.conjunction=function(a,b){return a.map(function(c,d){if("undefined"===typeof c)return"anything";c=b?k.add_a_or_an(c):c;return d===a.length-2?c+" and ":d===a.length-1?c:c+", "}).join("")};k.insert_function_bird_documentation=function(a,b){var c=TOONTALK[a]["function"],d=Object.keys(c),e="<table class='toontalk-function-bird-documentation-table'>";d.forEach(function(a,b){e+="<tr><td><div id='bird_id_"+
b+"'></div></td><td class='toontalk-function-bird-name'>"+a+"</td><td class='toontalk-function-bird-title-documentation'>"+c[a].title+"</td></tr>"});e+="</table>";$(b).html(e);d.forEach(function(b,c){var d=window.TOONTALK.bird.create_function(a,void 0,b),e=d.get_frontside_element();d.update_display();$("#bird_id_"+c).replaceWith($(e).addClass("toontalk-function-bird-documentation-bird"));e&&(e.id=encodeURIComponent(b))})};k.rerender_all=function(){$(".toontalk-side").each(function(a,b){if(a=k.widget_side_of_element(b))a.update_display(!0),
a.set_visible(document.contains(b))})};k.visible_element=function(a){return a&&null!==a.offsetParent};k.get_audio_volume=function(c){var d=document.hidden?0:a.volume;0===d&&b.push({audio_object:c,volume:c.volume});return d};k.play_audio=function(a){a.play().then(function(){h.push(a);a.addEventListener("ended",function(){var b=h.indexOf(a);0<=b&&h.splice(b,1)})})};k.mute_audio_objects_playing=function(){h.forEach(function(a){b.push({audio_object:a,volume:a.volume});a.volume=0});h=[]};k.stop_audio_objects=
function(){h.forEach(function(a){a.pause();try{a.currentTime=0}catch(u){}})};k.restore_audio_volumes=function(){b.forEach(function(a){a.audio_object.volume=a.volume;h.push(a.audio_object)});b=[]};k.is_attached=function(a){return jQuery.contains(window.document,a)};k.when_attached=function(a,b,c){var d=a.toontalk_attached_callback;jQuery.contains(window.document,a)&&!c?b():(a.toontalk_attached_callback=function(){d&&d();b();$(a).removeClass("toontalk-has-attached-callback");a.toontalk_attached_callback=
void 0;a.toontalk_widget_side&&a.toontalk_widget_side.rerender()},c&&(a.toontalk_run_even_if_not_observable=!0),$(a).addClass("toontalk-has-attached-callback"))};k.create_event=function(a,b){try{var c=new CustomEvent(a,{detail:b})}catch(M){c=document.createEvent("CustomEvent"),c.initCustomEvent(a,!1,!1,b)}return c};k.create_queue=function(){var b=[],c=0;return{getLength:function(){return b.length-c},isEmpty:function(){return 0==b.length},enqueue:function(c){var d=0==b.length;b.push(c);a.logging&&
0<=a.logging.indexOf("queue")&&console.log(c._debug_string+" enqueued");return d},dequeue:function(){if(0!=b.length){var d=b[c];a.logging&&0<=a.logging.indexOf("queue")&&console.log(d._debug_string+" dequeued");2*++c>=b.length&&(b=b.slice(c),c=0);return d}},peek:function(){return 0<b.length?b[c]:void 0},does_any_item_satisfy:function(a){var d;for(d=c;d<b.length;d++)if(a(b[d]))return!0;return!1}}};k.number_to_words=function(a){var b=a.indexOf("/"),c=function(a){var b="  half third fourth fifth sixth seventh eighth ninth tenth eleventh twelfth thirteenth fourteenth fifteenth sixteenth seventeenth eighteenth nineteenth twentieth".split(" ");
if(20>=a)return b[a];if(0===a%10&&100>a)return"thirtieth fortieth fiftieth sixtieth seventieth eightieth ninetieth".split(" ")[a/10-3];if(100===a)return"hundredth";if(1E3===a)return"thousandth";if(1E4===a)return"ten thousandth";if(1E5===a)return"hundred thousandth";if(1E6===a)return"millionth";if(1E7===a)return"ten millionth";if(1E8===a)return"hundred millionth";if(1E9===a)return"billionth"};if(0>b)return k.integer_to_words(a);var d=a.substring(0,b);var e="1"!==d&&"-1"!==d;return b+3>=a.length||!e&&
b+11>=a.length?(c=c(parseInt(a.substring(b+1))))?k.integer_to_words(d)+" "+c+(e?"s":""):k.integer_to_words(d)+" over "+k.integer_to_words(a.substring(b+1)):k.integer_to_words(a.substring(0,b))+" over "+k.integer_to_words(a.substring(b+1))};k.integer_to_words=function(a){var b="",c=" un duo tre quattuor quin se septe octo nove".split(" "),d="   *   sx mn  mx".split(" "),e=" deci viginti triginta quadraginta quinquaginta sexaginta septuaginta octoginta nonaginta".split(" "),f=" n ms ns ns ns n n mx m".split(" "),
g=" centi ducenti trecenti quadringenti quingenti sescenti septingenti octingenti nongenti".split(" "),h=" nx n ns ns ns n n mx m".split(" "),k=" milli dumilli tremilli quadrinmilli quinmilli sesmilli septinmilli octinmilli nonmilli".split(" "),l=" decimilli vigintimilli trigintamilli quadragintanmilli quinquagintamilli sexagintamilli septuagintamilli octogintamilli nonagintamilli".split(" "),m=" centimilli ducentimilli trecentimilli quadringentimilli quingentimilli sescentimilli septingentimilli octingentimilli nongentimilli".split(" "),
n=" milli-milli milli-dumilli milli-tremilli milli-quadrinmilli milli-quinmilli milli-sesmilli milli-septinmilli milli-octinmilli milli-nonmilli".split(" "),p="thousand million billion trillion quadrillion quintillion sextillion septillion octillion nonillion".split(" "),q,r=function(c){var d=0,e="",f;for(f=0;f<c;f++)if("0"!==a[f]||0<d)e+=a[f],d++;if(e){c=b;e=parseInt(e);f=" one two three four five six seven eight nine ten eleven twelve thirteen fourteen fifteen sixteen seventeen eighteen nineteen twenty".split(" ");
var g=" ten twenty thirty forty fifty sixty seventy eighty ninety".split(" "),h="";100<=e&&(h+=f[Math.floor(e/100)]+" hundred",e%=100,0<e&&10>e&&(h+=" and"));20<e?(""!=h&&(h+=" "),h+=g[Math.floor(e/10)],e%=10,0<e&&(h+="-")):""!=h&&0<e&&(h+=" ");0<e&&(h+=f[e]);b=c+h.toString()}return d},t=function(a,b){var c,d;if(void 0!==a&&void 0!==b)for(c=0;c<a.length;c++)for(d=0;d<b.length;d++)if(a[c]==b[d]||"*"===a[c]&&("s"===b[d]||"x"===b[d]))return b[d]};"-"===a[0]&&(b+="negative ",a=a.substring(1));for(;0<
a.length&&"0"===a[0];)a=a.substring(1);if(0===a.length)return"zero";for(q=a.length;;){" "!==b[b.length-1]&&(b+=" ");if(4>q){0===r(q)&&","===b.substring(b.length-1)&&(b=b.substring(0,b.length-1));break}var v=q-4;var w=1+v%3;var x=r(w);a=a.substring(w);q-=w;if(0<x){" "!==b[b.length-1]&&(b+=" ");var y=Math.floor(v/3);w=y%10;if(10>y)b+=p[y];else{x=Math.floor(y/10%10);v=Math.floor(y/100%10);var z=Math.floor(y/1E3%10);var A=Math.floor(y/1E4%10);var C=Math.floor(y/1E5%10);var D=Math.floor(y/1E6%10);var E=
c[w];y=e[x];var F=g[v];z=k[z];A=l[A];C=m[C];D=n[D];var G=void 0;E&&(b+=E,G=d[w]);y&&((w=t(G,f[x]))&&(b+=w),G=void 0,b+=y);F&&((w=t(G,h[v]))&&(b+=w),G=void 0,b+=F);b+=z;b+=A;b+=C;b+=D;"a"===b[b.length-1]&&(b=b.substring(0,b.length-2)+"i");b+="llion"}b+=","}}b=b.trim();c=b.lastIndexOf(", ");if(0<=c)return b.substring(0,c)+" and"+b.substring(c+1);","===b[b.length-1]&&(b=b.substring(0,b.length-1));return b};k.test_number_to_words=function(a){var b;for(b=0;b<a;b++){var c=Math.round(1E9*Math.random());
console.log(c+" = "+k.number_to_words(c.toString()))}};k.for_each_batch=function(a,b,c,d){var e;if(0!==a.length){void 0===d&&(d=0);c||(c=100);var f=Math.min(a.length,d+c);for(e=d;e<f;e++)try{b(a[e],e)}catch(pa){if(k.is_stack_overflow(pa)){k.set_timeout(function(){k.for_each_batch(a,b,c,e)});return}throw pa;}f<a.length&&k.set_timeout(function(){k.for_each_batch(a,b,c,f)})}};k.element_width=function(b){var c=$(b);if(c.is(".toontalk-conditions-contents"))return a.UTILITIES.get_toontalk_css_numeric_attribute("width",
".toontalk-conditions-container");if(!c.is(".toontalk-not-observable"))return $(b).width()};k.element_height=function(b){var c=$(b);if(c.is(".toontalk-conditions-contents"))return a.UTILITIES.get_toontalk_css_numeric_attribute("height",".toontalk-conditions-container");if(!c.is(".toontalk-not-observable"))return $(b).height()};k.resizable_and_scalable=function(a,b){var c=1,d=1,e;$(a).resizable({start:function(a,b){e={width:b.size.width,height:b.size.height}},resize:function(f,g){f={width:g.size.width,
height:g.size.height};$(a).is(".toontalk-backside-of-top-level")||(c*=f.width/e.width,d*=f.height/e.height,b(c,d),e=f)},handles:"n,e,s,w,se,ne,sw,nw"})};k.string_to_array=function(a,b){for(var c=[];a.length>b;)c.push(a.substr(0,b)),a=a.substr(b);c.push(a);return c};k.listen_for_speech=function(b){if(a.listen)if(window.speechSynthesis.speaking)setTimeout(function(){k.listen_for_speech(b)},1E3);else{var c=b.language||0<document.getElementsByClassName("goog-te-menu-value").length&&document.getElementsByClassName("goog-te-menu-value")[0].firstChild.innerText;
ecraft2learn.start_speech_recognition(function(a,c){b.descriptions_acceptable&&b.widget&&k.spoken_command_is_a_description(a,b.widget)?b.widget.rerender():b.names_acceptable&&b.widget&&k.spoken_command_is_a_naming(a,b.widget)?b.widget.rerender():b.success_callback&&b.success_callback(a,c)},b.fail_callback,void 0,c)}};k.stop_listening_for_speech=function(){"undefined"!==typeof ecraft2learn&&"function"===typeof ecraft2learn.stop_speech_recognition&&ecraft2learn.stop_speech_recognition()};k.spoken_command_is_a_description=
function(a,b){var c;0===a.indexOf("i am")?c=a.substring(5):0===a.indexOf("i'm")&&(c=a.substring(4));if(c)return(k.get_dragee_copy()||b).set_description(c,!0,!0),k.display_message("The description of the "+b.get_type_name()+' is now "'+c+'"'),!0};k.spoken_command_is_a_naming=function(a,b){var c;if(b.get_name&&(0===a.indexOf("my name is ")?c=a.substring(11):0===a.indexOf("call me ")&&(c=a.substring(8)),c))return(k.get_dragee_copy()||b).set_name(c,!0,!0),k.display_message("The name of the "+b.get_type_name()+
' is now "'+c+'"'),!0};k.download_file=function(a,b,c){var d=new XMLHttpRequest;d.open("GET",a);c&&d.setRequestHeader("Authorization","Bearer "+c);d.onload=function(){b(d.responseText)};d.onerror=function(){b(null)};d.send()};k.set_parameter=function(b,c){a[b]=c;"TRANSLATION_ENABLED"===b&&c&&v()};k.together_send_message=function(a){if(!(a.simulatedEventMessage||"drag"===a.type&&$(a.target).is(".toontalk-backside-of-top-level"))&&TogetherJS.require){var b=TogetherJS.require("elementFinder"),c=$(a.target).data("json"),
d=["pageX","pageY"];a instanceof MouseEvent&&(d=d.concat("altKey button buttons clientX clientY ctrlKey metaKey movementX movementY region screenX screenY shiftKey".split(" ")));var e={type:a.type+"_together",event_class:a.constructor.name,event_type:a.type,offsetLeft:a.target.offsetLeft,offsetTop:a.target.offsetTop,dragXOffset:c?c.view.drag_x_offset:0,dragYOffset:c?c.view.drag_y_offset:0,target:b.elementLocation(a.target),currentTarget:b.elementLocation(a.currentTarget),relatedTarget:a.relatedTarget&&
b.elementLocation(a.relatedTarget)};d.forEach(function(b){e[b]=a[b]});TogetherJS.send(e)}};k.initialize=function(b){var d=function(){var b=function(b,c,d,e,f){b=document.getElementById(b);if(b){if(a.CHROME_APP){var g=function(a){k.add_iframe_popup(c)};g=k.create_button(d,"toontalk-manual-button",e,g)}else g=document.createElement("a"),g.innerHTML=d,g.title=e,c&&(g.href=c,g.target="_blank"),$(g).addClass("ui-widget toontalk-help-link"),k.use_custom_tooltip(g);b.appendChild(g);$(g).css(f);return g}};
b("toontalk-manual-button","docs/manual/index.html?reset=1","Learn","Click to visit the page that introduces everything.",{background:"yellow"});b("toontalk-manual-tour","docs/tours/tour1.html?reset=1","Watch","Click to visit a page that replays a tour.",{background:"pink"});b("toontalk-manual-whats-new","docs/manual/whats-new.html?reset=1","What's new?","Click to visit see what has changed recently.",{background:"cyan"});if(a.together){var c=b("toontalk-together-button",void 0,"Work with others",
"Click to work with someone else.",{background:"orange"});c["data-end-togetherjs-html"]="Stop collaborating";c.addEventListener("click",function(){TogetherJS(c)},!1);window.TogetherJSConfig_on_close=function(){c.innerHTML="Work with others";c.title="Click to start collaborating with others."};window.TogetherJSConfig_on_ready=function(){c.innerHTML="Work alone";c.title="Click to stop collaborating."};TogetherJS.hub.on("togetherjs.hello-back",window.TogetherJSConfig_on_ready);var d=function(a){if(a.sameUrl){var b=
TogetherJS.require("elementFinder");try{var c="drop"===a.event_type?b.findElement(a.currentTarget):b.findElement(a.target),d="MouseEvent"===a.event_class?new MouseEvent(a.event_type,a):new DragEvent(a.event_type,a);d.simulatedEventMessage=a;c.dispatchEvent(d)}catch(Ha){console.error(Ha)}}};["dragstart_together","dragend_together","drop_together","drag_together"].forEach(function(a){TogetherJS.hub.on(a,d)})}},e=function(b){try{window.speechSynthesis.cancel()}catch(aa){}try{k.backup_all_top_level_widgets(!0)}catch(aa){a.UTILITIES.report_internal_error(aa)}};
b=function(){f=function(a){$(".toontalk-top-level-resource-container").each(function(a,b){(a=b.toontalk_widget_side)&&a.set_running&&a.set_running(!1)})};a.debugging=k.get_current_url_parameter("debugging");a.logging=k.get_current_url_parameter("log");a.together=k.get_current_url_boolean_parameter("together",!1);a.maximum_recursion_depth=32;a.volume=k.get_current_url_numeric_parameter("volume",10)/100;a.puzzle=k.get_current_url_boolean_parameter("puzzle",!1);a.open_backside_only_if_alt_key=k.get_current_url_boolean_parameter("alt_key_to_open_backside",
a.puzzle);a.reset=k.get_current_url_boolean_parameter("reset",a.puzzle);a.speak=k.get_current_url_boolean_parameter("speak",!1);a.listen=k.get_current_url_boolean_parameter("listen",!1);a.speak&&!window.speechSynthesis&&(a.speak=!1,k.display_message("This browser doesn't support speech output. speak=1 in URL ignored."));a.listen&&"undefined"===typeof SpeechRecognition&&"undefined"===typeof webkitSpeechRecognition&&(a.listen=!1,k.display_message("This browser doesn't support speech input. listen=1 in URL ignored."));
a.balloons=k.get_current_url_boolean_parameter("balloons",!0);a.TRANSLATION_ENABLED=k.get_current_url_boolean_parameter("translate",!1);a.FONT_ASPECT_RATIO=.64;a.animation_settings||(a.animation_settings={BIRD_ANIMATION_SPEED:.5,ROBOT_ANIMATION_SPEED:.25,BAMMER_ANIMATION_SPEED:.75,ANIMATION_SPEED:.5,OPEN_BACKSIDE_DURATION:500,CHANGE_SIZE_DURATION:1E3,BUTTON_USE_DELAY:200,STOP_TRAINING_DELAY:1500,PAUSE_BETWEEN_STEPS:50,PAUSE_BETWEEN_BIRD_STEPS:50});window.document.addEventListener("click",f);a.DEFAULT_QUEUE=
window.TOONTALK.queue.create();a.DEFAULT_QUEUE.start();a.CHROME_APP?chrome.runtime.onSuspend.addListener(e):window.addEventListener("beforeunload",e);a.TRANSLATION_ENABLED?v():$("#google_translate_element").remove();a.vacuum.the_vacuum||a.vacuum.create();k.add_test_all_button();d();O("toontalk-robot",a.robot);O("toontalk-empty-nest",a.nest);O("toontalk-bird-static",a.bird);$("[title]").each(function(a,b){k.use_custom_tooltip(b)});TOONTALK.RUNNING_LOCALLY||(function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=
e;a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)};a[e].l=1*new Date;f=b.createElement(c);g=b.getElementsByTagName(c)[0];f.async=1;f.src=d;g.parentNode.insertBefore(f,g)}(window,document,"script",a.CHROME_APP?TOONTALK.TOONTALK_URL+"libraries/analytics.js":"https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-57964541-1","auto"),a.CHROME_APP?(ga("set","checkProtocolTask",function(){}),ga("require","displayfeatures"),ga("send","pageview","/options.html")):ga("send","pageview"));
document.addEventListener("visibilitychange",function(){document.hidden?k.mute_audio_objects_playing():(k.rerender_all(),k.restore_audio_volumes())});setTimeout(function(){a.DISPLAY_UPDATES.update_display()},100);"undefined"===typeof a.cross_origin_url_function?k.download_file("https://toontalk.appspot.com/p/https%3A%2F%2Fdrive.google.com%2Fuc%3Fid%3D0B0taMM6vlEqQaWprd2d1ZnlmQWs",function(b){b&&"working"===b.trim()&&(a.cross_origin_url_function=function(a){return"https://toontalk.appspot.com/p/"+
encodeURIComponent(a)},a.is_already_cross_origin_url=function(a){return 0===a.indexOf("https://toontalk.appspot.com/p/")});k.process_json_elements()}):k.process_json_elements();S=a.together?1:(new Date).getTime();c=!0;document.dispatchEvent(a.UTILITIES.create_event("toontalk_initialized",{}));0<a.volume&&setTimeout(J)};var f;c||(k.get_current_url_parameter("replace-with-url")?T(b):b())};k.do_after_initialization=function(a){c?a():document.addEventListener("toontalk_initialized",a)};return k}(window.TOONTALK);
window.initialize_toontalk=window.TOONTALK.UTILITIES.initialize;
